<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">A Flexible Demand Model for Complements Using Household Production Theory</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2020-07-15">July 15, 2020</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Ludovic</forename><surname>Stourm</surname></persName>
							<email>stourm@hec.fr</email>
							<affiliation key="aff0">
								<orgName type="institution">HEC Paris</orgName>
								<address>
									<postCode>78350</postCode>
									<settlement>Jouy-en-Josas</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Raghuram</forename><surname>Iyengar</surname></persName>
							<email>riyengar@wharton.upenn.edu</email>
							<affiliation key="aff1">
								<orgName type="department">Wharton School</orgName>
								<orgName type="institution">University of Pennsylvania</orgName>
								<address>
									<postCode>19104</postCode>
									<settlement>Philadelphia</settlement>
									<region>Pennsylvania</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Eric</forename><forename type="middle">T</forename><surname>Bradlow</surname></persName>
							<email>ebradlow@wharton.upenn.edu</email>
							<affiliation key="aff1">
								<orgName type="department">Wharton School</orgName>
								<orgName type="institution">University of Pennsylvania</orgName>
								<address>
									<postCode>19104</postCode>
									<settlement>Philadelphia</settlement>
									<region>Pennsylvania</region>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">A Flexible Demand Model for Complements Using Household Production Theory</title>
					</analytic>
					<monogr>
						<idno type="ISSN">0732-2399 (print)</idno>
						<imprint>
							<date type="published" when="2020-07-15">July 15, 2020</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1287/mksc.2019.1218</idno>
					<note type="submission">Received: August 22, 2017 Revised: October 16, 2018; July 31, 2019; November 9, 2019 Accepted: December 2, 2019</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.2" ident="GROBID" when="2021-07-06T11:30+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>utility theory</term>
					<term>multicategory demand models</term>
					<term>Bayesian estimation</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>According to household production theory, consumers buy inputs and combine them to produce final goods from which they derive utility. We use this idea to build a micro-level model for the quantity demanded by a consumer across product categories. Our model proposes an intuitive explanation for the existence of negative cross-price effects across categories and can be estimated on purchase data in the presence of corner solutions and indivisible packages. We find that, even when reusing the same functional form as some previous models of demand for substitutes, our model can accommodate very different patterns of consumer preferences from perfect complementarity to no complementarity between goods. We estimate the model on purchase data from a panel of consumers and find that it yields a better fit than a set of benchmark models. We then show how the demand system estimated can be used to increase the profitability of couponing strategies by taking into account the spillover effect of coupons on demand for complementary categories and by manufacturers to make decisions regarding the size of packages by taking into account cross-category consumption. We also use the model to simulate demand under a shift in the proportions used in joint consumption, which could be stimulated via marketing efforts.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Consumers commonly purchase multiple goods to consume them jointly. For example, they buy burgers and buns to make sandwiches, they combine detergent and softener for their laundry, or eat crackers with dips. From a managerial point of view, crosscategory consumption provides an opportunity for coordinated promotion and pricing across goods. A rigorous analysis of optimal marketing strategy, therefore, first requires a model of demand in a way that takes into account the volumes purchased by consumers across categories. Not surprisingly, modeling demand across categories has been an important area of research in the marketing literature.</p><p>By leveraging household-level data of purchases made across categories and over time, marketing researchers have built models to estimate demand at the micro level <ref type="bibr" target="#b12">(Manchanda et al. 1999</ref><ref type="bibr" target="#b13">, Mehta 2007</ref><ref type="bibr" target="#b20">, Song and Chintagunta 2007</ref><ref type="bibr" target="#b16">, Niraj et al. 2008</ref><ref type="bibr" target="#b14">, Mehta and Ma 2012</ref><ref type="bibr" target="#b10">, Lee et al. 2013</ref>). Many of these econometric models take a utility-maximization paradigm to obtain parameters that are invariant to policy changes. In this paradigm, the starting point is that consumers choose to buy the quantities of goods that maximize their utility under a budget constraint. The goal of estimation is, therefore, to find the parameters of the model that best explain the purchases observed under the assumption that these purchases are the result of an optimization problem. From this common setup, two main approaches, which specify a parametric form on two different economic objects, have been developed.</p><p>In the first approach, the researcher specifies a functional form for the consumer's indirect utility and applies Roy's identity to derive the demand function, which relates the parameters of the indirect utility function to the consumer's quantity decisions as a function of prices. The translog indirect utility specification is often used as it can approximate any function at a second-degree level and can yield substitution and/or complementarity effects between goods. In the second approach, the researcher parameterizes the consumer's direct utility function and solves the firstorder conditions (FOCs) to obtain the demand system. In that framework, additively separable utility specifications cannot yield negative cross-price effects under a linear budget constraint <ref type="bibr" target="#b3">(Chintagunta and Nair 2011)</ref>, but they can be achieved using quadratic specifications with interaction terms <ref type="bibr" target="#b7">(Kim et al. 2010</ref>).</p><p>In either approach, however, the model does not provide any intuitive explanation for the existence of complementary effects across categories: although interaction terms can yield negative cross-price effects, they do not inform the researcher why two categories are complementary.</p><p>In this paper, we develop a new approach that provides a micro-foundation on how complementarity is generated across categories as a result of preferences for joint consumption uses. Our approach relies on household production theory <ref type="bibr" target="#b0">(Becker 1965</ref><ref type="bibr" target="#b15">, Muth 1966</ref>): the original consumer problem is altered to distinguish between inputs that can be purchased and latent final goods that can be consumed and provide utility. We represent the joint consumption of multiple inputs by a separate final good: for example, buns and burgers can be purchased (and consumed separately), but sandwiches can be produced from buns and burgers. Formally, the consumer has a utility function defined on goods consumed (e.g., sandwiches, burgers and buns) but can only buy inputs (e.g., burgers and buns). He or she decides not only what inputs to purchase but also what final goods to produce for his or her own consumption. This conceptual model is equivalent to the original one if we assume that the final goods are identical to the goods purchased, but it is more general if we assume that a broader set of final goods can be produced from the goods purchased.</p><p>We show that this conceptual model is useful to derive a flexible model of purchases across complements even if consumption is unobserved because it allows us to specify a parametric form for the utility of final goods. While a direct utility on inputs purchased can always be derived from the utility of final goods, its functional form is not straightforward. In fact, even an additively separable functional form for the utility on final goods, which we utilize in our model specification, can capture very different patterns of preferences for inputs purchased, including perfect complementarity.</p><p>In an empirical application, we estimate our model on purchase data from a panel of consumers, focusing on the tortilla chips and Mexican salsa categories. We find that it fits the data better than a set of benchmark models based on the deviance information criterion (DIC) and performs well in predicting purchase incidence and quantity. We also show the usefulness of our model to determine the optimal distribution of retailer coupons in a set of counterfactual analyses. We find that the retailer can make a higher profit by taking into account the spillover effects of coupons across categories, which can be measured using our flexible demand system. We also illustrate how the model can be used to inform package size decisions by manufacturers, thus demonstrating its potential value to both retailers and manufacturers. In addition, we use the parameters estimated to simulate demand under a shift in the proportions used in joint consumption, which may be possible by marketing that encourages the increased or decreased use of one product with another.</p><p>The rest of the paper is organized as follows. In Section 2, we formalize the economic problem of a consumer making quantity choices across related goods and review the econometric models that have been derived from it in the marketing literature. In Section 3, we lay out our general model of consumer behavior based on household production theory and show its usefulness for empirical work by studying the flexible patterns of consumer preferences it can imply over goods purchased. In Section 4, we study the properties of the demand system. In Section 5, we introduce stochastic elements in the model and describe its estimation; we also run a simulation study to investigate the consequences of ignoring complementarity between goods across categories. Section 6 describes an application of our model on household-level purchase data, and how it can inform managerial decisions in the context of retailer coupons manufacturer, package-size decisions, and in influencing changes in the proportions used by consumers when combining goods together. Section 7 concludes with a discussion of the main contributions and limitations of our model and ideas for future research.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Formalization and Literature</head><p>Suppose we want to model the quantities purchased by a consumer across J goods of interest. In the simplest microeconomic model, the consumer has a utility function U defined on the quantities of these goods x (x 1 , . . . , x J ) and the quantity y of an outside good. After observing the prices p, he or she chooses to buy the quantities that maximize his or her utility within his or her budget M. Mathematically, the consumer problem is represented as</p><formula xml:id="formula_0">V p, M ( ) max x∈X ,y≥0 U x, y ( ) subject to : p x ( ) + y ≤ M,<label>(1)</label></formula><p>where x belongs to a feasible set X , p(x) is the dollar amount to be paid to buy the quantities x of inside goods, and the price of the outside good is normalized to one. In this maximization problem, U is the direct utility, V is the indirect utility, and the demand system x * (p, M) gives the optimal quantities. From the observation of prices and the quantities purchased by consumers, the goal of demand estimation consists in characterizing the demand function so that one can measure the effect of prices on demand and/or predict demand under alternative scenarios with different prices p, budget M, or constraints on the set X .</p><p>Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements</p><p>Empirically estimating a demand model requires one to make parametric assumptions. While the papers by <ref type="bibr" target="#b12">Manchanda et al. (1999)</ref> and <ref type="bibr" target="#b5">Gentzkow (2007)</ref> focus only on purchase incidence, previous models of quantity rely mainly on two different approaches by specifying a functional form either for the indirect utility V or for the direct utility U. An indicative summary of previous models is presented in Table <ref type="table" target="#tab_0">1</ref>; the article by <ref type="bibr" target="#b3">Chintagunta and Nair (2011)</ref> provides an excellent review of that literature.</p><p>In the indirect-utility approach, the researcher specifies a functional form for V. The researcher then applies Roy's identity to obtain the demand function:</p><formula xml:id="formula_1">x * j − ∂V/∂p j ∂V/∂M .</formula><p>The estimation problem consists in finding those parameters of V that best fit the data. This approach has been used to model demand across substitutable and complementary categories, providing an integrated framework for purchase incidence, volume, and brand decisions <ref type="bibr" target="#b13">(Mehta 2007</ref><ref type="bibr" target="#b20">, Song and Chintagunta 2007</ref><ref type="bibr" target="#b14">, Mehta and Ma 2012</ref>. Parameterizing the indirect utility V bypasses the problem of specifying a functional form for the direct utility U and is thought to be a more flexible approach because the indirect utility can always be derived from a direct utility specification, but the reverse is not true. The translog indirect utility specification is often used as it can approximate any twice continuously differentiable function V at a second degree <ref type="bibr" target="#b13">(Mehta 2007</ref><ref type="bibr" target="#b20">, Song and Chintagunta 2007</ref><ref type="bibr" target="#b14">, Mehta and Ma 2012</ref>.</p><p>In a second approach pioneered by <ref type="bibr" target="#b6">Kim et al. (2002)</ref>, the researcher specifies a functional form for the direct utility U and derives the demand function by solving the first-order conditions of the consumer problem in Equation ( <ref type="formula" target="#formula_0">1</ref>). This approach is appealing because it allows one to accommodate different pricing schemes and/or constraints present in the real world by changing the feasible set X and the price function p. For example, <ref type="bibr" target="#b19">Satomura et al. (2011)</ref> allow for multiple constraints (such as a volume constraint) instead of a single budget constraint; <ref type="bibr" target="#b9">Lee and Allenby (2014)</ref> capture the indivisibility of demand by including integer constraints on the feasible set. Through these extensions, researchers have gained a richer understanding of the impact of prices and packaging on demand. To model demand for complements in that approach, one cannot resort to additively separable utility functions of the form U x (x 1 , . . . , x J ) ∑ J j 1 φ j (x j ) as they can only yield nonnegative cross effects of prices on demand under a linear budget constraint <ref type="bibr" target="#b3">(Chintagunta and Nair 2011)</ref>. However, quadratic utility specification with interaction terms can yield negative cross-price effects. Alternatively, <ref type="bibr" target="#b10">Lee et al. (2013)</ref> assume a sequential decision process whereby consumers make purchase decisions one category at a time: at each stage, the consumer maximizes a category-specific utility function that may be affected by purchase decisions in previous categories through an effect of inventories. Although this model allows the authors to capture asymmetric cross-price effects, it does not derive from the maximization of a joint utility function, which can restrict its applicability in counterfactual analyses, especially in measuring the effect of policy changes on consumer welfare.</p><p>We develop a third approach, which relies on household production theory as introduced by <ref type="bibr" target="#b0">Becker (1965)</ref> and <ref type="bibr" target="#b15">Muth (1966)</ref>. In this view, households buy inputs Notes. The third column indicates whether the demand system is derived from one utility maximization (which is necessary for welfare calculations). The models by <ref type="bibr" target="#b12">Manchanda et al. (1999)</ref> and <ref type="bibr" target="#b10">Lee et al. (2013)</ref> do not fit that category as they define one separate utility function per product category, and in <ref type="bibr" target="#b4">Dubé (2004)</ref>, the quantity chosen depends on an exogenous Poisson process. The fourth column indicates whether quantity is modeled <ref type="bibr" target="#b12">(Manchanda et al. (1999)</ref>, <ref type="bibr" target="#b5">Gentzkow (2007)</ref>, and <ref type="bibr" target="#b11">Liu et al. (2010)</ref> only model purchase incidence). The fifth column indicates whether the model allows for complementarity as defined by the existence of negative cross-price effects between goods. The last column indicates whether the model recognizes the indivisibility of demand resulting from package constraints. Most models assume that the goods are infinitely divisible; <ref type="bibr" target="#b4">Dubé (2004)</ref> and <ref type="bibr" target="#b16">Niraj et al. (2008)</ref> take the package sizes as given and model the integer units purchased by the consumer, but their models cannot be used to analyze the effect of divisibility because they do not model the consumer utility as a function of volumes.</p><p>Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements</p><p>Marketing <ref type="bibr">Science, 2020</ref><ref type="bibr">, vol. 39, no. 4, pp. 763-787, © 2020</ref> to produce final goods that they consume: as such, they are both producers (with a production function that transforms inputs into final goods) and consumers (with a utility function defined on final goods). In our context, we represent the joint consumption of two (or more) complements as a distinct final good that is produced and consumed by the household. We apply this idea to design a demand model for complements that allows for corner solutions and discrete demand resulting from indivisible packages. We thus build complementarity in the consumer's preferences and derive the cross-price effects from the primitives: in that sense, we extend Gentzkow ( <ref type="formula">2007</ref>) by allowing for the choice of quantity instead of just incidence.</p><p>Our work is closely related to the latent separability concept defined by <ref type="bibr" target="#b1">Blundell and Robin (2000)</ref>, which is a property of direct utility functions. Like the authors, we recognize that parts of the same input can be allocated to different final goods. For example, consumers may eat some burgers by themselves and combine some with buns to make sandwiches. Unlike <ref type="bibr" target="#b1">Blundell and Robin (2000)</ref>, however, we do not require fewer final goods than inputs: in fact, we include more final goods than inputs. This is because they seek to reduce the dimensionality of a large demand system by grouping goods into latent groups and we aim at flexibly estimating the demand across a small set of goods.</p><p>Our approach is also closely related to the characteristics model by <ref type="bibr" target="#b2">Chan (2006)</ref> in which the consumer derives utility from the hedonic attributes that are present in the goods he or she purchases. In both approaches, utility is not derived directly from the goods purchased but from a transformation of these goods into benefits (consumption uses in our model, hedonic attributes in the characteristics model); while the utility specification is additively separable in terms of these benefits, it is not in terms of the goods purchased because of this transformation. In the model by <ref type="bibr" target="#b2">Chan (2006)</ref>, the transformation from goods purchased into benefits is specified a priori by the researcher using available data on the goods' attributes; in our approach, the transformation arises as the solution to an optimal consumption problem as the consumer decides how to allocate the goods purchased into consumption uses. While the characteristics model is highly scalable and provides a good explanation for the existence of complementarity between items of the same category, its explanatory power for complements may be limited if the goods purchased cannot be adequately represented by a common set of additive attributes, which is likely to happen if the goods belong to different product categories. In contrast, our approach provides an explanation for the existence of complementarity between goods from different categories but is less scalable.</p><p>Thus, we focus in this paper on cross-category demand estimation with a small number of categories, and we provide thoughts, when possible, that could make our approach more scalable in the future. In the next section, we discuss our model in more depth.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Model of Consumer Preferences</head><p>We start by laying out the general model of household production. Then we describe our parametric assumptions and study the implications of the resulting model for consumer preferences over goods purchased.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.">Consumer Problem with Household Production</head><p>By considering household production, we make a conceptual distinction between the inputs that the consumer can purchase on the market and the final goods that he or she can consume after producing them from the inputs. For example, a consumer may be able to buy burgers and buns, which are sold separately on the market, but to eat a sandwich, he or she first needs to produce it by combining a bun and a burger. In this example, burgers and buns are inputs, and sandwiches are final goods. Burgers and buns can also be consumed separately: as such, they are both inputs and final goods by themselves. We denote by J the number of distinct inputs, by K ≥ J the number of distinct final goods that can be produced from the J inputs, by x (x 1 , . . . , x J ) the volumes of inputs purchased, and by c (c 1 , . . . , c K ) the quantities of final goods constructed and consumed. Importantly, the consumer first needs to buy enough inputs to be able to produce the final goods. To do so, he or she has a budget M that he or she can spend across the inputs and to buy some quantity y of an outside good whose price is normalized to one. The consumer enjoys utility from consuming the final goods and the outside good, which is represented by a utility functionŨ(c, y). The consumer problem consists in buying the optimal volumes of inputs x and outside good y, and using the inputs to produce the optimal quantities of final goods c in a way that maximizes his or her utility:</p><formula xml:id="formula_2">1 V p, M ( ) max c,x,yŨ c, y ( ) subject to : p x ( ) + y ≤ M x ∈ X c ∈ C x ( ),<label>(2)</label></formula><p>where p(x) is the dollar amount to be paid by the consumer if he or she buys the volumes of inputs x and C(x) is the set of final goods that can possibly be produced from them. <ref type="bibr">2</ref> In this model, the consumer makes the best use of the inputs x by allocating them into the production of the optimal quantities of final goods c. Therefore, the Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements maximum value that the consumer can derive from input quantities x and outside good quantity y can be obtained as</p><formula xml:id="formula_3">U x, y ( ) max cŨ c, y ( ) subject to : c ∈ C x ( ).<label>(3)</label></formula><p>We can thus derive a utility U(x, y) on inputs purchased from the utility of final goods purchased U(c, y) by solving the optimal allocation problem in <ref type="bibr">Equation (3)</ref>. Under this definition of U(x, y), the consumer problem in Equation ( <ref type="formula" target="#formula_2">2</ref>) can be rewritten under the original form of Equation (1). From the point of view of the consumer's purchase behavior, our model is thus equivalent to the original problem considered in Equation (1). However, adding a production-consumption step allows us to parame-terizeŨ(c, y) and C(x) instead of U(x, y) in the directutility approach or V(p, M) in the indirect-utility approach. The relationship betweenŨ(c, y), U(x, y), and V(p, M) is explained in Figure <ref type="figure" target="#fig_0">1</ref>. In our approach, we specify a functional form onŨ(c, y) and solve the problem in Equation (2) to derive the demand system x * (p, M). It should be noted that, if we assume C(x) to be the identity correspondence (C(x) {x} ∀x so that there is no difference between goods purchased and goods consumed), then Equation (3) trivially implies U(x, y) Ũ (c, y). It is thus obvious that any parameterization of U(x, y) in a direct-utility model can easily be accommodated under our approach by setting C(x) to be the identity correspondence. In contrast, Equation (3) implies that a utility function over goods purchased U(x, y) can always be inferred from a utility function over goods consumedŨ(c, y); however, the derived expression of U may not be straightforward.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.">Parametric Assumptions</head><p>We represent the joint consumption of multiple inputs as a final good, which is obtained by combining the inputs in fixed proportions that are known to the consumer (but unknown to the analyst). Each input can also be consumed separately, either by itself or in conjunction with some other goods that are outside the scope of the analysis. We aggregate such outside consumption uses and represent them by a final good that is obtained directly from that input. 3 Therefore, the same input can be used to produce different final goods, and some final goods may require multiple inputs. We represent this by a Leontief production function that can be described by a J × K input-output table, denoted by A, such that a jk represents the volume of input j that is required to make one unit of final good k. For example, the input-output table may look like the following in the case of burgers and buns:</p><formula xml:id="formula_4">A ) ( separate burger separate bun sandwich burger 1 0 1 bun 0 1 1 . (<label>4</label></formula><formula xml:id="formula_5">)</formula><p>The set C(x) of final good quantities c that can be produced from input volumes x is the set of vectors c with nonnegative entries and such that ∑ k a jk c k ≤ x j for all j or in matrix form: Ac ≤ x.</p><p>Next, we parameterize the utility function for the final goods consumed and for the outside good as follows:Ũ</p><formula xml:id="formula_6">c, y ( ) Ũ c c ( ) + U y y ( )<label>(5a)</label></formula><p>with :Ũ c c ( )</p><formula xml:id="formula_7">∑ K k 1 ψ k log c k + 1 ( ) (<label>5b</label></formula><formula xml:id="formula_8">)</formula><formula xml:id="formula_9">U y y ( ) ψ 0 log y ( ) ,<label>(5c)</label></formula><p>where ψ 0 , ψ 1 , . . . , ψ K are parameters whose values are nonnegative. <ref type="bibr">4</ref> The log specification for the utility of the outside good allows for an income effect and, hence, for asymmetric cross-price derivatives as we discuss in Section 4.1. The functional form for U c in Equation ( <ref type="formula" target="#formula_6">5b</ref>) is commonly used to parameterize the utility for goods purchased U(x, y) in direct-utility models of demand <ref type="bibr" target="#b19">(Satomura et al. 2011</ref><ref type="bibr" target="#b10">, Lee et al. 2013</ref><ref type="bibr" target="#b9">, Lee and Allenby 2014</ref>. It has desirable properties: the log function captures monotonicity and concavity in its argument, and the intercept added inside the log allows for corner solutions. It should be noted that this functional form is additively separable, which makes it easy to solve the consumer problem; however, a model in which this form is used to parameterize U(x, y) would not be able to yield complementarity between the J goods of interest, as discussed earlier. By using this functional form to parameterizeŨ(c, y) instead, our model can actually capture very different patterns of preferences for complements as we show in the next section.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3.">Implications for Consumer Preferences over Goods Purchased</head><p>In this section, we show how our model of preferences over final goods (c, y) translates into preferences over goods purchased (x, y). Using Equations (3) Marketing <ref type="bibr">Science, 2020</ref><ref type="bibr">, vol. 39, no. 4, pp. 763-787, © 2020</ref> and (5a)-(5c), our parameterization ofŨ(c, y), implies the following utility for purchased goods U(x, y):</p><formula xml:id="formula_10">U x, y ( ) U x x ( ) + U y y ( )<label>(6a)</label></formula><p>where</p><formula xml:id="formula_11">U x x ( ) max c ∑ K k 1 ψ k log c k + 1 ( ) (6b) subject to : ∑ k a jk c k ≤ x j ∀j (6c) c k ≥ 0 ∀k .<label>(6d)</label></formula><p>Equations ( <ref type="formula" target="#formula_10">6b</ref>)-( <ref type="formula" target="#formula_10">6d</ref>) define the consumer's problem of optimally allocating inputs to construct final goods; it does not include the input prices or the budget, as it takes the quantities of inputs as given. This problem is mathematically very similar to the multiple-constraint model by <ref type="bibr">Satomura et al. (2011). 5</ref> The first-order conditions of the optimal allocation problem are as follows:</p><formula xml:id="formula_12">ψ k c k + 1 + λ k − ∑ j μ j a jk 0 ∀k λ k c k 0 ∀k μ j x j − ∑ k a jk c k ( ) 0 ∀j c k , μ k , λ j ≥ 0,<label>(7)</label></formula><p>where the coefficients λ k and μ j are Lagrange multipliers corresponding to the nonnegativity constraints on the quantities of final goods c k and the constraints on the amount of inputs available, respectively. In a case with J 2 inputs, K 3 final goods, and A ( 1 0 1 0 1 a 23 ), where a 23 represents the proportion of input 2 combined with each unit of input 1 to create the third final good, we can easily obtain the expression of the optimal quantities of final goods consumed as a function of the quantities of goods purchased:</p><formula xml:id="formula_13">c * 3 x ( ) min max 0, c int ( ) 3 x ( ) ( ) , x 1 , x 2 a 23 ( ) c * 1 x ( ) x 1 − c * 3 c * 2 x ( ) x 2 − a 23 c * 3 ,<label>(8)</label></formula><p>where c <ref type="bibr">(int)</ref> 3 is the solution to a second-degree equation as shown in Appendix A. The resulting utility over inputs purchased is then U x (x) U c (c * (x)), whose expression cannot be simplified.</p><p>Using the expression of U x , we illustrate in Figure 2 several indicative indifference curves obtained for different parameter values, holding the outside good constant and considering two goods for purchase. The results are quite remarkable: we obtain L-shaped indifference curves characteristic of perfect complementarity whereby an additional unit of a good does not provide more utility to the consumer unless it is accompanied by an additional unit of the other good (Figure <ref type="figure" target="#fig_2">2</ref>(a)), curves characteristic of independent goods (Figure <ref type="figure" target="#fig_2">2</ref>(b)), and asymmetric curves (Figure <ref type="figure" target="#fig_2">2(c</ref>)). Our model can clearly accommodate very different preferences. In contrast, we illustrate in Figure <ref type="figure" target="#fig_3">3</ref> some indifference curves obtained under an alternative specification of U x that does not make use of household production but instead contains an interaction term in the log quantities. The curves are far less flexible under the alternative specification: for example, perfect complementarity cannot be obtained because U x is strictly increasing in both x 1 and x 2 on the entire domain. It would thus be very difficult to specify a functional form for the utility on goods purchased U x (x) in a way that yields flexible complementarity patterns; in contrast, our parameterization of U c (c) has a closed-form expression and U x (x) follows directly from it. Thus, setting up the household production problem greatly facilitates the problem of specifying a convenient functional form for the purpose of demand estimation across complementary goods.</p><p>The next section elaborates on the properties of the demand system implied by the model as a function of the preference parameters.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">The Demand System</head><p>According to the model laid out in the previous section, the consumer buys the quantities of inputs that solve the optimization problem in Equation (2). We thus obtain a demand system x * (p, M; ψ, A), where the demand for each good j is a function of the prices p for a given value ψ of the consumer's preference parameters and given the input-output table A. In this section, we seek to evaluate the flexibility of our model to accommodate different demand systems. We therefore study how different values of ψ imply different effects of prices on demand. To do this, we first assume that any continuous quantities can be purchased: in that case, the consumer problem can be solved analytically, and we can derive useful insights. Then, we study through simulation a demand system when the goods can only be purchased as indivisible packages.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.">Demand Under Continuous Quantities</head><p>Let us assume that the J inputs can be purchased in any nonnegative, continuous quantities (such that X R J + ) and that prices are linear in quantities (such that p(x) ∑ j p j x j ). Because any continuous quantities of inputs can be purchased, the consumer buys the quantities that are exactly necessary to make the optimal quantities c * k of final goods: given that he or she does not keep inventories, buying more inputs    Notes. These plots represent the indifference curves obtained with an alternative utility specification:</p><formula xml:id="formula_14">U x x 1 , x 2 ( ) ψ 1 log x 1 + 1 ( )+ ψ 2 log x 2 + 1 ( )+ ψ 3 log x 1 + 1 ( )log x 2 + 1 ( ).</formula><p>In contrast to Figure <ref type="figure" target="#fig_2">2</ref>, the patterns vary much less with different parameter values.</p><p>Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>770</head><p>Marketing <ref type="bibr">Science, 2020</ref><ref type="bibr">, vol. 39, no. 4, pp. 763-787, © 2020</ref> would only come at an extra monetary cost. Thus, the demand for inputs must be such that</p><formula xml:id="formula_15">x * j ∑ K k 1 a jk c * k ∀j.<label>(9)</label></formula><p>In this model with continuous quantities, we can thus obtain the demand for inputs x * j by aggregating the optimal quantities of final goods c * k . To derive these optimal quantities c * k , it is useful to define the full price f k of each final good k as the dollar amount that the consumer needs to pay to produce one unit of that final good by buying all the necessary inputs:</p><formula xml:id="formula_16">f k ∑ J j 1 a jk p j .<label>(10)</label></formula><p>By using this definition, the consumer problem in Equation ( <ref type="formula" target="#formula_2">2</ref>) can be simplified and rewritten in terms of the final goods only:</p><formula xml:id="formula_17">max c,yŨ c, y ( ) s.t. ∑ K k 1 f k c k + y ≤ M.<label>(11)</label></formula><p>We show in Appendix B how to solve the first-order conditions of this revised consumer problem under our parameterization ofŨ(c, y). Our specification allows for corner solutions: only those final goods in a set _ are consumed in a positive quantity. The expression for the quantities of final goods consumed and for the quantity of outside good are then as follows:</p><formula xml:id="formula_18">c * k max 0, ψ k y * ψ 0 f k − 1 { } where y * ψ 0 M + ∑ l∈_ f l ( ) ψ 0 + ∑ l∈_ ψ l .<label>(12)</label></formula><p>As explained in Appendix B, the set _ of final goods k for which c * k &gt; 0 can be found by sorting marginal utilities in decreasing order and comparing them to the marginal utility of the outside good. Furthermore, we can compute the derivatives of final good quantities with respect to their full prices for k, k in _:</p><formula xml:id="formula_19">∂c * k ∂f k ψ k ψ 0 + ∑ l∈_ ψ l 1 f k − M+ ∑ l∈_ f l f 2 k I k k ( ) [ ] ≤ 0 if k k ψ k ψ 0 + ∑ l∈_ ψ l × 1 f k &gt; 0 if k k . ⎧ ⎪ ⎪ ⎪ ⎨ ⎪ ⎪ ⎪ ⎩ (13)</formula><p>Thus, the full price f k of a final good k has a negative effect on the quantity consumed c k of that final good. Furthermore, the concave utility for the outside good leads to substitution between two final goods k and k as the terms ∂c * k /∂f k are negative; in addition, these cross-price derivatives are asymmetric. <ref type="bibr">6</ref> Next, by combining Equations ( <ref type="formula" target="#formula_15">9</ref>) and ( <ref type="formula" target="#formula_18">12</ref>), we can calculate the demand for input goods x * j as a function of input prices p j :</p><formula xml:id="formula_20">x * j ∑ K k 1 a jk max 0, ψ k y * ψ 0 f k − 1 { } ∀j. (<label>14</label></formula><formula xml:id="formula_21">)</formula><p>From this, we can directly see that the price of an input j negatively impacts its demand x * j as, for each final good k that uses input j (such that a jk &gt; 0), an increase in p j leads to an increase in f k and, therefore, a decrease in c * k . The derivatives of input quantities with respect to their prices are as follows:</p><formula xml:id="formula_22">∂x * j ∂p j ∂ ∑ K k 1 a jk c * k ( ) ∂p j ∑ k a jk ∑ k ∂c * k ∂f k × ∂f k ∂p j ∑ k∈_ ∑ k ∈_ a jk a j k ∂c * k ∂f k .<label>(15)</label></formula><p>From Equation ( <ref type="formula" target="#formula_22">15</ref>), we can make several observations. First, two inputs j and j that are never used jointly in household production (i.e., for which there is no k such that a jk &gt; 0 and a j k &gt; 0) are substitutes as they feature positive cross-price effects because of the negative terms ∂c k /∂f k , where k k . Second, if two goods j and j are used jointly in the household production of a final good k (such that a jk &gt; 0 and a j k &gt; 0), the cross-price derivative ∂x * j /∂p j includes the term ∂c * k /∂f k , which is negative; thus, our model allows for negative cross-price effects, which define complements. <ref type="bibr">7</ref> Third, if two goods j and j are exclusively used for the household production of one final good k, then they are perfect complements; if they are used in the same proportions, a one-dollar increase in the price of good j has the same effect on demand for good j as a one-dollar increase in the price of good j ; if they are used in different proportions, then the price effects are weighted by the proportions of each input in the construction of the joint final good. Finally, the cross-price derivatives ∂x * j /∂p j are not symmetric in general because the cross-price derivatives ∂c * k /∂f k are themselves not symmetric. Overall, our modeling approach allows for complementarity between two goods if they are used jointly in the household production of a final good; the cross-price effects can be asymmetric, and the concavity of the utility for the outside good also allows for some form of substitution. In the next section, we study by simulation the demand system under integer constraints.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2.">Demand Under Discrete Quantities</head><p>When goods can only be purchased in indivisible packages, the inputs purchased are constrained to lie on a grid such that x ijt ∈ {0, s j , 2s j , 3s j , . . .}, where s j is the amount of volume contained in one package of good j. For example, if buns are sold by packs of eight, then the consumer can buy 0, 8, or 16 buns, but not five. Consistent with <ref type="bibr" target="#b9">Lee and Allenby (2014)</ref>, we thus set the feasible set as the Cartesian product: X ∏ j {0, s j , 2s j . . .}. Furthermore, the price paid for quantities x is linear in the number of packages: p(x) ∑ j p j (x j /s j ), where p j is the price of one package. Given the integer constraints in the consumer problem, we cannot derive a closed-form expression for the demand system. Instead, we obtain the optimal purchase quantities x * (p, M) by searching on a grid for the values of x that maximize the consumer's objective function. <ref type="bibr">8</ref> To investigate the properties of the demand system when quantities are discrete, we must then use simulation. For exposition, we focus on the case in which J 2, K 3, and A ( 1 0 1 0 1 a 23 ) for some positive value of a 23 (in Section 5.5, we discuss the extension to more than two goods). In this case, the two inputs can be consumed separately (as represented by final goods 1 and 2) or jointly (as represented by a composite final good 3), and a 23 represents the proportion of input 2 that is combined with one unit of input 1 when they are consumed jointly.</p><p>In Table <ref type="table" target="#tab_4">2</ref>, we provide a summary of the demand system for various values of the parameters ψ and a 23 at different price points, assuming a setup in which each of the two goods is sold by packs that contain s j 10 units of content. We set the consumer budget equal to $50 and consider two price points for each good ($0.50 and $1.00 per pack). We add some random noise to the parameters ψ to investigate how the parameter values and prices impact the probability of purchase incidence for each good, the probability of purchase co-incidence and the expected quantity purchased of each good E[x j ].</p><p>In the first set of columns, we consider a case of perfect complementarity in which the preference parameters for separate consumptions ψ 1 and ψ 2 are set to zero but the utility of a joint consumption is positive (ψ 3 &gt; 0). In this case, the two goods are only purchased together. If the proportions used for joint consumption are the same for both inputs (a 23 1), the quantities purchased are equal, and a price discount for good 1 has the same effect as a price discount for good 2. If joint consumption requires twice more volume of input 2 than input 1 (e.g., a 23 2), the consumer buys on average more of good 2 than good 1 but not exactly twice as much because the goods are sold in indivisible packages (sometimes he or she may find it best to buy one pack of each good).</p><p>In the second set of columns, we consider a case of no complementarity, in which the separate consumptions bring utility (ψ 1 &gt; 0, ψ 2 &gt; 0) but the joint consumption brings no utility (ψ 3 0). In that case, purchase incidences are independent across the two goods, and the value of a 23 has no effect on demand because the joint final good is never produced by the consumer. In addition, a price discount for one good does not affect the quantity purchased of the other good.</p><p>In the last set of columns, we consider a case in which the separate consumptions and the joint consumption bring utilities (ψ 1 &gt; 0, ψ 2 &gt; 0, ψ 3 &gt; 0). In that case, purchase incidences are correlated, and a price discount for one good increases the quantity purchased of both goods, but to a lesser extent for the complementary good. Overall, the main arguments given in Section 4.1 also apply when demand is constrained because of indivisible packages, and we can see that the demand system can take many forms depending on the values of the preference parameters ψ 1 , ψ 2 , ψ 3 and the proportion a 23 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Econometric Model</head><p>In this section, we introduce stochastic elements to the model, discuss its estimation and the identification of its parameters, and perform simulations to show its robustness when applied to goods that are not complementary.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1.">Random Shocks and Consumer Heterogeneity</head><p>We now make adjustments in the model so that it can be applied to purchase data, in the absence of consumption data. Let us introduce the subscript i to refer to a consumer and the subscript t to indicate a specific purchase occasion. Suppose that we follow N consumers, and each consumer i has T i purchase occasions on which we observe the prices of packages p ijt that he or she faces and the volumes of goods x ijt that he or she buys. We take a random-utility approach to rationalize the consumer's purchase decisions under the consumer problem in Equation (2). Specifically, we assume that the ψ parameters in consumer i's utility functionŨ cit at time t account for person-, time-, and final good-specific random shocks:</p><formula xml:id="formula_23">ψ ikt ψ ik e ikt where ikt ∼ N 0, σ 2 k ( ) .<label>(16)</label></formula><p>The values ψ ik represent the stable part of the consumer's preferences and the shocks ikt , known to the consumer at time t, capture variation over time. Furthermore, we allow the proportion a i23 used in joint consumption to be heterogeneous across consumers.</p><p>The model only makes sense if the preference parameters ψ ik and a i23 are nonnegative: thus, we consider their logarithmic transformation. We collect all individual-level preference parameters into a vector ω i and model unobserved consumer heterogeneity through random coefficients:   </p><formula xml:id="formula_24">ω i ∼ iid MVNω, V<label>(</label></formula><formula xml:id="formula_25">)</formula><formula xml:id="formula_26">where ω i log ψ i1 ( ) , . . . , log ψ iK ( ) , log a i23 ( ) [ ] .<label>(</label></formula><formula xml:id="formula_27">Pr(x 1 &gt; 0) 26% 26% 18% 17% 17% 17% 25% 24% 21% Pr(x 2 &gt; 0) 26% 26% 18% 17% 17% 17% 25% 24% 22% Pr(x 1 &gt; 0&amp;x 2 &gt; 0) 26% 26% 18% 3% 3% 3% 12% 10% 8% E[x 1 ]</formula><p>3.7</p><p>2.9</p><p>1.8</p><p>1.9</p><p>1.9</p><p>1.9</p><p>2.8</p><p>2.5 2.3</p><formula xml:id="formula_28">E[x 2 ]</formula><p>2.7 2.9 2.7</p><p>1.9</p><p>1.9</p><p>1.9</p><p>2.6 2.5 2.4</p><formula xml:id="formula_29">p 1 0.50, p 2 1.00 Pr(x 1 &gt; 0) 19% 19% 12% 17% 17% 17% 22% 21% 20% Pr(x 2 &gt; 0) 19% 19% 12% 9% 9% 9% 13% 13% 11% Pr(x 1 &gt; 0&amp;x 2 &gt; 0) 19% 19% 12% 1% 1% 1% 7% 6% 4% E[x 1 ] 2.9 2.0 1.3 1.9 1.9 1.9 2.4 2.3 2.1 E[x 2 ]</formula><p>2.0 2.0 1.6 0.9 0.9 0.9</p><p>1.4</p><p>1.3</p><formula xml:id="formula_30">1.2 p 1 1.00, p 2 0.50 Pr(x 1 &gt; 0) 19% 19% 12% 9% 9% 9% 13% 13% 11% Pr(x 2 &gt; 0) 19% 19% 12% 17% 17% 17% 22% 21% 20% Pr(x 1 &gt; 0&amp;x 2 &gt; 0) 19% 19% 12% 1% 1% 1% 7% 6% 4% E[x 1 ] 2.3 2.0 1.3 0.9 0.9 0.9 1.4 1.3 1.2 E[x 2 ]</formula><p>1.9 2.0 2.1 1.9</p><p>1.9</p><p>1.9</p><formula xml:id="formula_31">2.3 2.3 2.2 p 1 1.00, p 2 1.00 Pr(x 1 &gt; 0) 14% 15% 9% 9% 9% 9% 12% 11% 10% Pr(x 2 &gt; 0) 14% 15% 9% 9% 9% 9% 12% 11% 10% Pr(x 1 &gt; 0&amp;x 2 &gt; 0) 14% 15% 9% 0.6% 0.6% 0.6% 4% 3% 2% E[x 1 ]</formula><p>1.8 1.5 0.9 0.9 0.9 0.9</p><formula xml:id="formula_32">1.3 1.2 1.1 E[x 2 ]</formula><p>1.4 Thus, in any period t, the consumer solves the consumer problem in which his or her preference parameters are such that ψ ikt ψ ik e ikt and in which demand is restricted because each good j is sold in indivisible packages that contain a volume s j .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2.">Likelihood and Estimation</head><p>The purchase bundle x is chosen by the consumer if it yields the highest utility among all possible bundles given the prices and the consumer's budget and preferences; otherwise, it is not optimal. To evaluate the probability that the consumer chooses the bundle x (conditional on the prices p, the consumer's preference parameters ψ, and the proportion a 23 he or she uses), we must therefore calculate an integral over the region of random shocks ϵ such that x is optimal.</p><p>Let us define the "optimality function" formally as</p><formula xml:id="formula_33">m x|p, M, ψ, a 23 ( ) I x * p, M; ψ, a 23 ( ) x { } ,<label>(18)</label></formula><p>where I{.} is the indicator function and x * (p, M; ψ, a 23 ) is the demand under prices p, budget M, and preference parameters ψ and a 23 as explained in Section 4.2. Consumer i's contribution to the likelihood can then be written as follows:</p><formula xml:id="formula_34">L i ω i , σ 2 ( ) ∏ T i t 1 ∫ ϵ it m x it |p it , M it , ψ ik e ikt { } k , a i23 ( ) × ∏ k N ikt |0, σ 2 k ( ) [ ] dϵ it ,<label>(19)</label></formula><p>where x it is the observed purchase decision by user i in trip t, ϵ it is a collection of all the shocks ikt , and N(.|μ, σ 2 ) is the probability density function of the univariate normal distribution with mean μ and variance σ 2 . The integral in Equation ( <ref type="formula" target="#formula_34">19</ref>) cannot be simplified; thus, we apply data augmentation to estimate the model. Our estimation algorithm, laid out in Appendix C, is similar to the "error augmentation" procedure used by <ref type="bibr" target="#b9">Lee and Allenby (2014)</ref>.</p><p>The next section discusses the identification of the model parameters.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3.">Identification</head><p>The parameters of our model can be identified from patterns of purchases as a function of prices. The ψ k parameters capture the consumer's utility for final goods: as such, they are defined relative to the marginal utility for the outside good ψ 0 ; we fix their scale by setting ψ 0 1. Different values of ψ k yield different own-and cross-price effects as discussed in Section 4. Thus, they are identified by the own-and cross-effects of prices on purchases; the magnitude of the price effects are smaller when the ψ k parameters are larger.</p><p>In the case considered earlier in which the number of inputs is J 2, high cross-price effects are picked up by a higher value of ψ 3 ; a low value of ψ 3 indicates no cross-price effects. Separate from cross-price effects, the random shocks ϵ are identified by the variance and correlation in purchase behavior across the J goods.</p><p>The proportion used in combining different inputs for a joint consumption (a 23 ) is identified by the proportions in quantities purchased when there is a joint purchase. Finally, the variation in purchase behavior at the individual level can be disentangled from consumer heterogeneity when the model is estimated on panel data with multiple observations per consumer. The simulation provided next furthers our discussion of identification.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.4.">Simulation Study</head><p>We ran two sets of simulations to investigate the possible consequences of ignoring (or allowing for) complementarity between two goods when estimating demand as a function of prices. For this analysis, we considered two different versions of our proposed model. Model 1 is our model that allows for complementarity with an input-output table A ( 1 0 1 0 1 a 23 ). For Model 2, we shut off any complementarity between goods by setting A equal to the identity matrix: consequently, K 2, there is no joint consumption, and the cross-price effects between goods purchased are forced to be zero.</p><p>We generated a data set for each of the two models, using that model as the true data-generating process. We generated the preference parameters of 200 consumers from a multivariate normal distribution with a meanω and a covariance matrix V. We considered packs of sizes 16 and 10, respectively; unit prices were drawn from a uniform distribution in the interval <ref type="bibr">[1,</ref><ref type="bibr">4]</ref>, and consumer budgets were drawn from a log-normal distribution. <ref type="bibr">9</ref> For each consumer, we generated 100 purchase occasions and solved for the optimal purchase quantities. Each resulting data set contained the prices observed by consumers and the quantities purchased of each good; we discarded the consumption data as this is unobserved in practice.</p><p>On both data sets, we estimated Models 1 and 2; we provide the results in Tables <ref type="table" target="#tab_6">3 and 4</ref>. The first set of rows indicates our estimates of the average preference parametersω along with their posterior standard error in parentheses. To compare how the models fit the data, we have reported the DIC of each model, which penalizes models with a higher complexity; a lower value of the DIC indicates a better fit. We have also reported, for each good, the hit rate of the models' purchase incidence predictions and the root mean squared error (RMSE) of their volume predictions (converted in package units) both in sample and out of sample on another data set Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements generated in the same fashion. We have also reported the own-and cross-price elasticities, which were computed by simulating the aggregate demand assuming a 10% increase in the price of each good. For each draw of the parameters from our sampler, we computed aggregate demand by first solving the consumer problem at each purchase occasion and then summing up the quantities purchased across periods and consumers. We computed the price elasticity of demand for each draw and reported the mean elasticities across posterior draws along with their posterior standard deviations in parentheses.</p><p>We can make several observations from these results. First, we recovered the true parameters and price elasticities within their 95% posterior intervals for each data set when estimating the "true" model. In both simulations, the true model fits the data best based on the DIC and other model fit criteria. While expected, these results confirm that the parameters of our model can be empirically identified and that our estimation procedure can recover them.</p><p>The estimation results also provide insights about the effect of capturing or ignoring complementarity between the goods. In the first data set generated, the consumer derives utility from the joint consumption of goods as indicated by the value ofω 3 . This leads to the existence of negative cross-price effects as shown by the sign of the true cross-price elasticities. On that data set, the model that does not allow for complementarity (Model 2) not only yields zero cross-price elasticities, but also leads to a significant bias in the estimation of own-price elasticity for good 2.</p><p>Conversely, the second data set was generated according to Model 2, which does not include utility for the joint consumption of goods purchased. However, it should be noted that Model 1, which allows for such complementarity, accurately estimates the true preference parameters for separate consumptionsω 1 andω 2 and yields a very large value for the proportion a 23 . Because such a high proportion a 23 makes it costly to buy all the necessary inputs for a joint consumption, the consumer prefers to consume the goods separately rather than jointly, and thus, the demand system can be reduced to the demand system of Model 2, in which the joint consumption does not exist. Consequently, the model yields accurate own-price elasticities and insignificant cross-price elasticities. Taken together, these results suggest that our model yields accurate results even in the absence of complementarity and that ignoring complementarity across goods can lead to substantial biases in the estimation of the own-price elasticities of these goods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.5.">Extension to J &gt; 2</head><p>In this section, we discuss how the model can be applied to estimate the demand for more than two goods. In this case, we still need to include J final goods representing the separate consumption of each input, and to allow for some slack when the input is not entirely exhausted through joint consumption with other inputs. Thus, the first J final goods represent the separate consumption uses of the inputs, and the other final goods (J + 1 to K) represent the joint consumption of at least two inputs. This leads to the following structure of A:</p><formula xml:id="formula_35">A I A 2 ( ), (<label>20</label></formula><formula xml:id="formula_36">)</formula><p>where I is the J × J identity matrix, and A 2 corresponds to the proportions used in the joint consumption of multiple inputs.</p><p>If there are J goods, there can be up to 2 J − 1 final goods. For each final good, we need to estimate a preference parameter ψ k as well as parameters giving the proportions of the necessary inputs. Thus, the number of parameters that need to be estimated increases exponentially with J. Without imposing any restrictions, extending the model to a case with a large J would therefore lead to some challenges. First, the computational burden increases: although our estimation algorithm remains valid, deriving the demand function requires an evaluation of the utility of each bundle of inputs, which grows exponentially in J.</p><p>Second, the data requirement increases: the researcher needs more observations to identify all the parameters of the model. In that regard, it should be noted that the unrestricted model (with K 2 J − 1 final goods) yields not only own-and cross-price effects, but also any N-way interaction effect of prices on demand (for any N ≤ J), which can be derived from the demand system given in Equation ( <ref type="formula" target="#formula_20">14</ref>). Thus, the parameters of such a model would be identified through all these price effects, whose number also grows exponentially. To reduce the dimensionality and make computation easier, some restrictions likely need to be imposed. For example, one could use managerial judgment or prior information on consumption uses to rule out some final goods (for example, we can eat burgers with ketchup and burgers with mustard but not ketchup with mustard). The researcher could also focus solely on final goods that can be produced from at most two (or three) different inputs; this would a priori rule out some interaction price effects. We note that many extant models have fewer parameters precisely because they do not allow for interaction effects of prices on demand. Regardless, we view scalability as one needed area for future extension of our work.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Empirical Application</head><p>This section discusses an application of our model to a data set of purchases made by a panel of consumers in the tortilla chips and Mexican salsa categories. We first describe the data, then we present our estimation results, and finally, we discuss three counterfactual analyses to show how our model can be used to make improved decisions in the distribution of coupons by retailers, in packaging by manufacturers, and in influencing changes in the proportions used by consumers when combining goods together.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1.">Data</head><p>The data were collected by AC Nielsen and are made of two parts. The first part contains data about a set of households that report their purchases over time using a scanner device at home: it provides the information about all shopping trips made by the households, the number of units purchased, and the price paid for each item purchased. Prices are only observable when a purchase is made; therefore, we combine the data about households with the second part of the data, which gives us store-level prices for each item each week. For our empirical application, we chose the tortilla chips and Mexican salsa categories, which are a classic example of complementary goods as they are often consumed together; we focused on a twoyear time window from 2010 to 2011. We focused, respectively, on the 10-and 16-ounce package sizes, which are the predominant formats in these categories. We aggregated prices to the category level by taking an average of brand-specific prices weighed by market share. We restricted the data to households making at least eight purchases in each of the two categories over the two-year period as is common in models that estimate heterogeneous effects. Finally, we operationalize the budget M as the total shopping expenditure during each trip as is commonly done in the literature <ref type="bibr" target="#b20">(Song and Chintagunta 2007)</ref>.</p><p>The resulting data set contained 251 consumers, each consumer making 151 shopping trips on average. Table <ref type="table" target="#tab_8">5</ref> gives some summary statistics of the data. Consumers bought multiple units of chips or salsa in 30% of their purchases, which indicates the need for a model of quantity. Consumers often bought both goods together as indicated by the high percentage of purchase co-incidence relative to the marginal percentages of incidence. We estimated logit models of incidence for each category (as reduced-form exploration) to investigate the effect of prices on demand with and without household-specific fixed effects. The results are displayed in Table <ref type="table" target="#tab_9">6</ref> and suggest that prices have a negative effect on demand within and across categories. The results also suggest the existence of heterogeneity across households.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2.">Estimation Results</head><p>We estimated two versions of our model on the data: our full model of complementary demand based on household production theory (Model 1) and the restricted model that rules out complementarity by setting A equal to the identity matrix (Model 2) as in the simulation study. We also estimated a hierarchical Bayesian multivariate probit model similar to <ref type="bibr" target="#b12">Manchanda et al. (1999)</ref> (Model 3) on the incidence data (discarding the quantity information) as a benchmark model to evaluate how well our model could predict purchase incidences. Finally, we estimated a hierarchical Bayesian Poisson regression for each product category to model the count of units purchased; both univariate models were combined under Model 4. The multivariate probit model and the Poisson models included an intercept, the price of chips and the price of salsa as predictors; we used random coefficients to capture consumer heterogeneity. For each model, we used a Bayesian estimation algorithm to generate 500,000 draws of the parameters from their Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements <ref type="bibr">Marketing Science, 2020</ref><ref type="bibr">, vol. 39, no. 4, pp. 763-787, © 2020</ref> posterior distribution. We discarded the first 100,000 draws and kept one draw every 100 draws thereafter to reduce autocorrelation. We ran three separate chains to assess convergence <ref type="bibr" target="#b18">(Rubin and Gelman 1992)</ref>.</p><p>In Table <ref type="table" target="#tab_10">7</ref>, we have compiled, for each model, our estimates of the population-level mean parameters along with the corresponding posterior standard deviation in parentheses. We have also reported the DIC of each model except for Model 3 because its likelihood is not comparable as it was only applied to the incidence data. Based on the DIC criterion, Model 1 fits the data better than Model 2, which suggests evidence of complementarity between salsa and chips, and it also fits better than Model 4. We also reported the hit rate of the models' purchase incidence predictions and the RMSE of their volume predictions (converted in package units) both in sample and out of sample for each category. <ref type="bibr">10</ref> The incidence hit rates obtained under Model 1 are better than those obtained under Model 3 even though Model 3 focuses only on incidence predictions and ignores quantities. Model 1 makes better incidence predictions than Model 4 based on the hit rates, but Model 4 makes slightly better volume predictions. These results are remarkable given that Model 1 contains only four consumer-specific parameters (ψ 1 , ψ 2 ψ 3 and a 23 ) and Models 3 and 4 contain six consumer-specific parameters (two intercepts, two own-price effects, and two cross-price effects).</p><p>Finally, we have reported the own-and crossprice elasticities along with their standard errors in parentheses. We note that the negative cross-price elasticities under Model 1 are statistically significant and nonnegligible. When comparing the difference in own elasticities between Models 1 and 2 from this real data empirical application (Table <ref type="table" target="#tab_10">7</ref>) and those from the simulation (Table <ref type="table" target="#tab_6">3</ref>), we note a similar pattern: Model 2 tends to overestimate the own-price elasticities.</p><p>Our estimates from Model 1 suggest that the preference parameter for joint consumption (ψ 3 ) is not larger than the preference parameter for a separate consumption of salsa (ψ 1 ) or a separate consumption of chips (ψ 2 ). This may be because people seek variety by attributing some of the inputs purchased to either separate or joint consumption uses. In the next section, we investigate further the consumption uses as inferred from our model, which highlights the value of our direct utility model on final goods consumed rather than inputs purchased.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.3.">Inferred Consumption</head><p>According to our model, the consumer has a consumption plan in mind when deciding to buy the goods x: he or she plans to allocate these inputs into different possible uses represented by a bundle c of final goods (separate consumption of salsa, separate consumption of chips, joint consumption of salsa and chips). We remind the reader that a separate consumption of salsa does not necessarily mean that the consumer eats salsa by itself but rather that the consumer consumes salsa without chips as explained in Section 3.2: for example, he or she may put salsa inside  burrito tortillas; similarly, he or she can eat chips without salsa but with guacamole. While purchases are observable, the consumption plans are not. However, we can use the posterior draws obtained from our Bayesian estimation algorithm to infer those consumption plans under our model. To do this, we reconstructed the preference parameters ψ ikt and the proportions a i23 for each consumer trip and for each posterior draw, and we solved the optimal consumption problem in Equation (3) given the observed quantities of goods purchased x ijt to determine the optimal consumption quantities c * ikt . We then aggregated the consumption plans by taking an average across draws and trips. We present a breakdown of those consumption plans in Figure <ref type="figure" target="#fig_5">4</ref>.</p><p>Because chips and salsa cannot be consumed jointly unless they are purchased together (under the maintained assumption that no inventory is carried between trips), we must infer that salsa is consumed separately when the consumer only buys salsa (and similarly for chips). We thus focus our attention on trips in which the consumer buys both salsa and chips. Out of those trips, we find that, in 22.5% of cases, the salsa and chips are consumed entirely separately; in 23.9% (20.0%), the consumer exhausts all the salsa (chips) by consuming it with the chips (salsa); in the remaining 33.6% of cases, the consumer uses, on average, 58.2% of the salsa and 54.4% of the chips for joint consumption and consumes the rest of the inputs separately. Overall, these results suggest a large portion of joint consumption, which one might expect given the two product categories, but not equal to one as both are also consumed for other purposes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.4.">Counterfactuals</head><p>We now run counterfactual analyses to show how our model can be used to make improved decisions in the distribution of coupons to consumers, which is useful for retailers, and in the choice of package size, which is important for manufacturers. We also simulate an alternative scenario in which people mix chips and salsa in different proportions that could be stimulated via marketing.</p><p>6.4.1. Coupons. Retailers commonly use categorylevel coupons by which they offer consumers a discount if they buy an item of any brand within a product category. <ref type="bibr" target="#b17">Rossi et al. (1996)</ref> have shown that a manufacturer can substantially increase its profit by tailoring the depth of coupons to each consumer based on his or her preferences as estimated from his or her transaction history. Building on their analysis, we seek to evaluate the importance for retailers to account for the spillover effect of coupons across categories when distributing customized coupons to consumers (not simply within the category in which the coupon is issued). Our model is well suited to simulate demand under alternative scenarios in which coupons are distributed because it recognizes both the discreteness of demand resulting from indivisible packages and cross-category effects. Similar to <ref type="bibr" target="#b17">Rossi et al. (1996)</ref>, we consider a targeted couponing problem in which the retailer decides the optimal distribution of coupons to consumers in a way that maximizes its profit, by determining which consumers should receive a coupon and what should be the face values of these coupons. We consider the problem of distributing coupons for salsa assuming that no coupons are distributed for chips, and the reverse problem. The expected profit made by the retailer across the two categories during the shopping trip of a consumer is given by the following equation:</p><formula xml:id="formula_37">E π [ ] ∑ j E q * j r j − F j × I q * j &gt; 0 ( ) [ ] ,<label>(21)</label></formula><p>where q * j is the number of packs bought by the consumer, 11 r j is the retailer's margin per package in category j, I(.) is the indicator function, and F j is the face value of the coupon distributed to consumer i prior to that shopping trip (if any). It should be noted that a coupon can only be used once even if the consumer buys multiple units: the marginal price of the second unit is higher than the first unit because the coupon cannot be redeemed a second time; thus, prices are no longer linear in quantity if coupons are distributed. Still, we can determine the optimal quantities q * j purchased by the consumer according to our model by searching on the grid of feasible demand points, taking into account the price paid at each point. We do this to simulate demand at each consumer trip in a series of counterfactual scenarios in which coupons of different face values are distributed. There is uncertainty about the optimal quantities in these counterfactual scenarios because we have uncertainty about the consumer's preference parameters: we thus solve the consumer problem for each of the posterior draws we obtained in our Bayesian estimation procedure, and we evaluate the expectation in Equation ( <ref type="formula" target="#formula_37">21</ref>) by taking an average across them. Calculating profit requires an assumption on the retailer's costs: consistent with <ref type="bibr" target="#b17">Rossi et al. (1996)</ref>, we assume that the retailer's margin r j on each package is $0.35. Furthermore, we only consider coupon face values between $0 and $0.35 in increments of 5 cents. By comparing the profit made by the retailer for these different face values, we identify which face value is optimal at each consumer trip. We repeated this process using Model 1 and then using Model 2 to investigate if there are differences in the coupons distributed when incorporating complementarity.</p><p>In Figure <ref type="figure" target="#fig_6">5</ref>, we plot the distribution of optimal coupon face values across all consumer trips under Model 1 (which takes into account the complementarity between salsa and chips) and Model 2 (which ignores it). We observe that the distribution of optimal coupons is shifted to the right when recognizing complementarity: under Model 1, the optimal face value of coupons is often higher than under Model 2 for both product categories. We explain these results as follows. Distributing retailer coupons in the salsa category can increase demand for that category but can also come at a cost as consumers who would normally buy salsa may get a discount without changing their buying behavior: in that case, the coupon comes as a windfall to those consumers. In contrast, the spillover effect on a complementary category should be positive as salsa coupons can induce more people to buy chips and do not create a windfall effect for normal chips buyers. Therefore one underestimates the total effect of coupons on profit when failing to recognize the spillover effect on a complementary category, which leads one to set face values that are too low.</p><p>To quantify the loss of profit when failing to recognize the cross-category spillover effect of coupons, we evaluated the aggregate profit made by the retailer across all trips when using Model 1 to customize salsa coupons (or chips coupons) and when using Model 2 instead. We used Model 1 as the reference model to simulate demand under both targeting scenarios because Model 1 fits our data best. In addition to profit, we also calculated the aggregate volume of salsa and the aggregate volume of chips bought by consumers and compared them with the baseline scenario when no coupons are distributed.</p><p>The results are reported in Table <ref type="table" target="#tab_12">8</ref>. We find that the relative increase in profit from distributing customized salsa coupons (chips coupons) is 5.9% (3.5%) larger when Model 1 is used to customize the face values compared with Model 2. An important part of this profit increase is due to the increase in demand for the complementary good: while the volume of salsa (chips) increases by about 4.9% (5.1%), the volume of its complement increases by about 0.6% (0.7%), which is quite important considering that the increase in volume of the complement does not come at the cost of more coupon redemptions in the complementary category.</p><p>Taken together, these results suggest that it may be important for retailers to take into account the spillover effect of coupons on demand for a complementary category when distributing retailer coupons. We have proposed a methodology to customize these coupons by using our model of demand, which can be readily Marketing <ref type="bibr">Science, 2020</ref><ref type="bibr">, vol. 39, no. 4, pp. 763-787, © 2020</ref> applied to simulate demand under counterfactual scenarios with discrete packages and the nonlinear in prices implied by coupons. 6.4.2. Package Size. We now study the effect of the package sizes set by manufacturers, which is of managerial importance <ref type="bibr" target="#b8">(Koenigsberg et al. 2010)</ref>. While <ref type="bibr" target="#b9">Lee and Allenby (2014)</ref> have studied the effect of pack size on demand within a single category and have shown that large packages can restrain consumers from making a purchase in that category, our model allows us to simulate consumers' reactions across complementary goods. Measuring this crosscategory effect is important because many manufacturers produce complementary goods, and their overall profit depends on demand across these goods. Moreover, changing a pack size can be costly for a manufacturer: a counterfactual analysis based on a structural model is therefore well suited to study this problem.</p><p>We simulated four alternative scenarios in which the sizes of packages were modified. Specifically, we considered doubling the size of a salsa jar or reducing it by half, and similarly for bags of chips. We assumed that prices were linear in volume such that, when 16ounce salsa jars were replaced by 32-ounce (8-ounce) salsa jars, the unit price of a jar was doubled (reduced by half). Using our posterior draws of the consumer's individual parameters and of their random shocks , we determined the consumer's purchase decision in these alternative scenarios for each trip. <ref type="bibr">12</ref> We then aggregated the volume sold in each category, the incidence rate, and the overall revenue generated by taking an average across draws and summing up across trips. The results are displayed in Table <ref type="table" target="#tab_11">9</ref>.</p><p>Within each category, we find that smaller packages lead to higher rates of purchase incidence, consistent with <ref type="bibr" target="#b9">Lee and Allenby (2014)</ref>; however, it reduces the overall volume as many consumers switch from buying a big pack to buying a small pack. More interestingly, decreasing the pack size of one good increases both the rate of purchase incidence and the volume of its complementary good as more consumers buy the complementary good for joint consumption. This second result could depend on the parameter values; it is mostly driven by an increase in joint purchase incidence in our context. Furthermore, our results indicate that higher levels of revenue are achieved with bigger pack sizes; thus, it may be optimal for the firm to set high pack sizes and leave some people out of the market. Naturally, a manufacturer should also consider its costs and the price negotiations with retailers to set the profit-maximizing sizes, but our model can form the core of the demand-side prediction. It is also worth pointing out that prices do not need to be linear in volume and that manufacturers should consider the effect of competition with other manufacturers, which is absent from our model. Nevertheless, these counterfactual analyses  Notes. This table shows the effect of different couponing strategies on profit and volumes sold. The first column shows the effect of salsa coupons distributed optimally based on our model that takes into account cross-category complementarity (Model 1). The second column shows the effect of salsa coupons distributed using the model that ignores complementarity (Model 2). The third and fourth columns similarly show the effect of chips coupons.</p><p>Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements provide new insights and show the usefulness of our model in simulating demand in scenarios with different package sizes.</p><p>6.4.3. Change in Mixing Proportions. We now consider an alternative scenario in which there is a shift in consumption uses, whereby consumers use different proportions when mixing chips and salsa together. We seek to understand what would be the impact on the demand and on the revenue generated. Specifically, we have simulated, for each consumer, a 10% or 20% decrease or increase in the mixing proportion of salsa per volume of chips (1/a 23 ) when he or she consumes them jointly while holding the parameters ψ constant. We have determined the aggregate volumes and revenue in this alternative scenario, and we have reported the results in Table <ref type="table" target="#tab_0">10</ref>.</p><p>From the results, we note that a higher revenue is obtained with a higher proportion of salsa per chips or, conversely, a lower proportion a 23 of chips per salsa. While the direction of this result is expected as we hold constant the utility parameter ψ 3 for a joint consumption but reduce the number of chips required for a joint consumption, this analysis allows us to measure the magnitude of the effect and can help marketers decide whether it is worthwhile trying to encourage changes in consumption uses given this magnitude. Thus, the analysis illustrates the usefulness of our approach in measuring changes in demand under alternative household production functions, whereby consumers change the way they combine inputs together. Such analyses should be of interest to marketers who may be able to influence consumption uses through advertising.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.">Conclusion</head><p>In this paper, we have proposed a general approach to modeling micro-level demand for complementary goods by invoking household production theory. Under our approach, two goods are complementary if the consumer enjoys utility from their joint consumption, represented by a final good that he or she can produce from them. By assumption, he or she decides not only what goods to purchase, but also how to allocate them into final goods that represent consumption uses, which may be joint or separate. Therefore, the consumption utility is defined over a set of latent final goods that is larger than the set of goods purchased. The resulting demand system allows for negative cross-price effects under a linear budget constraint. Thus, our approach offers an intuitive theoretical foundation for the existence of negative cross-price effects.</p><p>From the point of view of purchase behavior, the new consumer problem can be reduced to the usual problem without household production by redefining the consumer's utility over goods purchased after recognizing that the allocation of goods purchased into consumption uses is optimal. However, laying out the consumer problem with a household production step is useful for empirical work even if consumption is unobserved because it opens up the possibility of parameterizing the consumption utility over the set of final goods, which is larger than the set of goods purchased. We can then use an additively separable specification and still accommodate very different patterns of preferences from no complementarity to perfect complementarity.</p><p>We embedded the household production model of consumer behavior in a structural model that takes into account consumer heterogeneity, corner solutions, and discrete demand because of indivisible packages. We proposed a Bayesian method to estimate the model on purchase data in the absence of consumption data. In an empirical application, we showed how our model could be used to make improved managerial decisions regarding the distribution of coupons by retailers. We found that a retailer could better target consumers and make a higher profit by recognizing the spillover effect of coupons on demand across complementary categories. We also showed how our model could be used to make decisions regarding the size of packages while taking into account the effect on demand across categories. Finally, we derived insights about consumption patterns by using our model to infer how the goods purchased are combined into consumption The approach we propose opens new ideas for future research. While we have focused on complementarity in this paper, we believe that the approach can be extended to obtain a flexible demand system for substitutes by changing the consumer's production function, such that two goods are substitutable if one or the other can be used to fulfill a consumption need, represented by a final good. In such a model, substitution between goods would come from the utility for the inside goods, in addition to the concave utility for the outside good. Furthermore, while we have specified our model at the category level in our empirical application, the model could be extended to include the choice of brands by combining our approach with a discrete choice model for brands. Finally, our approach opens up the opportunity of modeling demand across complementary categories while allowing for forward-looking behavior and flexible consumption. <ref type="bibr" target="#b21">Sun (2005)</ref> achieves flexible consumption within a single category by making the quantities consumed a decision variable; extending this approach to a multicategory setting with complementarity requires a consumption utility defined on quantities consumed and allowing for complementarity. We have shown in this paper that an approach based on household product theory can yield such a consumption utility and believe that nesting it within a forward-looking model of consumer behavior could yield interesting insights about the longrun effect of promotions across categories. In this section, we solve the consumer problem without integer constraints as defined in Equation ( <ref type="formula" target="#formula_17">11</ref>), Section 4.1:</p><formula xml:id="formula_38">max c,y ∑ K k 1 ψ k log c k + 1 ( )+ ψ 0 log y ( ) s.t. ∑ K k 1 f k c k + y ≤ M c k ≥ 0 ∀k.</formula><p>Let us denote by (c * 1 , . . . , c * K , y * ) the solution to that problem, which is unique by concavity of the objective function. In the optimal solution, the outside good must be consumed in a positive quantity (y * &gt; 0). We use the fact that all the final goods that are consumed in a positive quantity (such that c k &gt; 0) must have the same ratio of marginal utility to marginal cost:</p><p>• If c * l &gt; 0, then the marginal-utility-to-price ratio of final good l is equal to that of the outside good:</p><formula xml:id="formula_39">ψ l f l c * l + 1 ( ) ψ 0 y * ⇒ c * l ψ l • y * ψ 0 • f l − 1 ⇒ ψ l f l &gt; ψ 0 y * .</formula><p>• On the other hand, if c * l 0, then the marginal-utilityto-price ratio of good l is at most equal to that of the outside good:</p><formula xml:id="formula_40">ψ l f l ≤ ψ 0 y * .</formula><p>Therefore, if the final goods are indexed by decreasing ratio ψ k f k , then only the first K * goods are purchased in some positive quantity, in which K * is such that</p><formula xml:id="formula_41">ψ 1 f 1 ≥ • • • ≥ ψ K * f K * &gt; ψ 0 y * ≥ ψ K * +1 f K * +1 • • • ≥ ψ K f K .</formula><p>Under the assumption that K * is known, let us write z l c l + 1 and M z M + ∑ K * k 1 f l . Then (z * 1 , . . . , z * K * ) are solutions of the following optimization problem:</p><formula xml:id="formula_42">max z,y ∑ K k 1 ψ k log z k ( ) + ψ 0 log y ( ) s.t. ∑ K k 1 f k z k + y ≤ M z .</formula><p>Noticing that the objective function is the Cobb-Douglas utility function, the solution is well known as</p><formula xml:id="formula_43">z * k M z f k × ψ k ψ 0 + ∑ K * l 1 ψ l ; y * ψ 0 M z ψ 0 + ∑ K * l 1 ψ l ⇒ c * k ψ k M + ∑ K * l 1 f l (<label>)</label></formula><formula xml:id="formula_44">f k ψ 0 + ∑ K * l 1 ψ l ( ) − 1; y * ψ 0 M + ∑ K * l 1 f l (<label>)</label></formula><formula xml:id="formula_45">ψ 0 + ∑ K * l 1 ψ l .</formula><p>Additionally, K * is such that</p><formula xml:id="formula_46">ψ 1 f 1 ≥ • • • ≥ ψ K * f K * &gt; ψ 0 + ∑ K * l 1 ψ l M + ∑ K * l 1 f l ≥ ψ K * +1 f K * +1 • • • ≥ ψ K f K .</formula><p>That is,</p><formula xml:id="formula_47">K * ∑ K k 1 I ψ k f k &gt; ψ 0 + ∑ k l 1 ψ l M + ∑ k l 1 f l ( ) .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix C. Estimation by Markov Chain Monte Carlo</head><p>This section describes our Bayesian estimation algorithm to estimate the discrete model. We specify the following prior:</p><formula xml:id="formula_48">ω ∼ MVN ω 0 , Σ 0 ( ) V ∼ IW ν, Δ ( ) σ 2 ∼ InvGamma γ, β ( ) , (C.1)</formula><p>where we chose values that lead to diffuse priors (ω 0 0 K , Σ 0 10 4 I K , ν K + 3, Δ νI K , γ 1, β 1). For clarity of exposition, we write • Σ is the diagonal matrix whose diagonal elements are σ 2 1 , . . . , σ 2 K (variance of ϵ it ). • ψ * i [log(ψ i1 ), . . . , log(ψ iK )].</p><p>• z ikt log(ψ ikt ) log(ψ ik ) + ikt . We then have ω i (ψ * i , log(a i23 )) and z it ψ * i + ϵ it . In our estimation strategy, we sequentially draw ψ * i conditional on log(a i23 ) and log(a i23 ) conditional on ψ * i . For that reason, we decompose the mean of ω i asω (ω ψ ,ω a ) and its variance as V ( Vψψ Vaψ Vψa Vaa ). Because the integral in Equation ( <ref type="formula" target="#formula_34">19</ref>) has no closed-form solution, we rely on data augmentation <ref type="bibr" target="#b22">(Tanner and Wong 1987)</ref>. The general idea is to perform the numerical integration of a variable by taking draws of that variable within the sampler. We treat z it as the missing data that needs to be integrated out as it is mathematically more convenient than ϵ it (although ϵ it can be derived easily from z it and ω i ). Our complete algorithm is provided:</p><p>1. Initialize a i23 and z it for all consumers i and trips t by solving the FOC of the continuous consumer problem (i.e., without integer constraints).</p><p>2. For i 1 to N, a. Draw ψ * i |{z it } Ti t 1 , log(a i23 ),ω, V, Σ: Because ψ * i and log(a i23 ) are parts of vector ω i following a MVN(ω, V),</p><formula xml:id="formula_49">ψ * i |a i23 ,ω, V ∼ µ ψ , Θ ψψ ( ) , (C.2) where µ ψ ω ψ + V ψa V −1 aa log a i23 ( )−ω a [ ] Θ ψψ V ψψ − V ψa V −1 aa V aψ .</formula><p>Besides, we have</p><formula xml:id="formula_50">z it |ψ * i ∼ iid MVN ψ * i , Σ ( ) because z it ψ * i + ϵ it . (C.3)</formula><p>Using conjugacy, we can combine Equations (C.2) and (C.3) to obtain </p><formula xml:id="formula_51">ψ * i | z it { } Ti t 1 , a i23 ,ω, V, Σ ∼ MVN S 1 Σ −1 ∑ Ti t 1 z it + Θ −1 ψψ µ ψ [ ] , S 1 ( ) , (C.4)</formula><formula xml:id="formula_52">T i Σ −1 + Θ −1 ψψ [ ] −1 .</formula><p>b. Draw log(a i23 )|{z it } Ti t 1 , ψ * i ,ω, V: Because ψ * i and log(a i23 ) are parts of vector ω i following a MVN(ω, V), We cannot use conjugacy to derive the conditional distribution of a i23 from Equations (C.5) and (C.6). Instead, we perform a Metropolis-Hastings step.</p><formula xml:id="formula_53">log a i23 ( )|ψ * i ,ω, V ∼ Nω a + V aψ V −1 ψψ ψ * i −ω ψ [ ] , V aa − V aψ V −1 ψψ V</formula><p>c. For t 1 to T i (trips of consumer i), Draw z it |ψ * i ,log(a i23 ),Σ by a Metropolis-Hastings step using the facts that (C.7)</p><formula xml:id="formula_54">z it |ψ * i ∼ MVN ψ * i , Σ<label>(</label></formula><formula xml:id="formula_55">3. Drawω|{ω i } N i 1 , V ∼ MVN(S 2 [V −1 ∑ N i 1 ω i + Σ −1 0 ω 0 ], S 2 ), where S 2 (NV −1 + Σ −1 0 ) −1 . 4. Draw V|{ω i } N i 1 ,ω ∼ IW(N + ν,Δ + ∑ N i 1 (ω i −ω)(ω i −ω) ). 5. Draw Σ|{z it } i,t , {ω i } N i 1 : a. For k 1 to K, Draw σ 2 k |{z ikt } i,t , {ω i } N i 1 ∼ InvGamma (γ 0 + 1 2 ∑ N i 1 T i , β 0 + 1 2 ∑ N i 1 ∑ Ti t 1 2</formula><p>ikt ), where ikt z ikt − ψ * ik . b. Set Σ diag(σ 2 1 , . . . , σ 2 K ). 6. Go to 2.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Endnotes</head><p>1 We assume that it is not costly to produce final goods from inputs.</p><p>2 As in the usual consumer problem as laid out in Equation (1), it is assumed that the consumer does not carry an inventory of inputs between purchase occasions. We discuss thoughts on dynamic consumer problems in the future research section.</p><p>3 For example, burgers can be consumed just by themselves or with ketchup (but without buns). If ketchup is outside the scope of the analysis, then we aggregate together these two uses of burgers and represent them by a final good for "separate burger" (meaning burger without bun). 4 A negative value of ψ k would imply that final good k gives a disutility. In that case, the consumer would never produce that good to consume it. The same applies if ψ k 0; thus, it is unnecessary to consider negative values of ψ k . <ref type="bibr">5 Satomura et al. (2011)</ref> lay out a direct-utility model in which the consumer purchases quantities of goods under multiple linear constraints, such as a budget constraint and a volume constraint; the consumer enjoys utility from the consumption of the goods purchased and from outside goods representing the best outside use of the slack resources (money or volume). Similarly, in our optimal allocation problem, the consumer faces one linear constraint for each input (because inputs enter linearly in the production of final goods) and derives utility from a final good representing their joint consumption as well as from the slack associated to each input (any input that is not used for the joint consumption is allocated to the final good representing the best separate use of that input). In <ref type="bibr" target="#b19">Satomura et al. (2011)</ref>, the outside goods are always consumed in some positive quantity because the utility associated is of the form log(z). In our model, however, the utility associated to the separate consumption uses is of the form log(c + 1), which allows for corner solutions. <ref type="bibr">6</ref> An alternative specification with a linear utility for the outside good would lead to ∂c * k /∂f k 0 for k k . Ultimately, this would rule out substitution between any pair of goods j and j and would yield symmetric cross-price effects ∂x * j /∂p j . 7 If goods j and j are also used in the production of other final goods k that require only one of the two inputs, the terms ∂c * k /∂f k are positive, which may lead to positive cross-price effects: the sign of ∂x * j /∂p j then depends on the utility for the final good k that uses both inputs, and on the strength of substitution between the final goods. <ref type="bibr">8</ref> In our simulations and in our empirical application, we assumed an upper bound of four packages on quantities purchased within each category (in our data, a consumer purchased more than four packages in less than 0.1% of the shopping trips), and we evaluated the consumer's objective function at all feasible points. 9 In both simulations, the parameter values for the distribution of budgets were set in a way to match the distribution of budgets in the empirical application: log(M it ) ∼</p><p>iid N(μ, σ) with μ 3.72 and σ 1.1.</p><p>Similarly, the values chosen for the parameters ω and V were motivated by the results obtained in our empirical application.</p><p>10 For each consumer, we kept 10 trips out of the sample used for estimation. The hit rate and RMSE were calculated as an average across posterior draws and across the shopping trips of all consumers.</p><p>11 It is equal to the volume x j divided by the size of a pack s j .</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 .</head><label>1</label><figDesc>Figure 1. Relationship BetweenŨ, U, and V in the Household-Production Model of Complementarity</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc>Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 2 .</head><label>2</label><figDesc>Figure 2. Indifference Curves Under the Household Production Model, Using Different Parameter Values</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 3 .</head><label>3</label><figDesc>Figure 3. Indifference Curves Under an Alternative Utility Specification</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 4 .</head><label>4</label><figDesc>Figure 4. Inferred Consumption</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 5 .</head><label>5</label><figDesc>Figure 5. (Color online) Distribution of Coupons</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head></head><label></label><figDesc>|p it , e zit ,</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>)</head><label></label><figDesc>Pr x it |z it , a i23 ( ) m x it |p it , e zit , a i23 ( ) .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1 .</head><label>1</label><figDesc>Related Literature</figDesc><table><row><cell>Study</cell><cell>Modeling approach</cell><cell>Integrated utility model</cell><cell>Quantity</cell><cell>Complementarity</cell><cell>Indivisibility</cell></row><row><cell>Manchanda et al. (1999)</cell><cell>Multivariate probit</cell><cell></cell><cell></cell><cell>3</cell><cell></cell></row><row><cell>Dubé (2004)</cell><cell>Poisson + logit</cell><cell></cell><cell>3</cell><cell></cell><cell></cell></row><row><cell>Chan (2006)</cell><cell>Characteristics model</cell><cell>3</cell><cell>3</cell><cell>3</cell><cell></cell></row><row><cell>Gentzkow (2007)</cell><cell>Discrete choice over bundles</cell><cell>3</cell><cell></cell><cell>3</cell><cell></cell></row><row><cell>Mehta (2007)</cell><cell>Indirect utility</cell><cell>3</cell><cell>3</cell><cell>3</cell><cell></cell></row><row><cell>Song and Chintagunta (2007)</cell><cell>Indirect utility</cell><cell>3</cell><cell>3</cell><cell>3</cell><cell></cell></row><row><cell>Niraj et al. (2008)</cell><cell>Discrete choice over bundles</cell><cell>3</cell><cell>3</cell><cell>3</cell><cell></cell></row><row><cell>Liu et al. (2010)</cell><cell>Discrete choice over bundles</cell><cell>3</cell><cell></cell><cell>3</cell><cell></cell></row><row><cell>Satomura et al. (2011)</cell><cell>Direct utility</cell><cell>3</cell><cell>3</cell><cell></cell><cell></cell></row><row><cell>Mehta and Ma (2012)</cell><cell>Indirect utility</cell><cell>3</cell><cell>3</cell><cell>3</cell><cell></cell></row><row><cell>Lee et al. (2013)</cell><cell>Sequential decisions</cell><cell></cell><cell>3</cell><cell>3</cell><cell>3</cell></row><row><cell>Lee and Allenby (2014)</cell><cell>Direct utility</cell><cell>3</cell><cell>3</cell><cell></cell><cell>3</cell></row><row><cell>Current study</cell><cell>Household production</cell><cell>3</cell><cell>3</cell><cell>3</cell><cell>3</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head></head><label></label><figDesc>Stourm, Iyengar, and Bradlow: A Flexible Demand Model for ComplementsMarketing Science, 2020, vol. 39, no. 4, pp. 763-787, © 2020 </figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head></head><label></label><figDesc>Stourm, Iyengar, and Bradlow: A Flexible Demand Model for ComplementsMarketing Science, 2020, vol. 39, no. 4, pp. 763-787, © 2020 </figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head>Table 2 .</head><label>2</label><figDesc></figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head></head><label></label><figDesc>Notes.This table summarizes our demand system at different price levels (the unit price of each input is either $2.00 or $3.00) and at different values of the preference parameters ψ</figDesc><table><row><cell>1.1</cell><cell>and</cell></row><row><cell>1.2</cell><cell></cell></row><row><cell>1.2</cell><cell></cell></row><row><cell>0.9 0.9</cell><cell>1), and the budget was set to $50.</cell></row><row><cell>0.9</cell><cell>N(0,</cell></row><row><cell>1.5 1.2</cell><cell>parameters were drawn such that ∼ iid</cell></row><row><cell></cell><cell>different proportions a 23 . The random shocks included in the ψ</cell></row></table><note>Stourm, Iyengar, and Bradlow: A Flexible Demand Model for ComplementsMarketing Science, 2020, vol. 39, no. 4, pp. 763-787, © 2020 </note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6"><head>Table 3 .</head><label>3</label><figDesc>Simulation 1: Estimation Results on Data Generated Under Model 1 (with Complementarity)</figDesc><table><row><cell cols="3">Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements</cell><cell></cell></row><row><cell>Marketing Science, 2020, vol. 39, no. 4, pp. 763-787, © 2020 INFORMS</cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>Truth</cell><cell>Model 1</cell><cell>Model 2</cell></row><row><cell cols="2">(Model 1)</cell><cell>(with complementarity)</cell><cell>(without complementarity)</cell></row><row><cell>Average log(ψ 1 ) (input 1 by itself)</cell><cell>−6.96</cell><cell>−6.99 (0.07)</cell><cell>−6.54 (0.06)</cell></row><row><cell>Average log(ψ 2 ) (input 2 by itself)</cell><cell>−6.40</cell><cell>−6.36 (0.06)</cell><cell>−6.02 (0.05)</cell></row><row><cell>Average log(ψ 3 ) (joint consumption)</cell><cell>−8.06</cell><cell>−7.96 (0.16)</cell><cell>-</cell></row><row><cell>Average log(a 23 ) (proportion chips/salsa)</cell><cell>−0.41</cell><cell>−0.39 (0.12)</cell><cell>-</cell></row><row><cell>σ 2 1 σ 2 2 σ 2 3</cell><cell>3.79 3.13 4.61</cell><cell>3.77 (0.13) 2.99 (0.09) 4.72 (0.30)</cell><cell>3.41 (0.10) 2.77 (0.07) -</cell></row><row><cell>V 11</cell><cell>0.44</cell><cell>0.53 (0.07)</cell><cell>0.46 (0.05)</cell></row><row><cell>V 12</cell><cell>0.30</cell><cell>0.26 (0.05)</cell><cell>0.30 (0.04)</cell></row><row><cell>V 13</cell><cell>0.12</cell><cell>0.16 (0.07)</cell><cell>-</cell></row><row><cell>V 14</cell><cell>−0.04</cell><cell>−0.03 (0.06)</cell><cell>-</cell></row><row><cell>V 22</cell><cell>0.64</cell><cell>0.56 (0.06)</cell><cell>0.48 (0.05)</cell></row><row><cell>V 23</cell><cell>0.27</cell><cell>0.20 (0.07)</cell><cell>-</cell></row><row><cell>V 24</cell><cell>−0.07</cell><cell>−0.10 (0.07)</cell><cell>-</cell></row><row><cell>V 33</cell><cell>1.24</cell><cell>0.96 (0.16)</cell><cell>-</cell></row><row><cell>V 34</cell><cell>−0.07</cell><cell>−0.11 (0.11)</cell><cell>-</cell></row><row><cell>V 44</cell><cell>0.49</cell><cell>0.62 (0.12)</cell><cell>-</cell></row><row><cell>DIC</cell><cell>-</cell><cell>41,687</cell><cell>42,221</cell></row><row><cell>In sample. . .</cell><cell></cell><cell></cell><cell></cell></row><row><cell>hit-rate for good 1 incidence</cell><cell>-</cell><cell>82.4%</cell><cell>82.3%</cell></row><row><cell>hit-rate for good 2 incidence</cell><cell>-</cell><cell>81.2%</cell><cell>81.1%</cell></row><row><cell>RMSE for good 1 quantity (packs)</cell><cell>-</cell><cell>0.780</cell><cell>0.783</cell></row><row><cell>RMSE for good 2 quantity (packs)</cell><cell>-</cell><cell>0.834</cell><cell>0.838</cell></row><row><cell>Out of sample. . .</cell><cell></cell><cell></cell><cell></cell></row><row><cell>hit-rate for good 1 incidence</cell><cell>-</cell><cell>82.1%</cell><cell>82.0%</cell></row><row><cell>hit-rate for good 2 incidence</cell><cell>-</cell><cell>80.5%</cell><cell>80.4%</cell></row><row><cell>RMSE for good 1 quantity (packs)</cell><cell>-</cell><cell>0.788</cell><cell>0.790</cell></row><row><cell>RMSE for good 2 quantity (packs)</cell><cell>-</cell><cell>0.846</cell><cell>0.850</cell></row><row><cell>Elasticity 1→1</cell><cell>−0.74</cell><cell>−0.75 (0.04)</cell><cell>−0.81 (0.04)</cell></row><row><cell>Elasticity 1→2</cell><cell>−0.07</cell><cell>−0.08 (0.01)</cell><cell>0.00 (0.01)</cell></row><row><cell>Elasticity 2→1</cell><cell>−0.09</cell><cell>−0.09 (0.01)</cell><cell>0.00 (0.01)</cell></row><row><cell>Elasticity 2→2</cell><cell>−0.76</cell><cell>−0.78 (0.03)</cell><cell>−0.85 (0.04)</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7"><head>Table 4 .</head><label>4</label><figDesc>Simulation 2: Estimation Results on Data Generated Under Model 2 (Without Complementarity)</figDesc><table><row><cell></cell><cell></cell><cell cols="2">Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements</cell></row><row><cell></cell><cell>Truth</cell><cell>Model 1</cell><cell>Model 2</cell></row><row><cell></cell><cell>(Model 2)</cell><cell>(with complementarity)</cell><cell>(without complementarity)</cell></row><row><cell>Average log(ψ 1 )</cell><cell>−6.53</cell><cell>−6.64 (0.06)</cell><cell>−6.63 (0.06)</cell></row><row><cell>(input 1 by itself)</cell><cell></cell><cell></cell><cell></cell></row><row><cell>Average log(ψ 2 )</cell><cell>−6.09</cell><cell>−6.12 (0.06)</cell><cell>−6.12 (0.06)</cell></row><row><cell>(input 2 by itself)</cell><cell></cell><cell></cell><cell></cell></row><row><cell>Average log(ψ 3 )</cell><cell>-</cell><cell>−5.22 (1.43)</cell><cell>-</cell></row><row><cell>(joint consumption)</cell><cell></cell><cell></cell><cell></cell></row><row><cell>Average log(a 23 )</cell><cell>-</cell><cell>38.80 (16.92)</cell><cell>-</cell></row><row><cell>(proportion chips/salsa)</cell><cell></cell><cell></cell><cell></cell></row><row><cell>σ 2 1 σ 2 2 σ 2 3</cell><cell>3.45 2.94 -</cell><cell>3.49 (0.10) 2.89 (0.08) 1.28 (1.19)</cell><cell>3.49 (0.10) 2.89 (0.08) -</cell></row><row><cell>V 11</cell><cell>0.43</cell><cell>0.56 (0.06)</cell><cell>0.54 (0.06)</cell></row><row><cell>V 12</cell><cell>0.36</cell><cell>0.40 (0.05)</cell><cell>0.40 (0.05)</cell></row><row><cell>V 13</cell><cell>-</cell><cell>0.05 (0.29)</cell><cell>-</cell></row><row><cell>V 14</cell><cell>-</cell><cell>0.00 (0.34)</cell><cell>-</cell></row><row><cell>V 22</cell><cell>0.58</cell><cell>0.65 (0.07)</cell><cell>0.64 (0.07)</cell></row><row><cell>V 23</cell><cell>-</cell><cell>0.08 (0.35)</cell><cell>-</cell></row><row><cell>V 24</cell><cell>-</cell><cell>0.00 (0.39)</cell><cell>-</cell></row><row><cell>V 33</cell><cell>-</cell><cell>1.83 (1.13)</cell><cell>-</cell></row><row><cell>V 34</cell><cell>-</cell><cell>−0.00 (0.99)</cell><cell>-</cell></row><row><cell>V 44</cell><cell>-</cell><cell>2.04 (1.91)</cell><cell>-</cell></row><row><cell>DIC</cell><cell>-</cell><cell>41,700</cell><cell>40,856</cell></row><row><cell>In sample. . .</cell><cell></cell><cell></cell><cell></cell></row><row><cell>hit-rate for good 1 incidence</cell><cell>-</cell><cell>82.9%</cell><cell>82.9%</cell></row><row><cell>hit-rate for good 2 incidence</cell><cell>-</cell><cell>81.6%</cell><cell>81.6%</cell></row><row><cell>RMSE for good 1 quantity (packs)</cell><cell>-</cell><cell>0.771</cell><cell>0.771</cell></row><row><cell>RMSE for good 2 quantity (packs)</cell><cell>-</cell><cell>0.843</cell><cell>0.843</cell></row><row><cell>Out of sample. . .</cell><cell></cell><cell></cell><cell></cell></row><row><cell>hit-rate for good 1 incidence</cell><cell>-</cell><cell>82.5%</cell><cell>82.5%</cell></row><row><cell>hit-rate for good 2 incidence</cell><cell>-</cell><cell>81.3%</cell><cell>81.3%</cell></row><row><cell>RMSE for good 1 quantity (packs)</cell><cell>-</cell><cell>0.782</cell><cell>0.782</cell></row><row><cell>RMSE for good 2 quantity (packs)</cell><cell>-</cell><cell>0.848</cell><cell>0.848</cell></row><row><cell>Elasticity 1→1</cell><cell>−0.81</cell><cell>−0.81 (0.04)</cell><cell>−0.81 (0.04)</cell></row><row><cell>Elasticity 1→2</cell><cell>0.00</cell><cell>0.00 (0.00)</cell><cell>0.00 (0.00)</cell></row><row><cell>Elasticity 2→1</cell><cell>−0.01</cell><cell>0.00 (0.01)</cell><cell>0.00 (0.01)</cell></row><row><cell>Elasticity 2→2</cell><cell>−0.81</cell><cell>−0.81 (0.04)</cell><cell>−0.81 (0.04)</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_8"><head>Table 5 .</head><label>5</label><figDesc>Description of Purchase Data in the Tortilla Chips and Mexican Salsa Categories</figDesc><table><row><cell></cell><cell cols="2">(a) Purchase frequency</cell><cell></cell><cell></cell></row><row><cell></cell><cell>Salsa and chips</cell><cell>Salsa only</cell><cell>Chips only</cell><cell>None</cell></row><row><cell>Number of observations (%)</cell><cell>1187 (3.1)</cell><cell>2218 (5.9)</cell><cell>2878 (7.6)</cell><cell>31625 (83.4)</cell></row><row><cell></cell><cell cols="2">(b) Descriptive statistics</cell><cell></cell><cell></cell></row><row><cell></cell><cell>Salsa</cell><cell>Chips</cell><cell></cell><cell></cell></row><row><cell>Price, $</cell><cell>2.70</cell><cell>2.60</cell><cell></cell><cell></cell></row><row><cell>Purchase incidence, %</cell><cell>8.98</cell><cell>10.72</cell><cell></cell><cell></cell></row><row><cell>Mean purchase quantity (packs)</cell><cell>1.34</cell><cell>1.32</cell><cell></cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_9"><head>Table 6 .</head><label>6</label><figDesc>Reduced-Form Evidence of Complementarity Between Tortilla Chips and Salsa</figDesc><table><row><cell></cell><cell>Incidence of salsa</cell><cell>Incidence of salsa (with household fixed effects)</cell></row><row><cell>Salsa price</cell><cell>−0.44 (0.09)</cell><cell>−0.63 (0.12)</cell></row><row><cell>Chips price</cell><cell>−0.29 (0.06)</cell><cell>−0.28 (0.08)</cell></row><row><cell></cell><cell>Incidence of chips</cell><cell>Incidence of chips (with household fixed effects)</cell></row><row><cell>Salsa price</cell><cell>−0.26 (0.08)</cell><cell>0.02 (0.12)</cell></row><row><cell>Chips price</cell><cell>−0.74 (0.05)</cell><cell>−0.91 (0.07)</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_10"><head>Table 7 .</head><label>7</label><figDesc>Estimation Results on Purchase Data in the Mexican Salsa and Tortilla Chips Categories, Including a Multivariate Probit Model and a Poisson Regression Model as Benchmark Models for Incidence and Quantity</figDesc><table><row><cell cols="3">Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements</cell><cell></cell><cell></cell></row><row><cell cols="2">Marketing Science, 2020, vol. 39, no. 4, pp. 763-787, © 2020 INFORMS</cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>Model 1</cell><cell>Model 2</cell><cell>Model 3</cell><cell>Model 4</cell></row><row><cell></cell><cell>(with complementarity)</cell><cell>(without complementarity)</cell><cell>(HB MV probit)</cell><cell>(HB Poisson)</cell></row><row><cell>Average log(ψ 1 ) (separate salsa)</cell><cell>−6.96 (0.07)</cell><cell>−6.53 (0.06)</cell><cell>-</cell><cell>-</cell></row><row><cell>Average log(ψ 2 ) (separate chips)</cell><cell>−6.40 (0.07)</cell><cell>−6.09 (0.06)</cell><cell>-</cell><cell>-</cell></row><row><cell>Average log(ψ 3 ) (joint consumption)</cell><cell>−8.06 (0.17)</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>Average log(a 23 ) (proportion)</cell><cell>−0.41 (0.11)</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>σ 2 1 σ 2 2 σ 2 3</cell><cell>3.79 (0.13) 3.13 (0.10) 4.61 (0.31)</cell><cell>3.45 (0.10) 2.94 (0.08) -</cell><cell>---</cell><cell>---</cell></row><row><cell>V 11</cell><cell>0.44 (0.05)</cell><cell>0.43 (0.05)</cell><cell>-</cell><cell>-</cell></row><row><cell>V 12</cell><cell>0.30 (0.05)</cell><cell>0.36 (0.04)</cell><cell>-</cell><cell>-</cell></row><row><cell>V 13</cell><cell>0.12 (0.07)</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>V 14</cell><cell>−0.04 (0.05)</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>V 22</cell><cell>0.64 (0.07)</cell><cell>0.58 (0.06)</cell><cell>-</cell><cell>-</cell></row><row><cell>V 23</cell><cell>0.27 (0.08)</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>V 24</cell><cell>−0.07 (0.06)</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>V 33</cell><cell>1.24 (0.20)</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>V 34</cell><cell>−0.07 (0.12)</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>V 44</cell><cell>0.49 (0.10)</cell><cell>-</cell><cell>-</cell><cell>-</cell></row><row><cell>Salsa intercept</cell><cell>-</cell><cell>-</cell><cell>−0.24 (0.19)</cell><cell>0.16 (0.47)</cell></row><row><cell>Chips intercept</cell><cell>-</cell><cell>-</cell><cell>0.01 (0.21)</cell><cell>0.29 (0.38)</cell></row><row><cell>Salsa price → salsa</cell><cell>-</cell><cell>-</cell><cell>−0.28 (0.06)</cell><cell>−0.66 (0.16)</cell></row><row><cell>Salsa price → chips</cell><cell>-</cell><cell>-</cell><cell>−0.04 (0.07)</cell><cell>−0.13 (0.14)</cell></row><row><cell>Chips price → salsa</cell><cell>-</cell><cell>-</cell><cell>−0.13 (0.04)</cell><cell>−0.22 (0.09)</cell></row><row><cell>Chips price → chips</cell><cell>-</cell><cell>-</cell><cell>−0.44 (0.05)</cell><cell>−0.78 (0.09)</cell></row><row><cell>Correlation of error terms</cell><cell>-</cell><cell>-</cell><cell>0.46 (0.01)</cell><cell>-</cell></row><row><cell>DIC</cell><cell>50,014</cell><cell>50,453</cell><cell>-</cell><cell>54,059</cell></row><row><cell>In sample. . .</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>hit-rate for salsa incidence</cell><cell>85.3%</cell><cell>85.3%</cell><cell>84.6%</cell><cell>83.3%</cell></row><row><cell>hit-rate for chips incidence</cell><cell>83.6%</cell><cell>83.6%</cell><cell>82.9%</cell><cell>81.7%</cell></row><row><cell>RMSE for salsa quantity (jars)</cell><cell>0.609</cell><cell>0.611</cell><cell>-</cell><cell>0.538</cell></row><row><cell>RMSE for chips quantity (bags)</cell><cell>0.658</cell><cell>0.661</cell><cell>-</cell><cell>0.568</cell></row><row><cell>Out of sample. . .</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>hit-rate for salsa incidence</cell><cell>82.6%</cell><cell>82.5%</cell><cell>81.7%</cell><cell>80.2%</cell></row><row><cell>hit-rate for chips incidence</cell><cell>79.8%</cell><cell>79.7%</cell><cell>78.3%</cell><cell>76.7%</cell></row><row><cell>RMSE for salsa quantity (jars)</cell><cell>0.674</cell><cell>0.677</cell><cell>-</cell><cell>0.588</cell></row><row><cell>RMSE for chips quantity (bags)</cell><cell>0.750</cell><cell>0.757</cell><cell>-</cell><cell>0.659</cell></row><row><cell>Elasticity salsa → salsa</cell><cell>−0.96 (0.04)</cell><cell>−1.04 (0.05)</cell><cell>−1.14 (0.27)</cell><cell>−0.56 (0.33)</cell></row><row><cell>Elasticity salsa → chips</cell><cell>−0.09 (0.01)</cell><cell>0.00 (0.00)</cell><cell>0.02 (0.27)</cell><cell>0.33 (0.32)</cell></row><row><cell>Elasticity chips → salsa</cell><cell>−0.10 (0.02)</cell><cell>0.00 (0.00)</cell><cell>−0.45 (0.17)</cell><cell>−0.14 (0.21)</cell></row><row><cell>Elasticity chips → chips</cell><cell>−1.01 (0.04)</cell><cell>−1.09 (0.04)</cell><cell>−1.49 (0.15)</cell><cell>−1.37 (0.15)</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_11"><head>Table 9 .</head><label>9</label><figDesc>Change in Package Size</figDesc><table><row><cell></cell><cell cols="2">Volume, oz.</cell><cell cols="2">Incidence rate, %</cell><cell>Revenue, $</cell></row><row><cell></cell><cell>salsa</cell><cell>chips</cell><cell>salsa</cell><cell>chips</cell><cell></cell></row><row><cell>Baseline (16 oz. salsa, 10 oz. chips)</cell><cell>67,456</cell><cell>49,330</cell><cell>8.9</cell><cell>10.5</cell><cell>23,609</cell></row><row><cell>Smaller salsa jar (8 oz.)</cell><cell>65,077</cell><cell>50,015</cell><cell>12.4</cell><cell>10.8</cell><cell>23,390</cell></row><row><cell>Bigger salsa jar (32 oz.)</cell><cell>70,598</cell><cell>48,093</cell><cell>5.9</cell><cell>10.0</cell><cell>23,813</cell></row><row><cell>Smaller chips bag (5 oz.)</cell><cell>68,294</cell><cell>47,350</cell><cell>9.1</cell><cell>14.2</cell><cell>23,272</cell></row><row><cell>Bigger chips bag (20 oz.)</cell><cell>65,673</cell><cell>51,625</cell><cell>8.4</cell><cell>7.0</cell><cell>23,880</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_12"><head>Table 8 .</head><label>8</label><figDesc>Counterfactual Results: Optimal Couponing</figDesc><table><row><cell></cell><cell cols="2">Salsa coupon</cell><cell cols="2">Chips coupon</cell></row><row><cell></cell><cell>Model 1</cell><cell>Model 2</cell><cell>Model 1</cell><cell>Model 2</cell></row><row><cell></cell><cell>(with complementarity)</cell><cell>(without complementarity)</cell><cell>(with complementarity)</cell><cell>(without complementarity)</cell></row><row><cell>Percentage change in. . .</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>. . .profit</cell><cell>1.25%</cell><cell>1.18%</cell><cell>1.48%</cell><cell>1.43%</cell></row><row><cell>. . .total volume of salsa</cell><cell>4.90%</cell><cell>4.21%</cell><cell>0.66%</cell><cell>0.54%</cell></row><row><cell>. . .total volume of chips</cell><cell>0.60%</cell><cell>0.47%</cell><cell>5.14%</cell><cell>4.60%</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_13"><head>Table 10 .</head><label>10</label><figDesc>Change in Consumption Proportions Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763-787, © 2020 INFORMS uses, and by simulating demand under alternative mixing proportions.</figDesc><table><row><cell></cell><cell cols="2">Volume, oz.</cell><cell cols="2">Incidence rate, %</cell><cell>Revenue, $</cell></row><row><cell></cell><cell>salsa</cell><cell>chips</cell><cell>salsa</cell><cell>chips</cell><cell></cell></row><row><cell>Salsa proportion reduced by 50%</cell><cell>63,659</cell><cell>49,524</cell><cell>8.6</cell><cell>10.3</cell><cell>23,021</cell></row><row><cell>Salsa proportion reduced by 20%</cell><cell>66,323</cell><cell>49,533</cell><cell>8.8</cell><cell>10.5</cell><cell>23,470</cell></row><row><cell>Salsa proportion reduced by 10%</cell><cell>66,937</cell><cell>49,437</cell><cell>8.9</cell><cell>10.5</cell><cell>23,549</cell></row><row><cell>Baseline</cell><cell>67,456</cell><cell>49,330</cell><cell>8.9</cell><cell>10.5</cell><cell>23,609</cell></row><row><cell>Salsa proportion increased by 10%</cell><cell>68,024</cell><cell>49,294</cell><cell>8.9</cell><cell>10.6</cell><cell>23,695</cell></row><row><cell>Salsa proportion increased by 20%</cell><cell>68,549</cell><cell>49,245</cell><cell>9.0</cell><cell>10.6</cell><cell>23,771</cell></row><row><cell>Salsa proportion increased by 50%</cell><cell>69,802</cell><cell>49,024</cell><cell>9.0</cell><cell>10.6</cell><cell>23,926</cell></row><row><cell>Salsa proportion increased by 100%</cell><cell>71,056</cell><cell>48,696</cell><cell>9.1</cell><cell>10.7</cell><cell>24,053</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_14"><head></head><label></label><figDesc>Stourm, Iyengar, and Bradlow: A Flexible Demand Model for ComplementsMarketing Science, 2020, vol. 39, no. 4, pp. 763-787, © 2020 where S 1</figDesc><table /></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot">MarketingScience, 2020, vol. 39, no. 4, pp. 763-787, © 2020 </note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="12">When estimating the model on the data, we enforced a constraint that no more than four units of each good could be purchased (as explained in endnote 8). Because we did not want our results to be driven by the constraint on the number of units, we instead enforced constraints on volume in these counterfactual analyses. For example, when dividing the jar size of salsa by two, we assumed that the consumers could then buy up to eight units. When doubling the size, we assumed that the consumer could buy up to two units.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgments</head><p>The authors thank the Kilts Center for Marketing at the University of Chicago Booth School of Business and Nielsen for access to the data used in this study. The analyses were calculated (or derived) based in part on data from the Nielsen Company (United States), LLC, and marketing databases provided through the Nielsen Datasets at the Kilts Center for Marketing Data Center at the University of Chicago Booth School of Business. The conclusions drawn from the Nielsen data are those of the researchers and do not reflect the views of Nielsen. Nielsen is not responsible for, had no role in, and was not involved in analyzing and preparing the results reported herein.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix A. Solution to the Consumption Problem</head><p>In this section, we derive the solution to the optimal consumption problem given in Equations (6b)-(6d):</p><p>In the case with two inputs and one composite such that A ( 1 0 1 0 1 a23 ), the first-order conditions given in Equation (7) become</p><p>Because U c is strictly increasing, constraints (A.2g) and (A.2h) must be binding:</p><p>We can simplify the FOC as</p><p>From Equations (A.4d)-(A.4f), there can be three possible cases:</p><p>x2−a23c3+1 . This leads to a second-degree equation:</p><p>x2+1 , then B &lt; 0 and C &gt; 0. By unicity of the optimization solution, there can be at most one root between zero and U; therefore, it must be the smallest one because it is positive:</p><p>Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">A theory of the allocation of time</title>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">S</forename><surname>Becker</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Econom. J. (London)</title>
		<imprint>
			<biblScope unit="volume">75</biblScope>
			<biblScope unit="issue">299</biblScope>
			<biblScope unit="page" from="493" to="517" />
			<date type="published" when="1965" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Latent separability: Grouping goods without weak separability</title>
		<author>
			<persName><forename type="first">R</forename><surname>Blundell</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Robin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">68</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="53" to="84" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Estimating a continuous hedonic-choice model with an application to demand for soft drinks</title>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">Y</forename><surname>Chan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">RAND J. Econom</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="466" to="482" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Discrete-choice models of consumer demand in marketing</title>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">K</forename><surname>Chintagunta</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">S</forename><surname>Nair</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="977" to="996" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Multiple discreteness and product differentiation: Demand for carbonated soft drinks</title>
		<author>
			<persName><forename type="first">J-P</forename><surname>Dubé</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="66" to="81" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Valuing new goods in a model with complementarity: Online newspapers</title>
		<author>
			<persName><forename type="first">M</forename><surname>Gentzkow</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Amer. Econom. Rev</title>
		<imprint>
			<biblScope unit="volume">97</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="713" to="744" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Modeling consumer demand for variety</title>
		<author>
			<persName><forename type="first">J</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">M</forename><surname>Allenby</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">E</forename><surname>Rossi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="229" to="250" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">An empirical analysis of mobile voice service and SMS: A structural model</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Telang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">B</forename><surname>Vogt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Krishnan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Management Sci</title>
		<imprint>
			<biblScope unit="volume">56</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="234" to="252" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Package size decisions</title>
		<author>
			<persName><forename type="first">O</forename><surname>Koenigsberg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Kohli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Montoya</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Management Sci</title>
		<imprint>
			<biblScope unit="volume">56</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="485" to="494" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Modeling indivisible demand</title>
		<author>
			<persName><forename type="first">S</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">M</forename><surname>Allenby</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="364" to="381" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">A direct utility model for asymmetric complements</title>
		<author>
			<persName><forename type="first">Iyengar</forename><surname>Stourm</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Bradlow ; Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">M</forename><surname>Allenby</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Flexible Demand Model for Complements</title>
				<imprint>
			<date type="published" when="2013" />
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="454" to="470" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Complementarities and the demand for home broadband internet services</title>
		<author>
			<persName><forename type="first">H</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">K</forename><surname>Chintagunta</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Zhu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="701" to="720" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<author>
			<persName><forename type="first">P</forename><surname>Manchanda</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Ansari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Gupta</surname></persName>
		</author>
		<title level="m">The &quot;shopping basket&quot;: A model for multicategory purchase incidence decisions. Marketing Sci</title>
				<imprint>
			<date type="published" when="1999" />
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="95" to="114" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Investigating consumers&apos; purchase incidence and brand choice decisions across multiple product categories: A theoretical and empirical analysis</title>
		<author>
			<persName><forename type="first">N</forename><surname>Mehta</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="196" to="217" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">A multicategory model of consumers&apos; purchase incidence, quantity, and brand choice decisions: Methodological issues and implications on promotional decisions</title>
		<author>
			<persName><forename type="first">N</forename><surname>Mehta</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Ma</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Marketing Res</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="435" to="451" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Household production and consumer demand functions</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">F</forename><surname>Muth</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="699" to="708" />
			<date type="published" when="1966" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">A cross-category model of households&apos; incidence and quantity decisions</title>
		<author>
			<persName><forename type="first">R</forename><surname>Niraj</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Padmanabhan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">B</forename><surname>Seetharaman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="225" to="235" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">The value of purchase history data in target marketing</title>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">E</forename><surname>Rossi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">E</forename><surname>Mcculloch</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">M</forename><surname>Allenby</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="321" to="340" />
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Inference from iterative simulation using multiple sequences</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">B</forename><surname>Rubin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Gelman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Statist. Sci</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="457" to="511" />
			<date type="published" when="1992" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Multiple-constraint choice models with corner and interior solutions</title>
		<author>
			<persName><forename type="first">T</forename><surname>Satomura</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">M</forename><surname>Allenby</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="481" to="490" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">A discrete-continuous model for multicategory purchase behavior of households</title>
		<author>
			<persName><forename type="first">I</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">K</forename><surname>Chintagunta</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Marketing Res</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="595" to="612" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Promotion effect on endogenous consumption</title>
		<author>
			<persName><forename type="first">B</forename><surname>Sun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="430" to="443" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">The calculation of posterior distributions by data augmentation</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A</forename><surname>Tanner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">H</forename><surname>Wong</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. American Statist. Assoc</title>
		<imprint>
			<biblScope unit="volume">82</biblScope>
			<biblScope unit="issue">398</biblScope>
			<biblScope unit="page" from="528" to="540" />
			<date type="published" when="1987" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<author>
			<persName><forename type="first">Iyengar</forename><surname>Stourm</surname></persName>
		</author>
		<author>
			<persName><surname>Bradlow</surname></persName>
		</author>
		<title level="m">Flexible Demand Model for Complements Marketing Science</title>
				<imprint>
			<date type="published" when="2020" />
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page" from="763" to="787" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
