<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Inference for Product Competition and Separable Demand</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2019-07-08">July 8, 2019</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Adam</forename><forename type="middle">N</forename><surname>Smith</surname></persName>
							<email>a.smith@ucl.ac.uk</email>
							<affiliation key="aff0">
								<orgName type="institution" key="instit1">UCL School of Management</orgName>
								<orgName type="institution" key="instit2">University College London</orgName>
								<address>
									<postCode>E14 5AA</postCode>
									<settlement>London</settlement>
									<country key="GB">United Kingdom</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Peter</forename><forename type="middle">E</forename><surname>Rossi</surname></persName>
							<email>perossichi@gmail.com</email>
							<affiliation key="aff1">
								<orgName type="department">Anderson School of Management</orgName>
								<orgName type="institution">University of California</orgName>
								<address>
									<postCode>90095</postCode>
									<settlement>Los Angeles, Los Angeles</settlement>
									<region>California</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Greg</forename><forename type="middle">M</forename><surname>Allenby</surname></persName>
							<email>allenby.1@osu.edu</email>
							<affiliation key="aff2">
								<orgName type="institution" key="instit1">Fisher College of Business</orgName>
								<orgName type="institution" key="instit2">Ohio State University</orgName>
								<address>
									<postCode>43210</postCode>
									<settlement>Columbus</settlement>
									<region>Ohio</region>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Inference for Product Competition and Separable Demand</title>
					</analytic>
					<monogr>
						<idno type="ISSN">0732-2399 (print)</idno>
						<imprint>
							<date type="published" when="2019-07-08">July 8, 2019</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1287/mksc.2019.1159</idno>
					<note type="submission">Received: October 12, 2017 Revised: November 29, 2018 Accepted: January 27, 2019</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.2" ident="GROBID" when="2021-07-06T11:29+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>price elasticities</term>
					<term>category demand</term>
					<term>dimension reduction</term>
					<term>random partition models</term>
					<term>Bayesian inference</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>This paper presents a methodology for identifying groups of products that exhibit similar patterns in demand and responsiveness to changes in price using store-level sales data. We use the concept of economic separability as the basis for establishing similarity between products and build a weakly separable model of aggregate demand. A common issue with separable demand models is that the partition of products into separable groups must be known a priori, which severely shrinks the set of admissible substitution patterns. We develop a methodology that allows the partition to be an estimated model parameter. In particular, we specify a log-linear demand system in which weak separability induces equality restrictions on a subset of cross-price elasticity parameters. An advantage of our approach is that we are able to find groups of separable products rather than just test whether a given set of groups is separable. Our method is applied to two aggregate, store-level data sets. We find evidence that the separable structure of demand can be inconsistent with category labels, which has implications for optimal category marketing strategies.</p><p>History: Yuxin Chen served as the senior editor and Michel Wedel served as associate editor for this article.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>This paper presents a methodology for measuring the dimension and boundaries of consumer demand using store-level scanner data. We formally define the boundaries of demand using the concept of economic separability: two product groups are said to be weakly separable if consumer preferences within each group are independent of consumption levels in the other group <ref type="bibr" target="#b12">(Deaton and Muellbauer 1980)</ref>. For example, the demand for cereal would be weakly separable from the demand for milk only if consumer preferences between any two cereals (e.g., Cheerios and Frosted Flakes) do not depend on the type or amount of milk consumed. Although separability assumptions remain widely used in empirical work, there is relatively little discussion of their practical viability <ref type="bibr" target="#b11">(Chintagunta and Nair 2011)</ref>. In multicategory demand settings, for example, it is commonly assumed that preferences are separable across categories, where the definition of categories is fixed according to product labels in the data. However, we believe that deciding on the separable structure of demand is an empirical question, especially when the goal is to measure substitution patterns within wide assortments or across multiple categories.</p><p>Our approach is to let the partition of products into separable groups be a parameter that can be estimated from the data. We specify an aggregate log-linear demand system in which the assumption of weakly separable preferences induces equality restrictions on a subset of cross-price elasticity parameters. Full inference in this model is nontrivial, as it requires quantifying the uncertainty in a partition, which is a discrete object defined over a high-dimensional and non-Euclidean space. To overcome this challenge, we take a Bayesian approach to inference and rely on recent advances in the literature on models for random partitions. Specifically, we use the location-scale partition model of <ref type="bibr" target="#b40">Smith and Allenby (2019)</ref> to specify a coherent prior and efficiently navigate the posterior of both the partition and the lower-dimensional set of price elasticities. The novelty is that we are able to discover groups of separable products rather than just test whether a given set of groups is separable.</p><p>The proposed demand model is applied to weekly, store-level retail scanner data in two product categories: (i) jams, jellies, and spreads and (ii) juice drinks. The jams, jellies, and spreads category contains two complementary subcategories-jams/jellies and spreads-which creates a strong prior on how to categorize products; that is, one may reasonably expect jams/jellies and spreads to constitute separable demand groups. This gives us the ability to examine the face validity of the partitions found by our method. In contrast, the juice category is comprised of wide assortments with many product lines spanning multiple flavor subcategories. The amount and type of variety make it harder to define the nature of competition, and thus an appropriate product categorization, a priori.</p><p>Throughout both analyses, we find that partitions with high posterior probability can be markedly different from predefined category labels in both their granularity and composition. In the juice category, for example, we find evidence that demand is not separable by flavor categories (e.g., apple, orange). We then show how assuming the wrong structure of demand can lead to a misunderstanding of competition and biases in category promotion effects. An additional benefit of our methodology is that we can integrate over the uncertainty in the partition parameter, which leads to improved estimates of cross-price effects and demand forecasts.</p><p>The idea of using economic separability to add structure to demand systems has a long history in marketing and economics. For example, much of the early empirical work in applied microeconomics imposes separability restrictions to facilitate estimation of demand models with highly aggregated goods, many parameters, and limited data (e.g., <ref type="bibr" target="#b5">Barten 1964</ref><ref type="bibr" target="#b10">, Byron 1970</ref><ref type="bibr" target="#b24">, Jorgenson and Lau 1975</ref>. Although this additional structure provides gains in efficiency, it can also limit the set of admissible substitution patterns. <ref type="bibr" target="#b35">Pudney (1981)</ref> suggests that empirical tests of separability are often rejected because there is no discussion of how to choose the grouping pattern imposed on the model. Our approach is thus similar in spirit, as we use the data to find more suitable demand groups.</p><p>The availability of modern scanner data has since allowed for more disaggregate demand analysis. Researchers now have access to UPC-level price and movement data across many product categories, but for tractability reasons usually work with data from a single product category or subcategory. Regardless of the scope of the data used, separability assumptions remain ubiquitous. For example, a common assumption in empirical work is that utility for the inside goods is separable from the utility of the outside good <ref type="bibr" target="#b11">(Chintagunta and Nair 2011)</ref>. In multicategory demand models, it is also often assumed that utility is separable across predefined categories (e.g., <ref type="bibr" target="#b29">Mehta 2007</ref><ref type="bibr" target="#b42">, Thomassen et al. 2017</ref>). However, and as will be seen in the following section, the viability of these assumptions crucially depends on the researcher's definition of categories. By allowing the composition of separable groups to be estimated from the data, we can offer insights into the boundaries of competition and if/where cross-category assumptions of separability appear unreasonable. <ref type="bibr">1</ref> Separability has also been shown to be useful for measuring price elasticities. For example, <ref type="bibr" target="#b32">Montgomery and Rossi (1999)</ref> improved elasticity estimates in a log-linear demand system by shrinking the parameters toward values predicted by additive separability. The main difference between their approach and ours is the type of separability imposed on the model. In particular, they assumed additive separability, which requires all pairs of goods to be strong substitutes <ref type="bibr" target="#b12">(Deaton and Muellbauer 1980)</ref>. This is sensible given their empirical focus on the demand for orange juice alone. We instead rely on weak separability which imposes a more flexible restriction across product groups and does not rule out complementarity a priori. This is motivated by our interest in modeling demand across wide assortments (e.g., the juice category), where products will be related but not necessarily substitutable.</p><p>More recently, there have been efforts to visualize and predict demand patterns for high-dimensional choice sets. Examples include those by <ref type="bibr" target="#b18">France and Ghose (2016)</ref> and <ref type="bibr" target="#b36">Ringel and Skiera (2016)</ref>, who provide methods for visualizing competition for more than 1,000 products using consumer purchase and online search data, respectively. The output from both analyses is some form of competitive map rather than estimates of marketing responsiveness parameters. <ref type="bibr" target="#b23">Jacobs et al. (2016)</ref> also study choice among large assortments, but focus on predicting future purchases rather than identifying competitive effects. They leverage models in text analysis to improve large-scale customer purchase predictions. One fundamental difference in our work is the treatment of demand. Whereas these methods abstract away from formal demand models, we embed the goal of identifying separable product groups within a traditional demand analysis where we estimate both the partition of goods and associated demand parameters. However, this comes at the cost of estimating a potentially large set of price effects, so the scalability of our model will depend on the type and amount of dimension reduction afforded by separability. <ref type="bibr" target="#b4">Bajari et al. (2015)</ref> provide an alternative dimension reduction solution for large-scale linear and logit demand models. In particular, they employ machine learning methods such as stepwise regression, support vector machines, and the lasso to reduce the number of relevant model covariates. However, many of these off-the-shelf methods provide a form of dimension reduction that lacks grounding in economic theory. For example, regularized regression estimators like the lasso can only accommodate shrinkage toward fixed constants that are usually set to zero. The benefits may thus be limited if the shrinkage points are Smith, Rossi, and Allenby: Inference for Product <ref type="bibr">Competition and</ref><ref type="bibr">Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690-710, © 2019 INFORMS</ref> misspecified. For instance, shrinkage to zero would be undesirable when applied to the price effect parameters of any Marshallian demand system, as zero substitution effects need not imply zero price effects. In this sense, separability offers a more flexible, theorydriven form of dimension reduction. Subsets of the full cross-price elasticity matrix are constrained to live in a lower-dimensional (and potentially nonzero) space of group-level parameters. This provides both adaptive and differential shrinkage, as elasticities are shrunk toward values consistent with theory, learned from the data, and that can change across product groups.</p><p>The remainder of this paper is organized as follows. Section 2 develops a separable aggregate demand model. Section 3 discusses probability models for random partitions. Section 4 outlines our approach for posterior inference. Section 5 presents the results of the two empirical studies. Section 6 explores the implications of separable demand on product competition, brand positioning, and price promotions effects. Section 7 concludes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Separable Preferences and Aggregate Demand</head><p>The theory of economic separability dates back to <ref type="bibr" target="#b26">Leontief (1947)</ref>, <ref type="bibr" target="#b20">Gorman (1959)</ref>, <ref type="bibr" target="#b41">Sono (1961)</ref>, and <ref type="bibr" target="#b19">Goldman and Uzawa (1964)</ref>, who provided a framework for analyzing large or complicated demand systems under the assumption that consumer preferences conform to a lower-dimensional structure.</p><p>In particular, separability requires that the set of products under study can be partitioned so that consumer preferences within each product group can be described independently of consumption levels in other groups. This type of economic dimension reduction is attractive for both behavioral and econometric reasons. For example, consumers may naturally limit the amount or type of information they use when choosing among a high-dimensional set of goods. Separability also limits the effects of price changes on the demand for products across groups, and therefore offers efficiency gains to the researcher wanting to estimate a demand system with many cross-price elasticities and limited data. The problem is that the gains in efficiency or parsimony come at the cost of model flexibility. The assumptions of separable preferences impose strong restrictions on demand elasticities when the partition is fixed, which means that the partition of products fully determines the nature of competition <ref type="bibr" target="#b12">(Deaton and Muellbauer 1980)</ref>. Our approach is to let the partition be an estimated model parameter, which relaxes the assumption that the structure of demand is known. Rather, we assume only that some true structure exists and then use the data to learn about that structure.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.">Economic Separability</head><p>Let π n (g 1 , . . . , g n ) denote a partition of n items into K ≤ n groups, where g i is an item-group indicator variable. Preferences are said to be weakly separable with respect to the partition π n if the utility of the consumption vector q (q 1 , . . . , q n ) can be written as</p><formula xml:id="formula_0">u(q) V(v 1 (Q 1 ), . . . , v K (Q K )).</formula><p>(1)</p><p>Here, Q k is the consumption set for products assigned to group k, v k (•) is a subutility function, and V(•) is an aggregation function defined over K variables. To better understand the behavioral implications of separability, we discuss two additional (and ultimately equivalent) definitions.</p><p>The first requires the marginal rate of substitution between any two products i and j in group k to be independent of consumption levels for a third product r in group :</p><formula xml:id="formula_1">∂u i (q)/u j (q) ∂q r 0 for all g i g j k, g r , k . (2)</formula><p>Here, u i (q) denotes the marginal utility of good i. The consequence of ( <ref type="formula">2</ref>) is that the consumption levels in group cannot affect the consumer's preference ordering for products in group k. Notice that this restriction does not say that the demand for products in group k is independent from the demand of products in group . Rather, separability can hold for product groups who are substitutes or complements in aggregate. For example, consider two complementary product groups: pasta and pasta sauce. The demand for pasta is weakly separable from the demand for sauce only if the consumer's preferences for two brands of pasta sauce (e.g., Prego and the store brand) are unaffected by the amount or type of pasta purchased.</p><p>In the context of differentiated product markets, one feature that could "break" separability is the presence of quality tiers. For example, if consumers prefer pairing certain types of pasta only with high-quality brands of sauce, then preferences between sauce varieties will depend on the type of pasta purchased, violating (2). The last definition is based on restrictions to the compensated (Slutsky) price effects:</p><formula xml:id="formula_2">S ij φ k (q) ∂q i ∂m ∂q j ∂m for all g i k, g j , k . (3)</formula><p>Here, S ij is a compensated price effect (i.e., the derivative of the Hicksian demand function for good i with respect to the price of good j), m is a monetary budget, 2 and φ k (q) is a function summarizing the relationship between groups k and . In our empirical applications, we assume a constant function φ k (q) φ k . Equation (3) implies that the effect of changing the price of product i in group k on the demand for product j in Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand group must conform to the group-level price effect, except as modified by budgetary effects. Again, if the demand for pasta is weakly separable from the demand for pasta sauce, then a decrease in the price of one sauce variety should have the same effect on the demand for all pasta varieties, barring budgetary effects. <ref type="bibr" target="#b19">Goldman and Uzawa (1964)</ref> show that (1)-( <ref type="formula">3</ref>) are all necessary and sufficient for each other, so that weakly separable preferences can be represented by any of the three.</p><p>A more restrictive form of separability is strong (or block-additive) separability, which assumes that the aggregation function V(•) in ( <ref type="formula">1</ref>) is additive. There are two important empirical consequences of strong separability. The first is that the groups themselves cannot have special meaning, as the additivity of V(•) always permits the creation of new groups by arbitrarily combining other groups <ref type="bibr" target="#b12">(Deaton and Muellbauer 1980)</ref>. Second, strong separability not only requires all crossgroup price effects conform to (3), but also requires that φ k (q) φ(q) for all groups k and . However, like weak separability, strong separability still leaves the set of within-group elasticities unrestricted. In this sense, the partition parameter π n is still meaningful in that it dictates which price effects are restricted.</p><p>A special case of strong separability is when each product constitutes its own group. In this case, preferences are said to be additive 3 and all pairs of goods must be strong substitutes. For both strong and additive separability, the additional restriction of constant group-level price effects is very limiting a priori and will be suitable only for narrowly defined product categories. Because our goal is to model demand for wide assortments with potentially ambiguous economic relationships, the flexibility of weak separability is preferred. Going forward, we will use the terms separability and weak separability interchangeably.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.">A Weakly Separable Log-Linear Demand Model</head><p>There are generally two strategies for constructing separable demand models. The first approach is to construct a separable utility function and then solve for the associated demand functions. However, the construction of weakly separable utility functions is challenging in practice. For instance, using the functional form restriction in (1) requires the researcher to specify sufficiently flexible subutility and aggregating functions v k (•) and V(•) that also yield tractable demand equations. This is infeasible when taking the primal approach, given that direct utility functions must be additively separable to yield a tractable demand system <ref type="bibr" target="#b30">(Mehta 2015</ref>). An alternative is to work with indirect utilities and impose the restriction in (2) on the marginal rates of substitution of a flexible functional form. However, <ref type="bibr" target="#b8">Blackorby et al. (1977)</ref> show that many flexible indirect utility functions such as the translog are "separability inflexible" in that, once restricted, they are no longer flexible enough to be regarded as approximations to any arbitrary weakly separable utility function.</p><p>The second approach, which we follow in this paper, is to impose separability restrictions on the demand function directly. Specifically, we impose the restriction in (3) on the price elasticity parameters of a log-linear demand system:</p><formula xml:id="formula_3">log q it n j 1 β ij log p jt + γ i log m t + z it ψ i + ε it , ε t (ε 1t , . . . , ε nt ) ∼ N(0, Σ). (4)</formula><p>Here, q it is the movement for product i at time t, and p jt is the price of product j at time t. The variable m t represents total expenditure at time t and can be viewed as an aggregated sample analogue to the individuallevel monetary budget term discussed in the previous section. It is important to include expenditure in the demand equation because (3) expresses price effects as a function of expenditure effects. We also include a d-dimensional vector of product-specific controls z it such as seasonal effects or promotional activity. The demand equations are tied together contemporaneously through the n × n error covariance matrix Σ.</p><p>The log-linear functional form is attractive because it is linear in price and expenditure elasticities and admits flexible substitution patterns. This has led to its widespread use for elasticity-based pricing in both industry and academia <ref type="bibr" target="#b31">(Montgomery 1997</ref><ref type="bibr" target="#b22">, Hitsch et al. 2017</ref><ref type="bibr" target="#b13">, DellaVigna and Gentzkow 2019</ref>. For our purposes, this functional form also makes it straightforward to project β ij onto the lower-dimensional space of separability parameters defined in (3). In fact, we later show that this restricted model retains its linearity in the lower-dimensional set of parameters, which enables efficient posterior computation.</p><p>Because separability is fundamentally a restriction on consumer preferences, it is also worth discussing the extent to which the demand equation in (4) is consistent with utility theory. In general, a demand system is said to be integrable (i.e., it can be rationalized by a model of constrained utility maximization) if it satisfies four properties: adding up, homogeneity, Slutsky symmetry, and negativity <ref type="bibr" target="#b12">(Deaton and Muellbauer 1980)</ref>. In a log-linear demand system, adding up is the most straightforward to impose a priori, as it requires all expenditure elasticities to equal one. The other three conditions place restrictions on functions of model parameters. <ref type="bibr">4</ref> However, requiring these conditions to hold everywhere yields a model in which a subset of own-price elasticities must equal negative one and all cross-price elasticities equal either zero or 1 + β ii <ref type="bibr" target="#b25">(LaFrance 1986)</ref>. Because this renders the log-linear model practically useless for measuring Smith, Rossi, and Allenby: Inference for Product <ref type="bibr">Competition and</ref><ref type="bibr">Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690-710, © 2019 INFORMS</ref> substitution patterns, we instead treat (4) as a flexible first-order approximation to a valid Marshallian demand system. In our empirical applications, we impose the adding-up restriction and then use the posterior distribution of cross-price effects to examine whether the remaining integrability conditions hold in the data.</p><p>Our separable log-linear model is then defined as (4) subject to the restriction in (3), which we translate from S ij to β ij and impose at the average expenditure share for each goodw j (see Appendix A for details on the derivation):</p><formula xml:id="formula_4">β ij w j (θ k γ i γ j − γ i ) if g i g j , η ij if g i g j .<label>(5)</label></formula><p>Here, η ij is an unrestricted within-group elasticity, and θ k is a separability parameter that we further restrict to be symmetric to satisfy group-level Slutsky symmetry. For two normal goods i and j belonging to different groups k and , it is now that case that</p><formula xml:id="formula_5">β ij &gt; 0 ⇐⇒ θ k &gt; 1 γ j .<label>(6)</label></formula><p>Therefore, all products in group k will be substitutes to all products in group if θ k is big enough, and complements if θ k is small enough.</p><p>There is still a question of whether the log-linear model subject to the restriction in (5) can approximate a demand system generated by some weakly separable utility function. As shown by <ref type="bibr" target="#b8">Blackorby et al. (1977)</ref>, the concern is that the separability constraints are too restrictive in that the model no longer has enough parameters to approximate the underlying separable model. To address this issue, <ref type="bibr" target="#b14">Driscoll et al. (1992)</ref> show that a model needs 1 + n + k n k (n k + 1)/2 + K(K − 1)/2 parameters to constitute a flexible approximation to a weakly separable process, where n k denotes the number of products assigned to group k. Because our model contains k n 2 k + K(K − 1)/2 price effects, this condition will be satisfied as long as we include n product intercepts and n k &gt; 1 for at least one group. 5</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3.">Related Models</head><p>Our aim in this paper is to study the structure of aggregate demand both within and across highly differentiated product categories. It is then necessary that our empirical demand specification allow for flexible substitution patterns. A natural starting point is to consider the unrestricted log-linear demand system in (4). The main drawback is that it requires n 2 price elasticity parameters to be estimated, which can be demanding on the data for even a moderate number of products. Moreover, the assessment of product competition is nontrivial, as it requires careful examination of a potentially large elasticity matrix.</p><p>Separability offers a dimension reduction solution through the introduction of product groups, but this comes at the cost of flexibility. By treating the partition as a model parameter, we accomplish three goals: (i) we endogenize the separable structure of demand, (ii) we reduce the dimension of the parameter matrix, and (iii) we retain much of the flexibility of the unrestricted model a priori. Estimating our separable model would be preferred over an unrestricted model whenever the researcher has insufficient data to precisely estimate price effects or directly cares about inferring the boundaries of competition.</p><p>An alternative approach commonly taken in the differentiated products literature is to use a mixed or random coefficient logit demand model, which is flexible in the sense that its choice probabilities can approximate the choice probabilities from any underlying utility function <ref type="bibr">(Berry et al. 1995, McFadden and</ref><ref type="bibr" target="#b28">Train 2000)</ref>. The added flexibility over the homogeneous logit model comes from the assumption that consumers are heterogeneous in their tastes for product characteristics. This allows the cross-price elasticity between two goods to be driven by their similarity in the characteristics space.</p><p>Although mixed logit models benefit from a formal treatment of utility theory and aggregation, there are a few reasons why they are not necessarily suitable for our purposes. First, the practical flexibility of the mixed logit is unclear, as the result of <ref type="bibr" target="#b28">McFadden and Train (2000)</ref> only holds for some appropriately specified mixing distribution and when arbitrarily highorder polynomials of price are allowed to enter the logit expression. Second, mixed logit models assume that market shares result from the aggregation of discrete choices across consumers. When modeling demand for wide assortments or across categories, the assumption of discrete choice is unreasonable. Third, accurate measurement of cross-price effects depends on the availability of rich product characteristic data, which are not always available. The flexibility in our model is not driven by characteristics (although the model can be extended to include them if desired). Finally, it is not obvious how to identify separable product groups within a mixed logit demand model. Although it is possible to use dimension reduction or clustering techniques on the induced price elasticity matrix, there is no reason to believe that those groups would actually reflect the separable structure of demand.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Models for Random Partitions</head><p>The separable demand model proposed in Section 2 is defined conditional on a partition π n . This section outlines probability models for π n that enable joint posterior inference. Because random partition models have seen little application in the field of marketing, Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand we first present a general discussion of their foundation and connection with Bayesian nonparametrics. Then, we review the more recent work of <ref type="bibr" target="#b40">Smith and Allenby (2019)</ref>, who develop a location-scale partition model that we use as the proposal distribution in our posterior sampling routine.</p><p>The construction of models for random partitions is often based on sampling from a discrete random probability measure, which is a central topic of Bayesian nonparametric methods. For example, using the Pólya urn scheme of <ref type="bibr" target="#b9">Blackwell and MacQueen (1973)</ref> to sample from a random distribution G with a Dirichlet process prior <ref type="bibr" target="#b17">(Ferguson 1973</ref>) also induces a model for random partitions. This result is due to the almost sure discreteness of draws from a Dirichlet process; that is, if a set of random variables φ 1 , . . . , φ n is sampled from G, then some of the draws will take on the same value with positive probability. The tied values can then be used to assign the items into mutually exclusive groups, which is equivalent to constructing a partition (Figure <ref type="figure" target="#fig_0">1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.">Random Partitions and the Dirichlet Process</head><formula xml:id="formula_6">Formally, consider sampling φ i |G ∼ G for i 1, . . . , n,</formula><p>where G ∼ DP(α, G 0 ). The precision parameter α &gt; 0 and base distribution G 0 are fixed hyperparameters. <ref type="bibr" target="#b9">Blackwell and MacQueen's (1973)</ref> Pólya urn scheme provides a way to generate the vector of φ's: draw φ 1 ∼ G 0 and then sample φ i |φ &lt; i for i 2, . . . , n according to</p><formula xml:id="formula_7">φ i |φ &lt; i ∼ w 0 G 0 (φ i ) + K (i) k 1 w k δ φ * k (φ i ),<label>(7)</label></formula><p>where</p><formula xml:id="formula_8">w 0 α α + i − 1 and w k n k α + i − 1 .<label>(8)</label></formula><p>Here, φ * k is the kth unique value in the set</p><formula xml:id="formula_9">φ &lt; i (φ 1 , . . . , φ i−1 ), δ φ * k (•) is a point mass at φ * k , K (i)</formula><p>is the number of unique values in φ &lt; i , and n k is the number of φ's equal to φ * k . The weights w 0 and w k represent the probability that φ i is a new draw from the base distribution and exactly equal to φ * k , respectively. Because our focus is on the induced partition rather than the distribution G, the choice of G 0 is immaterial, because the value of each φ i serves only as a group membership label.</p><p>The important feature of this sampling scheme is that φ i can be exactly equal to one of the previous φ's with strictly positive probability. Therefore, we can translate the vector φ (φ 1 , . . . , φ n ) into a partition π n (g 1 , . . . , g n ) using the following mapping:</p><formula xml:id="formula_10">g i k if φ i φ * k for i 1, . . . , n and k 1, . . . , K,<label>(9)</label></formula><p>where K denotes the number of groups. Because the φ's are generated stochastically, the Pólya urn scheme in ( <ref type="formula" target="#formula_7">7</ref>) induces a probability distribution p(π n ) defined over the space of possible partitions 3 n . The sequential nature of ( <ref type="formula" target="#formula_7">7</ref>) also leads to simple probability calculations:</p><formula xml:id="formula_11">p(π n ) ∏ n i 2 p(g i |g &lt; i ),<label>(10)</label></formula><p>where</p><formula xml:id="formula_12">g &lt; i (g 1 , . . . , g i−1</formula><p>), and</p><formula xml:id="formula_13">p(g i | g &lt; i ) w 0 if g i / ∈ {g 1 , . . . , g i−1 }, w g i otherwise.<label>(11)</label></formula><p>We next describe three desirable properties of random partition models based on Pólya urn sampling schemes.</p><p>Property 1 (Endogenous K ). If π n is a random partition generated from a Pólya urn scheme, then the number of groups K max{g 1 , . . . , g n } is also random. Consequently, the partitioning model p(π n ) induces a probability model over the number of groups p(K).</p><p>In many existing models of categorization (e.g., models based on the multinomial distribution), the number of groups must be fixed by the researcher a priori. Partitioning models based on Pólya urn schemes instead allows us to make inference about partitions and the number of groups jointly.</p><p>Property 2 (Order Restriction). If π n is a random partition generated from a Pólya urn scheme, then the elements of π n conform to the following order restriction: g 1 1 and g i ∈ {1, . . . , K (i) + 1} for i 2, . . . , n, <ref type="bibr" target="#b4">(12)</ref> where K (i) max{g 1 , . . . , g i−1 }. This property prevents any issues of label switching, which are also common in models of categorization. For example, consider two equivalent partitions π n (1, 1, 2, 1) and π n (2, 2, 1, 2). The order restriction only permits π n to be generated from the model, not π n . We will let 3 n denote the set of all possible partitions of n items subject to this restriction.  Property 3 (Marginalization). Let π n be a random partition of n items, and let π n+1 be a random partition of n + 1 items. If π n and π n+1 are generated from Pólya urn schemes, then the probability model for π n arises from marginalizing the model for π n+1 :</p><formula xml:id="formula_14">p(π n ) K+1 g n+1 1 p(π n+1 ). (<label>13</label></formula><formula xml:id="formula_15">)</formula><p>This property ensures that a partitioning model for n items does not depend on whether we consider an additional item, at least a priori. Further discussion of the marginalization property can be found in <ref type="bibr" target="#b33">Müller et al. (2015)</ref>.</p><p>The problem with the specific probability model for π n induced by the Dirichlet process is that it depends only on α and n k . Consequently, it is hard for the researcher to control the partitioning process or form expectations about the composition of sampled partitions. This restrictive nature of the Dirichlet process partitioning model makes it unattractive as a prior because it is not obvious how to summarize our knowledge of π n through the single precision parameter α. It is also unattractive as a proposal distribution within a Markov chain Monte Carlo (MCMC) routine because we can only navigate the high-dimensional partition space using independent state transitions; that is, there is no way to "center" the partition distribution around the current state when generating a candidate partition.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.">The Location-Scale Partition Distribution</head><p>Smith and Allenby (2019) address these limitations by developing the location-scale partitioning model, denoted LSP(ρ n , τ). The idea is to parameterize the group-assignment probabilities in (7) with a location partition ρ n (s 1 , . . . , s n ) and scale parameter τ &gt; 0:</p><formula xml:id="formula_16">φ i |φ &lt; i , ρ n , τ ∼ w 0 (ρ n , τ)G 0 (φ i ) + K (i) k 1 w k (ρ n , τ)δ φ * k (φ i ).<label>(14)</label></formula><p>Here, w 0 (•) and w k (•) are positive functions that satisfy w 0 (•) + k w k (•) 1. The composition of groups is now controlled by the information in ρ n and τ. Holding τ fixed, two items that are grouped together in ρ n are also more likely to be grouped together in π n . The specific functional forms for w 0 (•) and w k (•) are given by</p><formula xml:id="formula_17">w k (ρ n , τ) c i • τ + n s i S k τC (i) + τ + n k ,<label>(15)</label></formula><formula xml:id="formula_18">w 0 (ρ n , τ) c i • τ + I(s i C (i) + 1) τC (i) + τ + 1 ,<label>(16)</label></formula><p>where S k {s j : g j k and j &lt; i}, C (i) max{s 1 , . . ., s i−1 }, n c S k counts the number of elements in S k equal to c, and c i is a normalizing constant.</p><p>Because ( <ref type="formula" target="#formula_16">14</ref>) is a modified Pólya urn scheme, the LSP probability model will automatically satisfy Properties 1 and 2 described above. The functional forms for w 0 (•) and w k (•) also guarantee that the LSP model satisfies Property 3 as well as the following consistency property (see <ref type="bibr" target="#b40">Smith and Allenby (2019)</ref> for formal proofs).</p><p>Property 4 (Location-Scale Consistency). If π n ∼ LSP(ρ n , τ), then for any number of items n and location partition</p><formula xml:id="formula_19">ρ n ∈ 3 n , lim τ→0 Pr(π n ρ n |ρ n , τ) 1. (<label>17</label></formula><formula xml:id="formula_20">)</formula><p>This property ensures that the LSP(ρ n , τ) distribution behaves like a continuous, univariate distribution belonging to a location-scale family; that is, ρ n shifts the center of the distribution on 3 n , and τ determines the amount of dispersion around ρ n . As τ goes to zero, more probability mass is placed on ρ n . As τ gets large, the mass is spread more evenly over 3 n . An illustration of the differences between the partition distribution induced by the Dirichlet process and the LSP distribution is provided in the online appendix.</p><p>For our purposes, the LSP distribution facilitates estimation and inference in two ways. First, it serves as a prior distribution for π n , where prior knowledge can be directly imposed through the choice of location partition ρ n and dispersion parameter τ. Second, it serves as a proposal distribution in an MCMC routine. Specifically, we implement a random-walk Metropolis-Hastings algorithm, where a candidate partition π * n is proposed from an LSP(π n , v) distribution. Here π n is the partition in the current state, and v is a step size parameter. Candidate partitions will then be generated from a distribution centered around the partition in the current state, where the similarity between π * n and π n is controlled by v. The resulting Markov chain will be able to navigate the partition space much more effectively than alternative independence proposal mechanisms.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Posterior Inference</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.">Likelihood</head><p>The unrestricted log-linear demand system has a convenient statistical representation. Whereas log-linear models usually take the form of multivariate regressions, we rewrite (4) as a seemingly unrelated regression (SUR) model to account for the product-specific control variables:</p><formula xml:id="formula_21">y 1 y 2 . . . y n ⎛ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎝ ⎞ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎠ X 1 0 • • • 0 0 X 2 • • • 0 . . . . . . . . . . . . 0 0 • • • X n ⎛ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎝ ⎞ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎠ ω 1 ω 2 . . . ω n ⎛ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎝ ⎞ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎠ + ε 1 ε 2 . . . ε n ⎛ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎝ ⎞ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎠ , (<label>18</label></formula><formula xml:id="formula_22">)</formula><formula xml:id="formula_23">y XΩ + ε. (<label>19</label></formula><formula xml:id="formula_24">)</formula><p>Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand</p><p>Here, y i log q i is a T-dimensional vector of log demand, and X i (P, M, Z i ), where P is a T × n matrix of log prices, M is a T-dimensional vector of log expenditure, and Z i is a T × d matrix of product-specific controls. Furthermore, let ω i (β i , γ i , ψ i ), where β i is an n-dimensional vector of price elasticities, γ i is a scalar expenditure elasticity, and ψ i is a d-dimensional vector of control coefficients. Finally, the T-dimensional error vector follows a multivariate normal distribution with an expanded covariance matrix ε ∼ N(0, Σ ⊗ I T ), which induces a multivariate normal likelihood for the data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2.">Computation</head><p>In its unrestricted form, sampling from the posterior of the model in ( <ref type="formula" target="#formula_23">19</ref>), subject to the specification of proper conjugate priors, can be achieved using the SUR Gibbs sampling routine outlined in chapter 3 of <ref type="bibr" target="#b38">Rossi et al. (2005)</ref>. Posterior inference for the model in ( <ref type="formula" target="#formula_23">19</ref>) subject to separability restrictions in ( <ref type="formula" target="#formula_4">5</ref>) is more challenging. This is because the separability restrictions both (i) parameterize the conditional mean function as a nonlinear function of γ, which breaks the conjugacy that enables the use of Gibbs sampling, and (ii) project a subset of the elasticity parameters onto a lower-dimensional space whose dimension can change with the partition. We address these challenges by rewriting the mean function: y X(π n , γ; P, w)β π n + c(π n , γ; P, w)</p><formula xml:id="formula_25">+ Mγ + Zψ + ε,<label>(20)</label></formula><p>where β π n (η , θ ) denotes the joint vector of unrestricted elasticities η and restricted separability parameters θ. The first term presents the key result in that, once the suitable X(•) matrix is constructed, the model remains linear in β π n . The second term c(π n , γ; P, w) represents the remaining restrictions in (5) not contained in X(•). Specifically, let c(π n , γ; P, w) vec(PC), where C is an n × n matrix with elements C ij w j γ i I(g i g j ). The next two terms include log expenditure and product-specific controls, which are parameterized just as they are in ( <ref type="formula" target="#formula_23">19</ref>) with M diag{M, . . . , M} and Z diag{Z 1 , . . . , Z n }.</p><p>Next, we turn to the construction of X(•), which requires binding together the appropriate prices that are informative about η and θ, respectively. This gives rise to the following structure:</p><formula xml:id="formula_26">X(π n , γ; P, w) U 1 (π n ) 0 • • • 0 R 11 (π n , γ) ••• R 1nθ (π n , γ) 0 U 2 (π n ) ••• 0 R 21 (π n , γ) ••• R 2nθ (π n , γ) . . . . . . . . . . . . . . . 0 0 • • • U n (π n ) R n1 (π n , γ) ••• R nnθ (π n , γ) ⎛ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎜ ⎝ ⎞ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎟ ⎠ , (<label>21</label></formula><formula xml:id="formula_27">)</formula><p>where the block diagonal matrix in the first n columns constitutes the unrestricted covariates for η, and the remaining columns constitute the restricted covariates for θ. Specifically, U i (π n ) is the T × n η i matrix of log prices corresponding to the set of product i's unrestricted elasticities η i , where n η i dim(η i ). It is a function of π n because it is formed by combining all columns j of P such that g i g j . Each element of the remaining matrix is a T × 1 vector defined as</p><formula xml:id="formula_28">R ij (π n , γ) {r: g r ∈6 j ∩ g r g i }wr γ i γ r log p r if g i ∈ 6 j , 0 otherwise, (<label>22</label></formula><formula xml:id="formula_29">)</formula><p>where n θ dim(θ), and 6 j {k, } stores the pair of group indices (k, ) corresponding to the jth element of the θ vector. For example, if π n (1, 1, 2, 2, 3, 3), then n θ 3, 6 1 {1, 2}, 6 2 {1, 3}, and 6 3 {2, 3}.</p><p>The full set of model parameters includes the vector of unrestricted elasticities and separability parameters β π n , the expenditure elasticities γ, the partition of goods π n , the coefficients on the controls ψ, and the error covariance matrix Σ. Our posterior sampling strategy directly follows from the structure of the mean function in (20) and takes advantage of conditional conjugacy. We outline the two-step posterior sampling routine below.</p><p>Step 1 (Σ, ψ). To sample Σ and ψ from their posterior conditional on (β π n , π n , γ), let y − X(π n , γ; P, w)β π n − c(π n , γ; P, w) − Mγ Zψ + ε,</p><p>which is a standard SUR model. Thus, we can sample from this conditional posterior directly, subject to the specification of conjugate priors:</p><formula xml:id="formula_31">ψ ∼ N(ψ, A −1 ψ ) and Σ ∼ IW(ν 0 , V 0 ).</formula><p>Step 2 (β πn , γ, π n ). To sample (β π n , π n , γ) from their posterior conditional on (Σ, ψ), let</p><formula xml:id="formula_32">y − Zψ X(π n , γ; P, w)β π n + c(π n , γ; P, w) + Mγ + ε. (<label>24</label></formula><formula xml:id="formula_33">)</formula><p>This model is linear in β π n but not in γ or π n , so direct sampling from the associated posterior is not possible. We instead rely on a Metropolis-Hastings step.</p><p>The key is to construct efficient proposal distributions that ensure proper mixing and dimension matching between β π n and π n .</p><p>We construct our joint proposal distribution as follows:</p><formula xml:id="formula_34">q(β * π n , π * n , γ * |β π n , π n , γ) q 1 (β * π n |π * n , γ * )q 2 (π * n |π n )q 3 (γ * |γ),<label>(25)</label></formula><p>where (β * π n , π * n , γ * ) denote the candidate values and (β π n , π n , γ) denote the current values. Notice that conditional on values of π n and γ, we can rewrite (24)</p><p>Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand <ref type="bibr">Marketing Science, 2019</ref><ref type="bibr">, vol. 38, no. 4, pp. 690-710, © 2019</ref> as another SUR-like model that is linear in β π n . <ref type="bibr">6</ref> The benefit is that, subject to the specification of a conditionally conjugate prior β π n |π n ∼ N(β π n , A −1 β ), we can directly sample from the associated conditional posterior (see Appendix B for details). This results in a highly efficient independence proposal given that q 1 (•) is the exact conditional posterior of β π n . Two marginal random-walk proposals can then be used for π n and γ. In particular, we choose q 2 (•) to be the LSP distribution of <ref type="bibr" target="#b40">Smith and Allenby (2019)</ref> so that π * n ∼ LSP(π n , v), where v is a step size. The efficiency of this approach comes from being able to generate π * n from a distribution "centered" around the current partition, as in any ordinary random-walk proposal.</p><p>There are two benefits from the joint proposal strategy outlined above. First, the resulting ratio of likelihoods will always be tractable in the sense that the dimension of β π n is guaranteed to conform with π n . In fact, recognizing that q 1 (•) is the conditional posterior of β π n , it becomes straightforward to show the acceptance probability reduces to</p><formula xml:id="formula_35">! min 1, m * (y|π * n , γ * , Σ)p(π * n )p(γ * )q 2 (π n |π * n ) m(y|π n , γ, Σ)p(π n )p(γ)q 2 (π * n |π n ) ,<label>(26)</label></formula><p>where</p><formula xml:id="formula_36">m(y|π n , γ, Σ) p(y|β π n , π n , γ, Σ)p(β π n |π n )dβ π n . (27)</formula><p>Therefore, the proposed sampler is equivalent to a sampler that marginalizes over β π n when navigating the posterior of π n .</p><p>The second benefit is that generating β * π n from its full conditional distribution independent of β π n allows us to handle changes in dimensionality with little computational burden. Traditional attempts to accommodate transdimensional sampling problems within MCMC rely on random-walk proposals such as the reversible-jump MCMC sampler of <ref type="bibr" target="#b21">Green (1995)</ref>. However, these methods require complicated transition probability calculations and become inefficient in high dimensions. In contrast, we only use random-walk proposals to marginally navigate a high-dimensional (but fixed) partition space, and then use efficient independence proposals for β π n . Therefore, the transition probabilities in the proposed routine only require evaluating a multivariate normal density and the LSP probability mass function.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3.">Specification of Priors</head><p>Care must be taken when choosing hyperparameters in the prior distributions of β π n and π n . This is because the acceptance probability in the proposed MCMC routine is driven by the ratio of marginalized likelihoods that are integrated over β π n . Given that the dimension of β π n depends on π n , the integrals in the numerator and denominator of ( <ref type="formula" target="#formula_35">26</ref>) may be of differing dimensions and will penalize models with many parameters in the presence of diffuse conditional priors on β π n <ref type="bibr" target="#b27">(Lindley 1957</ref>). In the context of our separable demand model where n η i n η i grows faster than n θ , this means that the ratio of marginalized likelihoods will naturally favor models with fewer unrestricted elasticity parameters and many groups.</p><p>In situations with limited data (where the prior dominates the likelihood) or when the researcher wants to penalize models with many groups, this effect can be countered through a judicious choice ofβ π n , A β , ρ n , and τ. For example, researchers often specify diffuse priors in regression models by choosingβ π n 0 and A β 0.01I. However, choosing A β 0.1I may be more appropriate, as it reflects the knowledge that elasticities rarely fall outside the range (−6, 6). One may also choose ρ n to have few groups with a small value of τ. Doing so allows the marginal prior on π n to penalize partitions with many groups. See the online appendix for a simulation study that further explores the effect of the prior on posterior inference.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4.">Scalability</head><p>Although the SUR-like representation of the model likelihood enables efficient posterior inference, there are some limitations that arise when n is large. First, the joint proposal strategy outlined in Section 4.2 requires us to sample from the conditional posterior of β π n given all other parameters and data. The linearity of the model makes direct sampling possible, but potentially computationally expensive. This is because the dimension of this conditional posterior is n β πn n η + n θ k n 2 k + K(K − 1)/2, which grows quadratically in both the number of unrestricted parameters and groups. For example, if there are K 10 groups with each having n k 10 products, then n β πn 1,000 + 10( <ref type="formula" target="#formula_10">9</ref>)/2 1045. In contrast, if there are only K 2 groups with each having n k 50 products, then n β πn 5,000 + 1 5,001. Thus, the dimension of the conditional posterior can change dramatically with π n .</p><p>As with any Bayesian SUR model, drawing from this conditional posterior distribution of β π n requires computing its posterior mean and the inverse of the Cholesky root of its posterior covariance matrix in each iteration of the Markov chain <ref type="bibr" target="#b38">(Rossi et al. 2005)</ref>. Because the posterior moments depend on the design matrix X(π n , γ; P, w), which in turn depends on π n , we must also construct X(π n , γ; P, w) in each iteration. Although this adds to the complexity, we avoid the cost of multiplying these large matrices by exploiting the partial sparsity of X(π n , γ; P, w) and instead construct its cross product directly. <ref type="bibr">7</ref> Figure <ref type="figure" target="#fig_1">2</ref> illustrates the computational cost of sampling from the conditional posterior of β π n . The computation time we measure includes the cost of constructing the Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand cross product of X(π n , γ; P, w), computing the posterior mean, and taking the inverse of the Cholesky root of the posterior covariance matrix. <ref type="bibr" target="#b0">8</ref> In this exercise, we always define π n to be a partition with two groups (n θ 1), but vary the number of elements in each group n k ∈ {5, 10, 15, . . . , 50}. This leads to models with n ∈ {10, 20, 30, . . . , 100} products and n η ∈ {50, 200, 450, . . . , 5, 000} unrestricted elasticities. We plot the average computation time (across 100 replicates) against the number of unrestricted elasticities, where the number of observations is fixed at T 200 across all models. We find that the computation cost increases nonlinearly with n η .</p><p>Our model also requires navigating the space of partitions, which grows superexponentially in n <ref type="bibr" target="#b6">(Bell 1934)</ref>. LSP proposals allow us to navigate this space efficiently for moderate n, but are subject to the same scaling limitations as any random-walk Metropolis-Hastings algorithm; that is, there is a question of how to choose the step size of the LSP proposal distribution to ensure proper mixing as n gets large. Smith and Allenby (2019) find that using v 1/(n log n) appropriately scales the dimension of 3 n , and they demonstrate practical convergence for up to n 100 items. Higher-dimensional product sets can still be accommodated in our model, but may require stronger prior restrictions on the partition (e.g., assuming that a set of products must always belong to the same group).</p><p>Finally, there is a question of how the number of products n is allowed to scale relative to the number of observations T. In online retail, for example, there is a practical interest in "high-dimensional" regressionbased demand models in which the number of products, and associated price effects, exceeds the number of observations. The challenge is in this setting is that the least squares estimator of the unrestricted price elasticity matrix is no longer well defined. Note that although a Bayesian estimator of the same price elasticity matrix is not subject to this limitation because of the regularity imposed by the prior, the associated posterior would still exhibit significant uncertainty. Because we take a Bayesian approach to inference and impose further parameter restrictions, our model will generate a well-defined posterior even when n &gt; T. However, this high-dimensional setting is not our inherent focus for a few reasons.</p><p>First, our analysis is motivated by the fact that separability assumptions remain widely (and often implicitly) used in large-and small-scale demand problems alike. One of our goals is to assess the viability of these assumptions by providing empirical insights into the separable structure of demand. Although the choice of separable groups becomes more difficult when product space is really large, to our knowledge there is no other work that attempts to identify separable demand groups even within a single product category. Instead of focusing on scale alone, we aim to provide a more comprehensive description of competition within broad and highly differentiated product categories. Moreover, in our empirical applications, we focus on competition between brands and have found that the number of brands that constitute the majority of total category sales is small relative to the number of UPCs. Thus, for a brand-level analysis, the product set need not be extremely large to provide a complete description of category competition.</p><p>That being said, the core dimension reduction offered by separability remains attractive in very highdimensional settings. Joint inference for π n and β π n is impractical when n &gt; T because of the complexity of the partition space 3 n and the limited number of observations. However, if the goal is to simply forecast demand or generate estimates of price effects (which are otherwise intractable), then our recommendation is to fix both the expenditure elasticities (e.g., γ i 1 for all i) and partition. Doing so greatly reduces complexity of our sampling algorithm by removing the need to implement a Metropolis-Hastings step, which in turn makes posterior inference more practical when n is large (e.g., in the hundreds). In the online appendix, we also use a simulated data to show how the separable demand model performs in n &gt; T settings. Because the core focus of this paper is to uncover the separable structure of demand through posterior inference on π n , we assume T &gt; n going forward.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Empirical Analysis</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1.">Data</head><p>Our data come from the Nielsen Retail Measurement Services (RMS) database, which contains weekly movement, pricing, and store environment information for over 90 retail chains across the United States. 9 Marketing <ref type="bibr">Science, 2019</ref><ref type="bibr">, vol. 38, no. 4, pp. 690-710, © 2019</ref> Within the RMS database, UPCs are grouped into 10 departments (e.g., dry grocery), 125 product groups (e.g., snacks), and 1,100 product modules (e.g., potato chips). We construct two data sets from two distinct product groups: (i) jams, jellies, and spreads and (ii) juice drinks. The jams, jellies, and spreads product group consists of 9 product modules, whereas the juice product group consists of 18. <ref type="bibr" target="#b2">10</ref> For simplicity, we use data from a single store in Cincinnati, Ohio, for which instore promotional activity is available. Our sample period spans four years, from 2008 to 2011, and we use a random sample of 52 weeks as a holdout sample.</p><p>For each product group, we aggregate UPCs to the brand level because of high collinearity of prices within a brand (e.g., a 28 oz. jar of Jif creamy peanut butter vs. a 28 oz. jar of Jif chunky peanut butter). In the jams, jellies, and spreads category, we also combine the jams and jellies modules because they exhibit highly collinear prices. We believe that a brand-level analysis is the most natural for considering the formation of separable demand groups. For example, it seems unreasonable to think that rate of substitution between an 18 ounce jar of Jif peanut butter and an 18 ounce jar of Skippy peanut butter would ever be independent of the demand for the exact same Jif offering in a 28 ounce jar. Our sample of products includes the majority of brands that have a within-module share of volume exceeding 1% and are present for each year in the sample. For each brand, we then create volumeweighted prices that are standardized prices for the most common pack size in the product group.</p><p>Our analysis in the jams, jellies, and spreads product group uses data from the jams, jellies, preserves, and peanut butter modules. These four modules constitute 84% of total demand in the product group. Aggregating up to the brand level results in 18 unique products that are comprised of 224 UPCs and account for 85% of demand across the four product modules. Moreover, the distinct differences in and complementary relationship between peanut butter and jellies/preserves create a strong prior for how to categorize products. By comparing the separable demand groups we find in the data to the product module labels, we can examine the face validity of our methodology.</p><p>The second analysis from the juice drinks product group uses data from the top eight product modules, which constitute 90% of total demand for the entire juice product group. Aggregating up to the brand level results in 32 products that are comprised of 421 UPCs and account for 64% of total demand across the eight product modules. The relatively lower share of volume is due to the high fraction of small on-the-go package sizes, which we exclude in our analysis. Conditional on the set of package sizes in our sample (40-140 ounces), these 421 UPCs account for 83% of demand.</p><p>In both data sets, we include seasonal effects, display and feature advertising variables, and product intercepts as product-specific covariates. We also construct M t using expenditure data at the product group level, which spans a broader set of product modules and UPCs than those used to form the items under study. Detailed descriptions of the products from both data sets are provided in Appendix C.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2.">Prior and MCMC Settings</head><p>Until now, we have treated expenditure elasticities γ as model parameters. Although inference for γ is possible, we choose to fix γ i 1 for all i 1, . . ., n, as suggested by the adding-up condition. We feel this restriction is justified for two reasons. First, it amounts to placing a very dogmatic prior on γ that is centered around values suggested by economic theory. Doing so helps push estimates of remaining model parameters toward values consistent with integrable demand. Second, specifying demand as a function of total expenditure raises a concern of endogeneity when estimating γ. The inclusion of expenditure in ( <ref type="formula">4</ref>) is important to maintain the coherence of the restriction in (3). However, our focus is on understanding the structure of cross-price effects, so a formal treatment of expenditure endogeneity (e.g., by way of instrumental variables) only adds unnecessary complication to our analysis.</p><p>We proceed by estimating three demand models. The first is an unrestricted log-linear model. The second is a separable log-linear model where the partitioning of goods is fixed a priori based on the definition of product modules. The third is a separable log-linear model where π n is estimated from the data. All models are estimated using MCMC methods discussed in Section 4. Each Markov chain is run for R 500, 000 iterations and thinned by keeping every 100th raw. We use the first 25% of draws as burn-in. When π n is estimated, we choose the scale parameter of the proposal distribution to be v 1/(n log n).</p><p>Conditionally conjugate but fairly diffuse priors are placed on all parameters in the unrestricted model:</p><formula xml:id="formula_37">ψ ∼ N(0, 100I), β ∼ N(0, 10I), and Σ ∼ IW(n + 3,(n + 3)I).</formula><p>In both separable demand models, we place a N(0,10I) prior on the unrestricted elasticities η, a N(0, 100I) prior on the separability parameters θ, and the same priors on ψ and Σ as in the unrestricted model. When π n is estimated, we use the LSP distribution as a prior with ρ n equal to the partition with one group and τ 1/(nlog n). Doing so imposes a slight penalty on models with many groups.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3.">Model Comparison</head><p>Table <ref type="table" target="#tab_1">1</ref> provides posterior estimates of in-sample and predictive fit statistics. We report both the Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand log marginal density (LMD), calculated using the Newton-Raftery approximation, and the root mean squared error (RMSE). The in-sample fit across models is generally similar, with the unrestricted model fitting best in the jams, jellies, and spreads data and the more flexible separable model fitting best in the juice data. The advantages offered by separability are most noticeable in the predictive fit statistics. Specifically, reducing the dimension of the parameter space improves the accuracy and precision of demand forecasts.</p><p>The extent of the improvement between the two separable models depends on the product category and how closely the module labels match the demand structure in the data. For example, estimating π n leads to larger improvements in predictive fit when the posterior places mass on product groups inconsistent with category labels. In the next section, we show that module labels do a reasonable job describing the separable structure of demand for jams, jellies, and spreads, but not juice drinks.</p><p>We can also test for differences between weak, strong, and additive separability using the nested structure of the elasticity restrictions as discussed in Section 2.1. For example, additive separability requires π n to have n groups, so we can test for additivity by computing the posterior probability that K n in the more flexible separable model. In both data sets, the posterior distribution of K places no mass on K n, rejecting additivity.</p><p>Strong separability holds whenever the separability parameters are constant across groups. We can then test for strong separability by testing for equality among the θ k parameters. We carry out this test using the separable model that estimates π n because it fits the data best. <ref type="bibr" target="#b3">11</ref> The only complication is that when π n is estimated, the dimension of the θ vector potentially changes across iterations. We therefore isolate the partitions visited more than once in the Markov chain and compute 95% credible intervals for each θ k in the associated θ vector. We test for equality among the θ k 's by then checking to see whether any of the credible intervals do not overlap, which is the case 99% of the time in both data sets. Thus, the magnitude of the separability parameters provides empirical evidence that supports weak rather than strong separability.</p><p>Finally, we use the posterior distribution of crossprice effects β ij to examine the extent to which the integrability conditions are satisfied in the data. Adding up is satisfied by assumption. The posterior distributions for the homogeneity and negativity conditions are shown in the online appendix. We find that both hypotheses cannot be rejected for nearly all products in the data. We also compute the posterior distribution of the symmetry condition and find that it cannot be rejected 97% of the time in the jams, jellies, and spreads data and 98% of the time in the juice data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.4.">Inference for Partitions</head><p>The posterior distribution of π n is summarized in Figure <ref type="figure" target="#fig_2">3</ref>, which plots the posterior pairwise similarity matrix from each data set. The similarity matrix captures the proportion of times two items are grouped together throughout all post-burn-in iterations of the Markov chain, where darker colors imply higher clustering probabilities. We also show the grouping structure implied by product modules in the bottom right corner of each similarity matrix to be able to compare how the partitions supported by the data compare with product categories.</p><p>In the jams, jellies, and spreads data set, we find that partitions with high posterior probability are fairly consistent with the definition of product modules; that is, the estimated demand groups tend to separate peanut butter from jellies, jams, and preserves. Our results do indicate some co-clustering across the jellies/ jams and preserves modules. However, the majority of clustering occurs within the product module. We also find a slightly more refined structure of demand within the jellies/jams module, in which grape and strawberry offerings are usually separated from blackberry and raspberry offerings. However, the model fit statistics suggest that making the mistake of defining a category too broadly is still less egregious than defining categories that are too narrow.</p><p>In the juice data set, we find stark differences between the separable structure of demand and the predefined module categorization. In fact, partitions Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand with appreciable posterior mass always contain demand groups that span different flavor subcategories. For example, we find that three Simply juices (apple, orange, grapefruit) exhibit high co-clustering probabilities (83% for apple-orange, 64% for apple-grapefruit, and 58% for orange-grapefruit).</p><p>The nonseparability of demand for Simply juices may be attributed to marketing activities. For example, Simply products all have identical branding and are displayed together in the refrigerated section of the grocery store. <ref type="bibr" target="#b4">12</ref> The shelf placement of Simply Apple is especially intriguing given that most all apple juice products are usually shelf stable and physically located in a different aisle. Activities like these could help Simply, a much younger brand than its competitors, create a local monopoly in the broader juice category.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.5.">Inference for Separability and</head><p>Elasticity Parameters The estimates of the separability parameters provide information about the relationship between separable groups. In the jams, jellies, and spreads data set, for example, one may not only expect peanut butter and jelly to be in separable groups, but also that the separability parameters indicate groupwise complementarity. Given that the a priori relationship between different demand groups in the juice category is less obvious, we focus on inference for separability parameters for the jams, jellies, and spreads category.</p><p>Marginal inference for separability parameters is challenging when π n is estimated because the dimension of θ changes with π n . Because we are interested in whether the estimates of θ generally pick up complementarity between the peanut butter and jellies/ preserves product groups, we summarize the posterior of θ as follows. We first condition on states in the posterior such that all peanut butters belong to different groups from the jellies and preserves. Then, we compute the average value of θ both across peanut butters and jellies/preserves and within jellies/ preserves. The full distribution of θ in each case is shown in Figure <ref type="figure" target="#fig_3">4</ref>.</p><p>A priori, one may expect θ to induce complementarity between peanut butter and jellies/preserves, but substitutability between jellies and preserves. We can assess product relationships using (6), which shows that complementarity holds whenever θ &lt; 1. Figure <ref type="figure" target="#fig_3">4</ref> shows that the distribution of θ generally falls below one across peanut butter and jellies/preserves, and above one across jellies and preserves. This provides evidence that when π n is estimated, the model not only tends to assign peanut butter and jellies/ preserves into separable groups, but also produces values of θ that reflect complementarity between peanut butter and jellies/preserves and substitutability between jellies and preserves.</p><p>We can also project estimates of the lower-dimensional separability parameters back up to the space of the n × n price elasticity matrix. Figure <ref type="figure" target="#fig_4">5</ref> plots the posterior means and standard deviations of the full price elasticity matrix for the unrestricted model against the induced elasticities from the separable model with estimated π n . Although there is a high degree of correlation between elasticity estimates, many of the cross-price elasticities are estimated to be zero in the proposed model. One explanation is that some of the demand groups are not only separable, but also isolated. The fact that our model can accommodate both cases is an advantage over other regularization methods that only impose shrinkage to zero.</p><p>Moreover, the precision of the estimates tends to be worse for both unrestricted models. This is shown in the right column of Figure <ref type="figure" target="#fig_4">5</ref>, where the majority Note. The dashed vertical line indicates the value of θ for which products are complements (θ &lt; 1) or substitutes (θ &gt; 1).</p><p>Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand</p><p>Marketing <ref type="bibr">Science, 2019</ref><ref type="bibr">, vol. 38, no. 4, pp. 690-710, © 2019</ref> of points fall to the right of the 45 degree line. This provides evidence that separability restrictions are still able to provide gains in efficiency when the partition is also estimated.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Implications</head><p>This section explores the implications of separable demand on product competition, brand positioning, and the measurement category promotion effects. We investigate these topics using results from the juice data set, where the variety of flavors and brands generally complicates the analysis of market structure.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1.">Competition</head><p>An advantage of economic demand models is that they allow for a formal analysis of product competition as measured by the sign and magnitude of cross-price effects. For instance, brands with higher cross-price effects compete more intensely and are therefore closer substitutes. Separability offers a third dimension for assessing competition: the dimension of the price elasticity matrix. By allowing π n to be estimated from the data, we can learn about the boundaries of consumer preferences as defined by (2). Empirically, we find brands like Simply in the juice category appear to break the notion of separability by flavor. This means that the rate at which consumers substitute between brands within a flavor category (e.g., apple juice) may very well depend on their consumption in other flavor categories (e.g., orange juice). In a sense, this finding corroborates the goals of many marketing activities like umbrella branding and advertising, which seek to create information spillovers in the consumer's choice process. This result also implies that the boundaries of competition may be Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand broader than previously thought, at least within the juice category. Allowing for a formal connection between marketing variables (e.g., shelf collocation or advertising) to the separable structure of demand is something we leave for future work.</p><p>In addition to the boundaries of competition, we can also explore the induced effects of separability restrictions on the sign and magnitude of cross-price effects. In a separable demand model, cross-group price effects are a function of budget sharesw j , separability parameters θ, and expenditure elasticities γ. Because we fix expenditure elasticities a priori, the sign and magnitude of these cross-group price effects will be driven by θ. In many cases, θ will need to be large in absolute value to overcome small budget shares and produce nonzero cross effects.</p><p>We start by plotting the distribution of withingroup and across-group price elasticities for both separable models (Figure <ref type="figure" target="#fig_5">6</ref>). We find that imposing separability generally shrinks the cross-group price effects to a small neighborhood around zero, which suggests that products within a group are most influenced by price changes within the group than across groups. This is consistent with previous work on the effects of separability on competition (e.g., <ref type="bibr" target="#b39">Rubinfield 2000)</ref>, which have treated this property as a shortcoming of separability because the form of competition is in part fixed by the researcher's partitioning of goods. However, this is not a concern when π n is estimated from the data. In fact, we need the cross-group restrictions to be dogmatic to separate true cross effects from random noise.</p><p>To see the impact of separability at a more granular level, we also decompose the within-group and acrossgroup elasticities by flavor category. Table <ref type="table">2</ref> reports the average own elasticity, within-group elasticity, across-group elasticity, and absolute value of the ratio of within to across for each product module. The ratio illustrates the extent to which the magnitude of withingroup elasticities exceeds that of the cross-group elasticities.</p><p>We find that when the partition is fixed, the average ratio of within-to across-group elasticities tends to be extremely large. However, the ratios shrink significantly when π n is estimated. Even though each partition still places strong restrictions on the crossgroup effects, the reported elasticities are averaged over the posterior distribution of π n . This induced differential shrinkage allows the separable model to admit more flexible substitution patterns, obviating the concern that separable assumptions fix the form of product competition.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2.">Brand Positioning</head><p>Given the relationship between the partitioning of goods into separable groups and the induced patterns of competition, we next investigate how this information can influence brand positioning strategies. To illustrate, again consider the case of Simply juices. Our empirical analysis showed that Simply juices often belong to one group rather than separable groups. The retailer may then wonder whether this local concentration of demand for Simply hurts its ability to compete with its store brand juice offerings.</p><p>If brand positioning is a determinant of the separable structure of demand, then the retailer could consider repositioning the line of store brand juices in a way that moves store brand juices into the cluster of Simply juices. We explore this type of counterfactual with a simple example with three products: Simply Apple, Simply Orange, and store brand orange juice. If Simply Apple and Simply Orange belong to one group and the store brand orange juice belongs to another, then Simply Orange and the store brand orange  <ref type="bibr">, , vol. 38, no. 4, pp. 690-710, © 2019</ref> juice will likely be less competitive (as measured by the magnitude of their cross-price effect).</p><p>By exploiting the uncertainty in the posterior distribution of π n , we can offer insights relating to this counterfactual; that is, in the posterior of π n , we observe Simply Orange and Simply Apple belonging to the same cluster 83% of the time, whereas we observe Simply Orange and the store brand orange juice belonging to the same cluster 23% of the time. We then look at cases when Simply Orange and the store brand orange juice are either grouped together or not and compute the average cross-price elasticities between (i) Simply Orange and the store brand orange juice and (ii) Simply Apple and the store brand orange juice. The distributions of the mean absolute value cross-price elasticities are shown for each case in Figure <ref type="figure" target="#fig_6">7</ref>.</p><p>We find that the Simply-store brand cross-price effects are roughly zero when the two belong to different groups, but nonzero when they belong to the same group. This is even true for the effect of a price change on Simply Apple on the demand for store brand orange juice. The intuition is that joining the same cluster as Simply has the potential to generate positive crosscategory spillover effects for the store brand.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.3.">Promotion Effects and Category Revenue</head><p>Category managers are often tasked with setting pricing and promotional schedules across a wide assortment of goods. In these settings, it becomes especially important to estimate category demand systems that yield flexible yet precise demand elasticities to accurately measure the impact of price promotions on category sales. To illustrate the implications of separable (or nonseparable) demand on marketing actions, we consider the following promotional forecasting problem: What is the effect of a price promotion of one product on total category sales? In general, the answer is ambiguous as it depends on the relationship between a product's own and cross-price effects. It is then important to measure these price effects accurately and precisely, both within and across product modules. </p><formula xml:id="formula_38">q i h m (X, ω m i ) + ε i , ε (ε 1 , . . . , ε n ) ∼ N(0, Σ),<label>(28)</label></formula><p>where h m (X, ω m i ) denotes the conditional mean function for model m, which depends on covariates X and parameters ω m i . We let Ω m denote the full collection of model parameters. For example, Ω m (β, γ, ψ, Σ) in the unrestricted model, whereas Ω m (β π n , π n , γ, ψ, Σ) in the separable model when estimating π n . When the error vector is multivariate normal, the expected demand for good j (integrating over ε) has a simple closedform expression:</p><formula xml:id="formula_39">q j (Ω m |X) E ε q j (Ω m , ε|X) exp h m (X, ω m j ) + 0.5Σ jj .<label>(29)</label></formula><p>Expected revenue can then be written as an integral of 5 ) (Ω m |X) over the posterior distribution of all model parameters Ω m , corresponding to the posterior predictive distribution of Ω m :</p><formula xml:id="formula_40">E Ω m [5 ) (Ω m |X)] E Ω m j∈) p j • q j (Ω m |X) j∈) p j • exp h m (X, ω m j ) + 0.5Σ jj • dF(Ω m |X).<label>(30)</label></formula><p>We first provide an illustrative example in which we predict the effects of a $0.50-off price promotion for Simply Orange on category revenue. The depth of this promotion reflects a move from the 75th percentile of the Simply Orange price distribution to the 25th percentile of the distribution. Choosing Simply Orange also allows us to demonstrate the consequences of misspecifying the separable structure of demand because we find evidence that Simply Orange may not be separable from other Simply offerings. For each of the separable models, we compute expected demand under two price sets: (i) prices of all products are fixed at their average price, and (ii) prices of all products are fixed at their average price except for Simply Orange, which is $0.50 less than its average price. When π n is fixed, the model predicts a null effect on category revenue, with the 95% credible interval ranging from −3.6% to 3.3%. However, when π n is estimated, the model predicts a 2.8% increase on category revenue, with the 95% credible interval ranging from −2.4% to 11.2%. The difference is likely due to the misspecified shrinkage structure of crossprice effects. For instance, the nonseparability of demand coming from a brand like Simply may generate a form of brand complementarity. In this case, a price promotion of Simply in one flavor subcategory may lead to increased demand for Simply in other subcategories. However, this effect cannot be captured when π n is fixed and misspecified.</p><p>To empirically validate the previous example and demonstrate that biases exist beyond Simply Orange alone, we use price variation in our holdout sample to predict category sales. Because price promotions are not labeled in the data, we must first construct a set of base and promotion prices for each product. We define the base price as any price in the top 25th percentile of the product's price distribution in a given year, and the promotion price as any price in the bottom 25th percentile of the same distribution. <ref type="bibr">13</ref> We then use the unrestricted and separable models to predict demand under each product's base and promotion price set, compute the associated percentage change in category revenue, and then compare with the observed percentage change in sales in our holdout sample.</p><p>For each product i 1, . . . , n, we use (30) to compute the percentage change in expected category revenue generated by a price promotion of product i. This generates estimates of the category promotion effect for each good, which we then compare with the actual percentage change in category revenue observed in the holdout sample. Table <ref type="table" target="#tab_2">3</ref> reports the average bias in absolute value and standard deviation of these estimates for each model, where the averaging is done across products.</p><p>Estimates from the unrestricted model exhibit less bias but larger variance than those from the separable model with fixed π n . The larger variance is an artifact of the number of parameters in the unrestricted model. When π n is estimated; however, the bias relative to the unrestricted model disappears and we still retain the relative gains in efficiency.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.">Discussion</head><p>This paper develops a methodology that can be used to learn about the separable structure of demand from store-level scanner data. Traditional work on separable demand has treated the partitioning of products as fixed. Instead, we let the partition be a model  <ref type="bibr">Marketing Science, 2019</ref><ref type="bibr">, vol. 38, no. 4, pp. 690-710, © 2019</ref> parameter that can be estimated and propose a Bayesian method of joint inference for the partition and other demand parameters. An immediate benefit is that we are able to use the data to find potentially less obvious grouping structures. Using data from two distinct product categories, we find that the separable structure of demand can be markedly different from predefined category labels. For example, in the juice category, we find that multiple flavors are often present within demand groups, suggesting that the demand is not separable by flavor. This result also suggests that the boundary of competition between subcategories like apple and orange juice may extend beyond that which is defined by subcategory labels. We then show how misspecifying these boundaries impacts inference for product competition and promotion effects.</p><p>There are limitations of the current work that serve as a motivation for possible extensions. For example, our treatment of aggregate demand ignores many important aspects of consumer choice, such as store choice, category choice, purchase timing, and household inventories. Ideally, we would derive aggregate demand from a micro-model of utility maximization to account for these factors. However, this becomes challenging when the underlying utility deviates from an additively separable structure. We also used a store-level demand system that does not attempt to formally model the distribution of consumer preferences. If consumers are heterogeneous in the partitions that define their separable preferences, then some of the nonseparabilities we find at the store level could be due to this source of heterogeneity. However, it is well known that consumer heterogeneity is only weakly identified with aggregate data. It remains to be investigated whether heterogeneity in separability-based groupings of products can be identified using even relatively disaggregate storelevel data.</p><p>Our work may also have implications for formal retailer pricing policies. Traditionally, retailers are assumed to set prices by maximizing category profits, where categories are defined at a more disaggregate level, such as orange juice (e.g., <ref type="bibr" target="#b31">Montgomery 1997</ref><ref type="bibr" target="#b15">, Dubé et al. 2008</ref>). However, our results suggest demand may not be separable across categories like apple and orange juice, especially in the presence of strong multiproduct national brands. Formalizing the consequences on coordinated pricing with nonseparable category demand remains an open area for future work.</p><p>Finally, we have shown that both the structure of the log-linear model and the sheer dimension of the partition space both limit the scalability of our model. At the same time, very high-dimensional product sets are becoming more common in empirical work, so it would be useful to see how the core dimension reduction offered by separability can be used when the product space is extremely large. To the extent that separability can formally connect flexible and scalable statistical models with economic theory, this extension will be especially relevant when firms want to estimate demand parameters for the purpose of optimizing marketing actions. We leave these topics for future research. Price Elasticities Let S ij ∂qi ∂pj + q j ∂qi ∂m denote the effect of a unit increase in the price of good j on the compensated (Hicksian) demand of good i. Weak separability imposes a restriction on crossgroup compensated price effects; that is, if i and j are in different groups, then S ij φ k (q) ∂q i ∂m ∂q j ∂m .</p><p>(A.1)</p><p>Because log-linear demand models are parameterized in terms of uncompensated price elasticities (i.e., elasticities with respect to Marshallian demand functions), we need to translate the restriction on S ij intro a restriction on β ij . We first rewrite the original separability restriction in terms of expenditure elasticities:</p><formula xml:id="formula_41">S ij φ k (q) ∂q i ∂m ∂q j ∂m (A.2) φ k (q) m • ∂q i /q i ∂m/m • ∂q j /q j ∂m/m • q i q j m (A.3) φ k (q) m γ i γ j q i q j m (A.4) θ k (q)γ i γ j q i q j m . (A.5)</formula><p>We make the further assumption that the function θ k (q) only contains an intercept term and is thus independent of demand: θ k (q) θ k . Then, by the elasticity form of the Slutsky equation, it follows that S ij • p j q i β ij + γ i w j ⇒ θ k γ i γ j q i q j m • p j q i β ij + γ i w j (A.6) ⇒ θ k γ i γ j q j p j m β ij + γ i w j (A.7)</p><p>⇒ β ij w j (θ k γ i γ j − γ i ).</p><p>(A.8) To derive the posterior distribution of β πn conditional on all other parameters and data, we first isolate β πn and rewrite the model in (20) as y * X(π n , γ; P, w)β πn + ε, (B.1)</p><p>where y * y − c(π n , γ;P,w) − Mγ − Zψ and ε ∼ N(0, Σ ⊗ I T ).</p><p>Although X(•) is not block diagonal as in a standard SUR model, the likelihood function still exhibits a SUR-like representation because of the vectorized response, expanded mean function, and correlated errors.</p><p>Next, we translate this system into a system of uncorrelated errors:ỹ * whereβ πn (X πnX πn + A β ) −1 (X πnỹ * + A ββπn ).</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 .</head><label>1</label><figDesc>Figure 1. Drawing Random Partitions from Discrete Random Measures</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 .</head><label>2</label><figDesc>Figure 2. Average Computation Time in Seconds (over 100 Replicates) for a Single Draw from the Conditional Posterior of β πn for Various Model Sizes</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 3 .</head><label>3</label><figDesc>Figure 3. Posterior Pairwise Similarity Matrices for Each Data Set</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 4 .</head><label>4</label><figDesc>Figure 4. The Distribution of Separability Parameters for (a) Peanut Butter and Jellies/Preserves and (b) Jellies and Preserves</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 5 .</head><label>5</label><figDesc>Figure 5. Posterior Means and Standard Deviations of Price Elasticity Parameters for the Separable and Unrestricted Models</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 6 .</head><label>6</label><figDesc>Figure 6. Distributions of the Within-Group and Across-Group Elasticities for Separable Demand Models in the Juice Category</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 7 .</head><label>7</label><figDesc>Figure 7. Cross-Price Elasticities Between Simply Orange (Left) and Store Brand Orange and Simply Apple and Store Brand Orange (Right)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><label></label><figDesc>y ((U −1 ) ⊗ I T )y, (B.4)X πn ((U −1 ) ⊗ I T )X(π n , γ; P, w), (B.5) ε ((U −1 ) ⊗ I T )ε, (B.6) so that Var(ε) ((U −1 ) ⊗ I T )(Σ ⊗ I T )(U −1 ⊗ I T ) (U −1 ) ΣU −1 ⊗I T I n ⊗ I T . With a conditionally conjugate prior β πn |π n ∼ N(β πn , A −1 β ), the associated posterior takes the form β πn |π n , else ∼ N(β πn , (X πnX πn + A β ) −1 ), (B.7)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head></head><label></label><figDesc>Smith, Rossi, and Allenby: Inference for Product Competition and Separable DemandMarketing Science, 2019, vol. 38, no. 4, pp. 690-710, © 2019 </figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 1 .</head><label>1</label><figDesc>Model Fit StatisticsSmith, Rossi, and Allenby: Inference for Product Competition and Separable Demand</figDesc><table><row><cell cols="2">Marketing Science, 2019, vol. 38, no. 4, pp. 690-710, © 2019 INFORMS</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell>In-sample</cell><cell></cell><cell></cell><cell>Predictive</cell><cell></cell></row><row><cell>Model</cell><cell>LMD</cell><cell cols="2">RMSE</cell><cell>LMD</cell><cell cols="2">RMSE</cell></row><row><cell>Jams, jellies, and spreads</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>Unrestricted</cell><cell>−2,494.675</cell><cell>0.786</cell><cell>(0.007)</cell><cell>−1,205.749</cell><cell>1.047</cell><cell>(0.023)</cell></row><row><cell>Separable, fixed π n</cell><cell>−2,477.253</cell><cell>0.790</cell><cell>(0.005)</cell><cell>−1,092.224</cell><cell>0.974</cell><cell>(0.015)</cell></row><row><cell>Separable, estimated π n</cell><cell>−2,471.433</cell><cell>0.789</cell><cell>(0.004)</cell><cell>−1,082.494</cell><cell>0.960</cell><cell>(0.014)</cell></row><row><cell>Juice drinks</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>Unrestricted</cell><cell>−3,126.433</cell><cell>0.420</cell><cell>(0.005)</cell><cell>−1,237.058</cell><cell>0.492</cell><cell>(0.013)</cell></row><row><cell>Separable, fixed π n</cell><cell>−2,938.950</cell><cell>0.418</cell><cell>(0.003)</cell><cell>−1,016.541</cell><cell>0.422</cell><cell>(0.007)</cell></row><row><cell>Separable, estimated π n</cell><cell>−2,867.157</cell><cell>0.398</cell><cell>(0.004)</cell><cell>−1,009.781</cell><cell>0.409</cell><cell>(0.007)</cell></row></table><note>Notes. Posterior standard deviations of the RMSE statistic are given in parentheses. LMD, log marginal density; RMSE, root mean squared error.</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 3 .</head><label>3</label><figDesc>Effect of Price Promotions on Category RevenueNote. SD, Standard deviation.Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand</figDesc><table><row><cell>Model</cell><cell>Bias</cell><cell>SD</cell></row><row><cell>Unrestricted</cell><cell>0.051</cell><cell>0.055</cell></row><row><cell>Separable, fixed π n</cell><cell>0.058</cell><cell>0.026</cell></row><row><cell>Separable, estimated π n</cell><cell>0.051</cell><cell>0.026</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head></head><label></label><figDesc>Smith, Rossi, and  Allenby: Inference for Product Competition and Separable Demand Appendix B. Details for the Conditional Posterior of β π n</figDesc><table /></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot">MarketingScience, 2019, vol. 38, no. 4, pp. 690-710, © 2019 </note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="13">Other definitions of promotions, such as a percentage reduction from the base price, did not induce any material changes to the results.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgments</head><p>The authors thank the senior editor, associate editor, and two anonymous reviewers for their insightful comments. The authors' analyses were calculated (or derived) based in part on data from the Nielsen Company (US), LLC and marketing databases obtained through the Nielsen Datasets at the Kilts Center for Marketing at the University of Chicago Booth School of Business. The conclusions drawn from the Nielsen data are those of the researchers and do not reflect the views of Nielsen. Nielsen is not responsible for, had no role in, and was not involved in analyzing and preparing the results reported herein.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Note. "Same" indicates Simply Orange and store brand orange belong to the same group, whereas "different" indicates they belong to different groups. Smith and Allenby (2019) also apply their partitioning methodology to a multicategory demand setting. In their demand model, the partition identifies isolated product groups exhibiting zero cross-price effects.</p><p>Although we utilize their random partition model, our work differs in that we focus on estimating separable demand models in which product groups have lower-dimensional, but not necessarily zero, cross-price effects.</p><p>2 In the separability literature, m is also commonly referred to as income <ref type="bibr" target="#b19">(Goldman and Uzawa 1964)</ref>. This is likely because early empirical work concurrent to the development of separability focused on estimating complete demand systems with product sets spanning the entire space of commodities (e.g., food, housing, clothing) and a binding budget constraint on income. However, modern UPClevel scanner data have allowed researchers to measure substitution patterns at a finer level of granularity for a subset of the commodity space (e.g., breakfast cereals). In these settings, partial demand systems are usually estimated in which the budget constraint binds on a preallocated monetary budget that need not be equal to income.</p><p>3 The distinction between blockwise additivity and additivity is also made in <ref type="bibr" target="#b34">Pollak (1971)</ref> and <ref type="bibr">Deaton and Muellbauer (1980, chapter 5.3</ref>).</p><p>4 Homogeneity is satisfied if j β ij + γ i 0 ∀i; Slutsky symmetry is satisfied if β ij q i /p j + γ i β ji q j /p i + γ j ∀i, j; and negativity is satisfied if β ii ≤ γ i w i ∀i.</p><p>5 For example, if π n (1, 1, 1, 2, 2, 2), then n + k n 2 k + K(K − 1)/ 2 6 + 18 + 1 25, which exceeds the required 1</p><p>The model is not exactly a SUR model because the design matrix X(π n , γ; P, w) is not block diagonal. 7 A similar strategy is used to sample from the posterior of the standard Bayesian SUR model in the bayesm package <ref type="bibr" target="#b37">(Rossi 2017</ref>) in R.  <ref type="bibr">Marketing Science, 2019</ref><ref type="bibr">, vol. 38, no. 4, pp. 690-710, © 2019</ref> </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">All posterior sampling functions are written using the Rcpp package (Eddelbuettel and François</title>
		<imprint>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
	<note>in R</note>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">The data were provided by the Kilts Center for Marketing at the</title>
		<imprint/>
		<respStmt>
			<orgName>University of Chicago Booth School of Business</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title level="m" type="main">Jams, jellies, and spreads include butter-fruit and honey, fruit spreads, garlic spreads, honey, jams, jelly, marmalade, peanut butter, preserves</title>
		<imprint/>
	</monogr>
	<note>Juice drinks include apple, cider, clam, cranberry, fruit drinks. fruit drinks (can), grape, grapefruit, grapefruit (can), lemon/lime, nectars, orange, orange (can), pineapple, prune, tomato, vegetable (other. and remaining</note>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title level="m">category and the 20% level in jams, jellies, and spreads</title>
				<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Demand estimation with machine learning and model combination</title>
		<author>
			<persName><forename type="first">References</forename><surname>Bajari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Nekipelov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Ryan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">P</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename></persName>
		</author>
		<ptr target="https://www.simplyorangejuice.com/faq" />
	</analytic>
	<monogr>
		<title level="j">Amer. Econ. Rev</title>
		<imprint>
			<biblScope unit="volume">105</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="481" to="485" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Consumer demand functions under conditions of almost additive preferences</title>
		<author>
			<persName><forename type="first">A</forename><surname>Barten</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="issue">1-2</biblScope>
			<biblScope unit="page" from="1" to="38" />
			<date type="published" when="1964" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Exponential numbers</title>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">T</forename><surname>Bell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Amer. Math. Monthly</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page" from="411" to="419" />
			<date type="published" when="1934" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Automobile prices in market equilibrium</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">T</forename><surname>Berry</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Levinsohn</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Pakes</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="841" to="890" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">On testing separability restrictions with flexible functional forms</title>
		<author>
			<persName><forename type="first">C</forename><surname>Blackorby</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Primont</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">R</forename><surname>Russell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Econometrics</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="195" to="209" />
			<date type="published" when="1977" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Ferguson distributions via Pólya urn schemes</title>
		<author>
			<persName><forename type="first">D</forename><surname>Blackwell</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">B</forename><surname>Macqueen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Statist</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="353" to="355" />
			<date type="published" when="1973" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">A simple method for estimating demand systems under separable utility assumptions</title>
		<author>
			<persName><forename type="first">R</forename><surname>Byron</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Rev. Econom. Stud</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="261" to="274" />
			<date type="published" when="1970" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Structural workshop paper-Discrete-choice models of consumer demand in marketing</title>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">K</forename><surname>Chintagunta</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">S</forename><surname>Nair</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="977" to="996" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<author>
			<persName><forename type="first">A</forename><surname>Deaton</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Muellbauer</surname></persName>
		</author>
		<title level="m">Economics and Consumer Behavior</title>
				<meeting><address><addrLine>Cambridge, UK</addrLine></address></meeting>
		<imprint>
			<publisher>Cambridge University Press</publisher>
			<date type="published" when="1980" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Uniform pricing in US retail chains</title>
		<author>
			<persName><forename type="first">S</forename><surname>Dellavigna</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Gentzkow</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">National Bureau of Economic Research</title>
		<imprint>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
	<note type="report_type">NBER Working Paper 23996</note>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Testing hypotheses of functional structure: Some rules for determining flexibility of restricted production models</title>
		<author>
			<persName><forename type="first">P</forename><surname>Driscoll</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Mcguirk</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Alwang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Amer. J. Agricultural Econom</title>
		<imprint>
			<biblScope unit="volume">74</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="100" to="108" />
			<date type="published" when="1992" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Category pricing with state-dependent utility</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">P</forename><surname>Dubé</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">J</forename><surname>Hitsch</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">E</forename><surname>Rossi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A</forename><surname>Vitorino</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="417" to="429" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Rcpp: Seamless R and C++ integration</title>
		<author>
			<persName><forename type="first">D</forename><surname>Eddelbuettel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>François</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Statist. Software</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1" to="18" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">A Bayesian analysis of some nonparametric problems</title>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">S</forename><surname>Ferguson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Statist</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="209" to="230" />
			<date type="published" when="1973" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">An analysis and visualization methodology for identifying and testing market structure</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">L</forename><surname>France</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Ghose</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="182" to="197" />
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">A note on separability in demand analysis</title>
		<author>
			<persName><forename type="first">S</forename><surname>Goldman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Uzawa</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="387" to="398" />
			<date type="published" when="1964" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Separable utility and aggregation</title>
		<author>
			<persName><forename type="first">W</forename><surname>Gorman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="469" to="481" />
			<date type="published" when="1959" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Reversible jump Markov chain Monte Carlo computation and Bayesian model determination</title>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">J</forename><surname>Green</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">82</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="711" to="732" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<title level="m" type="main">Prices and Promotions in US Retail Markets: Evidence from Big Data</title>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">J</forename><surname>Hitsch</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Hortaçsu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Lin</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2017" />
			<pubPlace>Chicago</pubPlace>
		</imprint>
		<respStmt>
			<orgName>Booth School of Business, University of Chicago</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">Working Paper 17-18</note>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Model-based purchase predictions for large assortments</title>
		<author>
			<persName><forename type="first">Bjd</forename><surname>Jacobs</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Donkers</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Fok</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="389" to="404" />
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">The structure of consumer preferences</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">W</forename><surname>Jorgenson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">J</forename><surname>Lau</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Econom. Soc. Measurement</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="49" to="101" />
			<date type="published" when="1975" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">The structure of constant elasticity demand models</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">T</forename><surname>Lafrance</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Amer. J. Agricultural Econom</title>
		<imprint>
			<biblScope unit="volume">68</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="543" to="552" />
			<date type="published" when="1986" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Introduction to a theory of the internal structure of functional relationships</title>
		<author>
			<persName><forename type="first">W</forename><surname>Leontief</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="361" to="373" />
			<date type="published" when="1947" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">A statistical paradox</title>
		<author>
			<persName><forename type="first">D</forename><surname>Lindley</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="issue">1-2</biblScope>
			<biblScope unit="page" from="187" to="192" />
			<date type="published" when="1957" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Mixed MNL models for discrete response</title>
		<author>
			<persName><forename type="first">D</forename><surname>Mcfadden</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Train</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Appl. Econometrics</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="447" to="470" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Investigating consumers&apos; purchase incidence and brand choice decisions across multiple product categories: A theoretical and empirical analysis</title>
		<author>
			<persName><forename type="first">N</forename><surname>Mehta</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="196" to="217" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">A flexible yet globally regular multigood demand system</title>
		<author>
			<persName><forename type="first">N</forename><surname>Mehta</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="843" to="863" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Creating micro-marketing pricing strategies using supermarket scanner data</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">L</forename><surname>Montgomery</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="315" to="337" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Estimating price elasticities with theory-based priors</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">L</forename><surname>Montgomery</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">E</forename><surname>Rossi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Marketing Res</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="413" to="423" />
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">Bayesian Nonparametric Data Analysis</title>
		<author>
			<persName><forename type="first">P</forename><surname>Müller</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Quintana</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Jara</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Hanson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="s">Springer Series in Statistics</title>
		<imprint>
			<date type="published" when="2015" />
			<publisher>Springer</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Conditional demand functions and the implications of separable utility</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">A</forename><surname>Pollak</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Southern Econom. J</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="423" to="433" />
			<date type="published" when="1971" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">An empirical method of approximating the separable structure of consumer preferences</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">E</forename><surname>Pudney</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Rev. Econom. Stud</title>
		<imprint>
			<biblScope unit="volume">48</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="561" to="577" />
			<date type="published" when="1981" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">Visualizing asymmetric competition among more than 1,000 products using big search data</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">M</forename><surname>Ringel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Skiera</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Marketing Sci</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="511" to="534" />
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<monogr>
		<title level="m" type="main">bayesm: Bayesian inference for marketing/microeconometrics</title>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">E</forename><surname>Rossi</surname></persName>
		</author>
		<ptr target="https://cran.r-project.org/web/packages/bayesm/index.html" />
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
	<note>R package version 3.1-0.1.</note>
</biblStruct>

<biblStruct xml:id="b38">
	<monogr>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">E</forename><surname>Rossi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">M</forename><surname>Allenby</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Mcculloch</surname></persName>
		</author>
		<title level="m">Bayesian Statistics and Marketing</title>
				<meeting><address><addrLine>West Sussex, UK</addrLine></address></meeting>
		<imprint>
			<publisher>John Wiley and Sons Ltd</publisher>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title level="a" type="main">Market definition with differentiated products: The Post/Nabisco cereal merger</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">L</forename><surname>Rubinfield</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Antitrust Law J</title>
		<imprint>
			<biblScope unit="volume">68</biblScope>
			<biblScope unit="page" from="163" to="185" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title level="a" type="main">Demand models with random partitions</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">N</forename><surname>Smith</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">M</forename><surname>Allenby</surname></persName>
		</author>
		<idno type="DOI">10.1080/01621459.2019.1604360.</idno>
		<ptr target="https://doi.org/10.1080/01621459.2019.1604360" />
	</analytic>
	<monogr>
		<title level="j">J. American Statist. Assoc</title>
		<imprint>
			<date type="published" when="2019-06-04" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<analytic>
		<title level="a" type="main">The effect of price changes on the demand and supply of separable goods</title>
		<author>
			<persName><forename type="first">M</forename><surname>Sono</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Internat. Econom. Rev</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="239" to="271" />
			<date type="published" when="1961" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<analytic>
		<title level="a" type="main">Multi-category competition and market power: A model of supermarket pricing</title>
		<author>
			<persName><forename type="first">Ø</forename><surname>Thomassen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Smith</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Seiler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Schiraldi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Amer. Econom. Rev</title>
		<imprint>
			<biblScope unit="volume">107</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="2308" to="2351" />
			<date type="published" when="2017" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b43">
	<monogr>
		<author>
			<persName><forename type="first">Rossi</forename><surname>Smith</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Allenby</forename></persName>
		</author>
		<title level="m">Inference for Product Competition and Separable Demand</title>
				<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
