Vol. 27, No. 1, January­February 2008, pp. 29­48 issn 0732-2399 eissn 1526-548X 08 2701 0029

informs ®
doi 10.1287/mksc.1070.0331 © 2008 INFORMS

A Logit Model of Brand Choice Calibrated on Scanner Data
Peter M. Guadagni
Bonanza Street Books, Walnut Creek, California 94596, guadagni@alum.mit.edu
John D. C. Little
Sloan School of Management, Massachusetts Institute of Technology, Cambridge, Massachusetts 02142, jlittle@mit.edu
Amultinomial logit model of brand choice, calibrated on 32 weeks of purchases of regular ground coffee by 100 households, shows high statistical significance for the explanatory variables of brand loyalty, size loyalty, presence/absence of store promotion, regular shelf price and promotional price cut. The model is parsimonious in that the coefficients of these variables are modeled to be the same for all coffee brand-sizes. The calibrated model predicts remarkably well the share of purchases by brand-size in a hold-out sample of 100 households over the 32-week calibration period and a subsequent 20-week forecast period. The success of the model is attributed in part to the level of detail and completeness of the household panel data employed, which has been collected through optical scanning of the Universal Product Code in supermarkets.
Three short-term market response measures are calculated from the model: regular (depromoted) price elasticity of share, percent increase in share for a promotion with a median price cut, and promotional price cut elasticity of share. Response varies across brand-sizes in a systematic way with large share brand-sizes showing less response in percentage terms but greater in absolute terms. On the basis of the model a quantitative picture emerges of groups of loyal customers who are relatively insensitive to marketing actions and a pool of switchers who are quite sensitive.
This article was originally published in Marketing Science, Volume 2, Issue 3, pages 203­238, in 1983.
Key words: choice; logit; marketing-mix; scanners History: This paper was received May 1982 and was with the authors for 2 revisions.

1. Introduction
Manufacturers and retailers wish to understand how price, promotion and other marketing variables affect the sales and shares of the products they sell. Such information is the raw material for marketing mix decisions. Although first priority goes to determining how a product's variables affect its own sales, marketing managers increasingly would like to learn more about product interactions within a category. For example, a manufacturer would like to know whether promoting one product takes away sales and share from others in the same line. Similarly, retailers are acutely aware that a price cut on an item may increase its sales at the expense of a related item somewhere else in the store.
To understand such issues we need to model whole product categories. This task can be partitioned into determining, first, the effects of marketing variables on share and, then, effects on total category sales. In this paper, we address only the question of share, or, to be more precise, we examine the effect of marketing variables on customer choice among product alternatives. From choices we deduce share.
Many models of choice have been proposed. In fact, theoretical developments seem to be ahead of empir-

ical testing, at least insofar as live marketing practice is concerned. Fortunately, the automatic recording of purchases at the point of sale opens up new opportunities for model appraisal. Data now being collected by optical scanning of the Universal Product Code (UPC) in supermarkets should permit a careful examination of various customer choice models in the case of grocery products. We shall here use scanner-collected data on coffee purchases to calibrate a multinomial logit choice model and examine both its scientific quality as a representation of customer behavior and its potential usefulness for marketing decisionmaking.
Scanner data usually come in two forms: Store data and panel data. Store data provide individual item (UPC) sales and price by store by week. In addition, the companies supplying data may collect information on other store activities such as special display, coupon redemption, retail advertising, and shelfspace allocation. Panel data present histories of purchases for a sample of households. A cooperating household displays an identification card at checkout. The store clerk keys the household number into the cash register, thereby causing the purchase record to

29

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

30

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

be segregated and stored. Over time this creates a longitudinal customer history.
Scanner data have special advantages. They directly record the sales act of the individual customer at the item level, thereby avoiding the pipeline effects found in factory shipments and warehouse withdrawals. Initial cost is low since the data are a spinoff from the store's basic transaction process. However, subsequent processing and storage can be expensive. Scanner data are potentially deliverable to users with great speed, although how fast they will actually be delivered will depend on their time-value in decisionmaking. The data tend to be very accurate because they are part of the store's cash collection and accounting process. At present some purchases enter the cash register around the scanner, but, since store procedures determine the percentage of goods scanned, as more stores use the data for inventory control and other informational purposes, accuracy will further increase. Compared to diary panels, scanner measurement is relatively unobtrusive, bias-free and complete across products. It therefore represents a significant step forward in gathering information about products sold through supermarkets.
The greatest advantage of scanner data, however, is that they provide the competitive environment of the customer decision. Conventional diary data tell what the customer bought and its price but do not identify the other products, prices, and marketing activities impinging on the customer at the time of purchase. Similarly, standard warehouse withdrawal or store audit data for a geographic region do not describe the competitive situation within individual stores in the way scanner store data do. It is this rich, disaggregated detail that offers hope for new levels of customer and market understanding. Just as new measurements have driven advances in theory throughout the history of science, we can hope for progress here.
Current scanner data services fall in three broad categories: (1) groups of stores in single markets, (2) national samples of stores, and (3) instrumented markets. A group of stores in a single market offers opportunities for convenient in-store experiments using scanner-collected store data. When panels of storeloyal shoppers are added, the experimentation possibilities increase. Coupons, for example, can be validly tested for the first time, and models of individual customer behavior with respect to price and promotion become possible.
National store samples permit manufacturers to make generalizations that might be distrusted if made from a single market. Good random samples are still difficult to obtain because of the irregular geographic distribution of scanners but this will change. Empirical studies of store data can determine sales response

to promotion and price at the store level and, by looking across stores, information can be gathered on retailer's response to manufacturers' promotional offerings.
The most dramatic new service stimulated by scanners, however, is the instrumented market. This is a small to medium sized city with scanners in all major grocery stores. In addition, the city is pre-selected for high cable television coverage and split cable hardware is introduced so that household panels can be set up to receive different television advertisements. In-store observations can also be conducted, and so a remarkably complete picture of the shopper's marketing environment is possible: sales, prices, promotions, advertising (both newspaper and television), coupons, display and shelf-facings. The setting is ideal for a variety of testing: new products, advertising, store promotions, etc.
Much measurement and model building lies ahead using these various services. The present paper is one step. It will focus on a choice model applicable to household data collected in panels associated with individual stores or instrumented markets, supplemented by store data on the shopping environment. To indicate the task at hand, Figure 1 displays an example of scanner collected data. The market share of a major brand of coffee in a panel of 100 households shows great variation over a year's time both in overall trend and in specific peaks. We wish to understand and predict such behavior.
2. The Multinomial Logit Choice Model
The multinomial logit model computes the probability of choosing an alternative as a function of the attributes of all the alternatives available. The model has the appeal of being stochastic and yet admitting decision variables. Various authors have employed it in marketing. Hlavac and Little (1966) use a somewhat similar model to represent the probability that an automobile buyer purchases a car at a particular dealership. Silk and Urban (1978) imbed the logit in their pre-test-market evaluation process for new products. Punj and Staelin (1978) employ the model to describe students' choice of business schools. Gensch and Recker (1979) provide a general exposition and compare the fitting ability of the logit to that of regression for shoppers' choosing grocery stores. The logit has an even more extensive history of application in the field of transportation planning, particularly for predicting an individual's choice of mode of travel, e.g., car or bus (Domencich and McFadden 1975).
2.1. Axiomatic View As a choice model, the multinomial logit permits an axiomatic derivation which we briefly outline. Consider an individual, i, confronted with a choice from

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

31

Figure 1

The Share of Purchases of a Major Coffee Brand-Size as Recorded in a Panel of 100 Kansas City Households Shows Great Variability (Dates Shown Are the Starting Days of Four-Week Periods)
60

50

Purchase share

40

30

20

10

0 MAR 08.79

MAY 03.79

JUN 28.79 AUG 23.79 OCT 18.79 4 week periods

DEC 13.79

FEB 07.80

a set, Si, of alternatives. In our setting the alternatives will be different products in a category. We suppose
that:
(1) Alternative k  Si holds for the individual a preference or utility,

uk = vk + k

(1)

where
vk = a deterministic component of i's utility, to be calculated from observed variables, and
k = a random component of i's utility, varying from choice occasion to choice occasion, possibly as a result of unobserved variables.
(2) Confronted by the set of alternatives, individual i chooses the one with the highest utility on the occasion. I.e., the probability of choosing k is

pk = P uk  uj j  Si

(2)

(3) The k, k  Si, are independently distributed random variables with a double exponential (Gumbel
type II extreme value) distribution

P k  = e-e-

- <<

(3)

This form of the distribution appears to fix the mean and variance of quite arbitrarily, since (3) has a mean 0.575 and a variance 1.622, both dimension-less. A more general form would include a further location parameter and a scale parameter. However, any location parameter, even one dependent on k, can be absorbed into vk without loss of generality and, since the scaling of utility is arbitrary, we can set it so that the variance of the k is the 1.622 value implied by (3).

Notice, however, that this procedure produces larger utility values in a model that explains more variance than in one that explains less. We shall observe this phenomenon in our empirical work.
Given assumptions (1)­(3), it can be shown (Theil 1969, McFadden 1974) that individual i's choice probabilities have the remarkably simple form

pk = evk

evj

(4)

j Si

This expression is known as the multinomial logit. We note two properties that will be used later. First,
since (4) can be written

pk = 1

e vj -vk
j

it follows that utility is undetermined to the extent
of an additive constant. Thus, for example, if a price
variable has an inflationary trend that adds a constant
to all alternatives, pk will not be affected. Second, pk is S-shaped in vk when other vj are held
constant. Therefore, as shown in Figure 2, very large
or very small values of vk make pk flat and insensitive to changes in vk.
We also note that, as the variance of the random
component of utility goes to zero, the scaling of (3)
pushes individual vj (and any differences between pairs of vj ) toward infinity. As a result, the largest vk produces a pk that goes to 1, while others go to 0, as we would wish.
In our case the individual choice-makers are house-
holds. We do not know whether their behavior satis-
fies the assumptions used to derive (4). However, the

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

32

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

Figure 2

Choice Probability Is S-Shaped in Utility vk Choice probability (pk)

1.0

0

Utility (vk)

concept of utility (or preference or attractiveness) as a latent variable and a choice probability that is some normalized function of that variable has much appeal and a long history (Luce 1959, Yellott 1977, McFadden 1981).
A chief complaint about (4) is that, if we add to the alternatives a new one essentially identical to some existing alternative, say the kth, the new alternative might reasonably be expected to split k's probability and leave the others untouched, but, by (4), will instead reduce the probabilities of all alternatives. The issue is whether choices satisfy the assumption of "independence from irrelevant alternatives." (See Appendix 1 for further discussion.)
Various schemes have been proposed for overcoming the potential difficulty (McFadden 1981). Many of them involve arranging the alternatives into a hierarchy or tree structure that groups similar alternatives. Thus a tree representation of coffees might have all instant brands in one branch and all regular brands in another. We shall stay with the simple multinomial (4) adopting the pragmatic view that tests of the calibrated model will determine its quality. In setting up the application, however, we endeavor to avoid its known pitfalls.

2.2. Linear Utility

The deterministic component of a customer's utility

for alternative k will be expressed as a linear function

of observed variables, called the attributes of k. Some

of these will be attributes of the product (e.g., price)

and others may be attributes of the customer or the

environment (e.g., income or store) that differentially

favor one alternative over another for some reason. In

general

vki = bjkxjik

(5)

j T

where

xjik = observed value of attribute j of alternative k for customer i,
bjk = utility weight of attribute j of alternative k. We shall drop the superscript i when it is not
required for clarity.

From a modeling point of view it is convenient to break the attributes into two classes.
(1) Tk = {attributes unique to alternative k}. A product may have features that other products do not have but which contribute to its utility. For such attributes j  Tk, the coefficients may be denoted bjk and variables by xjik.
(2) TC = {attributes common to all alternatives}. Although an attribute such as price might be assigned uniquely to each product, a model more parsimonious in the number of parameters would use price as a single attribute across all products. Then price would have the same coefficient for all alternatives. For such attributes j  TC, the coefficients may be denoted bj and variables xjik.
In specialized form (5) becomes

vki = bjkxjik + bj xjik

(6)

j Tk

j TC

Although a linear form for utility is a natural place to start model building, we note that linearity for vk still leaves the choice probability quite nonlinear in the observational variables, xjk. The numerator of pk can be written
evk = ebjkxjk
j T
so that the model is, in an important sense, more multiplicative than additive.

2.3. Calibration

Equations (4) and (6) present the model. In prac-

tice we cannot observe either utilities or probabilities

directly. Rather, we observe choices and attribute val-

ues. The data consist of a set of choice records for

each individual:



1 if customer i chooses alternative k

yki n = 0

on the nth choice occasion otherwise

along with the values of the attributes of the alternatives on each choice occasion:
xjik n = value of attribute j for product k on nth purchase occasion for customer i

In our case a choice or observation is the purchase of a product by a customer on the occasion of buying within the product class. The bjk and bj are unknown constants to be determined by calibration. For calibration purposes, each attribute is thought of as having a complete set of data across alternatives for each observation, even though an attribute unique to a specific alternative does not appear in the utility expressions for other alternatives. To handle this situation, such an attribute is assigned a zero value for alternatives to which it is not relevant.

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

33

Calibration is done by maximum likelihood, using (4) and (6) to calculate the likelihood function. The actual program used is that of Manski and Ben-Akiva (Ben-Akiva 1973). Maximum likelihood parameter estimates are consistent and asymptotically efficient and normally distributed under very general conditions.

2.4. Quality of Fit Measures of quality of fit and parameter estimation guide model specification and help appraise the success of the calibration.
(1) t-values for coefficients. The Manski­Ben-Akiva program generates (asymptotic) t-statistics for each coefficient in the calibrated model.
(2) U 2 for model. Probabilistic models pose special difficulties in overall evaluation. Whereas regression models offer residuals and R2 as ready indicators of fit, a logit model predicts only probabilities which must then be compared to actual choices. Hauser (1978) discusses this and presents a set of statistics useful for evaluating such models. Working from the information measure of communication theory, he defines a measure U 2, in terms of calibrated model and prior probabilities of choice. U 2 may be described as the fraction of uncertainty (entropy) empirically explained by the calibrated model relative to the prior distribution of choice probabilities. The prior distribution constitutes a null model that defines maximum entropy for the situation at hand. A model under test that produces the same entropy as the null model explains nothing new and has U 2 = 0. A model that explains everything gives perfect prediction and has U 2 = 1.
Hauser derives a useful result for the case where the prior probability of choice is independent of the choice occasion. (This will be true for the null model we shall use, namely, choice probabilities equal to market shares.) He shows that under these circumstances U 2 equals McFadden's (1974) likelihood ratio index, 2. Therefore, using McFadden's definition of
2, we have

U 2 = 2 = 1 - L X /L0

(7)

where L X is the log likelihood of the calibrated
model with explanatory variables, X, and L0 is the log likelihood of the null model. Notice that, if L X of the
calibrated model does not improve on L0, then L X = L0 and U 2 = 0. However, if the model is perfect, i.e., the predicted probabilities are all zeros and ones
and correct, then the likelihood equals 1, L X = 0 and U 2 = 1. For the case that interests us, therefore,
Hauser's and McFadden's quite differently motivated
measures are equal and, since the Manski­Ben-Akiva
program provides log likelihoods in the output, we can easily calculate U 2 from (7).

U 2 is somewhat analogous to R2 in that they both have a range of 0 to 1 and indicate degree of variability explained. U 2 tends, however, to have a lower value for an excellent fit.
(3) Chi-squared tests of model significance. If one model, say A, can be formulated as a restriction (subset) of the parameters of the tested model, say B, then L = 2 log [likelihood ratio of model B to model A] is 2 distributed with degrees of freedom equal to the difference in degrees of freedom between model B and model A. See Hauser (1978). This test helps determine whether adding a parameter or set of parameters is worthwhile.
(4) Aggregate share. For a given population the average probability of choosing an alternative is the expected share of choices for that alternative. We can compare actual with expected share. Such comparisons plotted over time offer valuable visual representations of quality of fit.
3. Application to Packaged Goods
Market share is an aggregation of individual customer choices. If we can understand how and why households choose one product over another, we shall gain insight into the reasons for a product's success or failure. Scanner panel data and the logit model offer an opportunity for increasing our knowledge about packaged goods.
In applying the model, the alternatives will be products, but their exact level of aggregation and which ones to include in the relevant set are not necessarily obvious. Should different flavors, or colors, or sizes be treated as different products or lumped together? When product choice is hierarchical, we can induce similarity by defining alternatives at the same level in the hierarchy. For example, within the category of vegetables, the choice might be among fresh, frozen and canned. However, in studying brands, we might focus on competition within, say, canned peas. In the case of coffee, a natural grouping exists segregating instant and ground forms and another distinguishing caffeinated and decaffeinated products.
Another crucial issue is the degree of homogeneity in the customer population. We would like to consider customers identical in the sense that one set of utility weights applies to all. This will not imply that all customers behave in the same manner because some of the attribute values will vary from customer to customer.
For example, households are well known to be heterogeneous with respect to purchase probabilities because of differing brand preferences or loyalties. To model this we can introduce a customer loyalty attribute defined as a weighted sequence of past purchases of a brand. To hold down the number of constants, we can make loyalty a common attribute across brands, i.e., use the same bj coefficient for all.

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

34

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

Customers also frequently show a preference or loyalty to a particular package (cans versus bottles in soft drinks) or size (one pound versus two pounds or three pounds in coffee). Such preferences can be introduced as customer attributes in the same way as brand loyalty. By bringing in past customer purchase behavior as an explanatory variable through loyalty attributes, we conveniently model purchase probability heterogeneity while treating customers homogeneously.
4. Regular Ground Coffee
Coffee is a frequently purchased product actively marketed by manufacturers and retailer alike and so makes an excellent subject for building and testing a choice model. Price changes are relatively common because of fluctuations in commodity markets. Coffee is also a traditional supermarket loss leader with frequent promotions during which the store takes one or more coordinated marketing actions such as reducing price, putting up a special display or running an advertisement in the local media.
4.1. Data Our database consists of ground coffee store and panel records from four Kansas City supermarkets for the 78-week period September 14, 1978 to March 12, 1980. The data have been collected by Selling AreasMarketing, Inc. (SAMI) and kindly made available for this research.
The store sales data contain weekly item movement for each UPC in the category as well as the shelf price for each item each week. The customer panel has about 2,000 households, each of which has indicated it makes 90% or more of its purchases at one of the stores collecting the data. A single purchase record contains the household number, the date of purchase, the UPC, and the price paid. The panel has been cleaned to eliminate households with reporting gaps that indicate lack of store loyalty and also to omit households joining the panel in the middle of the period. The resulting static sample has been further reduced to exclude light and nonusers of ground coffee, these being defined as households that made less than five purchases during the year and a half of data. Quite a few families remain, however, and, of them, 200 have been chosen at random. A group of 100 forms the calibration sample and the second 100 a hold-out sample, reserved for testing the final model. The calibration group made 1037 purchases in the chosen brand-sizes during the 32-week period, March 8, 1979 to October 17, 1979 used for calibration. Sixteen of the purchases had missing store data leaving 1021 usable purchases. The holdout group made 921 purchases in the corresponding 32-week period plus another 666 in a 20-week post period October 18,

1979 to March 5, 1980 used for projection. Five of these had incomplete data leaving 1582 purchases for evaluative purposes.
In addition to the information generated by the store computers, we have local newspaper advertisements that assist in identifying promotional activity.
4.2. Alternatives Our selection of product alternatives draws on the research of Urban et al. (1984) about the structure of the coffee market. They divide the coffee market into six product groups defined by ground/instant, caffeinated/decaffeinated and, within instant, freeze dried/nonfreeze dried. To obtain a relatively homogeneous set of alternatives we restrict consideration to regular (caffeinated) ground coffee.
Another issue is brand versus size. In the Kansas City market, the popular sizes are one pound and three pound which we shall call "small" and "large." (Included in "small" are certain 13 and 14 ounce sizes advertised as producing the same number of cups as a pound.) Preliminary examination of switching behavior yielded no evidence to suggest that customer choice was hierarchical on either brand or size. However, different sizes of the same brand are clearly different products from both retailer's and customer's point of view. Customers show distinct size loyalty and retailers promote sizes separately. Therefore we model brand-sizes.
Ground coffees come as regular, drip, and automatic. However, given the brand-size, all grinds are priced the same and promoted together. A household's choice depends primarily on its coffee making equipment. We therefore combine UPC's across grinds to construct the brand-size alternatives.
Two low share brand-sizes (less than 1% of the purchases of the calibration sample) were dropped for lack of observations, leaving as the set of alternatives the eight largest selling brand-sizes.

Sizes

Brands

Small

A

B

C

D

E

Large

A

B

C

4.3. Attribute Variables The latent customer utility will be expressed as a linear function of attribute variables consisting of one unique attribute for each alternative and a set of attributes common across all alternatives. Each attribute variable will have a value for each alternative for each purchase, for example, the nth purchase of customer i.
(1) Unique to alternative. The utility function for a brand-size will include an additive constant specific

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

35

to that alternative. This is accomplished by a set of dummy variables:

x0i k n =

1 0

for alternative k otherwise

Each alternative, k, has its own variable except that one of them, say the N th, must be omitted to avoid a singularity in the maximum likelihood estimation, since, as previously remarked, the utilities are undetermined to the extent of an additive constant. The value of b0N can be taken as zero. The resulting brand-size specific constants, b0k, serve to capture any uniqueness an alternative has that is not captured by other explanatory variables insofar as describing average choice behavior over all observations is concerned. One consequence of introducing the b0k is that the average predicted probability of an alternative will equal its share of purchases over the observations. No other alternative-specific variables will be used.
(2) Common across alternatives. The major control variables we shall consider for the retailer are regular (depromoted) price, the presence or absence of a promotion for the brand-size and, if there is a promotion, the amount of price-cut (possibly zero) during the promotion. The first of these attribute variables is the regular price in the absence of promotion:

x1ik n = regular (depromoted) price of brand-size k at time of customer i's nth coffee purchase (dol/oz).

If brand-size k is on promotion at the purchase occasion, its regular or depromoted price is its price prior to the start of the promotion. The second variable is promotion:

 1 x2i k n = 0

if brand-size k was on promotion at time of customer i's nth coffee purchase
otherwise

Unfortunately, no data on feature or display activity are available for the stores in our sample. We do, however, have information on three events that would be expected to accompany a promotion: (1) short-term (one to three weeks) price reduction, (2) mention of the item in the store's weekly newspaper advertisement, and (3) an unsually high short-term movement for the product, chosen as store sales greater than two standard deviations above the average for the product without promotion. Since any one of these events alone may be a faulty indicator, we infer a promotion only if two out of three of these events take place in the given week. Although the unusual movement indicator seems potentially circular as a purchase explainer, we note that (1) unusual movement is

determined from store data not the panel data being explained, (2) the movements are very large, typically 3 to 10 times normal sales, and are clearly the result of store phenomena, not chance, and (3) unusual movement alone never defines a promotion because of the 2 out of 3 rule. Note also that any difficulty in identifying promotions here is a data problem not a model problem. That is, field observation can determine whether a product is featured and the amount of its display even though this information is not in our present set. Thus, even though the lack of in-store observation may conceivably have introduced some bias in the present situation, the model formulation seems adequate.
The 0­1 promotion variable will miss some of the variation among promotions, such as the difference in response between an end-aisle display and a small shelf-talker. However, we can explain some of the variation by adding a depth of discount or promotional price cut variable to the model:

x3ik n = promotional price cut on brand-size k at time of customer i's nth coffee purchase (dol/oz).

The variable is zero when there is no promotion of k. Thus the actual price of brand-size k is always x1k + x3k.
An important marketing question is whether a promotional purchase is, in some sense, as good as an ordinary purchase. For example, will a household that switches to a brand when it is on promotion be as likely to repurchase the brand at a later time as would be the case for a nonpromotional purchase? Shoemaker and Shoaf (1977), Dodson et al. (1978), and Jones and Zufryden (1981) have found that a promotional purchase decreases the likelihood of a subsequent purchase of that brand. We can look for this effect by introducing lagged promotion variables.

 1 x4i k n = 0

if customer i's previous purchase of coffee was a promotional purchase of an alternative with the same brand as brand-size k
otherwise

 1 x5i k n = 0

if customer i's second previous purchase of coffee was a promotional purchase of an alternative with the same brand as brand-size k
otherwise

A further set of variables depends on characteristics of the customer. As observed earlier, much of the heterogeneity in purchase probability over a population, be it called preference, habit or loyalty, can be captured by observing past behavior. We choose the

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

36

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

word loyalty to describe the customer's tendency to repurchase the same brand size. Let x6ik n = brand loyalty for brand of brand-size k for
nth coffee purchase of customer i.
We define

x6i k n =

bx6i k n - 1

 

1

+ 1 - b  0

if customer i bought brand of alternative k

at

 

purchase occasion otherwise

n-1



Operationally, therefore, loyalty is taken to be the
exponentially weighted average of past purchases of
the brand, treated as 0­1 variables. The carryover constant is b. To start up brand loyalty, we set x6ik 1 to be b if the brand of alternative k was the first purchase in the data history of customer i, otherwise
1 - b /(number of brands - 1), thus insuring that the sum of loyalties across brands always equals 1 for
a customer.
Size loyalty is analogous:

x7i k n = size loyalty for the size of brand-size k for nth coffee purchase of customer i

= sx7i n n - 1

 

1

+ 1 - s  0

if of

customer i alternative

bought size k at coffee

 

purchase n - 1 otherwise



where s is the carry-over constant for size. Initialization is analogous. The sum of loyalties over sizes is also 1.
For all variables except the alternative-specific dummies, the coefficients, bj , are the same for all brand-sizes. Thus in calculating customer i's utility the same coefficients will be used for every brandsize with respect to attributes such as price, promotion, loyalty, etc. This gives the model remarkably few parameters, considering the number of products addressed. Using the same coefficients across brandsize does not imply the same response to control variables. Response will depend on the whole marketing environment and on the customers' loyalty variables.

4.4. Calibration The calibration database contains 100 households with 1021 coffee purchases over 32 weeks spread across eight brand-sizes. In addition, 718 purchases over the previous 25 weeks have been used to initialize the loyalty variables. Each purchase will be treated as an observation so that we are combining cross-section and time-series data. This makes the loyalty variables particularly important since they

Figure 3

The Smoothing Parameters in the Loyalty Functions Are Fit to Coefficients Generated by Lagged Purchase Variables

(a) Brand

(b) Size

1.0

1.0

b = 0.875

s = 0.812

0.8

0.8

Coefficient

0.6

0.6

0.4

0.4

0.2

0.2

0 1 2 3 4 5 6 7 8 9 10 Prior purchase

0 1 2 3 4 5 7 8 9 10 Prior purchase

Note. Bars indicate ± one standard error.

carry not only much of the cross-sectional heterogeneity but also a good part of the purchase-to-purchase dynamics.
An immediate question, however, is how to pick the smoothing constants b and s for constructing the loyalty variables. The answer is: to pick trial values then refine them. Approximate s ( b = s = 0 75) are used and the model is developed with all other major explanatory attributes. Following this, the brand loyalty variable is replaced by ten dummy variables, each denoting whether or not the brand was purchased on the nth prior occasion (n = 1 10). The relative coefficient sizes indicate the impact of the nth prior purchase. The results, normalized to make the first coefficient unity, appear in Figure 3(a). The solid line shows the exponential decay selected. The value of
b has been chosen to make the differences between the line and the coefficients average to zero. The same process is repeated with lagged size dummies, as shown in Figure 3(b). The exponential function is quite satisfactory since the number of points more than a standard deviation from the line is close to what would be expected (5 actual versus 6 expected). The corresponding b and s define the loyalty variables. By varying the s over a grid of values and recalculating the maximum likelihood estimates of the other parameters until the likelihood function is also maximized by the s we could have all parameters as maximum likelihood estimates. We elected not to go to these rather substantial further efforts.
As may be seen the decay rates for brand and size loyalty are comparable. The brand coefficients decay slightly more slowly (higher ) suggesting somewhat more loyalty to brand than size, a conclusion to be supported again later.

5. Calibration Results
The calibrated logit model fits the coffee data well and provides information on a number of marketing issues. Table l shows the coefficients.

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

37

Table 1 Calibration of Coffee Model for 6 Specifications with Increasing Number of Variables Plus a Simulated Aggregate Model

Specification U2

S1

S2

S3

S4

S5

S6

S7

0

0.24

0.46

0.47

0.47

0.48

0.22

Brand loyalty Size loyalty Promotion Promotional price cut Regular (depromoted) price Price promotional purchase Second prior promotional purchase
Brand Size Constants Small A Large A Small B Large B Small C Large C Small D Small E
Log likelihood (N = 1 021)

0 28 22
0
0 48 39
-0 06 -0 4
0 99 88
0 38 31
-1 25 -6 1
-1 83 -6 8
-1,896

2 78 22 1 2 12 14 6
-0 12 -0 9
0 0 28 20 0 24 16 0 14 10 0 01 01 -1 23 -5 3 -1 52 -5 2 -1,440

3 47 21 9 2 74 16 1 2 22 15 5 18 12 55
-0 06 -0 4
0 0 11 07 0 05 03 0 31 20 0 03 02 -0 66 -2 6 -0 76 -2 3 -1,025

3 47 21 5 2 72 15 9 2 00 13 6 29 66 72 -26 36 -6 0
0 03 02 0 0 19 12 -0 06 -0 4 0 57 36 0 22 13 0 15 05 -1 5 -4 1 -1,007

3 79 21 3 2 74 15 9 2 07 13 9 29 20 71 -26 49 -5 9 -0 60 -3 5 -0 72 -3 9
0 01 01 0 0 20 12 -0 05 -0 3 0 62 38 0 27 16 0 10 03 -1 47 -4 1 -1,002

3 92 21 6 2 97 15 9 2 11 14 1 29 21 71 -29 94 -6 6 -0 22 -1 3 -0 46 -2 47
-0 09 -0 6
0 0 10 06 -0 08 -0 5 0 41 25 0 12 07 -0 05 -0 2 -1 72 -4 7 -977

1 40 11 5 26 98 80 -28 02 -7 8 0 62 45 0 49 33
0 48 35 0 0 41 31 -0 35 -2 3 1 49 11 6 0 59 42 0 10 04 -1 88 -6 3 -1,488

Note. Table entry shows attribute coefficients with t-statistic beneath in parentheses.

5.1. Quality of Fit To indicate the relative contribution of various attributes and to investigate the stability of the coefficients against changes in model specifications, the final model has been built up a few variables at a time. We can follow the changes in U 2, the amount of uncertainty explained by the model.
The specification S1 contains only the brand-size dummy variables. The effect of this is to make each household's purchase probability for a brand-size the same and equal to that brand-size's share of total purchase. Since this is our chosen null model, U 2 = 0. In S2 the addition of the brand and size loyalty variables produces a large jump to U 2 = 0 24, demonstrating, as expected, that the loyalty variables explain much purchase behavior across households. Notice the high t-statistics. Specification S3 introduces the promotion variables and another big jump to U 2 = 0 46. Bringing in regular price in S3 increases U 2 only a little to 0.47. Clearly regular price is not moving share around the way promotion does. However, a chi-squared test of

S4 relative to S3 shows statistical significance at the 0.01 level. When the prior promotional purchase variables are added in S5, U 2 increases slightly but after rounding is still 0.47.
The last step is to revise b and s as described earlier and rerun with the new loyalty variables. The result is S6, which we take as the final specification. It has U 2 = 0 48 indicating improved loyalty functions as a result of the iteration. Although the prior promotional purchase variable is not significant in a statistical sense, we retain it because the second prior is. (We have checked the third prior and it is not.)
Notice the growth of the brand loyalty coefficient as more uncertainty is explained. This happens because the utility scaling increases to hold the residual variance of k constant in (1), as discussed in §2.1. If enough variance were explained, the coefficients would become very large and the predicted probabilities would approach 0 and 1.
The brand-size constants would be zero if we had found variables that explained all the differences

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

38

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

among brands and sizes. Obviously this would be difficult to achieve and we have not, but notice that, in going from S1 to S6, most of the brand-size constants and their t-values decline.
Except for the brand-size constants, the coefficients, once introduced, tend to be rather stable throughout the various specifications, a healthy sign indicating that collinearity does not seem to be a serious issue. The only exception is the increase in the promotional price cut coefficient when regular price is introduced. The increase seems reasonable, however, since the regular price is the reference point from which the price cut is measured and its absence might reasonably hinder the explanatory ability of the cut.
An important practical question is whether a household-level model really offers any substantial advantages over a more aggregate model. Specification S7 investigates this issue by dropping the principal customer-specific variables of S6, namely, the brand and size loyalties. All other explanatory variables are the same. We see a dramatic drop in U 2 to 0.22. This clearly demonstrates the power of the customer-level loyalty variables for explaining purchase behavior across households. The coefficients for price, promotion, and price-cut stay about as before. This is probably comforting, although, if they were different, the disaggregate variables explain more uncertainty and would be preferred. The prior promotion coefficients change to a positive sign and become statistically significant. This is not too surprising because these variables are now the closest thing in the model to the loyalty variables. We also note that the brand-size constants increase. This is presumably because they carry the burden of fixing average share, some of which role was previously picked up by loyalty. In summary, the quality of the model deteriorates and the coefficients become more difficult to interpret, thereby providing solid support for a disaggregate model.
Pictures illustrating quality of fit are always helpful. A direct comparison of the probability of purchase calculated by the model and the actual purchase outcomes is of little value since the latter are either 0 or 1. However, the expected number of purchases of a brand size in a time period is easily calculated from the model since the category purchases are given. The expected number divided by total purchases gives the expected share of purchases which can then be compared to actual share. Figure 4 does this, showing predicted versus actual purchase shares for the eight brand-sizes over the calibration period. The curves are gratifyingly close.
As discussed earlier, the multinomial logit model implicitly assumes "independence from irrelevant alternatives" (IIA). McFadden et al. (1977) have devised a residuals test to evaluate whether the IIA

assumption holds in a given case. The underlying idea is that violation of the assumption will cause systematic errors in predicted choice probabilities. The observations are divided into cells in a systematic way and a goodness of fit test applied to each brand-size. In Appendix 1 we present the results of applying the procedures to our model. None of the eight individual tests shows a systematic error at the 0.05 level of significance. We conclude that violations of the IIA assumption are not a serious problem. We feel, however, that a more important test of the model will be its performance on a holdout sample of customers.

5.2. Discussion of Coefficients All the coefficients have the algebraic signs that would be expected.
The relative importance of attributes in explaining market behavior is of interest. The coefficient magnitudes per se are not too instructive because their units vary. Two better indicators are the contribution to U 2 and the t-statistic. Given a fixed sample size, the relative magnitudes of the t-statistics offer an indication of explanatory importance. In part this is because the numerator of t is the coefficient itself and so increases with its size. In addition, the denominator is the coefficient's standard error, which will tend to decrease if the data for the attribute have large variance, other things being equal. Such variance also opens the possibility of explaining considerable behavior.
Using these indicators we find brand and size loyalty most important. Brand has a larger coefficient and t-value than size, as well as a larger carry-over constant as noted earlier. However, size loyalty is extremely important, probably much more than manufacturers and retailers realize.
The next most important attribute is the 0­1 promotion variable, indicating that the attention that manufacturers and retailers give to promotion is not misplaced. After promotion a drop takes place to the two price variables, regular price and promotional price cut, and finally another drop to the prior promotional purchase.
The brand-size constants form a special group. They can represent unique product qualities and/or specification errors. As already mentioned, if the other explanatory variables are doing a nearly perfect job, these constants should be close to zero. Large A has been taken as the reference point and is zero by definition. Most of the others are small. However, it is revealing to compare brand-size constants with shares, arranged in decreasing order:

Small Small Large Small Large Large Small Small

C

B

C

A

A

B

D

E

Share of purchases:
Brand-size constant:

28 4 0 41

17 1 0 10

15 5 14 0 0 12 -0 09

10 6 9 8 3 0 1 6 0 -0 08 -0 05 -1 72

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

39

Figure 4

Predicted Share of Purchases Tracks Actual Share Closely for the Calibration Sample over the Calibration Period

Small A 60

Large A 60

50

50

40

40

30

30

20

20

10

10

0 MAR 08.79 MAY 03.79 JUN 28.79 AUG 23.79

0 MAR 08.79 MAY 03.79 JUN 28.79 AUG 23.79

Small B 60 50
40
30
20 10
0 MAR 08.79 MAY 03.79 JUN 28.79 AUG 23.79

Large B 60
50 40
30
20 10
0 MAR 08.79 MAY 03.79 JUN 28.79 AUG 23.79

Small C 60

Large C 60

50

50

40

40

30

30

20

20

10
0 MAR 08.79 MAY 03.79 JUN 28.79 AUG 23.79

10
0 MAR 08.79 MAY 03.79 JUN 28.79 AUG 23.79

Small D 60
50
40

Small E 60

50

Actual purchase share

Predicted purchase share

40

30

30

20

20

10

10

0 MAR 08.79 MAY 03.79

JUN 28.79

AUG 23.79

0 MAR 08.79

4 week periods

MAY 03.79

JUN 28.79

AUG 23.79

Perhaps a modest relationship exists, although only Small C and Small E at the extremes have significant t-values (2.5 and -4.7). One would conjecture that an explanatory variable may be missing. A top candidate would be quality of display during a promotion. Small E stands out even further than this would be expected to explain and, in fact, is a slightly different product with certain unique qualities.
Looking at the control variables further, we see that regular and promotional price coefficients have about the same magnitude. We do not expect this a priori

because the promotional price is likely to be advertised in the newspapers and by signs within the store. Similarity of coefficients does not necessarily imply similarity of price response, however, because of the other terms in the utility function.
Promotion is the most interesting control variable. Not only is its effect large but usually it is accompanied by a price cut that enhances total impact. Some marketers believe the effect of promotions to be entirely due to price but that view is not supported by our results. Even with a price cut of zero, a large

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

40

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

probability gain is calculated. This is consistent with much experience that special displays (e.g., end-aisle or free standing positions) play a major role in customer response.
The past promotion variable is directed at an important question in package goods marketing: Is a customer who buys a product on promotion less likely to repurchase that product than a customer who buys it under ordinary circumstances? The answer is needed for assessing the true value of promotional activity. The work of Shoemaker and Shoaf (1977), Dodson et al. (1978), and Jones and Zufryden (1981) indicates that the promotional purchase has a negative effect on subsequent purchase probability. The present model permits an explicit assessment of the effect. A promotional purchase affects subsequent buying through brand loyalty, size loyalty and the prior promotional purchase variables. Suppose that a customer buys a particular brand-size on promotion. Then the contribution of that purchase to the next period's utility as a result of the loyalty variables is (using coefficients from S6 of Table 1, the s of Figure 3, and the definitions of x6 and x7):
3 92 0 125 1 + 2 97 0 188 1 = 1 05
However, this contribution is diminished by the prior promotional purchase variable:
- 0 22 1 = -0 22
This leaves a net plus of 0.83 relative to a situation of not having purchased the brand-size at all. Carrying the process to the next purchase, the contribution of the original purchase to utility through the loyalty variables is:
3 92 0 875 0 125 1 + 2 97 0 812 0 188 1 = 0 88
but is diminished by the second prior promotional purchase variable
- 0 46 1 = -0 46
for a net of 0.42. The negative effect of the prior promotional purchase variables is in agreement with previous authors, but net contribution over the two periods remains positive. In other words the calculation says that the customer is more likely to purchase the promoted brand-size than if it had not been purchased in the first place, but less likely than if it had been a nonpromotional purchase.
6. Testing
The holdout sample of 100 households (1609 purchases) provides an opportunity to challenge the calibrated model. Tracking share of purchases by 4-week

period will be our primary method of evaluation. Not only does share loom important in practice but it also varies dramatically over time and over brand-size. We ask several questions:
(1) How well does the model predict brand-size share in the hold-out sample during the same time period used in the calibration?
(2) How well does the model predict share during time periods subsequent to the calibration?
(3) Can the model, using constants derived from data that mixes together all stores, predict shares within individual stores? In comparing predicted versus actual, we need a measure of random variation, especially for low share brand-sizes, whose number of purchases may be very few in a particular four weeks. Accordingly, we calculate a standard error of predicted share. For observation i and any given brandsize, the model predicts a probability of purchase pi. Given the null hypothesis that the calibrated model is correct, the actual purchase is binomially distributed. Letting s denote the predicted share and n the number of observations,

n
s = pi n
i=1

n

1/2

SE s = pi 1 - pi

n

i=1

where SE s is the standard error of share. Figure 5 displays an example of hold-out tracking,
the case of Small A. The dotted line in the middle is the model prediction, the upper and lower solid lines are ±1.64 SE and so form approximately a 90% confidence band. The loyalty variables are initialized in a pre-period September 14, 1978 through March 7, 1979. Tracking then takes place during the period from March 8, 1979 through October 17, 1979 previously used by the calibration sample and on into a new, forecast period October 18, 1979 through March 5, 1980.
As may be seen, agreement is remarkably good. A general upward trend is captured. So is a promotional peak and then a downward trend that is interrupted temporarily by another promotion. The model is impressive in tracking these ups and downs. We credit this to detailed information about the store environment at the time of purchase (namely, price, promotion, and promotional price cut for all competitors) plus information about the customer's purchase history summarized in the brand and size loyalty variables.
Of special interest is the good quality of tracking in the period October 18 to March 5, since here we not only are using a hold-out sample but also are forecasting outside the time period used by the calibration sample. In the forecast period we continue to employ

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

41

Figure 5

Tracking of Small A Purchase Share in a Holdout Sample of 100 Customers Shows Actual Share Falling Almost Entirely Within the Confidence Band

Share of purchases 60

Actual purchase share

50

Predicted purchase share

90% confidence band

40

30

20

10

0 MAR 08.79

MAY 03.79

JUN 28.79

AUG 23.79

OCT 18.79

DEC 13.79 FEB 07.80

4 week periods

Notes. The vertical line separates the calibration time period from the forecast period. During the forecast period loyalty variables are constructed from simulated purchases.

the actual prices and promotions of all the brand sizes (i.e., the model is not attempting to predict what marketing decisions will be made). A dilemma arises, however, over the loyalty variables. Loyalty uses purchases in its construction and yet the purpose of the holdout sample is to predict purchases. We can, of course, simply use the purchases just for the construction of the loyalty variables. This seems justified since we are always predicting ahead in time relative to the purchases entering the calculation. We use this procedure for March 8 to October 17, 1979. However, for October 18, 1979 to March 5, 1980, we adopt a new, Monte Carlo method so as to be above reproach on the issue. We construct a synthetic purchase history for each customer as follows: When an actual purchase is needed to update the loyalty variables, we draw a random number and use it to select a brand-size to be purchased, this being done so that the probability of picking a brand-size conforms to its model-calculated purchase probability. As the forecast period proceeds, the synthetic purchase history unfolds for each customer and enters the loyalty variables.
We see in Figure 5 that, even with the severe test of a new set of customers and a conservative loyalty calculation, tracking is good in the post-calibration periods. Figure 6 displays corresponding plots for all brand-sizes. The model follows the turns and trends of share quite well. Enough points lie outside the 90% confidence band, however, to suggest the model has not captured all phenomena and, indeed, we know some variables are missing.
In most cases the share changes are followed within a standard error or so but sometimes the absolute

level is missed. The deviation of Small B in the forecast period is an example. It would appear from the quality of fit in general that the model captures quite well the average effect of, say, promotion, but an individual promotion may be more or less successful than average. The one for Small B in the middle of the forecast period appears to have been less successful. The deviation persists after the promotion because the model increases the customers' loyalties on the basis of their assumed promotional purchases, whereas the actual customers experience no such effect. Despite the level difference, however, the directional changes continue to be correct.
Small D shows a level difference that puts the actual share entirely above the confidence band. Presumably, this is due to a miscalibration of the brand-size constant. On checking back, it turns out that the calibration sample contains only 31 purchases of Small D out of a total of 1021 during the calibration period (3.0% share). Despite random selection of customers for the two samples, the holdout group has many more purchases of Small D, about 93 out of 916 (10.2% share) in the same period. A larger brand-size constant would produce a better representation of the underlying population that both samples are drawn from and would certainly improve the appearance of the Small D plot. Be that as it may, the share changes are tracked well so that, with respect to the normative questions of what happens when the decision variables are changed, the Small D plot is reassuring.
Another opportunity to test the model arises from the presence of different stores in the sample. The panel population consists of store-loyal customers from four stores, each of which has its own individual personality. One of them is a large conventional

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

42

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

Figure 6

Tracking of Purchase Share in the Holdout Sample Is Quite Good for Almost All Brand-Sizes

Small A 60

Large A 60

50

50

40

40

30

30

20

20

10

10

0

0

MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80 MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80

Small B 60

Large B 60

50

50

40

40

30

30

20

20

10

10

0

0

MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80 MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80

Small C 60

Large C 60

50

50

40

40

30

30

20

20

10

10

0

0

MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80 MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80

Small D 60
50
40

Small E 60

50

Actual purchase share

Predicted purchase share

40

90% confidence band

30

30

20

20

10

10

0 MAR 08.79 JUN 28.79

OCT 18.79

0 FEB 07.80 MAR 08.79
4 week periods

JUN 28.79 OCT 18.79 FEB 07.80

supermarket; another a smaller, more neighborhood market; still another is a warehouse store; and the last is a conventional store with unconventional merchandising practices. The calibration process takes no account of the differences among stores beyond whatever manifestations these may generate through values of the attribute variables, nor does the calibration consider that different types of households may shop at different stores.
Breaking the customers down by store reduces sample sizes. To compensate we aggregate over sizes to brand level and also focus on two high share

brands A and C. Figure 7 presents tracking for these brands in the four stores. The format is as in Figure 5: holdout sample, predicted and actual shares with confidence band. The results are very satisfactory, with the model predicting behavior well across the four stores. Notice in particular the tracking of the decline of Brand C in Store 3. The implication is that if we know what is happening to the control variables in the store, we can predict share quite well.
The parsimony of the model deserves emphasis. Omitting the brand-size constants which, as we have discussed, determine only average share, the coeffi-

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

43

Figure 7

Tracking of Purchase Shares of Brands A and B in Four Different Supermarkets Is Quite Good Despite Different Store Characteristics

Brand A - Store 1 100

Brand C - Store 1 100

80

80

60

60

40

40

20

20

0

0

MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80 MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80

Brand A - Store 2 100

Brand C - Store 2 100

80

80

60

60

40

40

20

20

0

0

MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80 MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80

Brand A - Store 3 100
80

Brand C - Store 3 100
80

60

60

40

40

20

20

0

0

MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80 MAR 08.79 JUN 28.79 OCT 18.79 FEB 07.80

Brand A - Store 4

100

80

Actual purchase share

Predicted purchase share

60

90% confidence band

Brand C - Store 4 100 80
60

40

40

20

20

0 MAR 08.79

JUN 28.79

OCT 18.79

0 FEB 07.80 MAR 08.79
4 week periods

JUN 28.79

OCT 18.79

FEB 07.80

cients of the model are only seven in number and are exactly the same for every customer, store, and brand-size. Nevertheless, they combine with the control and environmental variables to produce widely different patterns of share that correspond well to actual behavior in the hold-out sample.
7. Market Response to Control Variables
Practical use of the model requires measures of how the market responds to the retailers' actions.

7.1. Calculating Response We have a calibrated model at the individual customer level but aggregate market response is of more interest to a decision maker and requires further computational effort. First of all, even though the logit coefficients are the same for all customers, individual responses will differ greatly depending on the store environment and prior loyalties. Table 2 illustrates this by showing that, in a hypothetical twoproduct market, a customer with equal loyalties to both products displays a price elasticity of share equal to -2.2, whereas a customer with 0.8 loyalty to one of

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

44

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

Table 2

Although the Model Coefficients Are the Same for All Customers, Response Can Be Quite Different Depending on Attribute Values at Time of Purchase

Hypothetical two product market: A and B

Loyalty coefficient: 7.0 Price coefficient: -30 oz/dol No other attributes.
Price response of customer with equal loyalties Loyalty to A = loyalty to B = 0 5 Price of A = price B = 0 15 dol/oz Probability of choosing A = e 3 5-4 5 / e-1 + e-1 = 0 5 10% price reduction of A to 0.135 dol/oz Probability of choosing A = 0 61 Price elasticity for A = -2 2
Price response of customer with unequal loyalties Loyalty to A = 0 8, loyalty to B = 0 2 Price of A = price of B = 0 15 dol/oz Probability of choosing A = 0 985 10% price reduction of A to 0.135 dol/oz Probability of choosing A = 0 991 Price elasticity for A = -0 06

the products has an elasticity of -0.06 to that product. This is an example of the S-shape of Figure 2 in action. Analogously, although the control variables in our eight-product market have the same coefficients for all brand-sizes, the market response for a particular product will depend on the actions of the other brand-sizes and the distribution of loyalties across the customers.
Analytically, determination of aggregate market response calls for an integration of the customer response function over a joint distribution of customer loyalties, prices, and promotions for every brand. One standard approach to such a high dimensional integration is Monte Carlo sampling. A simpler and easier method to implement is to use the actual customers, time periods and attribute variables of the data. By changing, say, the regular price of a brandsize by 1% over the whole time period and observing the corresponding change in share, we obtain an aggregate share response to regular price.
Many different response calculations are possible. Some examples are (1) regular price elasticity of share, (2) the cross elasticity of one brand-size's share to another's price, (3) share response to promotion, (4) the cannibalization of one size of a brand by the promotion of another, and (5) the elasticity of price during a promotion.
Each of these can be evaluated as a short-term effect, i.e., as an alteration of choice probabilities at the purchase occasion on which the variable is changed, or as a long-term effect, taking also into account the future impact of changed loyalty. We restrict ourselves here to three examples of short-term response: regular price elasticity, promotion response, and promotional

Table 3

Short-Term Market Response to Three Different Control Variables

Purchase share (%)

Regular (depromoted) price elasticity
of share

Share increase from promotion
with median price cut (%)

Promotional price cut elasticity of share

Small C

28 4

Small B

17 1

Large C

15 5

Small A

14 0

Large A

10 6

Large B

98

Small D

30

Small E

16

-1 9 -2 3 -2 3 -2 5 -2 7 -2 6 -3 4 -2 4

173

-1 1

334

-1 7

273

-1 7

362

-1 8

363

-1 8

502

-2 0

409

-3 2

568

-2 4

price cut elasticity. The results will illustrate a number of important points. The calculations are made as follows:
(1) Regular Price Elasticity. Using the calibration sample of the 32-week calibration period, all the regular prices of, say, Small A are increased by 1% and other variables held constant. The probability of choosing Small A is calculated for all purchases. This produces a new purchase share for Small A over the calibration period. The percent change in purchase share divided by the present change in price is taken as the short-term regular price elasticity.
(2) Response to a Promotion with a Median Price Cut. Consider again Small A. For every purchase occasion calculate the probability of purchase without a promotion. Calculate the average share for Small A. Repeat the process but compute the probability of purchase when Small A has a promotion with a median price cut. All other attributes are held constant throughout. Our measure of short-term promotion response is the percent increase of the second purchase share over the first.
(3) Promotional Price Cut Elasticity. For every purchase occasion calculate probability of purchase with a Small A promotion having a median price cut with 1% of regular price added back in. Calculate Small A purchase share. Take the percentage difference from the share with promotion and median price cut and divide by 1%. The result is the short-term promotional price cut elasticity.
The results are in Table 3.
7.2. Discussion A first observation is that response varies quite widely by brand-size. This was expected even though all brand-sizes use the same coefficients for the control variables, because the market response calculations take into account the complete environment, including competitive conditions, brand loyalties, etc. The variation in response by brand-size has significant implications for retailers and manufacturers.

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

45

Differences in price elasticity, for example, suggest different pricing policies across brand-sizes.
The next point is that the response measures show a definite pattern. Table 3 has been arranged so that the brand-sizes are listed in order of decreasing share of purchases. A glance down the table shows that the magnitudes of the response numbers tend to increase with decreasing share. For example, in each case the average of the four lower brand-sizes is larger in absolute magnitude than that of the higher four. The relationship is not perfect, thereby happily leaving room for brand individuality. Nevertheless, as a percentage of their own share, high share brand-sizes are less sensitive to their own control variables than low share brand-sizes. On the other hand, we can multiply the three response measures of Table 3 by the corresponding shares to obtain absolute share increments for the changes in control variables. If this is done, it will be discovered that the high-share brands tend to obtain a larger share increment than the low-share brands for the same marketing action.
We argue that these relationships between sensitivity and share are forced by the structure of the logit model. Details appear in Appendix 2. We find that the patterns of Table 3 exist at the individual purchase level and so their manifestation in aggregate is not surprising. We also find that the magnitude of regular price elasticity will be largest when all individual purchase probabilities are identical and equal to purchase share. Heterogeneity of purchase probabilities then lowers the magnitude of elasticity.
The nature of the heterogeneities in practice is illustrated in Figure 8, which shows histograms of purchase probabilities across purchases for the highest and lowest share brand-sizes. As may be seen, each product has a group of high probability purchasers, a broad range of intermediate values indicating switchers, and a cluster of near-zero probabilities. The latter is very large for the low share brand-size. A high purchase probability for a product implies a high utility in the logit model, often as a result of high loyalty. As mentioned in the discussion of the S-shaped curve of Figure 3, customers with high or low utilities for a given brand-size will have corresponding purchase probabilities that are relatively insensitive to marketing actions, thus reducing the overall responsiveness of the product.
In summary, the structure of the logit model tends to produce short-term sensitivities to marketing variables, which, when expressed in elasticity form, decrease in absolute value with increasing purchase share. A broad distribution of loyalties (and therefore probabilities of purchase) reduces sensitivity relative to a set of identical customers. Neither of these statements is dependent on the coffee market or the specific brands involved, but instead is only a function of the model form.

Percentage of purchases 0 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70 0.75 0.80 0.85 0.90 0.95 1.00

Figure 8
100 95 30 25 20 15 10 5 0

The Distribution of Purchase Probabilities Across Purchases for the Highest and Lowest Share Brand-Sizes Shows a Slight Bimodality with Higher Extremes and a Broad Middle
Distribution of purchase probabilities for Small C

Percentage of purchases 0 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70 0.75 0.80 0.85 0.90 0.95 1.00

Probability of purchase
Distribution of purchase probabilities for Small E 100 95 30 25 20 15 10
5 0

Probability of purchase

As a final observation about market response we remark on the completeness of the model. It gives information not just about a single brand-size but about the whole market. We could supplement Table 3 with cross-elasticities and other response measures as described earlier. The completeness permits the study of strategic issues, for example, the consideration by a company not only of its own actions but also of various possible competitive reactions.

8. Conclusions
The multinomial logit model has provided an excellent representation of the regular ground coffee market at the individual customer and retail store level. Coefficients of the model are statistically significant, many of them highly so. The calibrated model predicts the behavior of a hold-out sample of customers satisfyingly well. A remarkable feature of the model is its parsimony. The major coefficients, namely, those for brand and size loyalty and the control variables, are the same across all brand-sizes and all customers, and yet the model ably predicts brand-sizes with widely different shares, follows different trends and

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

46

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

turns over time and tracks brand performance in different types of stores. The results are not perfect and, reasonably so, since various marketing phenomena are missing (for example, display quality, couponing, and media advertising) as we know from other studies that these actions influence purchases. Nevertheless, the results here seem very promising.
The success of the modeling effort appears to be due to the micro detail and competitive completeness of the scanner panel data. People, not markets, respond to the actions of the retailers and manufacturers. The greater variability of the explanatory variables at the individual level offers richer opportunities for calibrating response than the corresponding store or market data.
Manipulation of the calibrated model yields share response to several marketing variables. Here we have only scratched the surface. However, it is clear that, because we are modeling the actions of all brandsizes, the answers produced by the model will depend strongly on the questions it is asked. In particular the answers will depend on the customer loyalties and competitive actions assumed.
Much work remains to be done. A major missing feature is the modeling of the purchase occasion itself. Our work has focused entirely on share, whereas certain market actions, notably promotion, tend to shift purchases in time and therefore at least temporarily expand the market.
The model needs other extensions. Presently, it describes what happens inside the retail store. This is not adequate for the retailer, who is relatively unconcerned about competition among brands, except perhaps for house brands, but is very concerned about competition from other retailers. (See Little and Shapiro 1980.) Correspondingly, although manufacturers are strongly interested in interbrand competition, the control variables of our model are those of the retailer and only indirectly influenced by the manufacturer. Various steps should be taken to extend the results closer to the decision makers' needs.
A good representation of the coffee market is encouraging, but coffee is just one of the many product categories. We do not yet know whether the strong assumptions of the multinomial logit will hold up in more complicated situations where, for example, product differentiation is greater or variety seeking is common or the customer maintains a portfolio of products. We expect that new modeling issues will emerge and require ingenuity to resolve.
Nevertheless, in the coffee case we see the suggestion of a new understanding of the interplay between brand franchise and marketing actions. Here is a model, frugal in parameters, that fits the data well and reveals a distinct pattern between share of purchases and market response. Since neither the relationship nor tracking is perfect, there appear to be

idiosyncratic effectiveness variables by brand and purchase occasion and, of course, other marketing variables await inclusion in the model. Nevertheless at the level of general understanding of these markets, the picture emerges that a well-entrenched brand-size has a set of loyal customers who make its share relatively insensitive to certain marketing actions, at least in the short run. At the same time the market also contains a pool of switchers less loyal to any brandsize who respond fairly readily to changes in marketing variables. Reliable knowledge about the interplay among attributes and their ramifications for brand strategy now seem to be within striking distance of our emerging marketing technology.
Acknowledgments The authors thank Selling Areas Marketing, Inc. (SAMI) for providing the scanner panel data on which this work is based. The authors are especially appreciative of the help of Kenneth Silvers, Frank Smith, Valerie Gager, and Jack Moffly.
Appendix 1. Test for Independence from Irrelevant Alternatives The multinomial logit model implicitly assumes "independence from irrelevant alternatives" (IIA). McFadden et al. (1977) present a residuals test that we shall apply to evaluate whether the assumption reasonably holds in our set of data. The motivating idea of the test is that violation of the IIA property will cause systematic errors in the choice probabilities. The procedure first calculates the probabilities by the calibrated model for, say, alternative j for each of the 1021 observations. The probabilities are then ranked and sorted into some number of cells, roughly the same number of observations in each cell. For each cell we calculate an expected number of choices of j from the probabilities and compare it with the actual number in a goodness of fit test. The statistic
M
2 = Sm - NmPjm 2 NmPj where
m=1
m = index of cell, M = total number of cells, Sm = number of actual choices of j in cell, Nm = total number of observations in cell, Pjm = average probability for alternative j in cell m, and Pj = average probability for alternative j in total sample,
has an asymptomatic distribution bounded by 2 distributions with M - 1 and M - K - 1 degrees of freedom where K is the number of estimated parameters. The test statistics are not independent across alternatives.
The test was run for each brand-size, dividing the observations into 50 cells each time or about 20 observations per

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

47

cell. The resulting 2 were

2

2

Small A 24 6 Large A 18 5 Small B 33 0 Large B 17 0

Small C 17 9 Large C 18 6 Small D 9 5 Small E 30 2

The degrees of freedom for the upper bound 2 statistic is 49 with critical (0.05) level 66.1 and for the lower bound 35 and 49.7. As may be seen the 2 for each brand-size falls well below both critical levels. Therefore no departure from IIA is detected.

Appendix 2. Effect of Share on Price Response Table 3 shows that the magnitude of short-term market response, when expressed as a percentage of purchase share, increases with decreasing share. After multiplying by share, response decreases with share. We claim that these phenomena are the result of the structure of the multinomial logit model. Our analysis will be done for the case of regular price.
Consider first a single customer and purchase decision. The expected share of purchases for one occasion is simply the probability of purchase. Let

i kk

n

= the regular price elasticity of purchase share

for brand-size k on purchase occasion n of

customer i

=

xki pki

n n

pki n xki n

(A1)

where xki n is the regular price and pki n the purchase probability of brand-size k on purchase occasion n of customer i.

Purchase probabilities are calculated from the multino-

mial logit

pki n = evki n

evji n
j

(A2)

with

vki n = aik n + bxbi n yk = utility of brand-size k for customer i on nth pur-
chase occasion, aik n = effects of all other constants and variables on utility
for the same purchase occasion,
b = coefficient of regular price,
yk = a parameter introduced in order to change all prices of brand-size simultaneously and proportionally.
Nominal value = 1 0.

For immediate purpose yk = 1. Substituting the derivative of (Al) into (A2) and simplifying yields

i kk

n

= bxki n

1 - pki n

(A3)

Therefore, on an individual basis, the absolute magnitude

of regular price elasticity increases as share decreases. This

explains the aggregate effect found in Table 3. Further

pki n

i kk

n

, the incremental share for a percentage change

in price, decreases with decreasing share on an individual

basis over the range of 0  pki n  1/2. Provided that the preponderance of the probabilities falls in this range, as will be the case for brand-sizes having shares less than 1/2, the second type of pattern in Table 3 can be expected.
Although (A3) explains the patterns found, further insight can be gained about aggregate elasticity. Let

mk = expected purchase share of brand-size k

=1 N

i

Ni
pki n
n

(A4)

where Ni = the number of purchases by customer i and N = Ni. Further let

kj = cross-elasticity of purchase share of k with respect to price of j

= yj mk mk yj

(A5)

From (A2)



pki n yj

= bxji

n

pki n - pki n -pki n pji n

2

j =k j =k

(A6)

Using (A5), (A4), and (A6), and setting yj = 1, we obtain

kk

=

b mk

1 N

i

xki n pki n - pki n 2
n

j =k

(A7)

kj

=

b mk

1 N

i

xji n pki n pji n
n

j =k

(A8)

Although (A7) looks a little complicated, we can use it to

learn the effect of heterogeneity of pki n on kk. To do this,

we first ask how we would pick the distribution of pki n

to maximize kk subject to the constraint that purchase

share is fixed, i.e., 1/N

pki n = mk. (For simplicity, we

study the case xki n = xk, a constant price for all purchases.)

Mathematically, the problem is equivalent to finding ui to

maximize ui - u2i subject to ui = Nmk, 0  ui  1, i =

1

N . In turn, this is equivalent to minimizing u2i sub-

ject to the same constraints. It can be shown, for example

by dynamic programming, that the solution is ui = mk. This means that the magnitude of regular price elasticity

kk will be largest for a set of customer purchases which have identical purchase probabilities all equal to the aggre-

gate purchase share of the group. Heterogeneity reduces kk from there. In fact, pushing the pki n to all 0s and 1s
would give kk = 0. For the identical probability case, (A7) reduces to

kk = bxk 1 - mk

Using the calibration value b = -29 9 and the average cof-

fee price in the market, 0.165 dollars/ounce, we obtain

kk = -4 93 1 - mk . This shows kk to be increasing with decreasing share, as expected. Comparison of values from

this formula with those in Table 3 shows the effect of het-

erogeneity on kk . As an example, Small C would have kk = 3 5 by this formula but is 1.9 by Table 3.
To summarize, the logit structure inherently produces the

patterns of response obtained. Further, the greater the dis-

persion of the individual purchase probabilities away from

pki n = mk toward all 0s and 1s, the lower the magnitude of elasticity.

Guadagni and Little: A Logit Model of Brand Choice Calibrated on Scanner Data

48

Marketing Science 27(1), pp. 29­48, © 2008 INFORMS

References
Ben-Akiva, M. 1973. Program for maximum likelihood estimation of the multinomial logit model. Transportation Systems Division, Department of Civil Engineering, MIT (January).
Dodson, J. A., A. M. Tybout, B. Sternthal. 1978. Impact of deals and deal retraction on brand switching. J. Marketing Res. 15(February) 72­81.
Domencich, T. A., D. McFadden. 1975. Urban Travel Demand. NorthHolland, Amsterdam.
Gensch, D. H., W. W. Recker. 1979. The multinomial, multiattribute logit choice model. J. Marketing Res. 16(February) 124­132.
Hauser, J. R. 1978. Testing the accuracy, usefulness, and significance of probabilistic choice models: An information theoretic approach. Oper. Res. 26(May) 406­421.
Hlavac, T. E., Jr., J. D. C. Little. 1966. A geographic model of an Urban automobile market. D. B. Hertz, J. Melese, eds. Proc. Fourth Internat. Conf. Oper. Res., Wiley-Interscience, New York, 302­311.
Jones, J. M., F. S. Zufryden. 1980. Adding explanatory variables to a consumer purchase behavior model: An exploratory study. J. Marketing Res. 17(August) 323­334.
Jones, J. M., F. S. Zufryden. 1981. Relating deal purchases and consumer characteristics to repeat purchase probability. J. Market Res. Soc. 23 84­99.
Little, J. D. C., J. F. Shapiro. 1980. A theory for pricing nonfeatured products in supermarkets. J. Bus. 53(July, Part 2) S199­S209.
Luce, R. D. 1959. Individual Choice Behavior. John Wiley and Sons, New York.

McFadden, D. 1974. Conditional logit analysis of qualitative choice behavior. P. Zarembka, ed. Frontiers in Econometrics. Academic Press, New York, 105­142.
McFadden, D. 1981. Econometric models of probabilistic choice. C. F. Manski, D. McFadden, eds. Structural Analysis of Discrete Data with Econometric Applications. MIT Press, Cambridge, MA, 198­272.
McFadden, D., K. Train, W. B. Tye. 1977. An application of diagnostic tests for the independence of irrelevant alternatives property of the multinomial logit model. Transportation Res. Record 637 39­45.
Punj, G. N., R. Staelin. 1978. The choice process for graduate business schools. J. Marketing Res. 15(November) 588­598.
Shoemaker, R. W., F. R. Shoaf. 1977. Repeat rates of deal purchases. J. Advertising Res. 17(April) 47­53.
Silk, A. J., G. L. Urban. 1978. A pre-test-market evaluation of new packaged goods: A model and measurement methodology. J. Marketing Res. 15(May) 171­191.
Theil, H. 1969. A multinomial extension of the linear logit model. Internat. Econom. Rev. 10(October) 251­259.
Urban, G. L., P. L. Johnson, J. R. Hauser. 1984. Testing competitive market structures. Marketing Sci. 3(2) 83­112. [Originally cited as: Urban, G. L., P. L. Johnson, R. H. Brudnick, J. R. Hauser. 1982. Modeling of competitive market structure: A methodology based on forced switching probabilities. Sloan School Working Paper 1236-81, MIT (November).]
Yellott, J. I., Jr. 1977. The relationship between Luce's choice axiom, Thurstone's theory of comparative judgment and the double exponential distribution. J. Math. Psych. 15 109­144.

