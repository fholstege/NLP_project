Vol. 34, No. 6, November­December 2015, pp. 843­863 ISSN 0732-2399 (print) ISSN 1526-548X (online)

http://dx.doi.org/10.1287/mksc.2015.0908 © 2015 INFORMS

A Flexible Yet Globally Regular Multigood Demand System

Nitin Mehta
Rotman School of Management, University of Toronto, Toronto, Ontario M5S 3E6, Canada, nmehta@rotman.utoronto.ca
Avexing challenge when using the utility-maximization framework to estimate consumers' decisions on which set of goods to purchase and how much quantity to buy is obtaining a functional form of the utility that satisfies three criteria: tractability, flexibility, and global regularity. Flexibility refers to the ability of a utility function to impose minimal prior restrictions on demand elasticities. Global regularity refers to the ability of a utility function to satisfy regularity properties required by economic theory in the entire feasible space of variables. The tractable utility functions used so far are either inflexible, which could yield inaccurate estimates of underlying elasticities, or do not satisfy global regularity, which can result in invalid expressions of likelihood and invalid policy simulations. I tackle this problem by deriving necessary and sufficient conditions for global regularity of Basic Translog utility. Using simulated and scanner data, I show that the proposed demand system yields better model fit, more accurately captures underlying elasticities, and yields substantially different results in counterfactuals compared to alternatives used in prior literature. Specifically, unlike the alternatives used so far, the proposed demand system allows for complementarities between goods, and more accurately captures the extent of their inferiority, the extent of their substitutability, and asymmetries in cross price effects.
Keywords: utility theory; econometrics; global regularity; flexible functional forms History: Received: April 1, 2013; accepted: December 29, 2014; Preyas Desai served as the editor-in-chief and
K. Sudhir served as associate editor for this article. Published online in Articles in Advance April 16, 2015.

1. Introduction
With the availability of disaggregate consumer demand data, there has been an upsurge in research attempting to model how consumers make purchase decisions when faced with multiple goods that can be complements or alternatives to each other. These purchase decisions are characterized by two simultaneous choices. The first choice pertains to which set of goods to purchase, and the second pertains to how much of each good to buy. The focus of this paper is the stream of research that estimates these decisions using a utility maximization framework. Such a framework requires deriving the demand equations of the purchased and nonpurchased goods from the maximization of consumer's utility subject to budget and nonnegativity constraints. Despite its theoretical appeal, the usefulness of this framework has been hampered by econometric and analytical difficulties. Next I provide an overview of the challenges of this framework and the goal of this paper. I then explore each of these in greater detail.
A perplexing challenge faced by researchers who have used the utility maximization framework is obtaining a functional form of the utility that satisfies three criteria: tractability, flexibility, and global regularity. Tractability refers to the ability of the utility function to yield closed form solutions of the demand

equations for purchased and nonpurchased goods. Flexibility refers to the ability of the utility function to impose minimal prior restrictions on demand elasticities. For instance, for cross-price elasticities, flexibility requires the utility function to allow for complementarity as well as substitutability between goods. For expenditure elasticities, flexibility requires the utility function to allow for normal as well as inferior goods. Global regularity refers to the ability of the utility function to satisfy regularity properties required by economic theory in the entire feasible space of variables in the utility maximization, where the variables include prices, expenditures, quantities, etc. The tractable functional forms of utilities used in prior literature are (a) inflexible, and thus could yield inaccurate estimates of underlying demand elasticities in the data and thereby inaccurate results in policy simulations, or (b) do not satisfy global regularity, which as I will explain later in §1.1, could result in invalid expressions of the likelihood and invalid policy analysis.
This paper attempts to resolve this longstanding problem by constructing an appropriate demand specification in a multigood choice context that satisfies all three criteria. Such a demand system will thus be easy to estimate, will yield valid expressions of the likelihood, and will accurately capture the underlying

843

Mehta: A Flexible Yet Globally Regular Multigood Demand System

844

Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

elasticities thereby facilitating meaningful policy analysis. This completes the overview of the challenges and the goal of the paper. Next I discuss the utility maximization framework, and elaborate on the challenges and tasks that I undertake to overcome those challenges.
1.1. Overview of the Utility Maximization Framework and the Challenges
In the utility maximization framework, two approaches are used to derive the demand equations of purchased and nonpurchased goods for a given observation. The first is the primal approach in which one specifies the functional form of the random direct utility and derives the Kuhn­Tucker conditions that yield the demand equations (Wales and Woodland 1983). The second is the dual approach in which one specifies the functional form of the random indirect utility and derives the demand equations in a manner that follows directly from the Kuhn­Tucker conditions (Lee and Pitt 1986). The choice of which approach to use depends on the extent to which the functional form of the direct or indirect utility satisfies the criteria of tractability, global regularity, and flexibility. Next, I discuss the importance of these criteria, the desirability of the two approaches based on these criteria, and the challenges therein.
The importance of tractability and flexibility is straightforward. For global regularity, if the researcher uses the primal approach, the direct utility must satisfy regularity properties of strict quasiconcavity, differentiability, and monotonicity in the entire feasible space of variables. If he uses the dual approach, then global regularity requires the indirect utility to be such that its corresponding direct utility satisfies the aforementioned properties in the entire feasible space. Satisfying global regularity is important for two reasons. First, it ensures the validity of policy simulations. If the utility function fails to satisfy regularity properties in the space of variables where simulations are performed, the simulations will be invalid because they will be inconsistent with utility maximization behavior. Second, it ensures the validity of the likelihood. To see why that is so,1 note that the observational likelihood consists of the joint distribution of observed quantities. To derive this distribution, the researcher derives the Kuhn­Tucker conditions in terms of random errors and quantities and uses transformation of variables from random errors to the quantities. This transformation yields a "valid" joint distribution of quantities as long as the Kuhn­Tucker conditions yield unique solutions of
1 Note that I have discussed the second reason in the context of the primal approach. The same rationale holds true for the dual approach because it is derived from Kuhn­Tucker conditions in the primal approach.

quantities for each given set of random errors. In this regard, Van Soest et al. (1993) have shown that when utility maximization is subject to nonnegativity constraints, the Kuhn­Tucker conditions can suffer from the "coherency problem," i.e., they may not yield unique solutions of quantities. Satisfying global regularity helps to address this problem. This is because if the direct utility is strictly quasiconcave (or if the indirect utility is such that its corresponding direct utility satisfies this property) at all values of variables in the data, then from Lagrange theory, the Kuhn­Tucker conditions will yield unique solutions of quantities, which ensure validity of the likelihood.
Given the importance of the three criteria, I next discuss the desirability of primal and dual approaches. If a researcher were to use the primal approach, he would have to restrict it to additively separable functional forms of direct utilities (e.g., LES, CES) to get tractable solutions of the demand equations. Such additive separable functional forms impose strong restrictions on demand elasticities. For instance, they restrict all pairs of goods to substitutes and only allow for normal (and not inferior) goods. The dual approach does not have this problem since flexible functional forms (e.g., AIDS, Basic Translog) lie in the realm of indirect utilities. These are second order approximations of an arbitrary indirect utility, which are tractable and can achieve any arbitrary demand elasticities as long as their parameter space is unrestricted.
However flexible functional forms present another problem in that they only satisfy global regularity in a restricted space of parameters. Thus if a researcher were to estimate a flexible functional form without imposing any prior restrictions of global regularity on its parameter space, and if the estimates obtained are such that regularity properties are violated at even a single observation in the data, the researcher can run into coherency problems. Even if he does not run into coherency problems, there is no guarantee that the parameter estimates will be such that the regularity properties are satisfied outside the realm of the data where simulations are performed. Thus to address these problems, it is crucial to impose prior restrictions on the parameter space while estimating the flexible functional form so that it satisfies global regularity. For minimal impact on flexibility, these restrictions should be "necessary and sufficient" conditions (i.e., the least restrictive conditions on the parameter space) that ensure global regularity of the flexible functional form. However, the parametric restrictions proposed to date vis-à-vis flexible functional forms have only been "sufficient" conditions that impose strong restrictions on elasticities. For instance, they restrict most of the goods to be substitutes, restrict expenditure elasticities of all goods to one, and restrict cross-price effects between two goods to be symmetric.

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

845

The above discussion presents the following picture of where the current literature stands. Prior papers that have used the utility maximization framework have followed three routes. The first entails using the primal approach with additively separable direct utilities (e.g., Kao et al. 2001, Du and Kamakura 2008). The second entails using the dual approach with only sufficient conditions for global regularity imposed on parameters of a flexible functional form (e.g., Lee and Pitt 1987, Chakir et al. 2004, Song and Chintagunta 2007). The third entails using the dual approach in which the researcher estimates a flexible functional form without imposing parametric restrictions that ensure its global regularity. The first two routes are inflexible and thus could yield inaccurate estimates of underlying elasticities and inaccurate results in policy simulations. The third route may not satisfy global regularity and thus carries a risk of coherency problems and invalid policy simulations. The desirable route that satisfies all three criteria is the dual approach in which the researcher imposes necessary and sufficient conditions on parameters of a flexible functional form so that it is globally regular. However, to my knowledge, this has not yet been accomplished. This sets the stage for what I hope to achieve. My goal is to derive necessary and sufficient conditions for global regularity of Basic Translog (indirect) utility. To my knowledge, it is the only flexible functional form that yields tractable solutions when the utility maximization is subject to nonnegativity constraints.
1.2. Research Objectives To achieve this goal, I have three objectives. The first is to derive necessary and sufficient conditions for global regularity of Basic Translog utility. The second is to formally derive restrictions on elasticities implied by Basic Translog utility when necessary and sufficient conditions are imposed, and to compare them with those implied by two alternatives used in the literature: (a) additively separable direct utilities and (b) Basic Translog utility when only sufficient conditions for global regularity are imposed. I show that the proposed model imposes much fewer restrictions on elasticities as compared to (a) and (b). It does not restrict cross-price effects between two goods to be symmetric. It does not restrict the expenditure elasticities to unity, it allows for inferior goods, and restricts only one pair of goods as substitutes. The third objective is to examine use of simulated and scanner data, and the consequences of having a demand system that imposes fewer restrictions on elasticities. Using simulated data, I show that the proposed model yields a better model fit and captures the true demand elasticities in the data more accurately than (a) and (b). Furthermore, its relative efficacy is robust to the number of goods and the number

of zero purchases. Unlike (a), my model allows for and accurately captures the extent of complementarity between goods and the extent of their inferiority, and does not underestimate the extent of substitutability between goods. Unlike (b), it accurately captures the true expenditure elasticities, does not underestimate complementarity, and captures the asymmetries in cross-price effects. Using two scanner data sets (one with complements, and the other with substitutes), I show that the proposed model yields substantially different results in counterfactuals compared to alternatives (a) and (b). Specifically, I show that, because alternative (a) does not allow for complements (i.e., underestimates substitutability), it yields smaller (larger) compensation values of goods compared to the proposed model in the data set with complements (i.e., substitutes).
The rest of the paper is organized as follows. In §2, I discuss the dual approach with nonnegativity constraints. In §3, I discuss the necessary and sufficient conditions for global regularity of Basic Translog utility. In §4, I derive the implications of these conditions on the flexibility of the Basic Translog utility. In §5, I discuss the empirical results.

2. Dual Approach with

Non-Negativity Constraints

To facilitate a better understanding of global regu-

larity in the context of Basic Translog utility, I first

briefly discuss the dual approach for specifying the

demand equations when there are nonnegativity con-

straints on quantities, and on the requirements for

global regularity using a general form of an indirect

utility (Lee and Pitt 1986). Consider the case wherein

there are c = 1 M goods and the consumer's

problem is to decide which goods to purchase, and

how much to buy of each purchased good. Let pc be

the market price and qc be the quantity of good c.

Let V y

be the indirect utility, which is a

function of the total expenditure y, price arguments

of M goods



c

M c=1

(whose

specifications

I

will

explain shortly), parameters , and random errors in

the support . Given the preliminaries, I start with

the demand equations. For expositional ease, I will

work with budget shares of goods instead of quanti-

ties (where the two are related via sc = pcqc/y). Consider a general observation in which the con-

sumer purchases goods c = m + 1 M with ob-

served (positive) budget shares as

sc

M c=m+1

and

does

not purchase goods c = 1 m with shares as sc = 0

 c = 1 m. For this observation, the demand equa-

tions consist of (a) the stochastic specifications of

observed budget shares of the purchased goods c =

m + 1 M, and (b) the regime conditions of the

nonpurchased goods c = 1 m, which are the con-

ditions that need to be satisfied for their observed

Mehta: A Flexible Yet Globally Regular Multigood Demand System

846

Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

budget shares to be zero. These demand equations

are derived by invoking Roy's identity on the indirect

utility V y

, which yields the optimal budget

shares of all goods as

Sc y

ln V y  - ln V y

/ ln c / ln y

 c = 1 M (1)

In the right-hand side (RHS) of Equation (1), the price

argument of any good i, i, takes the value of its market price pi if good i is purchased and the value of its virtual price Ti (which is treated as an unknown) if good i is not purchased. Thus i = Ti for nonpurchased goods i = 1 m and i = pi for purchased goods i = m + 1 M. The solutions of virtual prices

of nonpurchased goods,

Ti

m i=1

,

are

derived

by

setting

the optimal budget shares of all nonpurchased goods

in Equation (1) to zero, which yields

0=

ln V

Ti

m i=1

pi

M i=m+1

y

/ ln c  c = 1 m (2)

Solving the m equations in (2) yields the solutions

of virtual prices of the nonpurchased goods as func-

tions of the market prices of purchased goods as Tc =

Tc

pi

M i=m+1

y

 c = 1 m. Given the solutions

of the virtual prices, the demand equation of a non-

purchased good c is given as

pc  Tc

pi

M i=m+1

y

 c = 1 m (3)

implying that the virtual price of a nonpurchased good acts as its reservation price. The demand equation of a purchased good c is derived by substituting the virtual prices into the budget share of that purchased good in Equation (1) and setting its optimal budget share as its observed budget share

sc = -

ln V ln V

Ti · Ti ·

m i=1
m i=1

pi

M i=m+1

y

pi

M i=m+1

y

/ ln c / ln y

 c = m + 1 M (4)

This completes the specifications of the demand equa-

tions that follow from the dual approach. These

demand equations will be identical to those derived

from the direct utility maximization approach as long

as there exists a unique direct utility from which the

indirect utility V can be derived, and as long as that

direct utility satisfies the properties of monotonicity,

differentiability, and strict quasiconcavity. For that to

be so, V needs to satisfy the following regularity

properties (Van Soest et al. 1993):

1. V y

should be twice continuously dif-

ferentiable and homogenous of degree zero in the

expenditure y and price arguments .

2. V y

should be increasing in expenditure

y and nonincreasing in price arguments .

3. V y

should be strictly quasiconvex in

the price arguments , which is equivalent to the con-

dition that the M × M Slutsky substitution matrix that

follows from V y

should be negative semi-

definite with a rank of M - 1.

For global regularity, the indirect utility V y

needs to satisfy regularity properties 1­3 at all

feasible values of variables that enter the indirect util-

ity. This consists of all values of expenditures in the

space y  y y > 0 , all values of market prices in

the space

p

pc

M c=1

pc > 0 , and all values of ran-

dom errors in the support, . As to the market prices,

recall that the price argument for any good i, i, in the

indirect utility V y

takes the value of its mar-

ket price pi only if its observed budget share is positive; otherwise it takes the value of its virtual price.

This implies that the expression of the indirect util-

ity (in terms of which variables enter it) can change

depending on the observed values of budget shares.

This in turn implies the following requirement for its

global regularity.

Requirement for Global Regularity: For each vector

of observed budget shares s  s1 s2

sM in the

feasible space,

s

sc

M c=1

M c=1

sc

=1

sc  0

,

the

indirect utility V y

needs to satisfy regularity

properties 1­3 at all corresponding values of y  y,

pc

M c=1



p, and



that satisfy the demand equa-

tions when the observed budget share vector is s 

s1 s2

sM .

I next discuss the Basic Translog utility, and the nec-

essary and sufficient conditions that must be imposed

on its parameters so that it satisfies the above require-

ments of global regularity.

3. Basic Translog Utility
In §3.1, I discuss the variables and parameters in the Basic Translog utility. In §3.2, I lay out the necessary and sufficient conditions for satisfying the requirements for global regularity of the Basic Translog utility as discussed in §2. In §3.3, I compare the proposed approach with the approaches used in the prior literature to address regularity of the Basic Translog utility.

3.1. Parameters and Variables The Basic Translog (indirect) utility with M goods is given as (Christensen et al. 1975)

ln V

¯

= -AT ln ¯

+

1 2

ln

¯

TB

ln

¯

(5)

In Equation (5), A  a1 aM is an M × 1 vector of

parameters, B  bi c is an M × M symmetric matrix

of parameters, ¯  ¯1

¯M is an M × 1 vector of

normalized price arguments of the M goods, in which

the normalized price argument of good i is related to

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

847

its price argument via ¯i = i/y. From the discussion in §2, ¯i takes the value of the normalized market price p¯i (= pi/y) if the observed budget share of good i is positive; otherwise, it takes the value of the nor-

malized virtual price T¯i (= Ti/y). To incorporate randomness, the parameters in the vector A are given

as ac = a^c + c  c = 1

M , where  1

M

are the econometrician's errors with support as 

-

M.

Invoking Roy's identity on Equation (5) yields

the optimal budget share of any good c = 1 M

as Sc ¯ = - ln V ¯ / ln c / ln V ¯ / ln y , in which the (log) marginal utility of price of good c is

given as

ln V ln

¯
c

M
= -ac + bi c ln ¯i
i=1

c=1

M

(6)

and the (log) marginal utility of expenditure is given as

ln V ¯ ln y

M

MM

= ai -

bi m ln ¯i

i=1

m=1 i=1

(7)

Note in Equations (6)­(7) that the budget share of

good c is homogenous of degree zero in the param-

eters. Thus one of the parameters, for example aM , has to be normalized. Although the researcher can

choose any nontrivial normalization for aM , the prior literature has adopted the following condition for

its normalization: aM should be normalized so that Basic Translog utility can nest a homothetic ver-

sion, viz. Homothetic Translog utility, in which the

(log) marginal utility of expenditure always takes a

value of unity. Observe in Equation (7) that the (log)

marginal utility of expenditure takes a value of unity

if the researcher (a) imposes M homothetic restric-

tions,

M i=1

bc

i

=

0

c

=

1

M, and (b) normalizes

the parameter aM as aM = 1 -

M -1 c=1

ac

.

This

implies

the following normalization condition for aM :

Normalization condition: aM should be normalized

so that its normalization reduces to once M homotheticity restrictions,

aM = 1 -

M i=1

bc

i

=

M -1 c=1

ac

0 c =

1 M, are imposed on the parameters.

In the prior literature, two different normalizations

have been used for parameter aM , where both satisfy

the aforementioned normalization condition: aM = 1 -

M -1 c=1

ac

-

M c=1

M i=1

bc

i

(Pollak

and

Wales

1992)

and

aM = 1 -

M -1 c=1

ac

(Christensen

et

al.

1975).

In

this

paper, I choose the normalization for aM that satis-

fies the normalization condition, but is different from

those used in the prior literature. I will discuss the

normalization for aM in §3.2. Although the normalization of aM per se does not impact the flexibility of the Basic Translog utility, the normalization of aM has a strong impact on the extent of restrictions that must

be imposed on the other parameters (which impact

the flexibility of Basic Translog utility) for the Basic

Translog utility to satisfy the regularity properties.

Thus I will use the normalization of aM to my advantage so that I can impose minimal restrictions on other

parameters.

Before I proceed, without loss of generality, I rep-

resent the M × M symmetric matrix B of parameters

in Equation (5) in terms of the following partition,

which will simplify the exposition of requirements for

global regularity of Basic Translog utility as discussed

in §3.2

Z-1

-Z-1

B  - T Z-1 T Z-1 +

(8)

where Z-1 is a symmetric and invertible M - 1 ×

M - 1 matrix, is an M - 1 × 1 vector with ele-

ments as  1 2

M-1 , and is a scalar. Thus

Z-1 represents the elements in the first M - 1 rows

and M - 1 columns of the matrix B, -Z-1 represents

the first M - 1 elements in the Mth column of the

matrix B, and T Z-1 + represents the element in the

Mth column and Mth row of the matrix B.

This completes the discussion on the parameters

and variables in the Basic Translog utility. I next

discuss the necessary and sufficient conditions that

must be imposed on the parameters so that the

Basic Translog utility satisfies the regularity proper-

ties stated in §2.

3.2. Necessary and Sufficient Conditions for Global Regularity
I start with the following proposition which states the necessary and sufficient conditions required for satisfying regularity properties in the entire feasible space of the variables.

Proposition 1 (Global Regularity). For the given parameterization of matrix B in Equation (8), the neces-

sary and sufficient conditions that need to be imposed on

parameters of Basic Translog utility so that it satisfies all of

the regularity properties stated in §2 in the entire feasible

space of variables are: (a) the M - 1 × M - 1 matrix

Z is positive definite, (b) = 0, (c) the M - 1 × 1 vec-

tor > 0 (i.e., c > 0  c = 1

-

M -1 c=1

c ac .

M - 1), and (d) aM >

Proof. See §1 of the Web Appendix (available as

supplemental material at http://dx.doi.org/10.1287/

mksc.2015.0908).

Observe that condition (d) requires aM to satisfy the

inequality: aM > -

M -1 c=1

cac. Next, recall that aM can-

not be identified and must be normalized per the nor-

malization condition stated in §3.1. This implies that

I can use the normalization of aM to my advantage so that it not only satisfies the normalization condition

Mehta: A Flexible Yet Globally Regular Multigood Demand System

848

Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

in §3.1 but also results in condition (d) of Proposition 1 being always satisfied. Such a normalization of aM is given by the following corollary:

Corollary 1. A convenient normalization of aM that

satisfies condition (d) in Proposition 1 along with the nor-

malization condition given in §3.1 is aM = 1 -

M -1 c=1

c ac .

Proof. See §1 of the Web Appendix.

The normalization for aM given in the corollary imposes minimal restrictions on other parameters to

satisfy the regularity properties. If the researcher nor-

malizes aM in any other way, he will impose stronger restrictions on other parameters. For instance, con-

sider the case wherein the researcher uses the normal-

ization used in prior literature, aM = 1 -

M -1 c=1

ac .

Sub-

stituting this normalization value into condition (d)

of Proposition 1 yields the following inequality that

must be satisfied: 1+

M -1 c=1

c - 1 ac > 0. This inequal-

ity will only be satisfied for all values of random

parameters

ac

M -1 c=1

in

the

support

-

M-1 if

the researcher imposes the restrictions: c = 1  c =

1 M - 1. Observe that these are more restrictive

than those stated in condition (c) in Proposition 1,

which requires c > 0  c = 1 M - 1. This completes the discussion of necessary and suf-

ficient conditions. Note that the necessary and suffi-

cient conditions stated in Proposition 1 follow from

the specific parameterization of the M × M matrix B

given in Equation (8).

A natural question that follows is whether the

researcher would obtain the same necessary and suf-

ficient conditions if he were to start from a parametric

representation of the matrix B that is different from

the one assumed in Equation (8)? I have addressed

this in §2 of the Web Appendix, where I first state and

prove the general necessary and sufficient conditions

(i.e., the necessary and sufficient conditions that fol-

low from a general representation of the matrix B),2

and then show that all M × M matrices B that satisfy

the general necessary and sufficient conditions can be

represented in terms of the specific parameterization

of B in Equation (8) with the necessary and sufficient

conditions (as stated in Proposition 1) imposed on it.

This implies that the specific parameterization of B in

Equation (8) with the necessary and sufficient condi-

tions imposed on it covers all possible representations

of B that satisfy the general necessary and sufficient

conditions.

2 The general necessary and sufficient conditions are that: (i) All

principal M - 1 × M - 1 submatrices of B are positive defi-

nite, (ii) the determinant of B is zero, (iii) all of the elements in

the M × M cofactor matrix of B, i.e., F  fi c , are positive, and

(iv)

M c=1

fc

M ac

> 0.

3.3. Comparison with the Approaches Used in

Prior Literature

I compare the necessary and sufficient conditions for

global regularity stated in Proposition 1 with three

approaches used in the prior literature to address the

regularity of Basic Translog utility. These approaches

were proposed by Jorgensen and Fraumeni (1981),

Van Soest and Kooreman (1990), and Mehta and Ma

(2012), respectively. Jorgensen and Fraumeni (1981)

imposed the following set of conditions on the param-

eters of Basic Translog utility:

(a) The matrix B is positive semi-definite with all of

its principal submatrices being positive definite, and

M i=1

bc

i

=

0

c

=1

M. These restrictions can be

translated in terms of our block-wise representation

of B as: {Z is positive definite, = 0, and c = 1  c = 1 M - 1}.

(b) The parameter aM is normalized as aM = 1 -

M -1 c=1

ac

.

Conditions (a)­(b) represent the set of "sufficient

conditions" that ensure global regularity of Basic

Translog utility, and have been most widely used

in the literature. They are more restrictive on the

parameter space compared with the conditions in

Proposition 1 because, unlike the conditions in Propo-

sition 1 in which all elements in the M - 1 × 1

vector are restricted to be positive, all elements in

are restricted to be unity in condition (a). Con-

ditions (a)­(b) result in the Basic Translog utility to

reduce to the Homothetic Translog utility discussed in

§3.1. To see why, recall that aM is normalized as aM =

1-

M -1 c=1

ac

,

restricted as

and that the parameters in matrix B are

M i=1

bc

i

=

0

c

=

1

M in the Homo-

thetic Translog utility. Observe that these parameters

are reflected in conditions (a)­(b).

Van Soest and Kooreman (1990) imposed the fol-

lowing conditions on parameters of Basic Translog

utility: (a) matrix B is positive definite, (b)

M c=1

bi

c

0

i = 1

M, (c) 1 -

M i=1

M c=1

bi

c ln p¯i

> 0, and

(d) aM is normalized as aM = 1 -

M -1 c=1

ac

.

There

are

three key differences between the conditions stated

in Proposition 1 and conditions (a)­(d): First, condi-

tions (a)­(d) represent a set of sufficient conditions

that ensure regularity of Basic Translog utility. Sec-

ond, conditions (a)­(d) do not ensure global regu-

larity. Instead, they ensure regularity in a restricted

space of expenditure and market prices given in con-

dition (c). Third, conditions (b) and (c) are difficult

to impose a priori while estimating the model. This

is because condition (b) consists of a complex set of

inequalities, and condition (c) consists of parameters

and regressors. The only way to impose condition (c)

is to have a 0­1 indicator term in the likelihood, which

takes a value of zero if condition (c) is not satisfied.

However this results in discontinuities in the likeli-

hood, making it difficult to maximize.

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

849

Finally, Mehta and Ma (2012) imposed the follow-

ing conditions on the Basic Translog utility: (a) the

matrix B is generated as a product of two Choleskies

when the diagonal element of Cholesky correspond-

ing to the Mth good is zero, and (b) aM is normalized

as aM = 1 -

M -1 c=1

ac

.

Unlike

the

conditions

stated

in

Proposition 1, conditions (a)­(b) do not ensure global

regularity of the Basic Translog utility. Recall from §1

that estimating a flexible functional form without a

priori imposing restrictions of global regularity car-

ries the risk of coherency problems. Thus, to ensure

that their model does not suffer from these problems,

Mehta and Ma (2012) ex-post determined whether at

the estimated values of parameters, the Basic Translog

utility satisfies regularity properties at all observa-

tions in the data. Although they found that this was

indeed the case, their ex-post approach is not ideal.

This is because if the estimates are such that regularity

properties are violated at even one observation in the

data, there is the potential for coherency problems.3

4. Implications on Flexibility
Because the necessary and sufficient conditions stated in Proposition 1 restrict the parameter space of the Basic Translog utility, I identify the restrictions on the demand elasticities imposed by these conditions. I focus on cross-price and expenditure elasticities, and not the own-price elasticities. This is because in any demand system with M goods, the M own-price elasticities can be determined from the M × M - 1 cross-price elasticities. The expenditure elasticity of any good i is ln qi/ ln y, where a positive (negative) value implies that good i is a normal (inferior) good. The cross-price elasticity is Ei j = ln qi/ ln pj , where a positive (negative) value implies that the goods i and j are substitutes (i.e., complements). The restrictions on the demand elasticities imposed by the necessary and sufficient conditions are summarized in the following proposition.
Proposition 2. As a result of the necessary and sufficient conditions stated in Proposition 1, the Basic Translog utility imposes the following restrictions on elasticities: Out of the total of M × M - 1 cross-price elasticities across M goods, at least two of those elasticities must be positive.

3 In the approach used by Mehta and Ma (2012), the parameters do not converge if the iterative values of the parameters stray into the incoherent region. There are two possible reasons for this. First, the likelihood becomes invalid when the iterative values of the parameters stray outside the coherent region, implying that the objective function that is being maximized is no longer the likelihood. Second, if the regularity properties are not satisfied (specifically, quasiconcavity), the objective function is no longer smooth, which makes it very difficult to maximize.

Proof. See §1 of the Web Appendix.

I next compare the restrictions on elasticities stated

in Proposition 2 with those imposed by two alter-

natives most frequently used in prior literature. The

first is the Homothetic Translog utility, which is the

Basic Translog utility in which the researcher imposes

sufficient conditions for global regularity as proposed

by Jorgensen and Fraumeni. These sufficient condi-

tions have been used almost universally in papers

that have used Basic Translog utility (e.g., Lee and Pitt

1987, Chiang 1991, Song and Chintagunta 2007). The

second alternative is the Linear Expenditure System

(LES) used by Chintagunta (1993), Kao et al. (2001)

and Du and Kamakura (2008). It is an additively sepa-

rable direct utility given by U =

M i=1

ai

ln

qi - bi

and

is globally regular as long as bi < 0 and ai > 0  i =

1 M. The restrictions on elasticities imposed by

these two alternatives are summarized in the follow-

ing two propositions.

Proposition 3. The Homothetic Translog utility imposes the following restrictions on elasticities:
(1) The expenditure elasticity of any good i is always equal to one.
(2) The cross-price elasticities between goods i and j are restricted by sj Ei j = siEj i. Thus, if the budget shares of goods i and j are equal, their cross-price elasticities will be symmetric.
(3) Out of the total of M × M - 1 cross-price elasticities, at least 2 × M - 1 cross price elasticities must be positive. This implies that at least M - 1 pairs of goods are substitutes for each other.
Proof. See §1 of the Web Appendix.

Proposition 4. The LES utility imposes the following restrictions on elasticities of M goods:
(1) The expenditure elasticities are all positive, which implies that inferior goods are not allowed.
(2) All of the M × M - 1 cross-price elasticities are positive. This implies that all pairs of goods are restricted to be substitutes for each other.
Proof. See §1 of the Web Appendix.
Observe that the Basic Translog utility with necessary and sufficient conditions imposes much fewer restrictions on demand elasticities compared to Homothetic Translog and LES utilities. This implies that if the true demand elasticities in the data lie outside the restricted space of elasticities given in Propositions 3 and 4, then the Basic Translog utility with necessary and sufficient conditions should be better at capturing the true demand elasticities, compared to Homothetic Translog and LES utilities. I will investigate this issue in §5 using both simulated and scanner data.

850

5. Empirical Implementation
I first discuss the operationalization of parameters in the Basic Translog utility with the necessary and sufficient conditions imposed on its parameter space, as stated in Proposition 1. I then specify the demand equations and the likelihood. Finally, I discuss the empirical results.

5.1. Operationalization of Parameters in the

Basic Translog Utility

Recall that the parameters in Basic Translog utility

are those in the M × M matrix B  bc j and the

M × 1 vector A  a1 a2

aM . I start with the oper-

ationalization of parameters in matrix B. Equation (8)

yields the following expression for B after imposing

the restrictions in Proposition 1:

Z-1

-Z-1

B  - T Z-1 T Z-1

(9)

Because the M -1 × M -1 matrix Z is symmet-

ric and positive definite, I generate it as a product

of two Cholesky matrices as Z = CZ CZ T , where CZ is a M -1 × M -1 Cholesky matrix with ele-

ments as ciz j , and the diagonal elements are nonzero. Since all elements of the M -1 ×1 vector 

12

M-1 are positive, I generate it as =exp ,

where  1 2

M-1 is an M -1 ×1 vector.

Moving on to the parameters in the vector A 

a1 a2 aM , recall that ac was specified as ac = a^c + c in which a^c is the deterministic component and c is the econometrician's error. Because aM is normalized, I focus on operationalization of first M -1 elements of

the vector A. I define the following M -1 ×1 vectors:

A -M  a1

aM-1 , A^ -M  a^1

a^M-1 , and -M 

1

M-1 , where A -M = A^ -M + -M . I represent

the M -1 ×1 vector of the random elements -M in

terms of the following transformation:

-M  Z-1

(10)

where  1

M-1 is an M - 1 × 1 vector

of the (transformed) econometrician's errors that are

independent and identically distributed (i.i.d.) across

observations. I assume these to be multivariate nor-

mally distributed as  N 0 -1 . I generate as a

product of two Cholesky matrices as = C C T ,

where C is a Cholesky matrix with elements as ci j . Similarly, I represent the M - 1 × 1 vector of deter-

ministic components A^ -M as

A^ -M  Z-1

(11)

where  1 2

M-1 is an M - 1 × 1 vector

of parameters. From Equations (10) and (11), I thus

obtain the M - 1 × 1 vector of the random parame-

ters, A -M  a1 a2

aM-1 , as A -M  Z-1 + .

Finally, since the parameter aM is normalized as per

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

the corollary to Proposition 1 as aM = 1 -

M -1 i=1

i ai ,

I obtain the expression for aM from Equations (10)

and (11) as aM = 1 - T Z-1 + . This completes

the operationalization of the parameters. To sum-

marize, there are M + 2 × M - 1 parameters:

(i) M × M - 1 /2 parameters in the Cholesky CZ,

which generate the matrix Z, (ii) M - 1 parameters

in the vector  1

M-1 , which generate the

vector  1

M-1 , (iii) M - 1 parameters in

the vector  1

M-1 , and (iv) M × M - 1 /2

parameters in the Cholesky C , which generates the

covariance matrix of econometrician's errors, -1.

5.2. Demand Equations and the Likelihood

I now specify the demand equations and observa-

tion likelihood for the general observation discussed

in §2 in which the consumer purchases goods c =

m + 1 M with observed positive budget shares as

sm+1 sm+2

sM and does not purchase goods c =

1 m with observed budget shares as sc = 0  c =

1 m.

To do so I define the following terms. I partition the

M × 1 vector of normalized market prices of the M

goods along the nonpurchased and purchased goods

as P¯  P¯I P¯II p¯M , where P¯I  p¯1 p¯2

p¯m is a vec-

tor of the normalized market prices of nonpurchased

goods, P¯II  p¯m+1 p¯m+2

p¯M-1 is a vector of the

normalized market prices of purchased goods c =

m + 1 M - 1, and p¯M is the normalized market price of purchased good M. Similarly, I partition the

M - 1 × 1 vector , the M - 1 × M - 1 matrix Z,

the M - 1 × 1 vector , and the M - 1 × 1 vector

of errors along the nonpurchased and purchased

goods as: (a)  I II , where I  1

II  m+1

M-1 ; (b)

m and

Z

ZI ZITII

ZIII ZII

where ZI is an m × m matrix, ZII is an M - m - 1 ×

M - m - 1 matrix, and ZIII is the off diagonal m ×

M - m - 1 matrix; (c)  I II , where I 

1

m and II  m+1

M-1 ; and (d) 

I II , where I  1

m and II  m+1

M-1 .

Given these partitions, the specifications of demand

equations can be derived by following the steps

detailed in Equations (1)­(4) in §2. This yields the

demand equations for the purchased goods c = m +

1 M - 1 in vector form as

ZII sII

II = 1 - eITI -

T II

sII

-

II + ln P¯II -

II ln p¯M

(12)

where eII is an M - m - 1 × 1 vector of ones and

sII  sm+1

sM-1 is an M - m - 1 × 1 vector of

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

851

observed budget shares of purchased goods. I get the demand equations of nonpurchased goods as

ZIII sII

I  1 - eITI -

T II

sII

-

I + ln P¯I -

I ln p¯M

(13)

From the demand equations in (12) and (13), I next

specify the observational likelihood. Let f II

II be the

joint marginal density of errors II  m+1

M -1 ],

and let F I II

I

II be the joint c.d.f. of errors I 

1

m conditional on II. From (12) and (13),

I get the observational likelihood as

L

sc = 0

m c=1

sII =

sc

M -1 c=m+1

= ZII ×

1-

eITI -

T II

sII

m-M

×f II

ZII sII

1- eITI -

T II

sII -

II +lnP¯II -

II lnp¯M

×F I

II

ZIII sII

1- eITI -

T II

sII -

I +lnP¯I -

I lnp¯M

II

ZII sII

= 1-

eITI -

T II

sII -

II +lnP¯II -

II lnp¯M

(14)

To fully specify the observational likelihood, recall
that the M - 1 × 1 vector of the econometrician's
errors,  I II , is multivariate normally distributed as  N 0 -1 . Represent the inverse of the
covariance matrix as

I

III

T

III

II

where I is an m × m matrix, II is a M - m - 1 × M - m - 1 matrix, and III is the off diagonal matrix. This yields the marginal joint density of the errors II as

f II

II = 2

1
M-m-1 /2

II -

T III

-1 I

1/2 III

· exp

-

T II

II -

T III

-1 I

III

2

II

(15)

The joint c.d.f. of the errors I conditional on II as

F I II I II

1 = ^I I 2 m/2

1/2 I

· exp

-

^I -

-1 I

III

T II I
2

^I -

-1 I

III

II

d ^I

(16)

Substituting f II

II

and F I II

I

II into Equa-

tion (14) yields the observational likelihood. The inte-

gral in Equation (16) is computed by using the GHK

simulator with R = 300 random draws.

5.3. Simulated Data I use simulated data to achieve two objectives. The first is the empirical counterpart of §4, which is to investigate whether and to what extent the Basic Translog utility with necessary and sufficient conditions is better at capturing the true elasticities in the data, compared to Homothetic Translog and LES utilities. For this, I simulate three data sets with M = 4 goods using a direct quadratic utility. In data set 1, most pairs are complements. In data set 2, one of the goods is inferior and cross-price effects are asymmetric. In data set 3, all pairs are substitutes. The second objective is to examine the efficacies of the three utilities in capturing the true elasticities over two additional facets of the data: number of goods and number of zero purchases. For this, I simulate data sets 4 and 5 using the quadratic utility. These are similar to data set 3 in the sense that all pairs are substitutes. The difference is that these data sets have M = 6 goods and data set 5 has a larger number of zero purchases compared to data set 4. The quadratic utility used for simulating data sets 1­5 is given as

M

MM

U

qi

M i=1

=

i qi

-

1 2

i kqiqk

i=1

i=1 k=1

(17)

In Equation (17), the M × M matrix of parameters

 i k is symmetric and positive definite. Because the quadratic utility is homogenous of degree zero

in the parameters, one of the parameters, M , needs to be normalized. The randomness is incorporated

through the first M - 1 parameters of the vector 

1

M-1 M as i = ¯i + i  i = 1

M - 1,

where

¯i

M -1 i=1

are

the

intercepts

and

i

M -1 i=1

are

the

random errors, which are assumed to be multivariate

normally distributed as

i

M -1 i=1



N

0

.

I chose the quadratic utility to simulate the data

sets because it is flexible. However, the issue with the

quadratic utility is that it does not satisfy global reg-

ularity even in a restricted space of its parameters.

Instead, as discussed in Van Soest et al. (1993), it sat-

isfies the regularity properties in a restricted space of

the normalized market prices of M goods given by

M

>

max
i=1 M

i M /p¯i

(18)

Because the parameter M has to be normalized, its value is set so that the condition in Equation (18) is satisfied for all values of normalized prices simulated in the five data sets. This ensures that the regularity properties will be satisfied for all observations in the simulated data sets.
The true parameters of the quadratic utility as well as the distributions of normalized prices of the M goods used for simulating data sets 1­5 are given in §3 of the Web Appendix. All data sets consist

Mehta: A Flexible Yet Globally Regular Multigood Demand System

852

Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

Table 1 Summary Statistics of the Five Simulated Data Sets

Data set 1 (M = 4 goods)

Data set 2 (M = 4 goods)

Data set 3 (M = 4 goods)

Data set 4 (M = 6 goods)

Data set 5 (M = 6 goods)

Good 1 Good 2 Good 3 Good 4 Good 5
0 corners 1 corner 2 corners 3 corners 4 corners 5 corners

4,230 (0.077) 4,267 (0.077) 4,239 (0.077)
3,295 1,229 393
83

3,018 (0.066) 2,976 (0.067) 2,945 (0.065)

Panel A 3,210 (0.111) 4,205 (0.103) 4,196 (0.103)

599 2,757 1,639
5

Panel B

1,949 2,713 338
0

4,252 (0.057) 4,228 (0.056) 4,270 (0.057) 4,284 (0.057) 4,224 (0.055)
1,940 2,425 608
27 0 0

2,145 (0.014) 2,154 (0.014) 2,179 (0.014) 2,160 (0.014) 2,087 (0.013)
11 198 1,280 2,536 966 9

Notes. Panel A reports the number of observations in which each good is consumed, with the average budget share of each good in parentheses. Panel B breaks down the sample by number of nonconsumed goods.

of 5,000 observations and are constructed similar to

those in marketing in which the Mth good is the out-

side/composite good that is always purchased and

has a disproportionately high budget share. The sum-

mary statistics of data sets 1­5 are given in Table 1.

I estimate three models on each data set: (a) Model I,

with the Basic Translog utility with necessary and

sufficient conditions for global regularity imposed on

its parameters; (b) Model II, with the Homothetic

Translog utility; (c) Model III, with the LES utility.

As discussed in §4, the LES utility is given as U =

M i=1

ai

ln

qi - bi

which is globally regular as long as

the parameters bi < 0 and ai > 0  i = 1 M. I thus

operationalize the parameters bi and ai as

bi = - exp i and ai = exp i + i

(19)

where i is the econometrician's error for good i. For identification, the parameter M and the error M are normalized to zero. The M - 1 × 1 vector of econo-

metrician's errors  1

M-1 is assumed to be

multivariate normally distributed as  N 0 -1 ,

where is the inverse of the covariance matrix.

The parameter estimates of Models I­III for all five

data sets are given in §3 of the Web Appendix. The log

likelihoods and Bayesian information criteria (BIC) of

the three models for all five data sets are given in

Table 2. Model I outperforms Models II and III in terms of both the log likelihood and the BIC in all five data sets. However, the extent to which Model I outperforms Models II and III decreases from data set 4 to 5. This implies that, although Model I yields a higher log likelihood compared with Models II and III, its relative superiority decreases as the fraction of zero purchases is increased in the data.
I next discuss the extent to which Models I­III can accurately capture the true demand elasticities in each data set. The true demand elasticities are calculated in terms of percentage change in expected purchase quantities of all goods at the true values of parameters in the quadratic utility.
Data set 1 (Complements): The true demand elasticities for this data set are given in Table 3(A). The true pairwise cross elasticities are -0 608 between goods i = 1 3 which implies price complementarity. The true expenditure elasticity of each good i = 1 3 is 1.852. The elasticities predicted by Models I­III are reported in Tables 3(B)­3(D). All predicted elasticities of Model I are similar to the corresponding true elasticities. Model II's predicted cross elasticities between goods i = 1 3 range between -0 402 to -0 423, which implies that Homothetic Translog utility underestimates the extent of complementarity. Also, its

Table 2 Goodness of Fit Tests for Simulated Data Sets 1­5

Log likelihood (BIC)

Model I

Model II

Data set 1 Data set 2 Data set 3 Data set 4 Data set 5

19 519 0 (-38,884.7) 15 788 5 (-31,423.7) 10 435 1 (-20,716.8) 35 939 4 (-71,538.1) 13 326 7 (-26,312.7)

19 431 8 (-38,735.7) 15 691 1 (-31,254.5) 10 204 5 (-20,281.2) 35 794 0 (-71,289.8) 13 289 8 (-26,281.5)

Model III
19 439 8 (-38,768.9) 14 986 9 (-29,861.2)
9 610 0 (-19,109.3) 34 933 6 (-69,645.7) 12 990 8 (-25,760.2)

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

Table 3(A) True Price and Expenditure Elasticities for Simulated Data Set 1

Expected quantity of

Good 1

Good 2

Good 3

Price of Good 1 Good 2 Good 3 Good 4
Expenditure

-2 425 -0 608 -0 608
1 789
1 852

-0 608 -2 425 -0 608
1 789
1 852

-0 608 -0 608 -2 425
1 789
1 852

853
Good 4
0 272 0 272 0 272 -1 561 0 745

Table 3(B)

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 1 Predicted by Model I

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Price of Good 1 Good 2 Good 3 Good 4
Expenditure

-2 369 (0.031) -0 596 (0.023) -0 612 (0.024)
1 851 (0.042)
1 726 (0.069)

-0 597 (0.024) -2 365 (0.031) -0 609 (0.029)
1 807 (0.049)
1 764 (0.068)

-0 600 (0.022) -0 592 (0.022) -2 406 (0.030)
1 850 (0.050)
1 747 (0.066)

0 228 (0.005) 0 225 (0.005) 0 232 (0.005) -1 498 (0.010)
0 812 (0.014)

Table 3(C)

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 1 Predicted by Model II

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Price of Good 1 Good 2 Good 3 Good 4
Expenditure

-2 197 (0.027) -0 408 (0.018) -0 423 (0.019)
2 028 (0.046)
1

-0 404 (0.018) -2 169 (0.026) -0 413 (0.018)
1 986 (0.044)
1

-0 411 (0.019) -0 402 (0.018) -2 227 (0.025)
2 040 (0.042)
1

0 178 (0.004) 0 177 (0.003) 0 187 (0.003) -1 542 (0.009)
1

Table 3(D)
Price of Good 1 Good 2 Good 3 Good 4
Expenditure

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 1 Predicted by Model III

Expected quantity of

Good 1

Good 2

Good 3

Good 4

-2 132 (0.021) 0 041 (0.003) 0 043 (0.003) 1 595 (0.004)
1 547 (0.031)

0 041 (0.003) -2 114 (0.024)
0 043 (0.003) 1 582 (0.040)
1 551 (0.031)

0 042 (0.003) 0 042 (0.003) -2 152 (0.021) 1 611 (0.041)
1 542 (0.031)

0 105 (0.002) 0 103 (0.002) 0 109 (0.002) -1 483 (0.012)
0 834 (0.001)

expenditure elasticities are equal to one, which are significantly different from the true expenditure elasticities. The reason for this follows from result 1 in Proposition 3. As to Model III, it yields positive crossprice elasticities between all goods, which shows that it cannot capture complementarity. The reason for this follows from result 2 in Proposition 4.

Data set 2 (Inferiority and Asymmetry): The true demand elasticities are given in Table 4(A). The true expenditure elasticities of goods 1­3 are -0 298, 1.644, and 1.644, implying that good 1 is inferior. Furthermore, the true cross-price elasticities between goods 1 and 2 (which are E1 2 = 1 59 and E2 1 = 1 33), and between goods 1 and 3 (which are E1 3 = 1 59 and

Mehta: A Flexible Yet Globally Regular Multigood Demand System

854

Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

Table 4(A) True Price and Expenditure Elasticities for Simulated Data Set 2

Expected quantity of

Good 1

Good 2

Good 3

Price of Good 1 Good 2 Good 3 Good 4
Expenditure

-4 619 1 591 1 591 1 735
-0 298

1 337 -2 728
0 658 0 405
1 644

1 337 0 658 -2 728 0 405
1 644

Good 4
0 149 0 138 0 138 -1 423 0 998

Table 4(B)

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 2 Predicted by Model I

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Price of Good 1 Good 2 Good 3 Good 4
Expenditure

-4 430 (0.064) 1 496 (0.034) 1 473 (0.037) 1 670 (0.070)
-0 210 (0.095)

1 247 (0.025) -2 631 (0.025)
0 589 (0.018) 0 417 (0.038)
1 556 (0.054)

1 216 (0.025) 0 579 (0.018) -2 669 (0.025) 0 496 (0.039)
1 526 (0.051)

0 150 (0.004) 0 110 (0.004) 0 109 (0.004) -1 370 (0.005)
1 000 (0.007)

Table 4(C)

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 2 Predicted by Model II

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Price of Good 1 Good 2 Good 3 Good 4
Expenditure

-3 953 (0.056) 1 242 (0.032) 1 223 (0.033) 0 508 (0.025)
1

1 184 (0.028) -2 497 (0.026)
0 494 (0.017) 0 802 (0.020)
1

1 153 (0.030) 0 487 (0.017) -2 528 (0.026) 0 858 (0.018)
1

0 087 (0.004) 0 114 (0.003) 0 123 (0.003) -1 325 (0.004)
1

Table 4(D)
Price of Good 1 Good 2 Good 3 Good 4
Expenditure

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 2 Predicted by Model III

Expected quantity of

Good 1

Good 2

Good 3

Good 4

-2 805 (0.061) 0 239 (0.013) 0 251 (0.017) 0 750 (0.027)
1 574 (0.066)

0 266 (0.015) -2 325 (0.050)
0 207 (0.011) 0 594 (0.021)
1 258 (0.034)

0 271 (0.015) 0 201 (0.010) -2 349 (0.042) 0 602 (0.021)
1 275 (0.031)

0 191 (0.004) 0 130 (0.002) 0 136 (0.003) -1 291 (0.006)
0 844 (0.006)

E3 1 = 1 33) are asymmetric. The elasticities predicted by Models I­III are reported in Tables 4(B)­4(D). All predicted elasticities of Model I are similar to the true elasticities. As to Model II, all expenditure elasticities are one, which are significantly different from the true expenditure elasticities. Furthermore, its predicted cross elasticities between goods 1 and 2 (and between goods 1 and 3) are not significantly different from each other, implying that they are symmetric.

The reason for this follows from result 2 in Proposition 5. As to Model III, all of its expenditure elasticities are positive, which shows that LES utility cannot capture inferiority. The reason for this follows from result 1 in Proposition 4.
Data sets 3­5 (Substitutes): Starting with data set 3, the true demand elasticities are given in Table 5(A). The true cross-price elasticity between goods i = 1 3 is 1.266 (implying substitutability), and the

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

Table 5(A) True Price and Expenditure Elasticities for Simulated Data Set 3

Expected quantity of

Good 1

Good 2

Good 3

Price of Good 1 Good 2 Good 3 Good 4
Expenditure

-4 770 1 266 1 266 0 564
1 674

1 266 -4 770
1 266 0 564
1 674

1 266 1 266 -4 770 0 564
1 674

855
Good 4
0 099 0 099 0 099 -1 136 0 838

Table 5(B)

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 3 Predicted by Model I

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Price of Good 1 Good 2 Good 3 Good 4
Expenditure

-4 525 (0.055) 1 240 (0.040) 1 206 (0.045) 0 457 (0.077)
1 620 (0.097)

1 189 (0.041) -4 557 (0.066)
1 290 (0.050) 0 357 (0.073)
1 766 (0.089)

1 167 (0.041) 1 242 (0.047) -4 552 (0.066) 0 515 (0.078)
1 628 (0.096)

0 086 (0.003) 0 087 (0.003) 0 085 (0.003) -1 023 (0.003)
0 845 (0.006)

Table 5(C)

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 3 Predicted by Model II

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Price of Good 1 Good 2 Good 3 Good 4
Expenditure

-4 074 (0.062) 1 248 (0.045) 1 225 (0.047) 0 606 (0.030)
1

1 205 (0.045) -4 107 (0.064)
1 330 (0.045) 0 577 (0.030)
1

1 187 (0.045) 1 270 (0.045) -4 092 (0.064) 0 638 (0.030)
1

0 054 (0.002) 0 046 (0.002) 0 042 (0.002) -1 143 (0.003)
1

Table 5(D)
Price of Good 1 Good 2 Good 3 Good 4
Expenditure

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 3 Predicted by Model III

Expected quantity of

Good 1

Good 2

Good 3

Good 4

-3 824 (0.094) 0 503 (0.016) 0 508 (0.015) 0 242 (0.018)
2 571 (0.042)

0 527 (0.017) -3 991 (0.070)
0 529 (0.016) 0 253 (0.018)
2 682 (0.042)

0 534 (0.016) 0 528 (0.014) -4 041 (0.062) 0 257 (0.019)
2 722 (0.042)

0 139 (0.003) 0 138 (0.002) 0 140 (0.003) -1 055 (0.004)
0 739 (0.004)

true expenditure elasticity of each good i = 1 3 is 1.674. The elasticities predicted by Models I­III are reported in Tables 5(B)­5(D). Starting with Model I, all of its predicted elasticities are similar to the true elasticities. For Model II, its expenditure elasticities of all goods are equal to one; this is significantly different from the true expenditure elasticities. For Model III, its cross-price elasticities between goods i = 1 3 are positive, but significantly smaller than the true cross-price elasticities. This is because Model III is

based on the additively separable LES utility. In additively separable direct utilities, a price change in good i impacts the quantity of any other good only through the budget constraint. If good i has a small budget share, a change in the price of good i will not have a strong impact on the budget left for other goods. As a result, it will not have a strong impact on the quantities of other goods. Because budget shares of goods 1­3 are small, the result follows.

Mehta: A Flexible Yet Globally Regular Multigood Demand System

856

Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

Table 6(A) True Price and Expenditure Elasticities for Simulated Data Set 4

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Price of Good 1 Good 2 Good 3 Good 4 Good 5 Good 6
Expenditure

-2 994 0 420 0 420 0 420 0 420 0 799
0 513

0 420 -2 994
0 420 0 420 0 420 0 799
0 513

0 420 0 420 -2 994 0 420 0 420 0 799
0 513

0 420 0 420 0 420 -2 994 0 420 0 799
0 513

Good 5
0 420 0 420 0 420 0 420 -2 994 0 799 0 513

Good 6
0 024 0 024 0 024 0 024 0 024 -1 316 1 124

Table 6(B) Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 4 Predicted by Model I

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Good 5

Good 6

Price of Good 1 Good 2 Good 3 Good 4 Good 5 Good 6
Expenditure

-3 097 (0.109) 0 441 (0.066) 0 525 (0.068) 0 438 (0.069) 0 408 (0.060) 0 735 (0.102)
0 549 (0.147)

0 385 (0.070) -3 252 (0.113)
0 556 (0.083) 0 393 (0.056) 0 527 (0.074) 0 810 (0.101)
0 579 (0.130)

0 466 (0.057) 0 455 (0.086) -3 065 (0.100) 0 370 (0.076) 0 379 (0.083) 0 820 (0.092)
0 574 (0.111)

0 472 (0.074) 0 399 (0.057) 0 345 (0.071) -3 009 (0.099) 0 410 (0.071) 0 838 (0.083)
0 544 (0.112)

0 459 (0.065) 0 547 (0.066) 0 283 (0.083) 0 501 (0.078) -3 220 (0.083) 0 835 (0.078)
0 594 (0.109)

0 025 (0.003) 0 032 (0.004) 0 027 (0.004) 0 024 (0.004) 0 038 (0.004) -1 317 (0.006)
0 884 (0.011)

Table 6(C) Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 4 Predicted by Model II

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Good 5

Good 6

Price of Good 1 Good 2 Good 3 Good 4 Good 5 Good 6
Expenditure

-3 163 (0.077) 0 256 (0.069) 0 430 (0.051) 0 390 (0.072) 0 362 (0.068) 0 725 (0.050)
1

0 304 (0.078) -3 334 (0.106)
0 469 (0.079) 0 318 (0.059) 0 525 (0.069) 0 720 (0.056)
1

0 467 (0.054) 0 479 (0.078) -3 140 (0.082) 0 282 (0.062) 0 257 (0.067) 0 659 (0.042)
1

0 408 (0.074) 0 313 (0.062) 0 244 (0.059) -3 168 (0.112) 0 427 (0.047) 0 777 (0.056)
1

0 381 (0.071) 0 514 (0.069) 0 230 (0.065) 0 429 (0.049) -3 391 (0.076) 0 841 (0.039)
1

0 058 (0.004) 0 056 (0.004) 0 057 (0.003) 0 062 (0.004) 0 059 (0.003) -1 293 (0.005)
1

Table 6(D)
Price of Good 1 Good 2 Good 3 Good 4 Good 5 Good 6
Expenditure

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 4 Predicted by Model III

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Good 5

Good 6

-3 395 (0.073) 0 245 (0.009) 0 241 (0.009) 0 244 (0.010) 0 250 (0.010) 0 722 (0.015)
1 692 (0.040)

0 248 (0.009) -3 323 (0.070)
0 236 (0.007) 0 239 (0.009) 0 245 (0.107) 0 706 (0.021)
1 649 (0.037)

0 245 (0.010) 0 236 (0.007) -3 274 (0.056) 0 234 (0.010) 0 240 (0.098) 0 695 (0.014)
1 623 (0.030)

0 252 (0.010) 0 243 (0.009) 0 237 (0.008) -3 372 (0.072) 0 249 (0.094) 0 716 (0.021)
1 673 (0.036)

0 259 (0.011) 0 249 (0.009) 0 244 (0.009) 0 248 (0.009) -3 452 (0.142) 0 734 (0.022)
1 716 (0.043)

0 112 (0.003) 0 108 (0.004) 0 106 (0.003) 0 107 (0.003) 0 110 (0.004) -1 281 (0.005)
0 836 (0.005)

I finally discuss data sets 4 and 5, where both data sets have M = 6 goods and data set 5 has a larger number of zero purchases compared to data set 4. The true demand elasticities for these two data sets are given in Tables 6 and 7. The elasticities pre-

dicted by Models I­III for data set 4 are reported in Tables 6(B)­6(D), and for data set 5, in Tables 7(B)­7(D). The pattern of results in both data sets 4 and 5 is the same as that in data set 3. This suggests that the efficacy of Model I in capturing the true elasticities is robust

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

Table 7(A) True Price and Expenditure Elasticities for Simulated Data Set 5

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Price of Good 1 Good 2 Good 3 Good 4 Good 5 Good 6
Expenditure

-5 214 0 458 0 458 0 458 0 458 1 781
1 601

0 458 -5 214
0 458 0 458 0 458 1 781
1 601

0 458 0 458 -5 214 0 458 0 458 1 781
1 601

0 458 0 458 0 458 -5 214 0 458 1 781
1 601

Good 5
0 458 0 458 0 458 0 458 -5 214 1 781 1 601

857
Good 6
0 035 0 035 0 035 0 035 0 035 -1 129 -1 043

Table 7(B) Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 5 Predicted by Model I

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Good 5

Good 6

Price of Good 1 Good 2 Good 3 Good 4 Good 5 Good 6
Expenditure

-4 965 (0.191) 0 393 (0.068) 0 328 (0.075) 0 419 (0.109) 0 463 (0.094) 1 585 (0.219)
1 777 (0.271)

0 399 (0.074) -5 588 (0.225)
0 648 (0.124) 0 437 (0.086) 0 623 (0.153) 1 769 (0.268)
1 713 (0.319)

0 335 (0.079) 0 628 (0.129) -5 017 (0.215) 0 406 (0.109) 0 330 (0.113) 1 853 (0.233)
1 465 (0.262)

0 439 (0.125) 0 414 (0.077) 0 398 (0.110) -5 252 (0.262) 0 389 (0.075) 1 933 (0.213)
1 679 (0.264)

0 535 (0.121) 0 648 (0.163) 0 348 (0.123) 0 450 (0.089) -5 525 (0.240) 1 962 (0.202)
1 583 (0.286)

0 034 (0.003) 0 038 (0.003) 0 035 (0.002) 0 038 (0.002) 0 041 (0.003) -1 137 (0.003)
-1 048 (0.006)

Table 7(C) Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 5 Predicted by Model II

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Good 5

Good 6

Price of Good 1 Good 2 Good 3 Good 4 Good 5 Good 6
Expenditure

-4 846 (0.197) 0 565 (0.089) 0 295 (0.096) 0 499 (0.121) 0 433 (0.109) 2 054 (0.104)
1

0 568 (0.111) -5 328 (0.205)
0 608 (0.127) 0 478 (0.089) 0 671 (0.110) 2 049 (0.154)
1

0 304 (0.107) 0 583 (0.129) -4 716 (0.119) 0 421 (0.102) 0 355 (0.089) 2 049 (0.109)
1

0 531 (0.140) 0 462 (0.087) 0 422 (0.102) -5 020 (0.149) 0 417 (0.110) 2 225 (0.128)
1

0 494 (0.122) 0 702 (0.137) 0 378 (0.100) 0 465 (0.113) -5 205 (0.209) 2 158 (0.115)
1

0 029 (0.002) 0 030 (0.002) 0 030 (0.002) 0 032 (0.002) 0 035 (0.001) -1 158 (0.003)
1

Table 7(D)
Price of Good 1 Good 2 Good 3 Good 4 Good 5 Good 6
Expenditure

Price and Expenditure Elasticities (Standard Errors) for Simulated Data Set 5 Predicted by Model III

Expected quantity of

Good 1

Good 2

Good 3

Good 4

Good 5

Good 6

-5 711 (0.182) 0 169 (0.010) 0 179 (0.014) 0 170 (0.010) 0 165 (0.094) 1 660 (0.055)
3 367 (0.127)

0 169 (0.010) -5 422 (0.175)
0 169 (0.008) 0 157 (0.009) 0 157 (0.009) 1 573 (0.070)
3 197 (0.107)

0 183 (0.012) 0 171 (0.007) -5 496 (0.143) 0 155 (0.008) 0 155 (0.009) 1 595 (0.047)
3 237 (0.099)

0 181 (0.010) 0 165 (0.011) 0 161 (0.008) -5 549 (0.182) 0 175 (0.008) 1 604 (0.078)
3 263 (0.102)

0 181 (0.012) 0 171 (0.018) 0 168 (0.011) 0 182 (0.010) -5 779 (0.230) 1 680 (0.079)
3 397 (0.139)

0 060 (0.002) 0 056 (0.002) 0 057 (0.002) 0 058 (0.002) 0 062 (0.002) -1 122 (0.003)
0 827 (0.004)

to the number of goods and number of zero purchases. Furthermore, all three models are better at accurately capturing the true elasticities in data set 4 than in data set 5. This implies that the efficacy of either model in capturing the true elasticities decreases as the fraction of

zero purchases is increased. The reason for this follows from the fact that the likelihood contribution of a zero purchase consists of the joint probability that the errors lie in a certain region (as in Equation (14)), which is less informative compared to the likelihood contribution of

Mehta: A Flexible Yet Globally Regular Multigood Demand System

858

Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

Table 8 Summary Statistics of Scanner Panel Data Sets

Data set A (M = 5 goods, N = 16 589 observations)

Data set B (M = 6 goods, N = 10 129 observations)

Number of purchase obs.

Avg. budget share

Avg. price in cents/oz.

Number of purchase obs.

Avg. budget share

Avg. price in cents/oz.

Detergent Softener Pasta Pasta sauce

2 607 1 796 4 243 2 505

0 0111 0 0051 0 0047 0 0049

7 09

Blueberry

404

6 89

Mixed-berry

198

9 50

Strawberry

479

9 18

Plain

339

Pina-colada

457

0 0020

9 23

0 0016

9 11

0 0021

9 23

0 0014

9 23

0 0021

9 23

Basket expenditure in dollars (std. dev.)

0 corners

1 corner

Number of observations with

2 corners

3 corners

4 corners

5 corners

Data set A

55.68 (36.26)

79

513

2 203

4 965

8 829

Data set B

49.48 (39.50)

0

6

82

276

1 056

8 709

Note. The average budget share of each good in Table 7 is calculated over all purchase and nonpurchase observations.

a nonzero purchase, which consists of joint densities of errors (as in Equation (13)).
5.4. Scanner Panel Data I use scanner panel data to investigate whether and to what extent Basic Translog utility with necessary and sufficient conditions yields better goodness of fit and predictive ability, different estimates of demand elasticities, and different results in counterfactuals compared to Homothetic Translog and LES utilities. For this, I estimate Models I­III on two scanner data sets. Data set A consists of consumers' purchases across M = 5 goods in the store. The goods considered are: detergents, softeners, pasta, pasta sauce, and the composite good. Data set B consists of consumers' purchases across M = 6 goods, i.e., five flavors of 8 oz. Dannon yogurt, viz., blueberry (BB), mixed-berry (MB), strawberry (SB), plain (P), and pina-colada (PC), along with the composite good. Both data sets are from a large grocery store in Pittsburgh. The goods in data set A are similar to those used by Song and Chintagunta (2007) and Mehta and Ma (2012). The goods in data set B are similar to those used by Kim et al. (2002). The two data sets help address different issues. In data set A, {detergent, softener} and {pasta, pasta sauce} are complements; in data set B, the yogurt flavors are substitutes.

The summary statistics of the two data sets are given in Table 8. Data set A consists of 16,589 observations over two years with 140 consumers; data set B consists of 10,129 observations over two years with 110 consumers. Data set B has a much greater fraction of zero purchases compared to data set A. I split both data sets into estimation and holdout samples, where the estimation sample of data set A consists of 12,109 observations with 100 consumers and data set B consists of 7,184 observations with 80 consumers. I extend Models I­III estimated in §5.3 by incorporating unobserved heterogeneity and the impact of inventories and feature ads/displays of each focal good on consumers' purchases. I do this by specifying c (as given in Equation (11) for Models I and II, and Equation (19) for Model III) for consumer h on trip t for each focal good c = 1 M - 1 as
h c t = ´ c + h c + Pro c Proh c t + I c Invh h t (20)
In Equation (20), ´ c is the baseline population level mean parameter for good c, and h c is a random error that captures unobserved heterogeneity in the preference for good c. I assume the M - 1 × 1 vector of these errors, h  h 1 h M-1 , to be multivariate normally distributed across the population as
h  N 0 , where is a full covariance matrix. I generate as a product of two Cholesky matrices

Table 9 Goodness of Fit Tests for Scanner Panel Data Sets

Log likelihood (BIC)

Model I

Model II

Estimation sample Hold out sample
Estimation sample Hold out sample

Data set A

1 982 6 (-3,135.2) 650 0 (-879.7)

1 674 7 (-2,916.9) 538 0 (-689.3)

Data set B

-255 1 (1,025.2) -268 9 (1,001.1)

-286 4 (1,043.0) -293 6 (1,010.6)

Model III
1 719 5 (-3,053.5) 584 2 (-823.7)
-316 6 (1,023.6) -323 6 (998.2)

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

859

Table 10(A)

Price and Expenditure Elasticities (Standard Errors) for Scanner Data Set A Predicted by Model I

Price of Detergent Softener Pasta Pasta sauce
Expenditure

Detergent
-2 438 (0.129) -0 058 (0.016)
0 001 (0.009) 0 003 (0.009) 1 936 (0.112)

Softeners

Expected quantity of Pasta

Pasta sauce

-0 127 (0.034) -1 880 (0.088)
0 060 (0.018) 0 040 (0.020)
1 881 (0.096)

0 005 (0.019) 0 060 (0.016) -1 695 (0.065) -0 091 (0.016)
1 469 (0.088)

0 008 (0.019) 0 042 (0.018) -0 115 (0.021) -1 994 (0.084)
2 021 (0.094)

Comp. good
0 019 (0.003) 0 005 (0.001) 0 005 (0.000) 0 006 (0.001) 0 939 (0.002)

Table 10(B)

Price and Expenditure Elasticities (Standard Errors) for Scanner Data Set A Predicted by Model II

Price of Detergent Softener Pasta Pasta sauce
Expenditure

Detergent
-2 590 (0.139) -0 025 (0.014)
0 019 (0.011) 0 002 (0.041)
1

Softeners

Expected quantity of Pasta

Pasta sauce

-0 047 (0.030) -1 667 (0.109)
0 099 (0.022) 0 061 (0.024)
1

0 040 (0.022) 0 114 (0.016) -1 685 (0.063) -0 042 (0.022)
1

0 005 (0.020) 0 075 (0.018) -0 043 (0.022) -2 015 (0.110)
1

Comp. good
0 017 (0.002) 0 003 (0.001) 0 003 (0.001) 0 005 (0.001)
1

Table 10(C)

Price and Expenditure Elasticities (Standard Errors) for Scanner Data Set A Predicted by Model III

Price of Detergent Softener Pasta Pasta sauce
Expenditure

Detergent
-3 348 (0.112) 0 023 (0.003) 0 011 (0.001) 0 020 (0.002) 1 434 (0.078)

Softeners

Expected quantity of Pasta

Pasta sauce

0 052 (0.008) -2 912 (0.092)
0 010 (0.001) 0 016 (0.002)
1 244 (0.070)

0 026 (0.004) 0 012 (0.001) -2 789 (0.056) 0 027 (0.002)
1 197 (0.059)

0 045 (0.005) 0 016 (0.002) 0 024 (0.002) -3 306 (0.129)
1 406 (0.083)

Comp. good
0 023 (0.002) 0 009 (0.001) 0 008 (0.000) 0 011 (0.001) 0 991 (0.002)

as = C C T , where C is an M - 1 × M - 1 lower triangular Cholesky matrix with elements as ci j . I use 300 Halton draws to integrate out unobserved heterogeneity errors from the joint likelihood of a consumer's purchase history. The term Proh c t is a 0­1 promotional variable that takes a value of 1 if good c was feature advertised or displayed on trip t and Invh c t is consumer h's inventory at hand of good c on trip t. To operationalize inventories, I use the flexible inventory updating proposed by Ailawadi and Neslin (1998) that allows consumption rates to depend on inventory at hand.
The parameter estimates of Models I­III for the two data sets are given in §3 of the Web Appendix. The log likelihoods and BIC of all three models for the estimation and hold out samples for both data sets are given in Table 9. Model I outperforms Model II in terms of the log likelihood and the BIC in both samples in both data sets. Model I outperforms Model III in terms of log likelihood and BIC in both samples in data set A; however, in data set B, Model I outperforms Model III in both samples only in terms of log likelihood, but not BIC. To understand this result, note that the BIC

depends on the log likelihood as well as the number of parameters. Because data set B has a large fraction of zero purchases, it follows from our discussion in §5.3 that the relative superiority of Model I over Model III in terms of the log likelihood will be small. Furthermore, Model III has 14 fewer parameters compared to Model I in data set B. Because the BIC puts a heavy penalty on the model with the larger number of parameters, the result follows.
I next compare the demand elasticities predicted by the three models for data set A. Tables 10(A)­10(C) report the price and expenditure elasticities for the three models. The results mirror those discussed for simulated data set 1. Model I yields the own price elasticities of detergents, softeners, pasta, and pasta sauce as -2 438, -1 880, -1 695, and -2 014, respectively, and the expenditure elasticities as 1.936, 1.881, 1.469, and 2.021, respectively. Furthermore, Model I yields negative cross-price elasticities between detergents and softeners (-0 058 and -0 127) and between pasta and pasta sauce (-0 115 and -0 091), implying that these are price complements. For Model II, its predicted cross-price elasticities between detergents

Mehta: A Flexible Yet Globally Regular Multigood Demand System

860

Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

Table 11(A) Promotional Elasticities (Standard Errors) for Scanner Data Set A Predicted by Model I

Expected quantity of

Detergent

Softeners

Pasta

Pasta sauce

Promo on Detergent Softener Pasta Pasta sauce

1 141 (0.271) 0 089 (0.043) -0 001 (0.006) -0 002 (0.006)

0 096 (0.035) 1 614 (0.504) -0 036 (0.013) -0 024 (0.014)

-0 004 (0.018) -0 102 (0.045)
0 408 (0.086) 0 052 (0.014)

-0 006 (0.019) -0 068 (0.038)
0 066 (0.017) 0 598 (0.131)

Table 11(B) Promotional Elasticities (Standard Errors) for Scanner Data Set A Predicted by Model II

Expected quantity of

Detergent

Softeners

Pasta

Pasta sauce

Promo on Detergent Softener Pasta Pasta sauce

1 429 (0.238) 0 063 (0.033) -0 014 (0.008) -0 002 (0.005)

0 039 (0.019) 1 817 (0.445) -0 062 (0.016) -0 034 (0.017)

-0 033 (0.014) -0 252 (0.059)
0 458 (0.124) 0 023 (0.012)

-0 003 (0.017) -0 162 (0.054)
0 026 (0.013) 0 617 (0.176)

Table 11(C) Promotional Elasticities (Standard Errors) for Scanner Data Set A Predicted by Model III

Expected quantity of

Detergent

Softeners

Pasta

Pasta sauce

Promo on Detergent Softener Pasta Pasta sauce

1 069 (0.232) -0 017 (0.005) -0 002 (0.001) -0 004 (0.002)

-0 024 (0.005) 2 090 (0.775)
-0 001 (0.098) -0 003 (0.002)

-0 010 (0.004) -0 008 (0.003)
0 199 (0.002) -0 004 (0.136)

-0 017 (0.004) -0 011 (0.003) -0 003 (0.002)
0 341 (0.001)

and softeners are -0 047 and -0 025, and between pasta and pasta sauce are -0 043 and -0 042. These are much smaller in magnitude compared to those predicted by Model I, implying that it underestimates the extent of complementarity. Its predicted crossprice elasticities between pasta and pasta sauce are not significantly different from each other, implying that they are symmetric. Its expenditure elasticities are equal to one, which is significantly smaller than the expenditure elasticities predicted by Model I. The reason for these results follows from results 1 and 2 in Proposition 3. Model III's predicted cross-price elasticities between detergents and softeners, and between pasta and pasta sauce are all positive, which shows that the LES utility cannot capture complementarity. The reason for this follows from result 2 in Proposition 4. Its predicted own price elasticities of detergents, softeners, pasta, and pasta sauce are -3 348, -2 912, -2 789, and -3 306, respectively, which are significantly greater in magnitude than those predicted by Model I; and its predicted expenditure elasticities are 1.434, 1.244, 1.197, and 1.406, which are significantly smaller than those predicted by Model I. Finally, the promotional elasticities predicted by the three mod-

els are reported in Tables 11(A)­11(C). The pattern of cross-promotional elasticities across the three models is the same as that of cross-price elasticities.
Tables 12(A)­12(C) report the price and expenditure elasticities predicted by Models I­III for data set B.4 The results mirror those discussed for simulated data sets 3­5 in §5.3. Model I yields expenditure elasticities that range from 0.926 to 1.556, and positive cross-price elasticities between all yogurt flavors. The crossprice elasticities between blueberry, mixed berry, and strawberry pairs range from 0.185 to 0.276, which are significantly greater than those between other pairs. This implies that berry flavors are stronger substitutes for each other as compared to other flavors. Model II's predicted expenditure elasticities are all one, and are significantly different from those predicted by Model I. The reason for this follows from result 1 in Proposition 3. Model III yields values of cross-price elasticities between the five flavors in the range of 0.002 to 0.022, which are significantly smaller from those predicted by Model I. This once
4 I do not report promotional elasticities for data set B since the estimate of the promotional variable was insignificant in all models.

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

861

Table 12(A)

Price and Expenditure Elasticities (Standard Errors) for Scanner Data Set B Predicted by Model I

Expected quantity of

BB

MB

SB

Plain

PC

Comp. good

Price of

BB

-3 635 (0.286) 0 228 (0.062) 0 247 (0.128) 0 119 (0.069) 0 093 (0.050)

MB

0 185 (0.107) -2 463 (0.316) 0 215 (0.087) 0 013 (0.035) 0 053 (0.067)

SB

0 214 (0.085) 0 224 (0.063) -3 180 (0.276) 0 133 (0.068) 0 102 (0.063)

Plain

0 085 (0.052) 0 010 (0.020) 0 107 (0.525) -3 590 (0.295) 0 049 (0.046)

PC

0 096 (0.034) 0 065 (0.023) 0 111 (0.040) 0 067 (0.031) -2 568 (0.312)

Expenditure 1 480 (0.107) 0 926 (0.175) 1 400 (0.121) 1 425 (0.163) 1 556 (0.159)

0 004 (0.001) 0 002 (0.002) 0 003 (0.001) 0 004 (0.001) 0 003 (0.009)
0 994 (0.004)

Table 12(B)

Price and Expenditure Elasticities (Standard Errors) for Scanner Data Set B Predicted by Model II

Expected quantity of

BB

MB

SB

Plain

PC

Comp. good

Price of

BB

-3 213 (0.199) 0 225 (0.056) 0 162 (0.057) 0 035 (0.052) 0 152 (0.059)

MB

0 172 (0.071) -2 806 (0.380) 0 172 (0.068) 0 038 (0.020) 0 087 (0.053)

SB

0 148 (0.061) 0 211 (0.070) -2 757 (0.180) 0 005 (0.061) 0 037 (0.026)

Plain

0 025 (0.067) 0 030 (0.032) 0 004 (0.030) -3 439 (0.223) 0 030 (0.019)

PC

0 161 (0.075) 0 116 (0.034) 0 040 (0.025) 0 052 (0.026) -3 140 (0.268)

Expenditure

1

1

1

1

1

0 004 (0.000) 0 002 (0.001) 0 003 (0.001) 0 003 (0.001) 0 004 (0.001)
1

Table 12(C)

Price and Expenditure Elasticities (Standard Errors) for Scanner Data Set B Predicted by Model III

Expected quantity of

BB

MB

SB

Plain

PC

Comp. good

Price of

BB

-3 557 (0.204) 0 013 (0.002) 0 024 (0.004) 0 021 (0.004) 0 014 (0.003)

MB

0 008 (0.002) -2 354 (0.203) 0 006 (0.001) 0 002 (0.001) 0 006 (0.001)

SB

0 022 (0.003) 0 007 (0.001) -2 977 (0.216) 0 022 (0.003) 0 010 (0.002)

Plain

0 019 (0.003) 0 002 (0.001) 0 020 (0.003) -3 293 (0.212) 0 008 (0.002)

PC

0 012 (0.003) 0 006 (0.001) 0 009 (0.002) 0 008 (0.002) -2 759 (0.186)

Expenditure 1 037 (0.110) 0 703 (0.091) 0 904 (0.104) 0 964 (0.109) 0 821 (0.012)

0 006 (0.001) 0 003 (0.000) 0 005 (0.000) 0 004 (0.001) 0 004 (0.001)
1 001 (0.001)

again shows that LES underestimates substitutability between goods with small budget shares. The reason for this follows from our discussion in §5.3.
Finally I run a policy experiment to calculate the compensating value for each focal good, which provides useful information for assortment decisions (Kim et al. 2002). The compensating value of good c is the amount by which the total expenditure must be increased to compensate the household for the depletion of good c so that its utility remains unaffected. Its magnitude depends on the budget share of the good, its marginal utility of consumption, and the extent of substitutability of that good with the other goods (the greater the extent of substitutability, the lower the compensation value). Tables 13(A) and 13(B) show the per-trip compensating value for an average household of each focal good in both data sets, as predicted

by Models I­III. Model I yields significantly different compensating values of goods in both data sets compared to Models II and III. Comparing Models I and III, note that, while Model III yields significantly lower compensating values of the goods compared to Model I in data set A, it yields significantly larger compensating values of the three berry flavors compared to Model I in data set B. The reason for this result follows from the earlier observations that Model III does not allow for complementarity in data set A and that it underestimates the extent of substitutability between the three berry flavors in data set B.
In conclusion, the proposed model yields significantly different elasticities and results in the counterfactual compared to Models II and III. The reason for this follows from Propositions 4­6, which shows that

Mehta: A Flexible Yet Globally Regular Multigood Demand System

862

Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

Table 13(A) Compensating Values of Goods in Scanner Data Set A

Per trip compensating value in cents (std. error)

Detergent

Softeners

Pasta

Pasta sauce

Model I Model II Model III

40 40 (4.39) 34 84 (4.37) 26 89 (3.42)

30 93 (3.54) 45 07 (4.82) 18 86 (2.21)

44 44 (5.27) 36 08 (4.47) 18 15 (1.20)

24 07 (2.71) 24 56 (3.79) 14 98 (1.97)

Table 13(B) Compensating Values of Goods in Scanner Data Set B

Per trip compensating value in cents (std. error)

BB

MB

SB

Plain

PC

Model I 3 45 (0.36) 6 47 (0.55) 4 32 (0.39) 3 21 (0.44) 6 29 (0.72) Model II 4 14 (0.42) 5 76 (0.47) 5 56 (0.40) 2 78 (0.33) 5 50 (0.69) Model III 4 50 (0.40) 7 59 (0.76) 5 87 (0.61) 4 41 (0.47) 5 75 (0.58)

the proposed model imposes much fewer restrictions on elasticities compared to Models II and III. Thus if the true data elasticities lie outside the restricted space of elasticities given in Propositions 5 and 6, then the proposed model will be better at capturing the true elasticities and thereby yield significantly different results in counterfactuals compared to Models II and III. This is seen in the scanner data analysis. On the other hand, if the true elasticities in the data do, in fact, lie within the restricted space of elasticities given in, for example, Proposition 5 (i.e., if true expenditure elasticities were equal to one), then the proposed model will yield similar values of elasticities and results in counterfactuals as seen in Model II. However, even in that case, it is prudent to use our proposed model since it is difficult to a priori know whether the true expenditure elasticities are equal to one. Estimating Model II may not help as it is difficult to know whether it is accurately recovering the true expenditure elasticities from the data or whether it is restricting them to one. Because the proposed model does not impose restrictions on expenditure elasticities, it is only after estimating our proposed model that one can conclude that true expenditure elasticities are, in fact, equal to one.
6. Conclusions
A longstanding problem faced by researchers who have used the utility maximization framework with nonnegativity constraints is obtaining a functional form of the utility that satisfies the criteria of tractability, flexibility, and global regularity. I resolve this problem by proposing an appropriate demand system that satisfies all three criteria. I do this by deriving the necessary and sufficient conditions for global regularity of Basic Translog indirect utility. As a result, the proposed demand system is easy to estimate, yields valid expressions of the likelihood, is flexible

(in terms of allowing for complementarity and substitutability between goods, and normal/inferior goods) which helps to accurately capture underlying data elasticities, and facilitates meaningful policy analysis.
I formally prove that the proposed demand system imposes much fewer restrictions on demand elasticities compared with the two alternatives used in the literature: (a) Homothetic Translog utility, which is the Basic Translog utility when the researcher imposes sufficient conditions for global regularity, and (b) additively separable LES direct utility. I use simulated and scanner panel data to empirically examine the consequences of having a demand system that imposes much fewer restrictions on demand elasticities. Using simulated data, I show that our proposed model yields better model fit and captures the true data elasticities more accurately than (a) and (b), and that its relative efficacy is robust to the number of goods and number of zero purchases. Unlike (a), it allows for and accurately captures the extent of complementarity between goods and the extent of their inferiority, and does not underestimate the extent of substitutability between goods. Unlike (b), it accurately captures the true expenditure elasticities, does not underestimate the extent of complementarity, and captures the asymmetries in cross-price effects between goods. The reason for this follows from the fact that, compared with (a) and (b), the proposed demand system imposes a priori much fewer restrictions on demand elasticities. Using two scanner panel data sets (one with complements and the other with substitutes), I show that my proposed model yields substantially different results in policy simulations compared to (a) and (b). Specifically, I show that since alternative (a) does not allow for complementarities between goods, it yields significantly smaller compensation values of goods compared to our proposed model. On the other hand, since alternative (b) underestimates the extent of substitutability between goods, my model yields significantly larger compensation values of goods in the data set with substitutes.
Supplemental Material Supplemental material to this paper is available at http://dx .doi.org/10.1287/mksc.2015.0908.
Acknowledgments This research was funded by the Social Sciences and Humanities Research Council [Grant 491084]. The author thanks Arthur van Soest for his useful guidance, Yu Ma for providing the scanner panel data sets, and Peter Rossi for his useful comments. The author also thanks Tat Chan, Milind Dawande, David Soberman, Andrew Ching, Jian Ni, Charles Weinberg, Ig Horstmann, Jack Chen, and the seminar participants at the University of Alberta, University of British Columbia, and Johns Hopkins University for their comments. All omissions and errors are the responsibility of the author.

Mehta: A Flexible Yet Globally Regular Multigood Demand System Marketing Science 34(6), pp. 843­863, © 2015 INFORMS

863

References
Ailawadi KL, Neslin SA (1998) The effect of promotion on consumption: Buying more and consuming it faster. J. Marketing Res. 35(3):390­398.
Chakir R, Bousquet A, Ladoux N (2004) Modeling corner solutions with panel data: Application to the industrial energy demand in France. Empirical Econom. 29(1):193­208.
Chiang J (1991) A simultaneous approach to whether, what and how much to buy questions. Marketing Sci. 10(4): 297­315.
Chintagunta PK (1993) Investigating purchase incidence, brand choice and purchase quantity decisions of households. Marketing Sci. 12(2):184­208.
Christensen LR, Jorgensen DW, Lau LJ (1975) Transcendental logarithmic utility functions. Amer. Econom. Rev. 3(3): 367­383.
Du RY, Kamakura WA (2008) Where did all that money go? Understanding how consumers allocate their consumption budget. J. Marketing 72(6):109­131.
Jorgenson DW, Fraumeni BM (1981) Relative prices on technical change. Field BC, Berndt ER, eds. Modeling and Measuring Natural Resource Substitution (MIT Press, Cambridge, MA).
Kao C, Lee LF, Pitt M (2001) Simulated maximum likelihood estimation of linear expenditure system with binding nonnegativity constraints. Ann. Econom. Finance 2(1):203­223.

Kim J, Allenby GM, Rossi PE (2002) Modeling consumer demand for variety. Marketing Sci. 21(3):229­250.
Lee LF, Pitt M (1986) Micro-econometric demand systems with binding nonnegativity constraints: The dual approach. Econometrica 54(5):1237­1242.
Lee LF, Pitt M (1987) Micro-econometric models of rationing, imperfect markets, and nonnegativity constraints. J. Econometrics 36(1­2):89­110.
Mehta N, Ma Y (2012) A multi category model of consumers' purchase incidence, brand choice and quantity decisions. J. Marketing Res. 49(5):435­451.
Pollak R, Wales TJ (1992) Demand System Specification and Estimation (Oxford University Press, New York).
Song I, Chintagunta PK (2007) A discrete/continuous model of multi-category purchase behavior of households. J. Marketing Res. 34(4):595­612.
Van Soest A, Kooreman P (1990) Coherency of the indirect translog demand system with binding nonnegativity constraints. J. Econometrics 44(3):391­400.
Van Soest A, Kapteyn A, Kooreman P (1993) Coherency and regularity of demand systems with equality and inequality constraints. J. Econometrics 57(1­3):161­188.
Wales T, Woodland A (1983) Estimation of consumer demand equations with binding nonnegativity constraints. J. Econometrics 21:263­285.

