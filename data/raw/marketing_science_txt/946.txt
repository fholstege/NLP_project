Vol. 23, No. 1, Winter 2004, pp. 66­81 issn 0732-2399 eissn 1526-548X 04 2301 0066

informs ®
doi 10.1287/mksc.1030.0041 © 2004 INFORMS

Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

Jean-Pierre Dubé
Graduate School of Business, University of Chicago, 1101 East 58th Street, Chicago, Illinois 60637, jdube@gsb.uchicago.edu
For several of the largest supermarket product categories, such as carbonated soft drinks, canned soups, ready-to-eat cereals, and cookies, consumers regularly purchase assortments of products. Within the category, consumers often purchase multiple products and multiple units of each alternative selected on a given trip. This multiple discreteness violates the single-unit purchase assumption of multinomial logit and probit models. The misspecification of such demand models in categories exhibiting multiple discreteness would produce incorrect measures of consumer response to marketing mix variables. In studying product strategy, these models would lead to misleading managerial conclusions.
We use an alternative microeconomic model of demand for categories that exhibit the multiple discreteness problem. Recognizing the separation between the time of purchase and the time of consumption, we model consumers purchasing bundles of goods in anticipation of a stream of consumption occasions before the next trip. We apply the model to a panel of household purchases for carbonated soft drinks.
Key words: multiple discreteness; structural modeling; customer behavior; brand choice History: This paper was received September 25, 2000, and was with the authors 11 months for 3 revisions;
processed by Greg Allenby.

1. Introduction
On a given trip, consumers regularly purchase multiple products from the same category. We find evidence of such purchase behavior for carbonated soft drinks (CSDs), ready-to-eat cereals, canned soups, and cookies--four of the top five revenue-generating categories in the dry grocery department in U.S. food stores according to ACNielsen. For each of these categories, more than 20% of the shopping trips resulting in a within-category purchase involve the simultaneous purchase of at least two alternatives. In this paper, we focus on CSDs, which account for more than 10% of total sales in the dry grocery department. In a panel of household shopping trips, only 39% of the trips involving a CSD purchase result in the purchase of a single unit of a single UPC product. In fact, roughly 31% of the trips result in the purchase of two or more products, and the remaining 30% of the trips result in the purchase of multiple units. Table 1 reports on the distribution of total CSD brands and items per shopping trip.
Typically, researchers using household scanner panels estimate expected demand with discretechoice models (DCMs), such as the conditional logit (Guadagni and Little 1983) and the multinomial probit (Chintagunta 1992, McCullough and Rossi 1994). In categories in which consumers regularly purchase assortments, imposing the singleunit purchase assumption of the DCM will generate

incorrect consumer responses to marketing mix variables. For instance, in the context of quantity purchases, Chintagunta (1993) shows that brand choice alone in categories with multiunit quantity purchases only accounts for part of the total price response and, in some instances, generates inelastic price elasticities. In addition to providing incomplete estimates of consumer preferences, the misspecification of the DCM could also lead to incorrect managerial predictions for these categories. Finally, the DCM does not make use of potentially valuable information contained in the quantity data.
Following Hendel (1999), we use a structural approach that allows for a more general form of multiunit and multibrand shopping behavior in a single unified choice model. This structural approach to modeling the assortment choice follows a recent marketing tradition of using microeconomics to guide the specification of an appropriate model of consumer demand. For instance, Erdem and Keane (1996) model consumer learning about product quality, Gonul and Srinivasan (1996) model consumer price expectations, and Erdem et al. (2002) model both price expectations and inventory accumulation. Hendel's approach involves modeling assortment behavior as the outcome of several simultaneous discrete decision problems. Hence, he refers to this type of behavior as multiple discreteness.

66

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

67

Table 1 Carbonated Soft Drinks

Products/Units

1

2

1

20 652

11 238

2

0

6 928

3

0

0

4

0

0

5

0

0

6+

0

0

Total

20 652

18 166

3
1 447 2 215 1 322
0 0 0
4 984

4
2 454 1 817
768 335
0 0
5 374

5
245 436 302 165
51 0
1 199

6

7

8

9

10+

Total

454

33

282

464

146

259

247

114

109

109

63

77

69

27

18

7

20

12

19

215

37 039

45

166

12 476

45

130

3 037

28

69

846

16

41

222

12

33

84

1 350

403

757

165

654

53 704

In the current shopping context, this multiple discreteness arises for several reasons. Typically, marketers interpret shopping behavior in scanner panels as outcomes for a single consumer. In fact, many of the panelists are shoppers making decisions for the entire household. The consumption of the purchased goods typically occurs at some point after the trip. Therefore, the shopper must make multiple decisions in anticipation of the various occasions during which goods will be consumed. A separate choice is made for each anticipated consumption occasion. If preferences vary across these consumption occasions, then one would expect consumers to purchase a bundle of alternatives. Formally, the primitives of our shopping model involve a consumer optimizing a separate subutility function for each anticipated consumption occasion. The derived econometric model predicts the total expected vector of purchases.
Because the consumption occasions are not observed in the purchase data, we are not able to characterize the precise context in which alternatives are consumed. However, the marketing literature provides several explanations for why one would observe shoppers making multiple decisions. For instance, McAlister (1982) documents individuals seeking variety by switching their consumption of CSDs between several alternative flavors over time. At the time of purchase, this form of variety-seeking would induce consumers to select an assortment of alternatives. Similarly, if consumers are uncertain of their tastes at the future time of consumption, they may purchase an assortment to ensure they have the right product on hand (Hauser and Wernerfelt 1991, Simonson 1990, Walsh 1995). Alternatively, the shopper may make several decisions based on the varying tastes of several members of a household, such as children versus adults. Each of these scenarios provides a rationale for why consumers may need to make multiple decisions at the time of purchase. With standard scanner panel data, it is not possible to resolve any particular one of these theories. Instead, we view them as explanations for the multiple decisions in our shopping model.
We find that the proposed model provides a good fit of the aggregate purchases for each alternative. In

terms of the characterization of multiple-item shopping, the estimates provide substantial evidence of both observed and unobserved heterogeneity. Demographics play a significant role in determining differences in tastes in addition to identifying differences in the assortment of total purchases on each trip. To help understand some of the underlying structure, we estimate several comparison models that relax certain assumptions. In general, we find that most of our model parameters are fairly robust to these assumptions. We also compare our results to a purely statistical model of "quantity-then-brand choice."
An attractive feature of the current approach is the structural derivation, linking the statistical model to consumer theory. First, we have an intuitive link between our estimated parameters and consumer preferences. When the models are used to conduct marketing simulations, the link to individual utility maximization also allows us to measure consumer welfare. The Hicksian compensating variation can be used to measure consumer willingness to pay in dollars to maintain the status quo versus a hypothetical change in the marketing or category conditions.1 Finally, the derivation of CSD demand from consumer theory ensures that aggregate demand is "wellbehaved," such that a retailer's corresponding profit function satisfies all the conditions necessary for deriving an optimal price vector. For instance, many researchers have used double-log approximations for aggregate demand. Once this specification is used to study category profitability, additional ad hoc restrictions may need to be imposed for the profit function to be maximized (Anderson and Vilcassim 2001). In this sense, a structural derivation has practical appeal.
The paper is organized as follows. The second section describes the model of individual choice and demonstrates its relationship to the standard DCM. In §3, we discuss the econometric specification and the estimation procedure. Section 4 describes the data. In §5 we also report on the results, including parameter estimates and substitution patterns. We also report
1 For instance, Chintagunta et al. (2002) measure the impact of zone pricing on consumers. An earlier version of this paper measured the impact of product deletions on consumer welfare.

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

68

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

in §6 on the results of sensitivity analysis of the proposed model to various underlying assumptions, as well as results from a purely probabilistic comparison model. Finally, we present conclusions in §6.
2. Household CSD Demand
Our model is similar to that of Hendel (1999), who looks at the multiple discreteness in firms' profit-maximizing computer holdings decisions. We consider a random utility framework in which households make optimal shopping decisions subject to a budget constraint. For a given category on a given trip, the consumer anticipates several future consumption occasions and chooses some quantity of the optimal brand for each occasion. Allowing preferences to vary across these consumption occasions leads to consumers purchasing bundles of products and varying quantities of each. An interesting feature of Hendel's framework is that it can be shown to be a generalization of the typical discrete-choice model (e.g., logit or probit).
In practice, we do not observe the specific consumption occasions. Intuitively, we expect the source of these occasions to reflect such factors as many family members with varying tastes, the replenishment of overall household CSD inventory, and uncertain future tastes. However, without time-of-consumption data, we are unable to model the specific context in which products are consumed. Instead, we model the distribution of consumption occasions, consisting of the expected number of occasions and the tastes for each. The model first generates an integer number representing the number of consumption occasions for which a shopper must make purchases during the trip. Each of these consumption occasions has its own set of corresponding preferences. For each consumption occasion, the shopper chooses an optimal quantity of one of the alternatives. The model predicts the total purchase vector for a given trip, integrating across the decisions made for each of the anticipated consumption occasions.
Two recent studies have also modeled the incidence of multiple-item purchases.2 Harlam and Lodish (1995) use a variant of the DCM to estimate multiple brand purchases, but not the quantity of each alternative chosen. Because the model formulation is not structural, this specification will not be able to provide profit and consumer welfare measurements in assessing marketing strategy. Kim et al. (1999) propose an alternative imperfect substitutes specification capable of addressing both the multiple brand and the quantity decisions. At the time of a trip, a household
2 Manchanda et al. (1999) investigate purchase incidence decisions across categories.

optimizes a separate subutility function for each product alternative, rather than for each expected consumption occasion. The purchase of assortments of goods reflects heterogeneity of rates of diminishing marginal returns for the various alternatives. In contrast, we explain assortments by heterogeneity in tastes across expected consumption occasions. The imperfect substitutes model would be difficult to apply to CSDs, because the large number of product alternatives would require identifying a large number of subutility functions.

2.1. The Model

Because the expected number of consumption occa-

sions on a given trip follows a count process, a logi-

cal starting point is to assume a Poisson distribution.3

The total expected number of decisions a consumer

must make during a trip is an integer drawn from

a Poisson distribution. We allow the mean of this

Poisson distribution to vary across consumers and

across trips. Formally, during a shopping trip on date

t, a household h purchases a basket of various alter-

natives in the category in anticipation of Jht different future consumption occasions. Jht is an integer value that is derived from a Poisson distribution with a

mean ht:

Jht  P ht

(1)

where ht = Dht , Dht is a vector of household characteristics and shopping behavior that may vary over time, and is a vector of parameters.
For each of these j = 1 Jh (we drop the time subscript for expositional convenience) expected consumption occasions, the household generates utility from consuming from among the i = 1 I products in the category:

uhj Qij Dh

I

=

ihj Qij Sh

i=1

j=1 J h=1

H (2)

where Sh = Dh . In the above specification,

h ij

represents the household's perceived quality for

alternative i on consumption occasion j. The value Qij is the quantity chosen for alternative i. The parameter

captures the curvature in the utility function. So

long as the estimated value of lies between 0 and 1,

the model maintains the concavity property needed

for an interior solution.4 Sh captures the effect of household characteristics on the scale of purchases,

and is a vector of parameters. Because the utility

3 In our results section, we discuss the sensitivity of our findings to the Poisson assumption.
4 Kim et al. (1999) use a product-specific to allow diminishing returns to differ across products.

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

69

function has a perfect substitute specification, a single alternative will be chosen for the consumption occasion. The model permits any positive quantity of this alternative because of the curvature, . Moreover, because the consumer has such Jh decisions to make on each trip, the aggregate purchase vector may contain several alternative products and varying quantities of each.
We define perceived quality in the following manner:

h ij

=

max

0

Xi

h j

+

mh i

(3)

h j

=

~ + Dh

+

h j

(4)

Quality has the typical hedonic structure where Xi

is a vector of product i's attributes,

h j

is

the

vector

of household h's tastes for attributes on consump-

tion occasion j, and i is a vector of product-specific fixed effects (brand intercepts). We use a random coef-

ficients specification for the tastes in Equation (4). Vector ~ captures the portion of tastes common to all

households and consumption needs, and is a vector

of interactions between demographics and tastes for

attributes. Finally, is a diagonal matrix whose ele-

ments are standard deviations, and

h j

is

a

vector

of independent standard normal deviates. Thus, for

each household, the taste vector will be distributed

normally with, conditional on demographics, mean

~ + Dh and covariance matrix

(i.e., contains

the Cholesky factors of the covariance matrix of ).

In addition, we include the term mh = Dh to capture potential differences in households' tastes for quality,

where is a vector of parameters. Note that because

mh does not vary across brands, it allows households to purchase more expensive alternatives, regardless

of the underlying product attributes. As such, this

term introduces a vertical component to preferences.

Finally, the specification allows for zero demand (no-

purchase), depending on the values of the product

valuations .

In formulating the household's decision problem at

the time of a trip, we assume preferences are quasilin-

ear to separate the utility from purchases of the I soft

drink products and a composite commodity of other

goods, z. Conditional on Jh, the total utility of household h at the time of a shopping trip is given by:

Jh

U h = uhj Qij Dh

+z

(5)

j =1

The household's expenditure constraint is given by:

Jh I
piQij + z  yh
j=1 i=1

where pi is the price of product i and yh is the household's total shopping budget. Given the specification

of the utility function, the expenditure equation binds and may be substituted into (5) to give:

Jh

Jh I

U h = uhj Qij Dh

-

piQij + yh

(6)

j =1

j=1 i=1

Conditional on the number of anticipated consump-
tion occasions, Jh, the household's problem will be to pick a matrix with columns Qj j = 1 Jh to maximize (6).
Given the additive separability of (6) across each of
the Jh expected consumption occasions, we can treat each decision independently. The optimal quantity of
brand i for occasion j solves the first-order condition:

h ij

Qij -1Sh - pi = 0

Rewriting the first-order condition in terms of Qij gives:

Qij =

h ij

Sh

1/1-

pi

(7)

which is the optimal quantity of product i for con-

sumption occasion j. The optimal quantity of a given

brand is increasing in Sh, which is why we describe this term as impacting the scale of purchases. The

fact that consumers must purchase integer quanti-

ties does not pose a problem, because the subutility

functions (2) are concave and monotonically increas-

ing in Qij . These properties ensure that we only need to consider the two contiguous integers to Qij . We then compare the 2 · I potential quantities, picking

the one yielding the highest utility. Each of these

optimal quantities has a corresponding latent util-

ity uj = uj1

ujI , where uji = maxQ uhj Qij Dh .

The perfect substitutability ensures that a household

selects brand i if uji = max uj1

ujI Households

carry out a comparable decision for each expected

consumption occasion.

For each trip, we observe the sum of all of these

optimal quantities in the form of an aggregate pur-

chase vector. The model's predicted value for this

aggregate purchase vector has the following form:

EQh Dh X

Jh

=

···

Qjh Dh X

h j

Jh=1 j=1 -

· f Dh p J Dh

(8)

where f Dh is the normal probability density function of the taste vector conditional on household characteristics and model parameters, and p J Dh is the Poisson probability density function of the number of expected consumption occasions conditional on household characteristics and model parameters. Note that although we make distributional and functional form assumptions on the primitives of the model, econometrically, we estimate the expression (8), which is derived from the model.

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

70

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

2.2. Comparison with the Standard DCM An interesting feature of the random utility framework in the previous section is that it is a direct extension of the standard DCMs. Disregarding the expected consumption occasions and assuming that consumers are restricted to single-unit purchases, then no longer plays any role and (6) reduces to:

uhi = Xi Sh - pi

i=1 I

In this formulation, we are no longer able to identify
m Dh , so we set it to one for all households. We can also divide through by Sh to obtain:

uhi = Xi

-

1 Sh

pi

(9)

where the inverse of Sh is usually interpreted as the price-response parameter. Adding a random disturbance term directly in (9) gives the standard random utility DCM (McFadden 1981). The proposed model differs from the DCM in several ways. The curvature in the utility function enables consumers to purchase multiple units of a given product alternative instead of choosing either zero or one unit. The number of consumption occasions, generated by the Poisson distribution, implies that consumers solve multiplechoice problems on a trip. Allowing preferences to vary across these consumption occasions, a different alternative may be selected for each occasion. As a result, the total category shopping basket may include a variety of product alternatives and multiple units of each alternative chosen.
In general, existing marketing models are not suitable for categories exhibiting multiple discreteness. For instance, treating each unit purchased as an independent outcome from a DCM still conditions on the number of items in the shopping basket (e.g., the number of decisions made per trip). This model will not be able to predict expected demand out of the sample because the number of decisions would be unknown. Similarly, the "brand-then-quantity choice" specification of Krishnamurthi and Raj (1988) would require conditioning on the total number of brands chosen. Ignoring the structural derivation, we construct an alternative statistical model that captures the multiple discreteness and, at the same time, generalizes the standard DCM. In the Appendixes, we outline the derivation of a "quantity-then-brand choice" model. In the section on "Model Sensitivity," we compare the estimates of this statistical model to those of the proposed model described previously.

3. Estimation Procedure
In this section, we discuss the intuition for the econometric model we estimate. The two main features of

the methodology are the use of method of simulated moments and a nonparametric correction for serial dependence in the prediction errors. We defer the formal details regarding the estimation procedure to the Appendixes.
Referring back to §2.1, our model consists of the following system (where we have omitted the time subscripts):

EQ Dh X

Jh

=

···

Qjh Dh X

h j

Jh=1 j=1

-

· f Dh p J Dh

(10)

ht = Dht

(11)

Sh = Dh

(12)

mh = Dh

(13)

h j

=

~ + Dh

+

h j

(14)

Our objective is to estimate (10), the I-dimensional vector of total purchases for each alternative on a given shopping trip. In addition to the parameters,
, the purchase vector is a function of data matrices Dh, household characteristics, and X, product characteristics.
To estimate the model parameters, we use the generalized method of moments (GMM) approach, constructing conditional moments based on (10). To handle the complex multivariate integrals, we simulate the moments using Monte Carlo methods (McFadden 1989, Pakes and Pollard 1989), which allows us to obtain consistent parameter estimates. We use 30 draws and assume this number is sufficient to eliminate any noticeable simulation error. For each store trip, we take 30 independent draws from the Poisson distribution to simulate the number of expected consumption occasions. For each of these draws, we then take N + I - 1 × K draws from the standard normal distribution to simulate the taste coefficients for these occasions, in which N is the dimension of X and K is a sufficiently large number to place an upper bound on the number of occasions simulated for each household. These draws are then used to construct 30 simulations of the expected purchase vector for each trip. Simulated moments are obtained by averaging across the 30 simulated trip vectors. Technical details of the GMM procedure are provided in the Appendixes.
The panel structure of the data potentially introduces additional problems with the efficiency of our estimates. We attempt to control for both crosssectional and intertemporal persistence in the data. To deal with the cross-sectional aspect of the data, we include several state variables, such as temperature and seasonal dummies, to capture contemporaneous

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

71

aggregate demand shocks that could affect households in a similar fashion. However, most households also have fairly long purchase histories, which could exhibit persistent unobserved shocks (McCulloch and Rossi 1994, Seetharaman 1999 provide parametric time-series methods for multiperiod probit models). In the GMM procedure, we use a nonparametric correction for serial dependence in the prediction error based on Conley (1999). In this way, we correct the standard errors of our parameter estimates for serial dependence. Details for this standard error correction are presented in the Appendixes.

3.1. Identification

We now discuss several identification-related issues

that arise for the proposed econometric model. In

the data, we observe total demand, but we do not

observe the specific expected consumption occasions.

Nonetheless, we are able to identify the process that

generates these occasions. The main identification

problem involves the distinction between a household

purchasing, for example, five units of CSDs to satisfy

five expected occasions versus five CSDs to satisfy a

single occasion. Because the random tastes are inde-

pendent across consumption occasions, a household

with several decisions will tend to purchase several

different alternatives. However, a household with a

single consumption occasion will only purchase one

alternative. The number of consumption occasions

determines the joint distribution of the total num-

ber of units of CSDs purchased and the number of

different brands.

Several features of the model help us identify this

distribution. Note that the mean of the Poisson gener-

ating the number of expected consumption occasions,

the scale of purchases and the perceived product qual-

ities, h, Sh, and

h ij

,

respectively,

are

all

functions

of

household characteristics, Dh. Suppose household size

increases both h and Sh. Allowing household size

to influence both terms enables the model to distin-

guish between having a lot of consumption occasions

and purchasing a large quantity for a given consump-

tion occasion. Similarly, suppose income increases Sh and interacts positively with premium brands in ihj . Allowing income to enter both these terms enables

the model to distinguish between the number of units

purchased and the product selected for a given con-

sumption occasion. Although several different sets of

parameter values could give the same likelihood for

expected total purchases, they would not have the

same likelihood for the joint distribution of total prod-

ucts and total units purchased. Because the sample

households tend to purchase baskets containing sev-

eral different soft drink products, the data identify

this joint distribution.

An additional identifying assumption we make involves the independence of tastes across consumption occasions. We implicitly rule out cross-occasion externalities. It is not immediately clear how our results would change if we allowed for correlation in tastes across consumption occasions. However, if we were able to characterize specific consumption occasions, one might observe a phenomenon such as selecting cola for one situation increasing the likelihood of purchasing a non-cola for another situation.
Finally, the large number of product alternatives in the CSD category makes it infeasible to estimate a full matrix of correlated product-specific random effects. These correlated random effects typically play an important role in allowing for flexible substitution patterns between product alternatives. For instance, one might expect Diet Coke to be a closer substitute to Diet Pepsi than regular Coke. If the price of Diet Pepsi rises, one would want the model to permit Diet Pepsi consumers to switch primarily to Diet Coke rather than to other nondiet alternatives. Rather than capturing this "closeness" via correlated brand intercepts, we use the Lancasterian characteristics approach (e.g., Berry 1994, Fader and Hardie 1996). In the model, we characterize product alternatives in terms of their underlying product attributes (as described in the section on "Data"). The random coefficients for the product attributes enable flexible substitution patterns. Suppose a household's utility-maximizing choice for a given expected consumption occasion is a 6-pack of Diet Pepsi. If a household exhibits strong preferences for low-calorie goods on a consumption occasion, the household will tend to substitute other low-calorie alternatives for Diet Pepsi. If the consumption occasion also exhibits strong preferences for a specific package size, such as the 6-pack of cans, then the household will tend to substitute other low-calorie 6-packs for 6-packs of Diet Pepsi. The advantage of this characteristics approach is the parsimonious representation of substitution patterns. Effectively, consumer preferences are projected onto product attributes, which vastly reduces the number of parameters needed.
4. Data
The scanner data, collected by ACNielsen, cover the Denver area between January 1993 and March 1995. These data include consumer information for a random sample of 1,920 households, as well as weekly store-level information for 58 supermarkets with more than $2 million all-commodity volume. The store-level information consists of weekly prices, sales, and feature and display activity for 26 diet and regular products with a combined share of 51% of the household-level category sales. The list of 26 products

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

72

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

consists of all universal product codes (UPCs) with at least a 1% share of total-sample CSD volume each. Of these 26 products, 12 are owned by Pepsi, 8 are owned by Coke, and 6 are owned by Cadbury-Schweppes. The household-level data cover all shopping trips for these items. For each trip, we know the date, the store chosen, and the quantities purchased. For each alternative available within the store, we know the prices and whether the product was featured in a newspaper or as an in-store display. Combining the store and purchase data sets, we observe the full set of prices and marketing mix variables for all the alternatives on a given trip.
We treat different package sizes of a given product as separate goods. Thus, our analysis is at the UPC level. In the beer category, Allenby and Shively (2001) view different product sizes as a nonlinear pricing scheme based on consumers' volume choice. In the CSD context, the inherent difference in storability of small cans versus large bottles leads us to view sizes as different products altogether.
For each shopping trip, we construct a quality measure for each product based on both fixed and timevarying attributes (reported as per 12-oz serving). The fixed attributes consist of the ingredients of the product, which we collect from the nutritional information printed on the product packages: total calories, total carbohydrates, sodium content (in milligrams), and a set of dummy variables that indicate the presence of caffeine, phosphoric acid, citric acid, caramel color, and clear. We also include package-size indicators: 6-pack of 12-oz cans (6×cans), 12-pack of 12-oz cans (12×cans), and 6-pack of 16-oz bottles (6 × bottles), omitting 67.6-oz bottles, because we include an intercept. The time-varying attributes are shelf prices and marketing mix variables: feature ads and displays. Because the A&W root beer and cream soda are indistinguishable in terms of these observable attributes and marketing variables, we combine them into one generic A&W brand.
We also include controls for household-specific loyalty to brands and specific products. We include a dummy variable, brand loyalty, indicating whether the brand was purchased on the previous trip. We also include a dummy variable, product loyalty, indicating whether a specific product was purchased on the previous trip. This second variable distinguishes loyalty to a brand (e.g., Coke vs. Pepsi), opposed to loyalty to a specific package size of a brand, 6-pack of Coke versus a 12-pack of Coke. Linking these parameters back to the economics of consumer choices implies that consumers are myopic. Implicitly, consumers condition on the past but do not account for the impact of current decisions on future choices. It is difficult to provide a rational justification for these parameters when consumers are forward looking (see

Table 2 Descriptive Statistics (Averaged Across Trips)

Variables

Standard Mean Deviation Minimum Maximum

Kids

0 3865 0 4870

0

1

Family size

2 6976 1 4034

1

9

Income bracket

4 2470 1 9616

1

9

Female under 35

0 1964 0 3973

0

1

Time between trips (days) 6 8498 13 7602

0

763

Max. temperature (F)

64 6149 19 8264

8

99

Holiday

0 1747 0 3797

0

1

Price ($)

2 1515 0 3782

02

6

Feature ad

0 3203 0 0579

0

1

Display

0 4174 0 0503

0

1

Chintagunta et al. 2001 for a discussion). Despite the theoretical limitations, they have been found to improve the ability to predict purchases (Guadagni and Little 1983, Erdem 1996, Keane 1997).
Summary statistics of the demographic variables and time-varying product attributes used in the estimation appear in Table 2. Table 3 breaks down the fixed characteristics by flavor group, providing a rough sense of the relative positions of the different products in attribute space. These characteristics pick up such differences as the fact that Diet Coke, which contains citric acid, does not have the same flavor as regular Coke, which does not contain citric acid. The nondiet colas, lemon/lime, and pepper drinks are quite similar, with around 150 calories on average. The root beers and the citrus beverages are substantially higher, with about 170, and the new age are substantially lower, with 120. Phosphoric acid is used in all regular colas, all the diet colas, and in all the peppers. Although citric acid is found in all the fruit drinks, it is also used in many of the other products. The caramel and clear attributes span all of the products except for the citrus (Mountain Dew), which are yellow.
5. Results
5.1. Baseline Model We now present the results from our base model. In the following section, we discuss the sensitivity of our model to some of the specification and distributional assumptions. Model parameter estimates appear in Tables 4 and 5. We begin by discussing results for the means and standard deviations of random taste parameters in (14). These are the elements of the vector in Equation (3).5 As expected, both feature ads and displays have a strong positive influence on perceived product quality. The loyalty
5 Mean tastes for fixed product attributes are obtained by regressing product fixed effects on the measured attributes. The regression uses the estimated variances of the fixed effects as weights.

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

73

Table 3 Continuous Attributes by Flavor and Diet Versus Regular (Averages)

Continuous Variables

Indicator Variables

Flavor

Calories

Mg Sodium

Carbohydrates Caffeine Phosphorus Citric Acid Caramel Clear No.

Cola Regular Diet

150 (7.5) 0 (0)

40 5 7 4 34 7 8 7

41 (1.51)

7

7

0 (0)

6

9

Lemon/lime

Regular

143.3 (5)

61 7 16 4

38 333 0 5

0

0

Diet

0 (0)

35 (0)

0 (0)

0

0

Root beer

Regular

168.3 (4.1)

44 2 14 6

44 8 1 5

0

0

Citrus Regular

170 (0)

70 (0)

46 (0)

3

0

Pepper Regular

148.6 (3.8)

45 7 8 9

35 1 15 5

3

3

4

7

0

7

9

9

0

9

2

0

2

2

1

0

1

1

0

1

0

1

3

0

3

3

0

3

0

3

parameters, brand loyalty, and product loyalty show that conditioning on past brand choices and specific UPC choices provide information in predicting current preferences. These parameters suggest that loyalty to a specific brand might be stronger than loyalty to a given UPC. For instance, consumers are slightly more loyal to Coca-Cola in general than to a specific package size of Coca-Cola. Interestingly, their effect sizes are quite small, suggesting that consumer tendencies toward specific products may be driven more by preferences than habit. We also observe significant unobserved heterogeneity in consumer perceptions of product-specific quality (the intercept term). Although we find that the mean household places

Table 4 Estimated Taste Parameters of the Quality Function

Variables in Equation (14)

Mean (S.E.)

Standard Deviations (S.E.)

: Feature ad : Display : Brand loyalty : Product loyalty : Constant : Diet : Sodium : Carbs : Caffeine : Phosphorus : Citric : Caramel : No color : Cans × 6 : Cans × 12 : Bottles × 6 : Kids  Caffeine : (Household size  Servings) : Female head < 35 Store trips

1 52 2 00 0 27 0 02 1 02 -0 06 -0 03 0 23 0 47 -0 04 0 04 0 14 0 77 1 60 0 57 0 72 0 40 0 01 1 13

0 03

0 06 0 01

0 04

0 79 0 05

0 03

--

0 16

--

0 16

1 88 0 03

0 01

0 26 0 02

0 00

--

0 02

--

0 04

--

0 07

--

0 04

1 23 0 04

0 11

0 22 0 02

0 07

--

0 02

1 19 0 11

0 03

0 30 0 02

0 11

0 19 0 02

0 03

--

0 00

--

0 03

--

169,788

Note. S.E. = standard error.

little weight on whether a CSD is diet, we also find a substantial amount of heterogeneity. In particular, the distribution suggests an almost even split between positive and negative valuations of diet. At the same time, households place weight on higher energy (carbohydrate) beverages.
Previous marketing studies have found seemingly contradictory results with regard to the effects of demographics. With a few exceptions, the research generally finds weak and inconsistent effects (discussed in Kalyanam and Putler 1997). In the case of CSDs, however, we expect different-flavored products to cater to different demographic segments. For instance, households with a female head under 35 years old tend to have higher preferences for diet products.6 In fact, we might find additional explanatory power from dummies such as female head with a college degree.7 Similarly, larger households place slightly more weight on products with more 12-oz servings, such as the 12-pack (as captured by hh size  serv). Households with kids place a higher weight on products with caffeine than those without. Despite controlling for demographic interactions, we still find evidence of unobserved heterogeneity in tastes for package size 6-packs 12-packs and diet, suggesting that demographics alone are insufficient to explain taste differences.
We now move on to Table 5, which contains the parameters characterizing the mean of the Poisson distribution, vector h in Equation (11), the exponent mh in Equation (13), the scale component Sh in Equation (12), and curvature parameter h. Similar to
6 Diet Pepsi was reintroduced in Europe with double caffeine as Pepsi Max to overcome its "feminine" image.
7 "Just who's buying all these soft drinks, anyway?" Beverage Industry, 84(3), 1993.

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

74

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

Table 5 Estimated Nonlinear Coefficients in Utility Function

Variables in Equations (11), (12), and (13)

Coefficient (S.E.)

: Kids
: Family size
: Time since last CSD
: Time since last trip
: Temperature
: Holdiay
sh: Constant sh: Family size sh: Time since last trip sh: Time since last CSD mh: Income

0 336 0 041 0 001 -0 003 0 004 0 009 1 549 0 958 0 012 0 013 2 305 0 009

0 001 0 000 0 000 0 000 0 000 0 000 0 104 0 049 0 003 0 003 0 172 0 001

Note. S.E. = standard error.

Kalyanam and Putler (1997), we find that demographics are key for identifying product holdings. We are able to capture this additional role for demographic variables by using the quantity information, which is omitted in standard DCM models of brand choice. The expected number of consumption occasions, h, depends positively on the presence of children and on family size. Thus, larger households with children should have more expected consumption occasions and, in turn, should purchase more brands on a given trip. Holiday weeks (such as Christmas, Labor Day, and Memorial Day) exhibit the expected large positive effect on needs. Similarly, temperature increases the number of expected consumption occasions. Finally, the time since the last CSD purchase increases h, but the time since the last shopping trip seems to offset this effect.
The scale of purchases, Sh, also increases with family size. Therefore, one would expect larger households to purchase larger quantities of the brands selected. Unlike the positive relationship with h, which increases the scope of products purchased, Sh impacts the actual quantity, as seen in (7). Similarly, the scale of purchases increases with both the time since the last trip and time since the last CSD purchase. The strong positive effects are consistent with the notion that household inventories have depleted and need replenishing. The vertical component, mh, increases with income, suggesting that households with higher income have a higher taste for quality (e.g., a higher willingness to pay for high-quality goods). Finally, the estimated values of are positive and below one, which is consistent with the notion that the utility function is concave.
The reported standard errors have been corrected to account for potential serial dependence. We attempt to control for as many of the observed potential dynamic factors, such as timing of trips, loyalty, and inventories, as possible. Despite these controls, we still find unexplained persistence in the residuals.

Accounting for time-series increases some of the standard errors by as much as a factor of 1.8 in comparison with the simple robust standard errors.8 Nonetheless, almost all the parameters remain significant after this correction, probably because of the extremely large sample. For now, we have not derived an explicit source for this persistence, focusing solely on the precision of our standard errors. Because most marketing studies do not correct for unobserved timeseries, these findings suggest the need for further research into how well existing static models capture both heterogeneity as well as choice dynamics.

5.2. Aggregate Demand and Substitution Patterns

We use elasticities to measure consumer sensitivity

to marketing mix variables. Because households do

not face the same mix of marketing variables across

shopping trips, we report elasticities in response to

uniform percentage changes in marketing mix vari-

ables. Following Ben-Akiva and Lerman (1985), we

report the sum of the elasticity on each trip,

i pk

,

weighted by the share of total unit sales:

T t=1

ti pk

Qti /

T t=1

Qti

i=1

I.

i pk

=

Table 6 presents estimated own-price, feature ad,

and display elasticities for the baseline model. All

of the own-price elasticities are greater than one,

which is consistent with typical static category-pricing

models. Because feature ads and displays are binary

variables, we report the change in demand from

switching from a zero value to a one. We find that

advertising has the largest impact on caffeine-free diet

colas, the 12-pack of peppers, and on the lemon-lime

products. In contrast, regular colas appear to have

the lowest advertising and display responses. We also

find that advertising has a relatively small effect on

the 6-packs of cans and bottles, and a relatively large

effect on 67.6-oz bottles. We find similar effects from

display. From a retail manager's perspective, these

results suggest that the ability to stimulate consumer

response from marketing tools, such as newspaper

advertising and in-store displays, will vary for differ-

ent flavors and for different package types.

In a separate Appendix (available from the authors

on request), we present the cross-price elasticities

from the baseline model. The predicted substitu-

tion patterns show that, most importantly, consumers

seem to respond to price changes by switching

to another product of the same size. Most of the

observed substitution patterns reflect realistic interac-

tions. Almost all products substitute primarily to a

cola. Also, 6-packs of caffeine-free Diet Pepsi are very

substitutable with 6-packs of Diet Pepsi. Mountain

Dew and Dr. Pepper are generally predicted as likely

substitutes. Surprisingly, we find little interaction

8 We do not find any evidence of cross-sectional dependence.

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

75

Table 6

Own Price, Ad, and Display Elasticities for the Baseline Model and Multinomial Comparison Model

Products

Multinomial Model

Baseline Model

No Price Prices

Price Feature Ad Display in

in

PEPSI 6P

-2 38 1 41

COKE CLS 6P

-2 11 2 25

PEPSI DT 6P

-3 61 2 01

COKE DT 6P

-2 47 2 32

DR PR 6P

-3 14 2 78

MT DW 6P

-3 04 2 85

PEPSI DT CF 6P

-3 56 2 69

A&W CF 6P

-3 59 3 57

PEPSI 16 oz

-2 25 1 42

PEPSI 12P

-2 16 2 44

COKE CLS 12P

-2 13 2 40

COKE DT 12P

-2 50 2 33

PEPSI DT 12P

-2 66 3 16

DR PR 12P

-2 47 3 95

MT DW 12P

-3 02 3 09

COKE DT CF 12P -2 76 4 05

SP CF 12P

-2 57 4 71

PEPSI DT CF 12P -2 92 6 20

PEPSI 67.6 oz

-2 62 2 10

COKE CLS 67.6 oz -2 80 3 41

PEPSI DT CL 67.6 oz -2 66 3 16

COKE DT 67.6 oz -2 81 4 65

DR PR 67.6 oz

-2 94 3 18

7UP R CF 67.6 oz -2 57 3 13

7UP DT CF 67.6 oz -2 61 3 41

MT DW 67.6 oz

-3 23 4 11

1 69 -0 59 2 49 -0 59 1 98 -0 62 2 47 -0 67 2 81 -0 73 3 06 -0 72 2 87 -0 68 3 84 -0 73 1 50 -0 85 2 69 -0 64 2 67 -0 64 2 31 -0 72 3 63 -0 74 4 20 -0 81 3 04 -0 82 3 45 -0 78 4 97 -0 78 6 14 -0 81 2 23 -0 42 3 42 -0 43 3 40 -0 47 4 77 -0 48 3 32 -0 49 3 57 -0 45 3 47 -0 47 4 16 -0 49

-1 29 -1 32 -1 35 -1 46 -1 51 -1 37 -1 44 -1 54 -1 68 -1 40 -1 39 -1 53 -1 61 -1 69 -1 54 -1 61 -1 53 -1 70 -1 02 -1 04 -1 10 -1 19 -1 16 -1 02 -1 01 -1 07

Notes. 6P = 6-pack; CLS = classic; DT = diet; DR PR = Dr. Pepper; MT DW = Mountain Dew; CF = caffeine free; 12P = 12-pack; SP = Sprite; CL = Cola; R = regular.

between Sprite and 7UP, mainly because they do not include comparable sizes in the choice set.
5.3. Model Sensitivity In this section, we check the sensitivity of our baseline model to various underlying assumptions. In Tables 7 and 8, we present results from comparison models to investigate the sensitivity of our taste parameters to the specification of consumption occasions. We also report the mean-square error from out-of-sample predictions in Table 8, where we re-estimate each model using the first eight quarters of data, using the ninth quarter as a holdout sample.
The baseline model's parameter estimates appear in the first column. In the second column (heterogeneous Poisson), we check the sensitivity of our Poisson assumption by mixing it with a normally distributed random intercept. This modification offsets some of the restrictive properties of the Poisson, such as the equal mean and variance. The use of this more flexible distribution leads to smaller parameter magnitudes in the mean of the Poisson, as well as the vertical component, mh. However, we do not see a notable impact on the taste parameters. We also see a

relatively lower predictive ability out of sample than the baseline model.
In the third column (reference prices), we control for price expectations using proxies for reference prices (see Kalyanaram and Winer 1995 for a survey). Using a price index for the previous trip, as well as for the current trip, we implicitly assume that consumers use past observations of shelf prices to form an internal reference point with which to assess the current price level (Winer 1985).9 The omission of price expectations could limit the model if, for instance, households defer some of their current purchases in anticipation of better prices on a subsequent trip. Interestingly, these additional controls reduce the size of the random intercept in . However, as before, the taste parameters appear to be fairly robust to this change. Out of sample, this model performs very similarly to the simple heterogeneous Poisson. Although beyond the scope of the current analysis, others have modeled forward-looking behavior by consumers more formally in the context of discretechoice models when consumers have expectations about prices (Gonul 1999) or quality (Erdem and Keane 1996).
In the final column (deterministic Jh), we investigate the role of modeling the consumption occasions. We check the sensitivity of the Poisson specification by restricting the number of decisions made on a given trip to be equal to the actual number of alternatives purchased, making Jh deterministic Jht = forIi=1mIaQnihta>g0 e.rsTrhuisnnminogdeplowlicoyulsdimhualvaetiolinms,itbedecaaupspeeaitl cannot predict the changes in consumers' demand in response to a counterfactual change in marketing conditions. Although many of the parameters appear qualitatively unchanged, the scale of purchases, Sh, now depends very heavily on family size. Offsetting this effect, the interaction between family size and package size (in the tastes) becomes insignificant. Similarly, the responses to feature ads and displays increase dramatically, suggesting these parameters may be relatively more sensitive to the ability of the model to forecast the number of consumption occasions. These changes are likely related to the fact that conditioning on the total number of brands in the shopping basket also provides information about no-purchase. To provide a reasonable out-of-sample predictive fit, we do not condition on the observed number of brands. Instead, we set Jh equal to household h's average number of brands per trip in the estimation sample (average brands). We also set Jh equal to the predicted number of brands using a simple regression of total brands on the covariates used in h in the baseline model (regression). For both cases, we
9 We thank Russ Winer for suggesting this approach.

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

76

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

Table 7 Nonlinear Coefficients
Variables
h: Intercept h: Kids h: Family size h: Time since last CSD h: Time since last trip h: Temperature h: Holdiay h: Favorite products h: Overall prices h: Lag favorite products h: S.D. of intercept sh: Constant sh: Family size sh: Time since last trip sh: Time since last CSD mh: Income
Hansen's J (degrees-of-freedom)

Baseline
-- 0 336 0 001 0 041 0 001 0 001 0 000 -0 003 0 002 0 004 0 001 0 009 0 004
-- -- -- -- 1 549 0 104 0 958 0 049 0 012 0 003 0 013 0 003 2 305 0 172 0 009 0 001 629.49 (206)

Out-of-sample MSE Store trips

0.0407 169,788

Notes. S.D. = standard deviation; MSE = ?; lag = ?.

Heterogeneous Poisson
0 330 0 001 0 040 0 000 0 001 0 000 0 003 0 000 -0 003 0 000 0 010 0 000 0 056 0 02
-- -- -- 1 535 0 084 0 978 0 048 0 013 0 001 0 013 0 004 2 344 0 143 0 009 0 520 0 009 0 001 649.94 (204)
0.0417 169,788

Reference Prices
0 076 0 000 0 328 0 001 0 040 0 000 0 001 0 000 -0 003 0 001 0 003 0 001 0 010 0 004 1 007 0 004 0 466 0 002 -0 427 0 002 0 056 0 000 1 545 0 079 0 986 0 049 0 013 0 001 0 013 0 003 2 358 0 165 0 010 0 001 641.24 (201)
0.0418 169,788

Deterministic Jh

-- -- -- -- -- -- -- -- -- -- -- 0.132 (0.024) 8.662 (0.037) 0.010 (0.002) 0.009 (0.005) 2.699 (0.520) 0.008 (0.001) 534.97 (212)

Average Brands

Regression

0.0475

0.0491

169,788

find that the baseline model provides a better out-of-

sample fit according to the mean-square error.

To pursue the role of consumption occasions fur-

ther, we now consider a purely statistical model that

treats the total number of items in the shopping bas-

ket Qth =

I i=1

Qiht

as a Poisson random variable. The

allocation of these items across the 26 brands is mod-

eled as a multinomial distribution. The corresponding

success probabilities for this multinomial distribu-

tion are modeled as standard random coefficients log-

its. The derivation of this model is provided in the

Appendixes. We report empirical results in Table 9.

Because the treatment of prices in the Poisson quan-

tity regression is arbitrary, we report a specification

with no prices included, as well as a specification with

the mean of all 26 prices for the shopping trip.10

Interestingly, demographic variables seem to play

a comparable role in determining the expected total

number of product alternatives purchased. Note

that the taste parameters do not have precisely the

same interpretation as in the baseline model. In the

"quantity-then-brand choice" model, we need to nor-

malize one of the alternatives (we use A&W), so that

10 We also attempted to include each of the 26 product prices in the Poisson model, adding an additional 26 parameters. Although this specification did not alter the other model parameters dramatically, several of the price coefficients had positive signs. For a category monopolist, this would imply that setting the corresponding prices to infinite would cause consumers to have infinitely large shopping baskets.

our results are relative to this base brand.11 Marketing mix parameters have the expected signs, although there seems to be much less heterogeneity in the response to feature ads and displays. Unexpectedly, the response to last product purchased is negative, in contrast with the baseline model, where it is positive. This result would suggest that households are loyal to brands, but vary the package sizes they purchase. We also note the strong role of including prices in the mean of the quantity regression, . First, the mean response to prices ( in the brand probabilities) increases substantially. Second, many of the variance terms increase, implying a larger degree of heterogeneity.
In Figure 1, we see that the baseline model and the multinomial model provide comparable aggregate sales predictions, although the multinomial model underpredicts demand for the larger-share items. We attribute this problem to the difficulty in relating quantity decisions for each brand to their respective shelf prices. In the multinomial model, the quantity price elasticities are all captured through a single parameter (the coefficient on mean trip price in ). Similarly, the single-price parameter may not account well for different package sizes (e.g., cents off a 6pack of cans may not be equivalent to cents off a 2-liter bottle). In contrast, the baseline model allows consumers to assess each brand's quality to price
11 This normalization also prevents us from recovering the mean tastes for product attributes using the weighted regression approach for the baseline model.

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

77

Table 8

Taste Coefficients for Fixed Attributes in Quality Function-- First Stage Only

Variables

Baseline Heterogeneous Reference Deterministic

Model

Poisson

Prices

Jh

: feature ad : S.D. feature ad : Display : S.D. display : Brand loyalty : Product loyalty : S.D. constant : S.D. diet : S.D. citric : S.D. caramel : S.D. cans × 6 : S.D. cans × 12 : S.D. bott × 6 : (Kids  Caffeine) : (Household size 
Servings) : (Female head <
35  Diet) Store trips

1 52 0 03 0 06 0 01 2 00 0 04 0 79 0 05 0 27 0 03 0 02 0 16 1 88 0 03 0 26 0 02 1 23 0 04 0 22 0 02 1 19 0 11 0 30 0 02 0 19 0 02 0 40 0 03 0 01 0 00 1 13 0 03 169,788

1 41 0 03 0 06 0 01 1 79 0 04 0 78 0 03 0 28 0 04 0 02 0 09 1 87 0 02 0 26 0 02 1 24 0 05 0 21 0 02 1 21 0 10 0 30 0 01 0 19 0 03 0 39 0 02 0 01 0 00 0 94 0 04 169,788

1 41 0 04 0 06 0 01 1 79 0 05 0 79 0 07 0 28 0 05 0 02 0 01 1 89 0 04 0 26 0 03 1 24 0 04 0 21 0 02 1 21 0 10 0 30 0 02 0 19 0 02 0 39 0 03 0 01 0 00 0 94 0 04 169,788

7 32 0 05 0 44 0 02 7 69 0 06 1 63 0 03 0 37 0 03 -0 00 0 02 1 22 0 01 0 38 0 01 0 10 0 02 0 00 0 01 0 00 0 02 0 00 0 01 0 01 0 06 2 15 0 08 0 00 0 00 2 01 0 03 169,788

Note. S.D. = standard deviation.

ratio for both quantity and brand choices. Referring back to Table 6, we can also see that the multinomial model predicts own-price elasticities that are much lower than those of the baseline model. In the specification that omits prices entirely from the mean of the quantity regression, the elasticities are all less than one in magnitude, which would be inconsistent with standard category management pricing models. Note that this finding of inelastic brand choice probabilities is consistent with previous work studying the role of quantities (e.g., Chintagunta 1993). Including prices in the quantity regression results in more elastic estimates of demand, albeit substantially lower than those of the baseline model. Although not reported, using these estimates to study category pricing implies negative marginal costs (the implied margins are larger than the observed shelf prices). These results may suggest the importance of allowing prices to affect individual brand choices, as well as brandspecific quantity decisions.

Table 9

Taste Coefficients for the "Quantity-Then-Brand Choice" Model

Variables

No Price in

¯ Mean (S.E.)

S.D. (S.E.)

Prices in

¯ Mean (S.E.)

S.D. (S.E.)

: Price : Feature ad : Display : Product loyalty : Brand loyalty : Intercept

-2 839 -0 039
0 036 0 006 0 571 0 005 2 761 0 003 -1 114 0 029

: Diet

: Citric

: Caramel

: Cans  6

: Cans  12

: Bottles  16

: Kids  Caffeine
: (Family size)  Servings
: Female < 35  Diet
: Kids
: Family size
: Time since last CSD
: Time since last trip
: Temperature
: Holiday
: Price
Store trips

0 1552 0 0077 0 000 0 0004 -0 543 0 0057 0 309 0 002 -0 136 0 001 0 018 0 000 -0 013 0 000 -0 008 0 000 0 299 0 005
-- --

0 059 0 019 0 031 0 005 0 0025 0 004
0 056 0 002 0 019 0 003 0 026 0 004 0 160 0 008 0 018 0 003 0 053 0 003 0 049 0 013
169,788

-6 241 0 041 0 007 0 006 0 504 0 006 2 209 0 0034
-0 613 0 032
-0 014 0 008
-0 001 0 001
-0 701 0 009 0 127 0 002 0 057 0 001 0 027 0 001
-0 011 0 000 0 0017 0 000 0 400 0 005
-0 382 0 003

3 026 0 027 0 027 0 005 0 0016 0 005
0 524 0 015 0 969 0 005 0 525 0 005 0 369 0 004 0 336 0 009 1 178 0 006 2 636 0 01

Notes. S.E. = standard error; S.D. = standard deviation.

6. Conclusions
Although the typical logit and probit DCMs have provided useful predictions for consumer purchases in many product categories, their restrictive single-unit purchase assumption seems inappropriate for several categories, such as CSDs. Instead, we estimate a model that allows consumers to purchase a bundle of products within a category. In addition, demographic variables, which have typically been found

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

78

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

Figure 1

Model Sensitivity: Predicted Aggregate Sales (In-Sample) for Baseline Model and Multinomial Model

8000 7000

Actual Sales Baseline Model Multinomial Model

6000

5000

4000

3000

2000

1000

0

0

5

10

15

20

25

30

to provide little information in marketing applications, are instrumental in determining the joint distribution of total product alternatives and total units purchased on a given trip. Demographics also partially explain observed differences in tastes for product attributes. We also find that the correction for a 15-day lag in the persistence of the residuals has a substantial impact on estimated standard errors of choice model parameters. The estimates of consumer preferences seem to be fairly robust to some of the crucial underlying model assumptions.
The proposed specification derives from a microeconomic framework of consumer choice. In addition to providing intuition for the underlying model parameters, the structural model could also be useful for policy simulations that require economic metrics such as consumer willingness to pay. To demonstrate the advantages of the derivation, we compare our estimates to an alternative statistical "quantitythen-brand choice" model that also captures multiple discreteness. Whereas the alternative model provides comparable in-sample predictions of aggregate demand, it does not provide sensible price elasticities.
The current results suggest that accounting for multiple discreteness may be relevant for measuring the sensitivity of consumer demand to marketing mix. Future research might consider the additional role of attribute satiation on a given shopping trip.

Although simulating the consumption occasions, one could introduce flavor interaction terms that reflect which flavor combinations have been selected across expected consumption occasions. In addition to linking decisions across consumption needs, these interaction terms would also provide a statistical test for complementarities between flavors.
Finally, the current analysis accounts for variety in consumer purchases during a trip. Future research may benefit from examining how shopping dynamics influence consumer shopping baskets. For instance, the number of consumption occasions during a trip could be a function of both expectations about future prices and the rate of consumption or inventory depletion. Whereas we attempt to proxy for these effects, current research may help provide guidance in how to model these aspects formally (Erdem et al. 2002).
Acknowledgments The author is very grateful to his thesis committee: David Besanko, Tim Conley, Sachin Gupta, and Rob Porter. He also thanks the area editor and three anonymous reviewers, as well as Eric Anderson, Pradeep Chintagunta, Sanjay Dhar, Michaela Draganska, Anne McGill, Puneet Manchanda, and Peter Rossi for their comments. The author also benefited from comments from seminar participants at the University of California­Berkeley, Cornell, Northwestern University, Rochester, the University of Chicago GSB, the University of

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

79

Toronto, Washington University, and Yale School of Management. Scanner data used in this study were provided by ACNielsen. Financial support from a Northwestern University Dissertation Grant, the Center for the Study of Industrial Organization, and the Kilts Center for Marketing (GSB) is gratefully acknowledged.

Appendix A: GMM Procedure
Using (10), we define the prediction error ht Dht Xht 0 = EQ Dht Xt - Qht, where the vector Qht contains the observed purchases. At the true parameter values, 0:

E ht Dht Xht 0 = -0I

h = 1 H and t = 1 Th

(15) We also assume that:

E ht Dh 0 hk Dht 0 = t-k

(16)

where t-k is a finite I × I matrix. Using (15), we can construct conditional moments based on Zht = Dht  IJ , which is independent of the unobservables (Hansen 1982):
E Zht  ht Dht 0 Zht = -0I

For estimation, we use the sample analog of these conditional moments:

g DHT

1 H Th

=

HT

Zht 
h=1 t=1

ht Dht

(17)

where DHT  D1T 1

DHTH denotes the matrix contain-

ing all of the household/trip information for the sample

of H households, each making Th shopping trips, and T =

1/H

H h=1

Th.

We

search

for

the

value

GMM that minimizes

the function JHT given by:

JHT = g DHT

WHT g DHT

(18)

For the weight matrix, WHT , we use the inverse of the asymptotic variance of g which gives asymptotically effi-

cient estimates under certain regularity conditions (Hansen

1982). The computation of W is discussed below. This

framework gives estimates with the following asymptotic

distribution:



N GMM - 0 = N 0

(19)

=

plim

dg Dht d

0

Wplim

dg Dht d

0

-1
(20)

Appendix B: Estimation of the Weight Matrix, W
Hansen (1982) shows that, under certain regularity condi-
tions, the efficient weighting matrix WHT is the inverse of S, the variance of the sample moments. The variance of the
moments has the following form:

S = lim H T

HT · E E

g DHT

0 g DHT

0

= lim H T

1 H Th Th E
HT h=1 t=1 k=1

1 1 + R Zht tkZhk

DHT (21)

where R is the number of simulation draws. Similar to the discussion in McFadden (1989), the added simulation "noise" will not affect the consistency of the estimator, but it will reduce the efficiency by a factor of 1 + 1/R . As R  , the estimator approaches asymptotic efficiency (we use 30 draws).
In the current context, S must account for the panel structure of the data. To deal with the cross-sectional aspect of the data, we include several state variables, such as temperature and seasonal dummies, to capture contemporaneous aggregate demand shocks that could affect households in a similar fashion. Despite these controls, we may still find dependence in the shocks. The source of these shocks could be systematic measurement error. For instance, householdspecific reporting errors in the scanning process or shopping at nonscanner stores could generate unobserved serial dependence. Alternatively, unobserved heterogeneity not captured by the current model specification might also generate dependence. Yet another source of error consists of unobserved local factors, such as the presence of a convenience store in which consumers purchase CSDs. One might expect this latter source of error to be common across households in close proximity, potentially generating crosssectional dependence.
To estimate the matrix S, we index each observation by both time and household. We use Conley's (1999) nonparametric, positive, semidefinite covariance estimator, which is analogous to Newey and West's (1987) spectral time-series estimator. This approach allows us to correct both for serial dependence over time, as well as dependence across geographic space (e.g., households that are physically close to one another may have correlated shocks). Given a consistent
estimate and a predetermined time L and inter-household distance B, beyond which the dependence in the shocks dies out, the estimator for S is:

1 H L Th SHT = HT h l=1t=1k=t+1

t -k dhl

· M Dh k M Dl k-t

+ M Dh k-t

1 H Th

- HT

M
h=1 k=1

Dh

k

M Dh k

M Dl k (22)

where dhl is the Euclidean distance between households h and l, and M s Dh k = Zhk  hk Dhk . We use the Bartlett weight for t d to assign decreasing weight to

the correlation between households' purchases as they grow

further apart in time and space:



 1- t -k if t  L

t -k dhl = 0

1+L else

1- dhl 1+B

if dhl  B

(23)

Appendix C: "Quantity-Then-Brand Choice" Model
In this section, we describe a combined quantity-and-brand choice model that accounts for the multiple discreteness observed in the soft drink purchases. The model consists of two components. The first component, the Poisson quantity

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

80

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

regression, estimates the total number of items in the shop-

ping basket on a given trip. The total units purchased are

distributed among the various brands according to a multi-

nomial distribution. The approach is similar to Dillon and

Gupta (1996), although they use cross-sectional data and

they do not include the no-purchase option.

More formally, we assume the total number of items in

household h s basket during trip t, Qht =

I i=1

Qhit

,

is

dis-

tributed Poisson with mean, h, a function of household

characteristics. Thus, category purchases for an individual

can be written as:

P Qht = nht

=

e nht - h
h

nht !

nht = 0 1

To capture the brand choice aspect of demand, we assume consumer choices are generated by a multinomial distribution:

P Qht1 = nht1

QhtI = nhtI nh ph =

nht ! i nhit !

i

pnhit hit

where phit is the probability that consumer h chooses prod-

uct i and nht =

I i=1

nhit

are

the

total

units

purchased

on

the trip. We model the brand choice probability, phit, as a

multinomial logit:

phit = 1 +

exp Xit h

I k=1

exp

Xkt

h

where Xit is a vector of product i attributes including, marketing mix, and h is a vector of household h s response parameters. To capture heterogeneity across households, we model the parameters, h, as normally distributed random variables:
h = ¯ + Dh + h
where ¯ is the mean response across households, is a diagonal matrix whose elements are standard deviations, and h is a vector of i.i.d. standard normal deviates. As in the proposed model, we capture correlations in product valuations using random tastes for product attributes.
Assembling the components of the model, we can write the conditional likelihood for household h's category purchase vector on trip t:

Lht =

e nht - h
h
nht !

nht ! i nhit !

i

pnhit hit

The conditional likelihood of household h's entire purchase

history is then computed as Lh = t Lht . Accounting for the uncertainty in household h s response parameters, we

obtain the unconditional likelihood: Lh = t Lht

d,

where · is the probability density function of a standard

normal random variable. To estimate the model parameters , ¯, and , we use simulated maximum likelihood (see,

e.g., Erdem 1996).

Note that this alternative multinomial specification

shares many similarities to the proposed model of §2. For

instance, unlike standard brand choice models, we explic-

itly use the information contained in the quantity purchases.

A subtle difference in this model is that the total number

of items in the shopping basket is determined by the Poisson. In the proposed model of §2, the Poisson distribution determines the number of consumption occasions, placing an upper bound on the number of brands chosen. However, the actual nunber of units of each of the selected brands is not constrained by the Poisson.
References
Allenby, Greg M., Thomas S. Shively, Sha Yang, Mark J. Garrett. 2001. A choice model for packaged goods: Dealing with discrete quantities and quantity discounts. Marketing Science 23 95­108.
Anderson, E., N. Vilcassim. 2001. Structural demand models for retail category pricing. Working paper, University of Chicago, Chicago, IL.
Ben-Akiva, M., S. R. Lerman. 1985. Discrete Choice Analysis: Theory and Applications to Travel Demand. The MIT Press, Cambridge, MA.
Berry, S. 1994. Estimating discrete-choice models of product differentiation. Rand J. Econom. 25 242­262.
Berto Villas-Boas, Sofia. 2001. Vertical contracts between manufacturers and retailers: An empirical analysis. Working paper, University of California, Berkeley, CA.
Chiang, J. 1991. The simultaneous approach to the whether, what, and how much to buy questions. Marketing Sci. 10 297­315.
Chintagunta, P. 1992. Estimating a multinomial probit model of brand choice using the method of simulated moments. Marketing Sci. 11 386­407.
Chintagunta, P. 1993. Investigating purchase incidence, brand choice and purchase quantity decisions of households. Marketing Sci. 12 184­208.
Chintagunta, P, J. P. Dubé, V. Singh. 2002. Balancing profitability and customer value: An application to zone-pricing by a supermarket chain. Working paper, University of Chicago, Chicago, IL.
Chintagunta, P., E. Kyriazidou, J. Perktold. 2001. Panel data analysis of household brand choices. J. Econometrics 103 111­153.
Conley, T. G. 1999. GMM estimation with cross-sectional dependence. J. Econometrics 92(1) 1­45.
Dillon, W. R., S. Gupta. 1996. A segment-level model of category volume and brand choice. Marketing Sci. 15 38­59.
Erdem, T. 1996. A dynamic analysis of market structure based on panel data. Marketing Sci. 16 359­378.
Erdem, T., M. P. Keane. 1996. Decision-making under uncertainty: Capturing dynamic brand choice processes in turbulent consumer goods markets. Marketing Sci. 15 1­20.
Erdem, T., S. Imai, M. P. Keane. 2002. A model of consumer brand and quantity choice dynamics under price uncertainty. Quantitative Marketing Econom. 1(1) 5­64.
Fader, P. S., B. G. S. Hardie. 1996. Modeling consumer choice among SKUs. J. Marketing Res. 33 442­452.
Gönül, F. F. 1999. Estimating price expectations in the OTC medicine market: An application of dynamic stochastic discrete choice models to scanner panel data. J. Econom. 89 41­56.
Gönül, F. F., K. Srinivasan. 1996. Estimating the impact of consumer expectations of coupons on purchase behavior: A dynamic structural model. Marketing Sci. 15 262­279.
Guadagni, P. M., J. D. C. Little. 1983. A logit model of brand choice calibrated on scanner data. Marketing Sci. 2 203­238.
Hansen, L. P. 1982. Large sample properties of generalized method of moments estimators. Econometrica 50 1029­1054.
Harlam, B. A., L. M. Lodish. 1995. Modeling consumers' choices of multiple items. J. Marketing Res. 32(November) 404­418.

Dubé: Multiple Discreteness and Product Differentiation: Demand for Carbonated Soft Drinks

Marketing Science 23(1), pp. 66­81, © 2004 INFORMS

81

Hauser, J. R., B. Wernerfelt. 1990. An evaluation cost model of consideration sets. J. Consumer Res. 16 393­408.
Hendel, I. 1999. Estimating multiple-discrete choice models: An application to computerization returns. Rev. Econom. Stud. 66 423­446.
Kalyanam, K., D. S. Putler. 1997. Incorporating demographic variables in brand choice models: An indivisible alternatives framework. Marketing Sci. 16 166­181.
Kalyanaram, G., R. S. Winer. 1995. Empirical generalizations from reference price research. Marketing Sci. 14 161­169.
Keane, M. P. 1997. Modeling heterogeneity and state dependence in consumer choice behavior. J. Bus. Econom. Statist. 15 310­327.
Krishnamurthi, L., S. P. Raj. 1988. A model of brand choice and purchase quantity price sensitivities. Marketing Sci. 7 1­20.
Manchada, P., A. Ansari, S. Gupta. 1999. The "shopping basket": A model for multicategory purchase incidence decisions. Marketing Sci. 18 95­114.
McAlister, L. 1982. A dynamic attribute satiation model of varietyseeking behavior. J. Consumer Res. 9 141­150.
McCulloch, R., P. E. Rossi. 1994. An exact likelihood analysis of the multinomial probit model. J. Econometrics 64 207­240.
McFadden, D. 1981. Econometric models of probabilistic choice. C. Manski, D. McFadden, eds. Structural Analysis of Discrete Data with Econometric Applications. MIT Press, Cambridge, MA.

McFadden, D. 1989. A method of simulated moments for estimation of discrete response models without numerical integration. Econometrica 57 995­1026.
Montgomery, A. L. 1997. Creating micro-marketing pricing strategies using supermarket scanner data. Marketing Sci. 16 315­338.
Newey, W. K., K. D. West. 1987. A simple positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. Econometrica 55 703­708.
Pakes, A., D. Pollard. 1989. Simulation and the asymptotics of optimization estimators. Econometrica 57 1027­1057.
Rossi, P. E., G. Allenby. 1993. A Bayesian approach to estimating household parameters. J. Marketing Res. 30 171­182.
Seetharaman, P. B. 1999. Modeling serial correlation in household brand choices using a multinomial probit model of brand choice. Working paper, Washington University, St. Louis, MO.
Simonson, I. 1990. The effect of purchase quantity and timing on variety-seeking behavior. J. Marketing Res. 27 150­162.
Smith, R. J. 1992. Non-nested tests for competing models estimated by generalized method of moments. Econometrica 60 973­980.
Walsh, J. W. 1995. Flexibility in consumer purchasing for uncertain future tastes. Marketing Sci. 14 148­165.
Winer, R. S. 1985. A price vector model of demand for consumer durables: Preliminary developments. Marketing Sci. 4 74­90.

