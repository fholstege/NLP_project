http://pubsonline.informs.org/journal/mksc

MARKETING SCIENCE
Vol. 39, No. 4, July­August 2020, pp. 763­787 ISSN 0732-2399 (print), ISSN 1526-548X (online)

A Flexible Demand Model for Complements Using Household Production Theory

Ludovic Stourm,a Raghuram Iyengar,b Eric T. Bradlowb
a HEC Paris, Jouy-en-Josas, France 78350; b Wharton School, University of Pennsylvania, Philadelphia, Pennsylvania 19104 Contact: stourm@hec.fr, https://orcid.org/0000-0002-5477-2992 (LS); riyengar@wharton.upenn.edu,
https://orcid.org/0000-0002-7999-302X (RI); ebradlow@wharton.upenn.edu (ETB)

Received: August 22, 2017 Revised: October 16, 2018; July 31, 2019; November 9, 2019 Accepted: December 2, 2019 Published Online in Articles in Advance: July 15, 2020
https://doi.org/10.1287/mksc.2019.1218
Copyright: © 2020 INFORMS

Abstract. According to household production theory, consumers buy inputs and combine them to produce final goods from which they derive utility. We use this idea to build a micro-level model for the quantity demanded by a consumer across product categories. Our model proposes an intuitive explanation for the existence of negative cross-price effects across categories and can be estimated on purchase data in the presence of corner solutions and indivisible packages. We find that, even when reusing the same functional form as some previous models of demand for substitutes, our model can accommodate very different patterns of consumer preferences from perfect complementarity to no complementarity between goods. We estimate the model on purchase data from a panel of consumers and find that it yields a better fit than a set of benchmark models. We then show how the demand system estimated can be used to increase the profitability of couponing strategies by taking into account the spillover effect of coupons on demand for complementary categories and by manufacturers to make decisions regarding the size of packages by taking into account cross-category consumption. We also use the model to simulate demand under a shift in the proportions used in joint consumption, which could be stimulated via marketing efforts.

History: Avi Goldfarb served as the senior editor for this article. Funding: The authors thank the Jay H. Baker Retailing Center for funding. Supplemental Material: The data/replication files are available at https://doi.org/10.1287/mksc.2019.1218.

Keywords: utility theory · multicategory demand models · Bayesian estimation

1. Introduction
Consumers commonly purchase multiple goods to consume them jointly. For example, they buy burgers and buns to make sandwiches, they combine detergent and softener for their laundry, or eat crackers with dips. From a managerial point of view, crosscategory consumption provides an opportunity for coordinated promotion and pricing across goods. A rigorous analysis of optimal marketing strategy, therefore, first requires a model of demand in a way that takes into account the volumes purchased by consumers across categories. Not surprisingly, modeling demand across categories has been an important area of research in the marketing literature.
By leveraging household-level data of purchases made across categories and over time, marketing researchers have built models to estimate demand at the micro level (Manchanda et al. 1999, Mehta 2007, Song and Chintagunta 2007, Niraj et al. 2008, Mehta and Ma 2012, Lee et al. 2013). Many of these econometric models take a utility-maximization paradigm to obtain parameters that are invariant to policy changes. In this paradigm, the starting point is that consumers choose to buy the quantities of goods that maximize their utility

under a budget constraint. The goal of estimation is, therefore, to find the parameters of the model that best explain the purchases observed under the assumption that these purchases are the result of an optimization problem. From this common setup, two main approaches, which specify a parametric form on two different economic objects, have been developed.
In the first approach, the researcher specifies a functional form for the consumer's indirect utility and applies Roy's identity to derive the demand function, which relates the parameters of the indirect utility function to the consumer's quantity decisions as a function of prices. The translog indirect utility specification is often used as it can approximate any function at a second-degree level and can yield substitution and/or complementarity effects between goods. In the second approach, the researcher parameterizes the consumer's direct utility function and solves the firstorder conditions (FOCs) to obtain the demand system. In that framework, additively separable utility specifications cannot yield negative cross-price effects under a linear budget constraint (Chintagunta and Nair 2011), but they can be achieved using quadratic specifications with interaction terms (Kim et al. 2010).

763

764

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

In either approach, however, the model does not provide any intuitive explanation for the existence of complementary effects across categories: although interaction terms can yield negative cross-price effects, they do not inform the researcher why two categories are complementary.
In this paper, we develop a new approach that provides a micro-foundation on how complementarity is generated across categories as a result of preferences for joint consumption uses. Our approach relies on household production theory (Becker 1965, Muth 1966): the original consumer problem is altered to distinguish between inputs that can be purchased and latent final goods that can be consumed and provide utility. We represent the joint consumption of multiple inputs by a separate final good: for example, buns and burgers can be purchased (and consumed separately), but sandwiches can be produced from buns and burgers. Formally, the consumer has a utility function defined on goods consumed (e.g., sandwiches, burgers and buns) but can only buy inputs (e.g., burgers and buns). He or she decides not only what inputs to purchase but also what final goods to produce for his or her own consumption. This conceptual model is equivalent to the original one if we assume that the final goods are identical to the goods purchased, but it is more general if we assume that a broader set of final goods can be produced from the goods purchased.
We show that this conceptual model is useful to derive a flexible model of purchases across complements even if consumption is unobserved because it allows us to specify a parametric form for the utility of final goods. While a direct utility on inputs purchased can always be derived from the utility of final goods, its functional form is not straightforward. In fact, even an additively separable functional form for the utility on final goods, which we utilize in our model specification, can capture very different patterns of preferences for inputs purchased, including perfect complementarity.
In an empirical application, we estimate our model on purchase data from a panel of consumers, focusing on the tortilla chips and Mexican salsa categories. We find that it fits the data better than a set of benchmark models based on the deviance information criterion (DIC) and performs well in predicting purchase incidence and quantity. We also show the usefulness of our model to determine the optimal distribution of retailer coupons in a set of counterfactual analyses. We find that the retailer can make a higher profit by taking into account the spillover effects of coupons across categories, which can be measured using our flexible demand system. We also illustrate how the model can be used to inform package size decisions by manufacturers, thus demonstrating its potential value to both

retailers and manufacturers. In addition, we use the parameters estimated to simulate demand under a shift in the proportions used in joint consumption, which may be possible by marketing that encourages the increased or decreased use of one product with another.
The rest of the paper is organized as follows. In Section 2, we formalize the economic problem of a consumer making quantity choices across related goods and review the econometric models that have been derived from it in the marketing literature. In Section 3, we lay out our general model of consumer behavior based on household production theory and show its usefulness for empirical work by studying the flexible patterns of consumer preferences it can imply over goods purchased. In Section 4, we study the properties of the demand system. In Section 5, we introduce stochastic elements in the model and describe its estimation; we also run a simulation study to investigate the consequences of ignoring complementarity between goods across categories. Section 6 describes an application of our model on household-level purchase data, and how it can inform managerial decisions in the context of retailer coupons manufacturer, package-size decisions, and in influencing changes in the proportions used by consumers when combining goods together. Section 7 concludes with a discussion of the main contributions and limitations of our model and ideas for future research.

2. Formalization and Literature

Suppose we want to model the quantities purchased

by a consumer across J goods of interest. In the

simplest microeconomic model, the consumer has a

utility function U defined on the quantities of these

goods x (x1, . . . , xJ) and the quantity y of an outside good. After observing the prices p, he or she chooses

to buy the quantities that maximize his or her utility

within his or her budget M. Mathematically, the

consumer problem is represented as

() V p, M max

() U x, y

xX ,y0

subject to : p(x) + y  M, (1)

where x belongs to a feasible set X , p(x) is the dollar amount to be paid to buy the quantities x of inside goods, and the price of the outside good is normalized to one. In this maximization problem, U is the direct utility, V is the indirect utility, and the demand system x(p, M) gives the optimal quantities. From the observation of prices and the quantities purchased by consumers, the goal of demand estimation consists in characterizing the demand function so that one can measure the effect of prices on demand and/or predict demand under alternative scenarios with different prices p, budget M, or constraints on the set X .

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

765

Empirically estimating a demand model requires one to make parametric assumptions. While the papers by Manchanda et al. (1999) and Gentzkow (2007) focus only on purchase incidence, previous models of quantity rely mainly on two different approaches by specifying a functional form either for the indirect utility V or for the direct utility U. An indicative summary of previous models is presented in Table 1; the article by Chintagunta and Nair (2011) provides an excellent review of that literature.
In the indirect-utility approach, the researcher specifies a functional form for V. The researcher then applies Roy's identity to obtain the demand function: xj - VV//Mpj . The estimation problem consists in finding those parameters of V that best fit the data. This approach has been used to model demand across substitutable and complementary categories, providing an integrated framework for purchase incidence, volume, and brand decisions (Mehta 2007, Song and Chintagunta 2007, Mehta and Ma 2012). Parameterizing the indirect utility V bypasses the problem of specifying a functional form for the direct utility U and is thought to be a more flexible approach because the indirect utility can always be derived from a direct utility specification, but the reverse is not true. The translog indirect utility specification is often used as it can approximate any twice continuously differentiable function V at a second degree (Mehta 2007, Song and Chintagunta 2007, Mehta and Ma 2012).
In a second approach pioneered by Kim et al. (2002), the researcher specifies a functional form for the direct utility U and derives the demand function by solving the first-order conditions of the consumer problem in

Equation (1). This approach is appealing because it

allows one to accommodate different pricing schemes

and/or constraints present in the real world by

changing the feasible set X and the price function p.

For example, Satomura et al. (2011) allow for multiple

constraints (such as a volume constraint) instead of

a single budget constraint; Lee and Allenby (2014)

capture the indivisibility of demand by including in-

teger constraints on the feasible set. Through these

extensions, researchers have gained a richer under-

standing of the impact of prices and packaging on

demand. To model demand for complements in that

approach, one cannot utility functions of the

resort to additively form Ux(x1, . . . , xJ)

seJj p1araj (bxlje)

as they can only yield nonnegative cross effects of

prices on demand under a linear budget constraint

(Chintagunta and Nair 2011). However, quadratic

utility specification with interaction terms can yield

negative cross-price effects. Alternatively, Lee et al.

(2013) assume a sequential decision process whereby

consumers make purchase decisions one category

at a time: at each stage, the consumer maximizes a

category-specific utility function that may be affected

by purchase decisions in previous categories through

an effect of inventories. Although this model allows

the authors to capture asymmetric cross-price effects,

it does not derive from the maximization of a joint

utility function, which can restrict its applicability in

counterfactual analyses, especially in measuring the

effect of policy changes on consumer welfare.

We develop a third approach, which relies on house-

hold production theory as introduced by Becker (1965)

and Muth (1966). In this view, households buy inputs

Table 1. Related Literature

Study

Modeling approach

Integrated utility model Quantity Complementarity Indivisibility

Manchanda et al. (1999)

Multivariate probit

Dubé (2004)

Poisson + logit

Chan (2006)

Characteristics model

3

Gentzkow (2007)

Discrete choice over bundles

3

Mehta (2007)

Indirect utility

3

Song and Chintagunta (2007) Indirect utility

3

Niraj et al. (2008)

Discrete choice over bundles

3

Liu et al. (2010)

Discrete choice over bundles

3

Satomura et al. (2011)

Direct utility

3

Mehta and Ma (2012)

Indirect utility

3

Lee et al. (2013)

Sequential decisions

Lee and Allenby (2014)

Direct utility

3

Current study

Household production

3

3

3

3

3

3

3

3

3

3

3

3

3

3

3

3

3

3

3

3

3

3

3

3

Notes. The third column indicates whether the demand system is derived from one utility maximization (which is necessary for welfare calculations). The models by Manchanda et al. (1999) and Lee et al. (2013) do not fit that category as they define one separate utility function per product category, and in Dubé (2004), the quantity chosen depends on an exogenous Poisson process. The fourth column indicates whether quantity is modeled (Manchanda et al. (1999), Gentzkow (2007), and Liu et al. (2010) only model purchase incidence). The fifth column indicates whether the model allows for complementarity as defined by the existence of negative cross-price effects between goods. The last column indicates whether the model recognizes the indivisibility of demand resulting from package constraints. Most models assume that the goods are infinitely divisible; Dubé (2004) and Niraj et al. (2008) take the package sizes as given and model the integer units purchased by the consumer, but their models cannot be used to analyze the effect of divisibility because they do not model the consumer utility as a function of volumes.

766

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

to produce final goods that they consume: as such, they are both producers (with a production function that transforms inputs into final goods) and consumers (with a utility function defined on final goods). In our context, we represent the joint consumption of two (or more) complements as a distinct final good that is produced and consumed by the household. We apply this idea to design a demand model for complements that allows for corner solutions and discrete demand resulting from indivisible packages. We thus build complementarity in the consumer's preferences and derive the cross-price effects from the primitives: in that sense, we extend Gentzkow (2007) by allowing for the choice of quantity instead of just incidence. Our work is closely related to the latent separability concept defined by Blundell and Robin (2000), which is a property of direct utility functions. Like the authors, we recognize that parts of the same input can be allocated to different final goods. For example, consumers may eat some burgers by themselves and combine some with buns to make sandwiches. Unlike Blundell and Robin (2000), however, we do not require fewer final goods than inputs: in fact, we include more final goods than inputs. This is because they seek to reduce the dimensionality of a large demand system by grouping goods into latent groups and we aim at flexibly estimating the demand across a small set of goods.
Our approach is also closely related to the characteristics model by Chan (2006) in which the consumer derives utility from the hedonic attributes that are present in the goods he or she purchases. In both approaches, utility is not derived directly from the goods purchased but from a transformation of these goods into benefits (consumption uses in our model, hedonic attributes in the characteristics model); while the utility specification is additively separable in terms of these benefits, it is not in terms of the goods purchased because of this transformation. In the model by Chan (2006), the transformation from goods purchased into benefits is specified a priori by the researcher using available data on the goods' attributes; in our approach, the transformation arises as the solution to an optimal consumption problem as the consumer decides how to allocate the goods purchased into consumption uses. While the characteristics model is highly scalable and provides a good explanation for the existence of complementarity between items of the same category, its explanatory power for complements may be limited if the goods purchased cannot be adequately represented by a common set of additive attributes, which is likely to happen if the goods belong to different product categories. In contrast, our approach provides an explanation for the existence of complementarity between goods from different categories but is less scalable.

Thus, we focus in this paper on cross-category demand estimation with a small number of categories, and we provide thoughts, when possible, that could make our approach more scalable in the future. In the next section, we discuss our model in more depth.

3. Model of Consumer Preferences
We start by laying out the general model of household production. Then we describe our parametric assumptions and study the implications of the resulting model for consumer preferences over goods purchased.

3.1. Consumer Problem with Household Production
By considering household production, we make a conceptual distinction between the inputs that the consumer can purchase on the market and the final goods that he or she can consume after producing them from the inputs. For example, a consumer may be able to buy burgers and buns, which are sold separately on the market, but to eat a sandwich, he or she first needs to produce it by combining a bun and a burger. In this example, burgers and buns are inputs, and sandwiches are final goods. Burgers and buns can also be consumed separately: as such, they are both inputs and final goods by themselves. We denote by J the number of distinct inputs, by K  J the number of distinct final goods that can be produced from the J inputs, by x (x1, . . . , xJ) the volumes of inputs purchased, and by c (c1, . . . , cK) the quantities of final goods constructed and consumed. Importantly, the consumer first needs to buy enough inputs to be able to produce the final goods. To do so, he or she has a budget M that he or she can spend across the inputs and to buy some quantity y of an outside good whose price is normalized to one. The consumer enjoys utility from consuming the final goods and the outside good, which is represented by a utility function U~ (c, y). The consumer problem consists in buying the optimal volumes of inputs x and outside good y, and using the inputs to produce the optimal quantities of final goods c in a way that maximizes his or her utility:1

() V p, M max
c,x,y

U~ (c,

) y

subject to : p(x) + y  M

xX

c  C(x),

(2)

where p(x) is the dollar amount to be paid by the consumer if he or she buys the volumes of inputs x and C(x) is the set of final goods that can possibly be produced from them.2
In this model, the consumer makes the best use of the inputs x by allocating them into the production of the optimal quantities of final goods c. Therefore, the

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

767

maximum value that the consumer can derive from

input quantities x and outside good quantity y can be

obtained as ()
U x, y max
c

U~ (c,

) y

subject to : c  C(x).

(3)

We can thus derive a utility U(x, y) on inputs purchased from the utility of final goods purchased U~ (c, y) by solving the optimal allocation problem in Equation (3). Under this definition of U(x, y), the consumer problem in Equation (2) can be rewritten under the original form of Equation (1). From the point of view of the consumer's purchase behavior, our model is thus equivalent to the original problem considered in Equation (1). However, adding a production­consumption step allows us to parameterize U~ (c, y) and C(x) instead of U(x, y) in the directutility approach or V(p, M) in the indirect-utility approach. The relationship between U~ (c, y), U(x, y), and V(p, M) is explained in Figure 1. In our approach, we specify a functional form on U~ (c, y) and solve the problem in Equation (2) to derive the demand system x(p, M). It should be noted that, if we assume C(x) to be the identity correspondence (C(x) {x} x so that there is no difference between goods purchased and goods consumed), then Equation (3) trivially implies U(x, y) U~ (c, y). It is thus obvious that any parameterization of U(x, y) in a direct-utility model can easily be accommodated under our approach by setting C(x) to be the identity correspondence. In contrast, Equation (3) implies that a utility function over goods purchased U(x, y) can always be inferred from a utility function over goods consumed U~ (c, y); however, the derived expression of U may not be straightforward.

3.2. Parametric Assumptions
We represent the joint consumption of multiple inputs as a final good, which is obtained by combining the inputs in fixed proportions that are known to the consumer (but unknown to the analyst). Each input can also be consumed separately, either by itself or in conjunction with some other goods that are outside the scope of the analysis. We aggregate such outside consumption uses and represent them by a final good that is obtained directly from that input.3 Therefore, the same input can be used to

Figure 1. Relationship Between U~ , U, and V in the Household-Production Model of Complementarity

produce different final goods, and some final goods may require multiple inputs. We represent this by a Leontief production function that can be described by a J × K input­output table, denoted by A, such that ajk represents the volume of input j that is required to make one unit of final good k. For example, the input­output table may look like the following in the case of burgers and buns:

( separate burger separate bun sandwich )

A burger

1

bun

0

0

1.

1

1

(4)

The set C(x) of final good quantities c that can be

produced from input volumes with nonnegative entries and

x is the set such that

ofkvaejkcctkorsxcj

for all j or in matrix form: Ac  x.

Next, we parameterize the utility function for

the final goods consumed and for the outside good

as follows:

U~ (c,

) y

U~ c

(c)

+

() Uy y

(5a)

with :

U~ c(c)

K k log(ck + 1)

(5b)

() k1 ()

Uy y 0 log y ,

(5c)

where 0, 1, . . . , K are parameters whose values are nonnegative.4 The log specification for the utility of the outside good allows for an income effect and, hence, for asymmetric cross-price derivatives as we discuss in Section 4.1. The functional form for Uc in Equation (5b) is commonly used to parameterize the utility for goods purchased U(x, y) in direct-utility models of demand (Satomura et al. 2011, Lee et al. 2013, Lee and Allenby 2014). It has desirable properties: the log function captures monotonicity and concavity in its argument, and the intercept added inside the log allows for corner solutions. It should be noted that this functional form is additively separable, which makes it easy to solve the consumer problem; however, a model in which this form is used to parameterize U(x, y) would not be able to yield complementarity between the J goods of interest, as discussed earlier. By using this functional form to parameterize U~ (c, y) instead, our model can actually capture very different patterns of preferences for complements as we show in the next section.

3.3. Implications for Consumer Preferences over Goods Purchased
In this section, we show how our model of preferences over final goods (c, y) translates into preferences over goods purchased (x, y). Using Equations (3)

768

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

and (5a)­(5c), our parameterization of U~ (c, y), implies the following utility for purchased goods U(x, y):

()

()

U x, y Ux(x) + Uy y

(6a)

K

where Ux(x)

max
c

k log(ck + 1) (6b)  k 1

subject to:

ajkck  xj j

(6c)

k

ck  0 k .

(6d)

Equations (6b)­(6d) define the consumer's problem of optimally allocating inputs to construct final goods; it does not include the input prices or the budget, as it takes the quantities of inputs as given. This problem is mathematically very similar to the multiple-constraint model by Satomura et al. (2011).5 The first-order conditions of the optimal allocation problem are as follows:

k ck +

1

+

k

-


j

jajk

0

k

(

kc)k 0 k



(7)

j xj - ajkck 0 j

k

ck, k, j  0,

where the coefficients k and j are Lagrange multi-

pliers corresponding to the nonnegativity constraints

on the quantities of final goods ck and the constraints

on the amount of inputs available, respectively. In

a case with J 2 inputs, K 3 final goods, and

A

(

1 0

0 1

1 a23

),

where

a23

represents

the

proportion

of

input 2 combined with each unit of input 1 to create

the third final good, we can easily obtain the ex-

pression of the optimal quantities of final goods

consumed as a function of the quantities of goods

purchased:

c3(x)

(( min max 0,

) c(3int)(x) ,

x1,

x2 a23

)

c1(x) x1 - c3

c2(x) x2 - a23c3,

(8)

where c(3int) is the solution to a second-degree equation as shown in Appendix A. The resulting utility over inputs purchased is then Ux(x) Uc(c(x)), whose expression cannot be simplified.
Using the expression of Ux, we illustrate in Figure 2 several indicative indifference curves obtained for
different parameter values, holding the outside good
constant and considering two goods for purchase. The
results are quite remarkable: we obtain L-shaped indif-
ference curves characteristic of perfect complementarity

whereby an additional unit of a good does not provide more utility to the consumer unless it is accompanied by an additional unit of the other good (Figure 2(a)), curves characteristic of independent goods (Figure 2(b)), and asymmetric curves (Figure 2(c)). Our model can clearly accommodate very different preferences. In contrast, we illustrate in Figure 3 some indifference curves obtained under an alternative specification of Ux that does not make use of household production but instead contains an interaction term in the log quantities. The curves are far less flexible under the alternative specification: for example, perfect complementarity cannot be obtained because Ux is strictly increasing in both x1 and x2 on the entire domain. It would thus be very difficult to specify a functional form for the utility on goods purchased Ux(x) in a way that yields flexible complementarity patterns; in contrast, our parameterization of Uc(c) has a closed-form expression and Ux(x) follows directly from it. Thus, setting up the household production problem greatly facilitates the problem of specifying a convenient functional form for the purpose of demand estimation across complementary goods.
The next section elaborates on the properties of the demand system implied by the model as a function of the preference parameters.

4. The Demand System
According to the model laid out in the previous section, the consumer buys the quantities of inputs that solve the optimization problem in Equation (2). We thus obtain a demand system x(p, M; , A), where the demand for each good j is a function of the prices p for a given value  of the consumer's preference parameters and given the input­output table A. In this section, we seek to evaluate the flexibility of our model to accommodate different demand systems. We therefore study how different values of  imply different effects of prices on demand. To do this, we first assume that any continuous quantities can be purchased: in that case, the consumer problem can be solved analytically, and we can derive useful insights. Then, we study through simulation a demand system when the goods can only be purchased as indivisible packages.

4.1. Demand Under Continuous Quantities

Let us assume that the J inputs can be purchased in

any nonnegative, continuous quantities (such that

X that

Rp(J+x))andtjhpajxtj)p. rBiceecsaaursee

linear in quantities (such any continuous quanti-

ties of inputs can be purchased, the consumer buys

the quantities that are exactly necessary to make the optimal quantities ck of final goods: given that he or she does not keep inventories, buying more inputs

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

769

Figure 2. Indifference Curves Under the Household Production Model, Using Different Parameter Values

Notes. These plots represent indifference curves over two goods purchased, holding the quantity of outside good y constant and assuming

A

(

101 011

).

Different

values

of

the

parameters

give

very

different

patterns

from

no

complementarity

(subplot

a)

to

perfect

complementarity

(subplot d).

770

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

Figure 3. Indifference Curves Under an Alternative Utility Specification

Notes. These plots represent the indifference curves obtained with an alternative utility specification: Ux(x1, x2) 1 log(x1 + 1) + 2 log(x2 + 1) + 3 log(x1 + 1) log(x2 + 1) .
In contrast to Figure 2, the patterns vary much less with different parameter values.

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

771

would only come at an extra monetary cost. Thus, the demand for inputs must be such that

xj K ajkck j.

(9)

k1

In this model with continuous quantities, we can ttthhhueesseoopobtptimtaiimnalathlqqeuuadanentmittiaiteinesdsocfkfo,rfiitininsapulusgtesofuoxdjl tsboycdkae.gfiTgnoreetgdhaeetrifinuvlgel price fk of each final good k as the dollar amount that the consumer needs to pay to produce one unit of that final good by buying all the necessary inputs:

J

fk

ajk pj .

(10)

j1

By using this definition, the consumer problem in

Equation (2) can be simplified and rewritten in terms

of the final goods only:

max

U~ (c,

) y

c,y

K

s.t.

fkck + y  M.

(11)

k1

We show in Appendix B how to solve the first-order

conditions of this revised consumer problem under our parameterization of U~ (c, y). Our specification

allows for corner solutions: only those final goods

in a set _ are consumed in a positive quantity. The

expression for the quantities of final goods con-

sumed and for the quantity of outside good are then

as follows:

ck

max

{ 0,

ky 0fk

-

} 1

where y

0(0M++l_l_fll) .

(12)

As explained in Appendix B, the set _ of final goods k for which ck > 0 can be found by sorting marginal utilities in decreasing order and comparing them to

the marginal utility of the outside good. Furthermore,

we can compute the derivatives of final good quan-

tities with respect to their full prices for k, k in _:

[



]

ck fk

 

k
0+ l_
k
0+ l_

l l

1 fk
×

-
1 fk

M+

l_
fk2

fl

I(k

k)

 0 if k k > 0 if k k .

(13)

Thus, the full price fk of a final good k has a negative effect on the quantity consumed ck of that final good.

Furthermore, the concave utility for the outside good

leads to substitution between two final goods k and k

as the terms ck/fk are cross-price derivatives

negative; in addition, these are asymmetric.6 Next, by

combining Equations (9) and (12), we can calculate

the demand for input goods xj as a function of input prices pj:

xj

K
k1

ajk

{ max 0,

ky 0fk

-

} 1

j.

(14)

From this, we can directly see that the price of an input j negatively impacts its demand xj as, for each final good k that uses input j (such that ajk > 0), an
dineccrreeaasseeiinnpcjkl.eTahdesdtoerainvainticvreesaosfeiinnpfuk at qnuda, tnhteitrieefsowrei,tha respect to their prices are as follows:

xj (Kk 1 ajkck )

pj

pj


k

ajk


k

ck fk

×

fk pj

 ajkaj k
k_ k _

ck fk

.

(15)

From Equation (15), we can make several observa-
tions. First, two inputs j and j that are never used
jointly in household production (i.e., for which there is no k such that ajk > 0 and aj k > 0) are substitutes as they feature positive cross-price effects because of the negative terms ck/fk , where k k . Second, if two goods j and j are used jointly in the household production of a final good k (such that ajk > 0 and aj k > 0), the cross-price derivative xj /pj includes the term ck/fk, which is negative; thus, our model allows for negative cross-price effects, which define complements.7 Third, if two goods j and j are exclusively used for the household production of one final
good k, then they are perfect complements; if they
are used in the same proportions, a one-dollar increase
in the price of good j has the same effect on demand
for good j as a one-dollar increase in the price of
good j ; if they are used in different proportions, then
the price effects are weighted by the proportions of each input in the construction of the joint final good. Finally, the cross-price derivatives xj /pj are not symmetric in general because the cross-price derivatives ck/fk are themselves not symmetric.
Overall, our modeling approach allows for com-
plementarity between two goods if they are used jointly in the household production of a final good;
the cross-price effects can be asymmetric, and the
concavity of the utility for the outside good also al-
lows for some form of substitution. In the next section,
we study by simulation the demand system under
integer constraints.

4.2. Demand Under Discrete Quantities
When goods can only be purchased in indivisible packages, the inputs purchased are constrained to lie on a grid such that xijt  {0, sj, 2sj, 3sj, . . .}, where sj is the amount of volume contained in one package

772

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

of good j. For example, if buns are sold by packs of

eight, then the consumer can buy 0, 8, or 16 buns, but

not five. Consistent with Lee and Allenby (2014), we

thus X

sej{t0,thsje, 2sfej .a.s.i}b.leFusretthearsmtohree,Ctahretepsriaicne

product: paid for

qp(uxa)ntitiej psj

x (xj

is linear in /sj), where pj

the number is the price of

of packages: one package.

Given the integer constraints in the consumer prob-

lem, we cannot derive a closed-form expression for

the demand system. Instead, we obtain the optimal purchase quantities x(p, M) by searching on a grid for

the values of x that maximize the consumer's objective function.8 To investigate the properties of the demand

system when quantities are discrete, we must then use

simulation. For exposition, we focus on the case in

which J

2, K

3, and A

(

1 0

0 1

1 a23

)

for

some

pos-

itive value of a23 (in Section 5.5, we discuss the ex-

tension to more than two goods). In this case, the two

inputs can be consumed separately (as represented by final goods 1 and 2) or jointly (as represented by a composite final good 3), and a23 represents the proportion of input 2 that is combined with one unit of

input 1 when they are consumed jointly.

In Table 2, we provide a summary of the demand

system for various values of the parameters  and a23 at different price points, assuming a setup in which

each of the two goods is sold by packs that contain

sj 10 units of content. We set the consumer budget equal to $50 and consider two price points for each

good ($0.50 and $1.00 per pack). We add some ran-

dom noise to the parameters  to investigate how the

parameter values and prices impact the probability

of purchase incidence for each good, the probability

of purchase co-incidence and the expected quantity

purchased of each good E[xj]. In the first set of columns, we consider a case of perfect

complementarity in which the preference parameters

for separate consumptions 1 and 2 are set to zero but the utility of a joint consumption is positive (3 > 0). In this case, the two goods are only purchased to-

gether. If the proportions used for joint consumption

are the same for both inputs (a23 1), the quantities purchased are equal, and a price discount for good 1

has the same effect as a price discount for good 2. If

joint consumption requires twice more volume of

input 2 than input 1 (e.g., a23 2), the consumer buys on average more of good 2 than good 1 but not exactly

twice as much because the goods are sold in indi-

visible packages (sometimes he or she may find it best

to buy one pack of each good).

In the second set of columns, we consider a case of no

complementarity, in which the separate consumptions

bring utility (1 > 0, 2 > 0) but the joint consumption brings no utility (3 0). In that case, purchase incidences are independent across the two goods, and

the value of a23 has no effect on demand because the

joint final good is never produced by the consumer. In addition, a price discount for one good does not affect the quantity purchased of the other good.
In the last set of columns, we consider a case in which the separate consumptions and the joint consumption bring utilities (1 > 0, 2 > 0, 3 > 0). In that case, purchase incidences are correlated, and a price discount for one good increases the quantity purchased of both goods, but to a lesser extent for the complementary good. Overall, the main arguments given in Section 4.1 also apply when demand is constrained because of indivisible packages, and we can see that the demand system can take many forms depending on the values of the preference parameters 1, 2, 3 and the proportion a23.
5. Econometric Model
In this section, we introduce stochastic elements to the model, discuss its estimation and the identification of its parameters, and perform simulations to show its robustness when applied to goods that are not complementary.

5.1. Random Shocks and Consumer Heterogeneity
We now make adjustments in the model so that it can be applied to purchase data, in the absence of consumption data. Let us introduce the subscript i to refer to a consumer and the subscript t to indicate a specific purchase occasion. Suppose that we follow N consumers, and each consumer i has Ti purchase occasions on which we observe the prices of packages pijt that he or she faces and the volumes of goods xijt that he or she buys. We take a random-utility approach to rationalize the consumer's purchase decisions under the consumer problem in Equation (2). Specifically, we assume that the  parameters in consumer i's utility function U~ cit at time t account for person-, time-, and final good-specific random shocks:

where

ikt
ikt



i(k e N 0,

ikt
2k

) .

(16)

The values ik represent the stable part of the consumer's preferences and the shocks ikt, known to the consumer at time t, capture variation over time. Fur-
thermore, we allow the proportion ai23 used in joint consumption to be heterogeneous across consumers.
The model only makes sense if the preference parameters ik and ai23 are nonnegative: thus, we consider their logarithmic transformation. We collect all individual-level preference parameters into a vector i and model unobserved consumer heterogeneity through random coefficients:

i iid [MV(N(¯) , V)

()

]

where i log i1 , . . . , log iK , log(ai23) . (17)

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

Table 2. Demand Under Different Prices and Parameter Values

Perfect complementarity 1 2 0, 3 e-4+

No complementarity 1 2 e-5+ , 3 0

Some complementarity 1 2 3 e-5+

a23 0.5

a23 1

a23 2

a23 0.5

a23 1

a23 2

a23 0.5

a23 1

a23 2

p1 0.50, p2 0.50

Pr(x1 > 0)

26%

Pr(x2 > 0)

26%

Pr(x1 > 0&x2 > 0)

26%

E[x1]

3.7

E[x2]

2.7

26%

18%

17%

26%

18%

17%

26%

18%

3%

2.9

1.8

1.9

2.9

2.7

1.9

17%

17%

17%

17%

3%

3%

1.9

1.9

1.9

1.9

25%

24%

21%

25%

24%

22%

12%

10%

8%

2.8

2.5

2.3

2.6

2.5

2.4

p1 0.50, p2 1.00

Pr(x1 > 0)

19%

Pr(x2 > 0)

19%

Pr(x1 > 0&x2 > 0)

19%

E[x1]

2.9

E[x2]

2.0

19%

12%

17%

19%

12%

9%

19%

12%

1%

2.0

1.3

1.9

2.0

1.6

0.9

17%

17%

9%

9%

1%

1%

1.9

1.9

0.9

0.9

22%

21%

20%

13%

13%

11%

7%

6%

4%

2.4

2.3

2.1

1.4

1.3

1.2

p1 1.00, p2 0.50

Pr(x1 > 0)

19%

Pr(x2 > 0)

19%

Pr(x1 > 0&x2 > 0)

19%

E[x1]

2.3

E[x2]

1.9

19%

12%

9%

19%

12%

17%

19%

12%

1%

2.0

1.3

0.9

2.0

2.1

1.9

9%

9%

17%

17%

1%

1%

0.9

0.9

1.9

1.9

13%

13%

11%

22%

21%

20%

7%

6%

4%

1.4

1.3

1.2

2.3

2.3

2.2

p1 1.00, p2 1.00

Pr(x1 > 0)

14%

15%

9%

9%

9%

9%

12%

11%

10%

Pr(x2 > 0)

14%

15%

9%

9%

9%

9%

12%

11%

10%

Pr(x1 > 0&x2 > 0)

14%

15%

9%

0.6%

0.6%

0.6%

4%

3%

2%

E[x1]

1.8

1.5

0.9

0.9

0.9

0.9

1.3

1.2

1.1

E[x2]

1.4

1.5

1.2

0.9

0.9

0.9

1.2

1.2

1.1

Notes. This table summarizes our demand system at different price levels (the unit price of each input is either $2.00 or $3.00) and at different values of the preference parameters  and different proportions a23. The random shocks included in the  parameters were drawn such that iid N(0, 1), and the budget was set to $50.

773

774

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

Thus, in any period t, the consumer solves the consumer problem in which his or her preference parameters are such that ikt ike ikt and in which demand is restricted because each good j is sold in indivisible packages that contain a volume sj.

5.2. Likelihood and Estimation

The purchase bundle x is chosen by the consumer if it

yields the highest utility among all possible bundles

given the prices and the consumer's budget and

preferences; otherwise, it is not optimal. To evalu-

ate the probability that the consumer chooses the

bundle x (conditional on the prices p, the consumer's

preference parameters , and the proportion a23 he or

she uses), we must therefore calculate an integral over

the region of random shocks  such that x is optimal.

Let us define the "optimality function" formally as

(

)

m x|p, M, , a23

I{x

( p,

M;

,

) a23

} x,

(18)

where I{.} is the indicator function and x(p, M; , a23) is the demand under prices p, budget M, and preference parameters  and a23 as explained in Section 4.2. Consumer i's contribution to the likelihood can then
be written as follows:

Li

( i,

2)

Ti  (

{

})

t 1[

m xit|pit, Mit,

it

]

ike ikt

k, ai23

×

( N

ikt|0, 2k ) dit,

k

(19)

where xit is the observed purchase decision by user i in trip t, it is a collection of all the shocks ikt, and N(.|, 2) is the probability density function of the univariate normal distribution with mean  and variance 2. The integral in Equation (19) cannot be simplified; thus, we apply data augmentation to
estimate the model. Our estimation algorithm, laid out in Appendix C, is similar to the "error augmentation" procedure used by Lee and Allenby (2014). The next section discusses the identification of the
model parameters.

5.3. Identification
The parameters of our model can be identified from patterns of purchases as a function of prices. The k parameters capture the consumer's utility for final goods: as such, they are defined relative to the marginal utility for the outside good 0; we fix their scale by setting 0 1. Different values of k yield different own- and cross- price effects as discussed in Section 4. Thus, they are identified by the own- and cross-effects
of prices on purchases; the magnitude of the price effects are smaller when the k parameters are larger. In the case considered earlier in which the number of

inputs is J 2, high cross-price effects are picked up by a higher value of 3; a low value of 3 indicates no cross-price effects. Separate from cross-price effects, the random shocks  are identified by the variance and correlation in purchase behavior across the J goods. The proportion used in combining different inputs for a joint consumption (a23) is identified by the proportions in quantities purchased when there is a joint purchase. Finally, the variation in purchase behavior at the individual level can be disentangled from consumer heterogeneity when the model is estimated on panel data with multiple observations per consumer. The simulation provided next furthers our discussion of identification.

5.4. Simulation Study

We ran two sets of simulations to investigate the pos-

sible consequences of ignoring (or allowing for) com-

plementarity between two goods when estimating

demand as a function of prices. For this analysis, we

considered two different versions of our proposed

model. Model 1 is our model that allows for comple-

mentarity with an input­output table A

(

1 0

0 1

1 a23

).

For Model 2, we shut off any complementarity be-

tween goods by setting A equal to the identity matrix:

consequently, K 2, there is no joint consumption,

and the cross-price effects between goods purchased

are forced to be zero.

We generated a data set for each of the two models,

using that model as the true data-generating process.

We generated the preference parameters of 200 con-

sumers from a multivariate normal distribution with

a mean ¯ and a covariance matrix V. We considered

packs of sizes 16 and 10, respectively; unit prices

were drawn from a uniform distribution in the inter-

val [1, 4], and consumer budgets were drawn from a log-normal distribution.9 For each consumer, we

generated 100 purchase occasions and solved for the

optimal purchase quantities. Each resulting data set

contained the prices observed by consumers and the

quantities purchased of each good; we discarded the

consumption data as this is unobserved in practice.

On both data sets, we estimated Models 1 and 2;

we provide the results in Tables 3 and 4. The first

set of rows indicates our estimates of the average

preference parameters ¯ along with their posterior

standard error in parentheses. To compare how the

models fit the data, we have reported the DIC of each

model, which penalizes models with a higher com-

plexity; a lower value of the DIC indicates a better fit.

We have also reported, for each good, the hit rate

of the models' purchase incidence predictions and

the root mean squared error (RMSE) of their vol-

ume predictions (converted in package units) both

in sample and out of sample on another data set

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

775

Table 3. Simulation 1: Estimation Results on Data Generated Under Model 1 (with Complementarity)

Truth

Model 1

Model 2

(Model 1) (with complementarity) (without complementarity)

Average log(1) (input 1 by itself) Average log(2) (input 2 by itself) Average log(3) (joint consumption) Average log(a23) (proportion chips/salsa) 21 22 23 V11 V12 V13 V14 V22 V23 V24 V33 V34 V44

-6.96 -6.40 -8.06 -0.41
3.79 3.13 4.61 0.44 0.30 0.12 -0.04 0.64 0.27 -0.07 1.24 -0.07 0.49

-6.99 (0.07) -6.36 (0.06) -7.96 (0.16) -0.39 (0.12)
3.77 (0.13) 2.99 (0.09) 4.72 (0.30) 0.53 (0.07) 0.26 (0.05) 0.16 (0.07) -0.03 (0.06) 0.56 (0.06) 0.20 (0.07) -0.10 (0.07) 0.96 (0.16) -0.11 (0.11) 0.62 (0.12)

-6.54 (0.06) -6.02 (0.05)
-- -- 3.41 (0.10) 2.77 (0.07) -- 0.46 (0.05) 0.30 (0.04) -- -- 0.48 (0.05) -- -- -- -- --

DIC

--

In sample. . .

hit-rate for good 1 incidence

--

hit-rate for good 2 incidence

--

RMSE for good 1 quantity (packs)

--

RMSE for good 2 quantity (packs)

--

Out of sample. . .

hit-rate for good 1 incidence

--

hit-rate for good 2 incidence

--

RMSE for good 1 quantity (packs)

--

RMSE for good 2 quantity (packs)

--

41,687
82.4% 81.2%
0.780 0.834
82.1% 80.5%
0.788 0.846

42,221
82.3% 81.1% 0.783 0.838
82.0% 80.4% 0.790 0.850

Elasticity 11 Elasticity 12 Elasticity 21 Elasticity 22

-0.74 -0.07 -0.09 -0.76

-0.75 (0.04) -0.08 (0.01) -0.09 (0.01) -0.78 (0.03)

-0.81 (0.04) 0.00 (0.01) 0.00 (0.01)
-0.85 (0.04)

generated in the same fashion. We have also reported the own- and cross-price elasticities, which were computed by simulating the aggregate demand assuming a 10% increase in the price of each good. For each draw of the parameters from our sampler, we computed aggregate demand by first solving the consumer problem at each purchase occasion and then summing up the quantities purchased across periods and consumers. We computed the price elasticity of demand for each draw and reported the mean elasticities across posterior draws along with their posterior standard deviations in parentheses.
We can make several observations from these results. First, we recovered the true parameters and price elasticities within their 95% posterior intervals for each data set when estimating the "true" model. In both simulations, the true model fits the data best based on the DIC and other model fit criteria. While expected, these results confirm that the parameters of our model can be empirically identified and that our estimation procedure can recover them.

The estimation results also provide insights about the effect of capturing or ignoring complementarity between the goods. In the first data set generated, the consumer derives utility from the joint consumption of goods as indicated by the value of ¯3. This leads to the existence of negative cross-price effects as shown by the sign of the true cross-price elasticities. On that data set, the model that does not allow for complementarity (Model 2) not only yields zero cross-price elasticities, but also leads to a significant bias in the estimation of own-price elasticity for good 2.
Conversely, the second data set was generated according to Model 2, which does not include utility for the joint consumption of goods purchased. However, it should be noted that Model 1, which allows for such complementarity, accurately estimates the true preference parameters for separate consumptions ¯ 1 and ¯ 2 and yields a very large value for the proportion a23. Because such a high proportion a23 makes it costly to buy all the necessary inputs for a joint consumption, the consumer prefers to consume the goods

776

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

Table 4. Simulation 2: Estimation Results on Data Generated Under Model 2 (Without Complementarity)

Average log(1) (input 1 by itself)
Average log(2) (input 2 by itself)
Average log(3) (joint consumption)
Average log(a23) (proportion chips/salsa)
21 22 23 V11 V12 V13 V14 V22 V23 V24 V33 V34 V44
DIC In sample. . .
hit-rate for good 1 incidence hit-rate for good 2 incidence RMSE for good 1 quantity (packs) RMSE for good 2 quantity (packs) Out of sample. . . hit-rate for good 1 incidence hit-rate for good 2 incidence RMSE for good 1 quantity (packs) RMSE for good 2 quantity (packs)
Elasticity 11 Elasticity 12 Elasticity 21 Elasticity 22

Truth (Model 2)
-6.53
-6.09
--
--
3.45 2.94 -- 0.43 0.36 -- -- 0.58 -- -- -- -- --
--
-- -- -- --
-- -- -- --
-0.81 0.00
-0.01 -0.81

Model 1 (with complementarity)
-6.64 (0.06)
-6.12 (0.06)
-5.22 (1.43)
38.80 (16.92)
3.49 (0.10) 2.89 (0.08) 1.28 (1.19) 0.56 (0.06) 0.40 (0.05) 0.05 (0.29) 0.00 (0.34) 0.65 (0.07) 0.08 (0.35) 0.00 (0.39) 1.83 (1.13) -0.00 (0.99) 2.04 (1.91)
41,700
82.9% 81.6% 0.771 0.843
82.5% 81.3% 0.782 0.848
-0.81 (0.04) 0.00 (0.00) 0.00 (0.01)
-0.81 (0.04)

Model 2 (without complementarity)
-6.63 (0.06)
-6.12 (0.06)
--
--
3.49 (0.10) 2.89 (0.08)
-- 0.54 (0.06) 0.40 (0.05)
-- -- 0.64 (0.07) -- -- -- -- --
40,856
82.9% 81.6% 0.771 0.843
82.5% 81.3% 0.782 0.848
-0.81 (0.04) 0.00 (0.00) 0.00 (0.01)
-0.81 (0.04)

separately rather than jointly, and thus, the demand system can be reduced to the demand system of Model 2, in which the joint consumption does not exist. Consequently, the model yields accurate own-price elasticities and insignificant cross-price elasticities.
Taken together, these results suggest that our model yields accurate results even in the absence of complementarity and that ignoring complementarity across goods can lead to substantial biases in the estimation of the own-price elasticities of these goods.
5.5. Extension to J > 2 In this section, we discuss how the model can be applied to estimate the demand for more than two goods. In this case, we still need to include J final goods representing the separate consumption of each

input, and to allow for some slack when the input is not entirely exhausted through joint consumption with other inputs. Thus, the first J final goods represent the separate consumption uses of the inputs, and the other final goods (J + 1 to K) represent the joint consumption of at least two inputs. This leads to the following structure of A:

A (I A2),

(20)

where I is the J × J identity matrix, and A2 corresponds to the proportions used in the joint consumption of
multiple inputs. If there are J goods, there can be up to 2J - 1 final
goods. For each final good, we need to estimate a preference parameter k as well as parameters giving the proportions of the necessary inputs. Thus, the

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

777

number of parameters that need to be estimated increases exponentially with J. Without imposing any restrictions, extending the model to a case with a large J would therefore lead to some challenges. First, the computational burden increases: although our estimation algorithm remains valid, deriving the demand function requires an evaluation of the utility of each bundle of inputs, which grows exponentially in J. Second, the data requirement increases: the researcher needs more observations to identify all the parameters of the model. In that regard, it should be noted that the unrestricted model (with K 2J - 1 final goods) yields not only own- and cross-price effects, but also any N-way interaction effect of prices on demand (for any N  J), which can be derived from the demand system given in Equation (14). Thus, the parameters of such a model would be identified through all these price effects, whose number also grows exponentially. To reduce the dimensionality and make computation easier, some restrictions likely need to be imposed. For example, one could use managerial judgment or prior information on consumption uses to rule out some final goods (for example, we can eat burgers with ketchup and burgers with mustard but not ketchup with mustard). The researcher could also focus solely on final goods that can be produced from at most two (or three) different inputs; this would a priori rule out some interaction price effects. We note that many extant models have fewer parameters precisely because they do not allow for interaction effects of prices on demand. Regardless, we view scalability as one needed area for future extension of our work.
6. Empirical Application
This section discusses an application of our model to a data set of purchases made by a panel of consumers in the tortilla chips and Mexican salsa categories. We first describe the data, then we present our estimation results, and finally, we discuss three counterfactual analyses to show how our model can be used to make improved decisions in the distribution of coupons by retailers, in packaging by manufacturers, and in influencing changes in the proportions used by consumers when combining goods together.
6.1. Data The data were collected by AC Nielsen and are made of two parts. The first part contains data about a set of households that report their purchases over time using a scanner device at home: it provides the information about all shopping trips made by the households, the number of units purchased, and the price paid for each item purchased. Prices are only observable when a purchase is made; therefore, we combine the data about households with the second

part of the data, which gives us store-level prices for each item each week. For our empirical application, we chose the tortilla chips and Mexican salsa categories, which are a classic example of complementary goods as they are often consumed together; we focused on a twoyear time window from 2010 to 2011. We focused, respectively, on the 10- and 16-ounce package sizes, which are the predominant formats in these categories. We aggregated prices to the category level by taking an average of brand-specific prices weighed by market share. We restricted the data to households making at least eight purchases in each of the two categories over the two-year period as is common in models that estimate heterogeneous effects. Finally, we operationalize the budget M as the total shopping expenditure during each trip as is commonly done in the literature (Song and Chintagunta 2007).
The resulting data set contained 251 consumers, each consumer making 151 shopping trips on average. Table 5 gives some summary statistics of the data. Consumers bought multiple units of chips or salsa in 30% of their purchases, which indicates the need for a model of quantity. Consumers often bought both goods together as indicated by the high percentage of purchase co-incidence relative to the marginal percentages of incidence. We estimated logit models of incidence for each category (as reduced-form exploration) to investigate the effect of prices on demand with and without household-specific fixed effects. The results are displayed in Table 6 and suggest that prices have a negative effect on demand within and across categories. The results also suggest the existence of heterogeneity across households.
6.2. Estimation Results We estimated two versions of our model on the data: our full model of complementary demand based on household production theory (Model 1) and the restricted model that rules out complementarity by setting A equal to the identity matrix (Model 2) as in the simulation study. We also estimated a hierarchical Bayesian multivariate probit model similar to Manchanda et al. (1999) (Model 3) on the incidence data (discarding the quantity information) as a benchmark model to evaluate how well our model could predict purchase incidences. Finally, we estimated a hierarchical Bayesian Poisson regression for each product category to model the count of units purchased; both univariate models were combined under Model 4. The multivariate probit model and the Poisson models included an intercept, the price of chips and the price of salsa as predictors; we used random coefficients to capture consumer heterogeneity. For each model, we used a Bayesian estimation algorithm to generate 500,000 draws of the parameters from their

778

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

Table 5. Description of Purchase Data in the Tortilla Chips and Mexican Salsa Categories

Number of observations (%)
Price, $ Purchase incidence, % Mean purchase quantity (packs)

(a) Purchase frequency

Salsa and chips Salsa only

1187 (3.1)

2218 (5.9)

(b) Descriptive statistics

Salsa

Chips

2.70

2.60

8.98

10.72

1.34

1.32

Chips only 2878 (7.6)

None 31625 (83.4)

posterior distribution. We discarded the first 100,000 draws and kept one draw every 100 draws thereafter to reduce autocorrelation. We ran three separate chains to assess convergence (Rubin and Gelman 1992).
In Table 7, we have compiled, for each model, our estimates of the population-level mean parameters along with the corresponding posterior standard deviation in parentheses. We have also reported the DIC of each model except for Model 3 because its likelihood is not comparable as it was only applied to the incidence data. Based on the DIC criterion, Model 1 fits the data better than Model 2, which suggests evidence of complementarity between salsa and chips, and it also fits better than Model 4. We also reported the hit rate of the models' purchase incidence predictions and the RMSE of their volume predictions (converted in package units) both in sample and out of sample for each category.10 The incidence hit rates obtained under Model 1 are better than those obtained under Model 3 even though Model 3 focuses only on incidence predictions and ignores quantities. Model 1 makes better incidence predictions than Model 4 based on the hit rates, but Model 4 makes slightly better volume predictions. These results are remarkable given that Model 1 contains only four consumer-specific parameters (1, 2 3 and a23) and Models 3 and 4 contain six consumer-specific parameters (two intercepts, two own-price effects, and two cross-price effects).
Finally, we have reported the own- and crossprice elasticities along with their standard errors in

parentheses. We note that the negative cross-price elasticities under Model 1 are statistically significant and nonnegligible. When comparing the difference in own elasticities between Models 1 and 2 from this real data empirical application (Table 7) and those from the simulation (Table 3), we note a similar pattern: Model 2 tends to overestimate the own-price elasticities.
Our estimates from Model 1 suggest that the preference parameter for joint consumption (3) is not larger than the preference parameter for a separate consumption of salsa (1) or a separate consumption of chips (2). This may be because people seek variety by attributing some of the inputs purchased to either separate or joint consumption uses. In the next section, we investigate further the consumption uses as inferred from our model, which highlights the value of our direct utility model on final goods consumed rather than inputs purchased.
6.3. Inferred Consumption According to our model, the consumer has a consumption plan in mind when deciding to buy the goods x: he or she plans to allocate these inputs into different possible uses represented by a bundle c of final goods (separate consumption of salsa, separate consumption of chips, joint consumption of salsa and chips). We remind the reader that a separate consumption of salsa does not necessarily mean that the consumer eats salsa by itself but rather that the consumer consumes salsa without chips as explained in Section 3.2: for example, he or she may put salsa inside

Table 6. Reduced-Form Evidence of Complementarity Between Tortilla Chips and Salsa

Salsa price Chips price
Salsa price Chips price

Incidence of salsa
-0.44 (0.09) -0.29 (0.06)
Incidence of chips
-0.26 (0.08) -0.74 (0.05)

Incidence of salsa (with household fixed effects)
-0.63 (0.12) -0.28 (0.08)
Incidence of chips (with household fixed effects)
0.02 (0.12) -0.91 (0.07)

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

779

Table 7. Estimation Results on Purchase Data in the Mexican Salsa and Tortilla Chips Categories, Including a Multivariate Probit Model and a Poisson Regression Model as Benchmark Models for Incidence and Quantity

Average log(1) (separate salsa) Average log(2) (separate chips) Average log(3) (joint consumption) Average log(a23) (proportion) 21 22 23 V11 V12 V13 V14 V22 V23 V24 V33 V34 V44 Salsa intercept Chips intercept Salsa price  salsa Salsa price  chips Chips price  salsa Chips price  chips Correlation of error terms
DIC In sample. . .
hit-rate for salsa incidence hit-rate for chips incidence RMSE for salsa quantity (jars) RMSE for chips quantity (bags) Out of sample. . . hit-rate for salsa incidence hit-rate for chips incidence RMSE for salsa quantity (jars) RMSE for chips quantity (bags)
Elasticity salsa  salsa Elasticity salsa  chips Elasticity chips  salsa Elasticity chips  chips

Model 1 (with complementarity)
-6.96 (0.07) -6.40 (0.07) -8.06 (0.17) -0.41 (0.11)
3.79 (0.13) 3.13 (0.10) 4.61 (0.31) 0.44 (0.05) 0.30 (0.05) 0.12 (0.07) -0.04 (0.05) 0.64 (0.07) 0.27 (0.08) -0.07 (0.06) 1.24 (0.20) -0.07 (0.12) 0.49 (0.10)
-- -- -- -- -- -- --
50,014
85.3% 83.6% 0.609 0.658
82.6% 79.8% 0.674 0.750
-0.96 (0.04) -0.09 (0.01) -0.10 (0.02) -1.01 (0.04)

Model 2 (without complementarity)
-6.53 (0.06) -6.09 (0.06)
-- -- 3.45 (0.10) 2.94 (0.08) -- 0.43 (0.05) 0.36 (0.04) -- -- 0.58 (0.06) -- -- -- -- -- -- -- -- -- -- -- --
50,453
85.3% 83.6%
0.611 0.661
82.5% 79.7%
0.677 0.757
-1.04 (0.05) 0.00 (0.00) 0.00 (0.00)
-1.09 (0.04)

Model 3 (HB MV probit)
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -0.24 (0.19) 0.01 (0.21) -0.28 (0.06) -0.04 (0.07) -0.13 (0.04) -0.44 (0.05) 0.46 (0.01)
--
84.6% 82.9%
-- --
81.7% 78.3%
-- --
-1.14 (0.27) 0.02 (0.27)
-0.45 (0.17) -1.49 (0.15)

Model 4 (HB Poisson)
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 0.16 (0.47) 0.29 (0.38) -0.66 (0.16) -0.13 (0.14) -0.22 (0.09) -0.78 (0.09) --
54,059
83.3% 81.7% 0.538 0.568
80.2% 76.7% 0.588 0.659
-0.56 (0.33) 0.33 (0.32)
-0.14 (0.21) -1.37 (0.15)

burrito tortillas; similarly, he or she can eat chips without salsa but with guacamole. While purchases are observable, the consumption plans are not. However, we can use the posterior draws obtained from our Bayesian estimation algorithm to infer those consumption plans under our model. To do this, we reconstructed the preference parameters ikt and the proportions ai23 for each consumer trip and for each posterior draw, and we solved the optimal consumption problem in Equation (3) given the observed qoputainmtiatliecsonosf ugmoopdtisonpuqrucahnatsietidesxcijitktt.oWdeettehremniangegtrheegated the consumption plans by taking an average across draws and trips. We present a breakdown of those consumption plans in Figure 4.

Because chips and salsa cannot be consumed jointly unless they are purchased together (under the maintained assumption that no inventory is carried between trips), we must infer that salsa is consumed separately when the consumer only buys salsa (and similarly for chips). We thus focus our attention on trips in which the consumer buys both salsa and chips. Out of those trips, we find that, in 22.5% of cases, the salsa and chips are consumed entirely separately; in 23.9% (20.0%), the consumer exhausts all the salsa (chips) by consuming it with the chips (salsa); in the remaining 33.6% of cases, the consumer uses, on average, 58.2% of the salsa and 54.4% of the chips for joint consumption and consumes the rest of the inputs separately. Overall, these results suggest a large portion of joint consumption, which one might

780 Figure 4. Inferred Consumption

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

expect given the two product categories, but not equal to one as both are also consumed for other purposes.
6.4. Counterfactuals We now run counterfactual analyses to show how our model can be used to make improved decisions in the distribution of coupons to consumers, which is useful for retailers, and in the choice of package size, which is important for manufacturers. We also simulate an alternative scenario in which people mix chips and salsa in different proportions that could be stimulated via marketing.
6.4.1. Coupons. Retailers commonly use categorylevel coupons by which they offer consumers a discount if they buy an item of any brand within a product category. Rossi et al. (1996) have shown that a manufacturer can substantially increase its profit by tailoring the depth of coupons to each consumer based on his or her preferences as estimated from his or her transaction history. Building on their analysis, we seek to evaluate the importance for retailers to account for the spillover effect of coupons across categories when distributing customized coupons to consumers (not simply within the category in which the coupon is issued). Our model is well suited to simulate demand under alternative scenarios in which coupons are distributed because it recognizes both the

discreteness of demand resulting from indivisible pack-

ages and cross-category effects.

Similar to Rossi et al. (1996), we consider a targeted

couponing problem in which the retailer decides the

optimal distribution of coupons to consumers in a

way that maximizes its profit, by determining which

consumers should receive a coupon and what should

be the face values of these coupons. We consider the

problem of distributing coupons for salsa assuming

that no coupons are distributed for chips, and the

reverse problem. The expected profit made by the

retailer across the two categories during the shopping

trip of a consumer is given by the following equation:

E[]



E[qj rj

-

Fj

×

I(qj

>

)] 0,

(21)

j

where qj is the number of packs bought by the consumer,11 rj is the retailer's margin per package in category j, I(.) is the indicator function, and Fj is the face value of the coupon distributed to consumer i prior to
that shopping trip (if any). It should be noted that a coupon can only be used once even if the consumer
buys multiple units: the marginal price of the second unit is higher than the first unit because the coupon
cannot be redeemed a second time; thus, prices are no
longer linear in quantity if coupons are distributed. Still, we can determine the optimal quantities qj purchased by the consumer according to our model

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

781

by searching on the grid of feasible demand points, taking into account the price paid at each point. We do this to simulate demand at each consumer trip in a series of counterfactual scenarios in which coupons of different face values are distributed. There is uncertainty about the optimal quantities in these counterfactual scenarios because we have uncertainty about the consumer's preference parameters: we thus solve the consumer problem for each of the posterior draws we obtained in our Bayesian estimation procedure, and we evaluate the expectation in Equation (21) by taking an average across them. Calculating profit requires an assumption on the retailer's costs: consistent with Rossi et al. (1996), we assume that the retailer's margin rj on each package is $0.35. Furthermore, we only consider coupon face values between $0 and $0.35 in increments of 5 cents. By comparing the profit made by the retailer for these different face values, we identify which face value is optimal at each consumer trip. We repeated this process using Model 1 and then using Model 2 to investigate if there are differences in the coupons distributed when incorporating complementarity.
In Figure 5, we plot the distribution of optimal coupon face values across all consumer trips under Model 1 (which takes into account the complementarity between salsa and chips) and Model 2 (which ignores it). We observe that the distribution of optimal coupons is shifted to the right when recognizing complementarity: under Model 1, the optimal face value of coupons is often higher than under Model 2 for both product categories. We explain these results as follows. Distributing retailer coupons in the salsa category can increase demand for that category but can also come at a cost as consumers who would normally buy salsa may get a discount without changing their buying behavior: in that case, the coupon comes as a windfall to those consumers. In contrast, the spillover effect on a complementary category should be positive as salsa coupons can induce more people to buy chips and do not create a windfall effect for normal chips buyers. Therefore one underestimates the total effect of coupons on profit when failing to recognize the spillover effect on a complementary category, which leads one to set face values that are too low.
To quantify the loss of profit when failing to recognize the cross-category spillover effect of coupons, we evaluated the aggregate profit made by the retailer across all trips when using Model 1 to customize salsa coupons (or chips coupons) and when using Model 2 instead. We used Model 1 as the reference model to simulate demand under both targeting scenarios because Model 1 fits our data best. In addition to profit, we also calculated the aggregate volume of salsa and the aggregate volume of chips bought by consumers and compared them with the baseline scenario when no coupons are distributed.

Figure 5. (Color online) Distribution of Coupons
The results are reported in Table 8. We find that the relative increase in profit from distributing customized salsa coupons (chips coupons) is 5.9% (3.5%) larger when Model 1 is used to customize the face values compared with Model 2. An important part of this profit increase is due to the increase in demand for the complementary good: while the volume of salsa (chips) increases by about 4.9% (5.1%), the volume of its complement increases by about 0.6% (0.7%), which is quite important considering that the increase in volume of the complement does not come at the cost of more coupon redemptions in the complementary category.
Taken together, these results suggest that it may be important for retailers to take into account the spillover effect of coupons on demand for a complementary category when distributing retailer coupons. We have proposed a methodology to customize these coupons by using our model of demand, which can be readily

782

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

Table 8. Counterfactual Results: Optimal Couponing

Salsa coupon

Chips coupon

Model 1

Model 2

Model 1

Model 2

(with complementarity) (without complementarity) (with complementarity) (without complementarity)

Percentage change in. . . . . .profit . . .total volume of salsa . . .total volume of chips

1.25% 4.90% 0.60%

1.18% 4.21% 0.47%

1.48% 0.66% 5.14%

1.43% 0.54% 4.60%

Notes. This table shows the effect of different couponing strategies on profit and volumes sold. The first column shows the effect of salsa coupons distributed optimally based on our model that takes into account cross-category complementarity (Model 1). The second column shows the effect of salsa coupons distributed using the model that ignores complementarity (Model 2). The third and fourth columns similarly show the effect of chips coupons.

applied to simulate demand under counterfactual scenarios with discrete packages and the nonlinear in prices implied by coupons.
6.4.2. Package Size. We now study the effect of the package sizes set by manufacturers, which is of managerial importance (Koenigsberg et al. 2010). While Lee and Allenby (2014) have studied the effect of pack size on demand within a single category and have shown that large packages can restrain consumers from making a purchase in that category, our model allows us to simulate consumers' reactions across complementary goods. Measuring this crosscategory effect is important because many manufacturers produce complementary goods, and their overall profit depends on demand across these goods. Moreover, changing a pack size can be costly for a manufacturer: a counterfactual analysis based on a structural model is therefore well suited to study this problem.
We simulated four alternative scenarios in which the sizes of packages were modified. Specifically, we considered doubling the size of a salsa jar or reducing it by half, and similarly for bags of chips. We assumed that prices were linear in volume such that, when 16ounce salsa jars were replaced by 32-ounce (8-ounce) salsa jars, the unit price of a jar was doubled (reduced by half). Using our posterior draws of the consumer's individual parameters and of their random shocks , we determined the consumer's purchase decision in

these alternative scenarios for each trip.12 We then aggregated the volume sold in each category, the incidence rate, and the overall revenue generated by taking an average across draws and summing up across trips. The results are displayed in Table 9.
Within each category, we find that smaller packages lead to higher rates of purchase incidence, consistent with Lee and Allenby (2014); however, it reduces the overall volume as many consumers switch from buying a big pack to buying a small pack. More interestingly, decreasing the pack size of one good increases both the rate of purchase incidence and the volume of its complementary good as more consumers buy the complementary good for joint consumption. This second result could depend on the parameter values; it is mostly driven by an increase in joint purchase incidence in our context. Furthermore, our results indicate that higher levels of revenue are achieved with bigger pack sizes; thus, it may be optimal for the firm to set high pack sizes and leave some people out of the market. Naturally, a manufacturer should also consider its costs and the price negotiations with retailers to set the profit-maximizing sizes, but our model can form the core of the demand-side prediction. It is also worth pointing out that prices do not need to be linear in volume and that manufacturers should consider the effect of competition with other manufacturers, which is absent from our model. Nevertheless, these counterfactual analyses

Table 9. Change in Package Size

Baseline (16 oz. salsa, 10 oz. chips) Smaller salsa jar (8 oz.) Bigger salsa jar (32 oz.) Smaller chips bag (5 oz.) Bigger chips bag (20 oz.)

Volume, oz.

salsa

chips

67,456 65,077 70,598 68,294 65,673

49,330 50,015 48,093 47,350 51,625

Incidence rate, %

salsa

chips

8.9

10.5

12.4

10.8

5.9

10.0

9.1

14.2

8.4

7.0

Revenue, $
23,609 23,390 23,813 23,272 23,880

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

783

Table 10. Change in Consumption Proportions

Salsa proportion reduced by 50% Salsa proportion reduced by 20% Salsa proportion reduced by 10% Baseline Salsa proportion increased by 10% Salsa proportion increased by 20% Salsa proportion increased by 50% Salsa proportion increased by 100%

Volume, oz.

salsa

chips

63,659 66,323 66,937 67,456 68,024 68,549 69,802 71,056

49,524 49,533 49,437 49,330 49,294 49,245 49,024 48,696

Incidence rate, %

salsa

chips

8.6

10.3

8.8

10.5

8.9

10.5

8.9

10.5

8.9

10.6

9.0

10.6

9.0

10.6

9.1

10.7

Revenue, $
23,021 23,470 23,549 23,609 23,695 23,771 23,926 24,053

provide new insights and show the usefulness of our model in simulating demand in scenarios with different package sizes.
6.4.3. Change in Mixing Proportions. We now consider an alternative scenario in which there is a shift in consumption uses, whereby consumers use different proportions when mixing chips and salsa together. We seek to understand what would be the impact on the demand and on the revenue generated. Specifically, we have simulated, for each consumer, a 10% or 20% decrease or increase in the mixing proportion of salsa per volume of chips (1/a23) when he or she consumes them jointly while holding the parameters  constant. We have determined the aggregate volumes and revenue in this alternative scenario, and we have reported the results in Table 10.
From the results, we note that a higher revenue is obtained with a higher proportion of salsa per chips or, conversely, a lower proportion a23 of chips per salsa. While the direction of this result is expected as we hold constant the utility parameter 3 for a joint consumption but reduce the number of chips required for a joint consumption, this analysis allows us to measure the magnitude of the effect and can help marketers decide whether it is worthwhile trying to encourage changes in consumption uses given this magnitude. Thus, the analysis illustrates the usefulness of our approach in measuring changes in demand under alternative household production functions, whereby consumers change the way they combine inputs together. Such analyses should be of interest to marketers who may be able to influence consumption uses through advertising.
7. Conclusion
In this paper, we have proposed a general approach to modeling micro-level demand for complementary goods by invoking household production theory. Under our approach, two goods are complementary if the consumer enjoys utility from their joint consumption, represented by a final good that he or she can produce from them. By assumption, he or she

decides not only what goods to purchase, but also how to allocate them into final goods that represent consumption uses, which may be joint or separate. Therefore, the consumption utility is defined over a set of latent final goods that is larger than the set of goods purchased. The resulting demand system allows for negative cross-price effects under a linear budget constraint. Thus, our approach offers an intuitive theoretical foundation for the existence of negative cross-price effects.
From the point of view of purchase behavior, the new consumer problem can be reduced to the usual problem without household production by redefining the consumer's utility over goods purchased after recognizing that the allocation of goods purchased into consumption uses is optimal. However, laying out the consumer problem with a household production step is useful for empirical work even if consumption is unobserved because it opens up the possibility of parameterizing the consumption utility over the set of final goods, which is larger than the set of goods purchased. We can then use an additively separable specification and still accommodate very different patterns of preferences from no complementarity to perfect complementarity.
We embedded the household production model of consumer behavior in a structural model that takes into account consumer heterogeneity, corner solutions, and discrete demand because of indivisible packages. We proposed a Bayesian method to estimate the model on purchase data in the absence of consumption data. In an empirical application, we showed how our model could be used to make improved managerial decisions regarding the distribution of coupons by retailers. We found that a retailer could better target consumers and make a higher profit by recognizing the spillover effect of coupons on demand across complementary categories. We also showed how our model could be used to make decisions regarding the size of packages while taking into account the effect on demand across categories. Finally, we derived insights about consumption patterns by using our model to infer how the goods purchased are combined into consumption

784

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

uses, and by simulating demand under alternative mixing proportions.
The approach we propose opens new ideas for future research. While we have focused on complementarity in this paper, we believe that the approach can be extended to obtain a flexible demand system for substitutes by changing the consumer's production function, such that two goods are substitutable if one or the other can be used to fulfill a consumption need, represented by a final good. In such a model, substitution between goods would come from the utility for the inside goods, in addition to the concave utility for the outside good. Furthermore, while we have specified our model at the category level in our empirical application, the model could be extended to include the choice of brands by combining our approach with a discrete choice model for brands. Finally, our approach opens up the opportunity of modeling demand across complementary categories while allowing for forward-looking behavior and flexible consumption. Sun (2005) achieves flexible consumption within a single category by making the quantities consumed a decision variable; extending this approach to a multicategory setting with complementarity requires a consumption utility defined on quantities consumed and allowing for complementarity. We have shown in this paper that an approach based on household product theory can yield such a consumption utility and believe that nesting it within a forward-looking model of consumer behavior could yield interesting insights about the longrun effect of promotions across categories.

Acknowledgments The authors thank the Kilts Center for Marketing at the University of Chicago Booth School of Business and Nielsen for access to the data used in this study. The analyses were calculated (or derived) based in part on data from the Nielsen Company (United States), LLC, and marketing databases provided through the Nielsen Datasets at the Kilts Center for Marketing Data Center at the University of Chicago Booth School of Business. The conclusions drawn from the Nielsen data are those of the researchers and do not reflect the views of Nielsen. Nielsen is not responsible for, had no role in, and was not involved in analyzing and preparing the results reported herein.

Appendix A. Solution to the Consumption Problem

In this section, we derive the solution to the optimal con-

sumption problem given in Equations (6b)­(6d):



Ux(x)

max
c

k log(ck + 1)
k

s.t.  ck  0

k

ajkck  xj

j.

k

(A.1)

In the case with two inputs and one composite such that

A

(1
0

0 1

1 a23

),

the

first-order

conditions

given

in

Equa-

tion (7) become

1 c1 +

1

+

1

-

1

0

2 c2 +

1

+

2

-

2

0

3 c3 +

1

+

3

-

1

-

2a23

0

1c1 0

2c2 0

3c3 0

1(x1 - c1 - c3) 0

2(x2 - c2 - c3a23) 0

ck, k, j  0.

(A.2a)
(A.2b)
(A.2c) (A.2d) (A.2e) (A.2f) (A.2g) (A.2h) (A.2i)

Because Uc is strictly increasing, constraints (A.2g) and (A.2h) must be binding:

{ c1 x1 - c3
c2 x2 - a23c3.

(A.3)

We can simplify the FOC as

x1

1 - c3

+

1

+

1

-

1

0

x2

-

2 a23c3

+

1

+

2

-

2

0

3 c3 +

1

+

3

-

1

-

2a23

0

1(x1 - c3) 0

2(x2 - a23c3) 0

3c3 0.

(A.4a)
(A.4b)
(A.4c) (A.4d) (A.4e) (A.4f)

From Equations (A.4d)­(A.4f), there can be three possible

casCCCCeaaaassss:seeeec33221ba:(::icn03cc,t33ecr3i0oaxx2ri213fUsf<<o,lxauxo32123triiio0ffffnx<1a)xx+21:2311cc<3+<3 <saxaxo22123U3lvaax,n2en+w2sdd1.chx3+1e3a11r23e+-xU12xx+12--a2ca312323a+m+x2131i++n12{xx2-1xa,21x2aa3+x2322c+21333}3.a+2.13.. This leads to a second-degree equation: Ac23 + Bc3 + C 0,
where

(

)

A a( 23 1 + )2 + (3

)

(

)

B 1 + 2 a23 - 1 + 3 (x2 + 1) - 2 + 3 a23(x1 + 1)

C 3(x1 + 1)(x2 + 1) - 1(x2 + 1) - 2a23(x1 + 1)

(A.5)

Clearly,

A > 0.

In

addition,

because

3

>

1 x1 +1

+

a23

x2 +2 1,

then B < 0 and C > 0. By unicity of the optimization solu-

tion, there can be at most one root between zero and U;

therefore, it must be the smallest one because it is positive:



c(3int)

-B - B2 - 4AC 2A

(A.6)

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

785

2a

Note that, in and 2b, one

case 1, C < 0, and therefore, can show that c(3int) > U. We

c(3int) can

< 0. In cases simplify the

solution as

c3

(( min max 0,

c(3int)

) ,

x1

,

x2 a23

) .

(A.7)

Appendix B. Derivation of the Demand System In this section, we solve the consumer problem without integer constraints as defined in Equation (11), Section 4.1:

max
c,y
s.t.

K

()

k log(ck + 1) + 0 log y

k1

K fkck + y  M

k1

ck  0 k.

Let us denote by (c1, . . . , cK , y) the solution to that problem, which is unique by concavity of the objective
function. In the optimal solution, the outside good must be consumed in a positive quantity (y > 0). We use the fact
that all the final goods that are consumed in a positive
quantity (such that ck > 0) must have the same ratio of marginal utility to marginal cost:
· If cl > 0, then the marginal-utility-to-price ratio of final good l is equal to that of the outside good:

fl

(cl+l

) 1

0 y

 cl

l · y 0 · fl

-1



l fl

>

0 y

.

· On the other hand, if cl 0, then the marginal-utilityto-price ratio of good l is at most equal to that of the out-

side good:

l fl



0 y

.

Therefore, if the final goods are indexed by decreasing

ratio

k fk

,

then

only

positive quantity,

the first K goods are purchased in which K is such that

in

some

1 f1



···



K fK

>

0 y



K+1 fK+1

·

··



K fK

.

cl

Under + 1 and

the Mz

asMsum+ ptKkio1nflt.hTahteKn(zis1,k. n. .o,wzKn,)laerteussowlurtiitoenzsl

of

the following optimization problem:

max
z,y
s.t.

K

()

k log(zk) + 0 log y

k1

K fkzk + y  Mz.

k1

Noticing that the objective function is the Cobb­Douglas utility function, the solution is well known as

zk  ck

fMkfk(kz(×M0 ++0+Kl Kl11kKlfll1))-l

; 1;

y y

00(+M0M+Kl z1 Kl l1 fl

0

+

K
l1

l

)

.

Additionally, K is such that

1 f1



·

··



K fK

>

0 M

+ +

K lK1
l1

l fl



K+1 fK+1

··

·



K fK

.

That is,

K

(

K I

k

k 1 fk

>

0 M

+ +

k lk
l

) 1 l . 1 fl

Appendix C. Estimation by Markov Chain Monte Carlo
This section describes our Bayesian estimation algorithm to estimate the discrete model. We specify the following prior:

¯  MVN(0, 0)

V  IW(, )

2



( InvGamma ,

) ,

(C.1)

where we chose values that lead to diffuse priors (0 0K, 0 104IK,  K + 3,  IK,  1,  1). For clarity of ex-

position, we write

·  is the diagonal matrix whose diagonal elements are

21

,. ·

.. ,i 2K

(variance [log(i1), .

of ..,

it). log(iK

)].

eosnt·Wilmozegiak(tttahiioe23nnl)ohasgtna(rvdaietkleto)ggyi(,aliow2(3g)e(cis,oieklnoq)dgu+i(etaniiio2kt3tni.)aa)llalyonnddrzaiitw. Forii

+ it. In our conditional that reason,

we decompose the mean of i as ¯ (¯ , ¯ a) and its vari-

ance as V

( V
Va

Va Vaa

).

Because

the

integral

in

Equation

(19)

has no closed-form solution, we rely on data augmentation

(Tanner and Wong 1987). The general idea is to perform the

numerical integration of a variable by taking draws of that

variable within the sampler. We treat zit as the missing data

that needs to be integrated out as it is mathematically more

convenient than it (although it can be derived easily from zit and i). Our complete algorithm is provided:
1. Initialize ai23 and zit for all consumers i and trips t by

solving the FOC of the continuous consumer problem (i.e.,

without integer constraints).

2. For i 1 to N,

a. Draw Because i

i|{zit}Tt i 1, log(ai23), ¯ , and log(ai23) are parts

V, of

: vector

i

following

a

MVN(¯ , V),

i |ai23,

¯ ,

V



( µ,

)  ,

(C.2)

where

µ

¯ 

+

Va Va-a1

[ log(ai23

)

-

] ¯ a

 V - VaVa-a1Va.

Besides, we have

zit|i

iid

MVN(i,

) 

because

zit

i + it.

(C.3)

Using conjugacy, we can combine Equations (C.2)

and (C.3) to obtain

([

])

i |{zit}Tt i 1, ai23, ¯ , V,   MVN S1 -1 Ti zit + -1µ , S1 ,

t1

(C.4)

786

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

where

S1

[ Ti -1

+

-1 ]-1 .

Bebca. uDsreawiloagn(dail2o3)g|{(azii2t}3Tt)i

1, i , ¯ , V: are parts of

vector

i

following

a MVN(¯ , V),

log(ai23()|i, ¯ , V  N ¯ a + VaV-1

[i

-

] ¯  ,

Vaa

-

) VaV-1Va .

(C.5)

Besides, we have

(

)

Pr xit|zit, log(ai23)

Ti

( m xit

|pit

,

ezit

,

ai23

) .

t1

(C.6)

We cannot use conjugacy to derive the conditional dis-

tribution of ai23 from Equations (C.5) and (C.6). Instead, we perform a Metropolis­Hastings step.

c. For t Draw zit|i

1 to Ti (trips of , log(ai23),  by a

consumer i), Metropolis­Hastings

step

us-

ing the facts that

zit|i  Pr(xit|zit

MVN , ai23)

(i ,(

) 

m xit|pit

,

ezit

,

ai23

) .

(C.7)

3. Draw where S2
4. Draw

V¯(|N|{{Vii-}}1NiNi +11,,V¯ -01)I-MW1.V(NN+(S2,[V+-1Ni Ni1(1ii-+¯)-0(1i -0],¯S)2

), ).

5. Draw |{zit}i,t, {i}Ni 1:

0

a. For k

Draw

+

1 2

N
i

1

Ti
t

1

where ikt

1 to K,

2k |{zikt}i,t, {i}Ni 1

2ikt ), zikt -

ik

.



InvGamma

(0

+

1 N
2 i1

Ti,

b. Set  diag(21, . . . , 2K).

6. Go to 2.

Endnotes
1 We assume that it is not costly to produce final goods from inputs.
2 As in the usual consumer problem as laid out in Equation (1), it is assumed that the consumer does not carry an inventory of inputs between purchase occasions. We discuss thoughts on dynamic consumer problems in the future research section.
3 For example, burgers can be consumed just by themselves or with ketchup (but without buns). If ketchup is outside the scope of the analysis, then we aggregate together these two uses of burgers and represent them by a final good for "separate burger" (meaning burger without bun).
4 A negative value of k would imply that final good k gives a disutility. In that case, the consumer would never produce that good to consume it. The same applies if k 0; thus, it is unnecessary to consider negative values of k. 5 Satomura et al. (2011) lay out a direct-utility model in which the consumer purchases quantities of goods under multiple linear constraints, such as a budget constraint and a volume constraint; the consumer enjoys utility from the consumption of the goods purchased and from outside goods representing the best outside use of the slack resources (money or volume). Similarly, in our optimal allocation problem, the consumer faces one linear constraint for each input (because inputs enter linearly in the production of final goods) and derives utility from a final good representing their joint

consumption as well as from the slack associated to each input (any input that is not used for the joint consumption is allocated to the final good representing the best separate use of that input). In Satomura et al. (2011), the outside goods are always consumed in some positive quantity because the utility associated is of the form log(z). In our model, however, the utility associated to the separate consumption uses is of the form log(c + 1), which allows for corner solutions. 6 An alternative specification with a linear utility for the outside good would lead to ck/fk 0 for k k . Ultimately, this would rule out substitution between any pair of goods j and j and would yield symmetric cross-price effects xj /pj . 7 If goods j and j are also used in the production of other final goods k that require only one of the two inputs, the terms ck/fk are positive, which may lead to positive cross-price effects: the sign of xj /pj then depends on the utility for the final good k that uses both inputs, and
on the strength of substitution between the final goods. 8 In our simulations and in our empirical application, we assumed an upper bound of four packages on quantities purchased within each category (in our data, a consumer purchased more than four packages in less than 0.1% of the shopping trips), and we evaluated the consumer's objective function at all feasible points. 9 In both simulations, the parameter values for the distribution of budgets were set in a way to match the distribution of budgets in the empirical application: log(Mit) iid N(, ) with  3.72 and  1.1. Similarly, the values chosen for the parameters  and V were motivated by the results obtained in our empirical application. 10 For each consumer, we kept 10 trips out of the sample used for estimation. The hit rate and RMSE were calculated as an average across posterior draws and across the shopping trips of all consumers. 11 It is equal to the volume xj divided by the size of a pack sj. 12 When estimating the model on the data, we enforced a constraint that no more than four units of each good could be purchased (as explained in endnote 8). Because we did not want our results to be driven by the constraint on the number of units, we instead enforced constraints on volume in these counterfactual analyses. For example, when dividing the jar size of salsa by two, we assumed that the consumers could then buy up to eight units. When doubling the size, we assumed that the consumer could buy up to two units.
References
Becker GS (1965) A theory of the allocation of time. Econom. J. (London) 75(299):493­517.
Blundell R, Robin J (2000) Latent separability: Grouping goods without weak separability. Econometrica 68(1):53­84.
Chan TY (2006) Estimating a continuous hedonic-choice model with an application to demand for soft drinks. RAND J. Econom. 37(2): 466­482.
Chintagunta PK, Nair HS (2011) Discrete-choice models of consumer demand in marketing. Marketing Sci. 30(6):977­996.
Dubé J-P (2004) Multiple discreteness and product differentiation: Demand for carbonated soft drinks. Marketing Sci. 23(1):66­81.
Gentzkow M (2007) Valuing new goods in a model with complementarity: Online newspapers. Amer. Econom. Rev. 97(3):713­744.
Kim J, Allenby GM, Rossi PE (2002) Modeling consumer demand for variety. Marketing Sci. 21(3):229­250.
Kim Y, Telang R, Vogt WB, Krishnan R (2010) An empirical analysis of mobile voice service and SMS: A structural model. Management Sci. 56(2):234­252.
Koenigsberg O, Kohli R, Montoya R (2010) Package size decisions. Management Sci. 56(3):485­494.
Lee S, Allenby GM (2014) Modeling indivisible demand. Marketing Sci. 33(3):364­381.

Stourm, Iyengar, and Bradlow: A Flexible Demand Model for Complements Marketing Science, 2020, vol. 39, no. 4, pp. 763­787, © 2020 INFORMS

787

Lee S, Kim J, Allenby GM (2013) A direct utility model for asymmetric complements. Marketing Sci. 32(3):454­470.
Liu H, Chintagunta PK, Zhu T (2010) Complementarities and the demand for home broadband internet services. Marketing Sci. 29(4):701­720.
Manchanda P, Ansari A, Gupta S (1999) The "shopping basket": A model for multicategory purchase incidence decisions. Marketing Sci. 18(2):95­114.
Mehta N (2007) Investigating consumers' purchase incidence and brand choice decisions across multiple product categories: A theoretical and empirical analysis. Marketing Sci. 26(2):196­217.
Mehta N, Ma Y (2012) A multicategory model of consumers' purchase incidence, quantity, and brand choice decisions: Methodological issues and implications on promotional decisions. J. Marketing Res. 49(4):435­451.
Muth RF (1966) Household production and consumer demand functions. Econometrica 34(3):699­708.

Niraj R, Padmanabhan V, Seetharaman PB (2008) A cross-category model of households' incidence and quantity decisions. Marketing Sci. 27(2):225­235.
Rossi PE, McCulloch RE, Allenby GM (1996) The value of purchase history data in target marketing. Marketing Sci. 15(4):321­340.
Rubin DB, Gelman A (1992) Inference from iterative simulation using multiple sequences. Statist. Sci. 7(4):457­511.
Satomura T, Kim J, Allenby GM (2011) Multiple-constraint choice models with corner and interior solutions. Marketing Sci. 30(3): 481­490.
Song I, Chintagunta PK (2007) A discrete-continuous model for multicategory purchase behavior of households. J. Marketing Res. 44(4):595­612.
Sun B (2005) Promotion effect on endogenous consumption. Marketing Sci. 24(3):430­443.
Tanner MA, Wong WH (1987) The calculation of posterior distributions by data augmentation. J. American Statist. Assoc. 82(398): 528­540.

