CELEBRATING 30 YEARS
Vol. 30, No. 4, July­August 2011, pp. 717­736 issn 0732-2399 eissn 1526-548X 11 3004 0717

doi 10.1287/mksc.1110.0648 © 2011 INFORMS

No Customer Left Behind: A Distribution-Free Bayesian Approach to Accounting for Missing Xs
in Marketing Models

Yi Qian
Department of Marketing, Kellogg School of Management, Northwestern University, Evanston, Illinois 60208, yiqian@northwestern.edu
Hui Xie
Division of Epidemiology and Biostatistics, University of Illinois, Chicago, Illinois 60612, huixie@uic.edu
In marketing applications, it is common that some key covariates in a regression model, such as marketing mix variables or consumer profiles, are subject to missingness. The convenient method that excludes the consumers with missingness in any covariate can result in a substantial loss of efficiency and may lead to strong selection bias in the estimation of consumer preferences and sensitivities. To solve these problems, we propose a new Bayesian distribution-free approach, which can ensure that no customer is left behind in the analysis as a result of missing covariates. In this way, all customers are being considered in devising managerial policies. The proposed approach allows for flexible modeling of a joint distribution of multidimensional interrelated covariates that can contain both continuous and discrete variables. At the same time, it minimizes the impact of distributional assumptions involved in covariate modeling because the method does not require researchers to specify parametric distributions for covariates and can automatically generate suitable distributions for missing covariates. We have developed an efficient Markov chain Monte Carlo algorithm for inference. Besides robustness and flexibility, the proposed approach reduces modeling and computational efforts associated with missing covariates and therefore makes the missing covariate problems easier to handle. We evaluate the performance of the proposed method using extensive simulation studies. We then illustrate the method in two real data examples in which missing covariates occur: a mixed multinomial logit discrete-choice model in a ketchup data set and a hierarchical probit purchase incidence model in a retail store data set. These analyses demonstrate that the proposed method overcomes several important limitations of existing approaches for solving missing covariate problems and offers opportunities to make better managerial decisions with the current available marketing databases. Although our applications focus on consumer-level data, the proposed method is general and can be applied to other marketing applications where other types of marketing players are the units of analysis.
Key words: CRM; hierarchical Bayesian; individual marketing; marketing mix variable; MCMC; missing covariates
History: Received: December 14, 2009; accepted: March 7, 2011; Eric Bradlow and then Preyas Desai served as the editor-in-chief and Fred Feinberg served as associate editor for this article. Published online in Articles in Advance June 6, 2011.

1. Introduction
Regression models are a main class of econometric tools for empirical marketing and economics studies. For example, a vast marketing literature studies brand choices and purchasing behaviors of individual consumers. In these studies, discrete-choice regression models have become workhorses in assessing determinants of consumer choices among differentiated products and stores. Purchase incidence models are frequently used to evaluate what drives household purchasing/shopping decisions. Regression models for conjoint analysis are essential in studying the importance of product attributes and the design of new products. To create the most effective marketing

strategies, it is crucial to obtain valid and precise estimates of consumer preferences and responsiveness to marketing mix strategies.
In practice, missing data issues often arise in the applications of regression models (Little and Rubin 2002, Qian 2007). As noted in Blattberg et al. (2008, p. 301), "Missing variables is a fact of life for DBM [Database Marketing] applications." The focus of this paper is on how to obtain valid and efficient estimates of regression relationships when some key covariates in a regression model are subject to missingness. To describe the issue more precisely, let Y denote the regression outcome, and let X = X1 XK denote K covariates. We are interested in estimating

717

718

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

a parametric regression model, f Y X , where is a vector of parameters of interest. In marketing research, it is not uncommon that some variables in X are subject to missingness. For example, scanner panel data frequently have been used to calibrate discretechoice models. Although scanner panel data have the advantage of reflecting consumer behaviors in real life, missing data issues can be severe. Missing data can occur in this situation because here, unlike experimental studies, typically only the values of marketing mix variables (e.g., price and coupon values) for the purchased products are recorded in the collection of scanner data (Erdem et al. 1999, henceforth referred as EKS). Other situations in which missing data could occur include item and unit nonresponse in surveys (Bradlow and Zaslavsky 1999), conjoint analysis (Bradlow et al. 2004), attrition and intermittent missingness in panel data (Qian and Xie 2010), data combination from different sources (Kamakura and Wedel 1997, 2000; Gilula et al. 2006; Feit et al. 2010), and one-to-one marketing (Khan et al. 2009). In sum, missing data are ubiquitous in marketing research.
A simple method for avoiding missing covariate problems is the complete-case analysis, where the standard regression analysis is applied to the subset of units with complete data. The complete-case analysis, although convenient, is inefficient, because it does not exploit the available information in those excluded units. Furthermore, when the probability of missingness depends on the regression outcome, exclusion of units with incomplete data leads to inconsistent estimation of population parameters because the resulting subsample is nonrepresentative. For example, in the above scanner panel data example, the missingness of those important marketing mix variables depends on the observed choice outcome Y . A complete-case analysis or an ad hoc method to fill in the missing values without accounting for this dependence is subject to self-selection bias in the estimation of price sensitivity and promotion effect (EKS 1999).
A general approach that avoids the drawbacks of the complete-case analysis is to posit a model for the covariates in X and then estimate a joint model for the outcome Y and the covariates in X. That is, one bases the inference on the following likelihood:

L

Y Xobs

 f Y Xobs Xmis f Xobs Xmis dXmis (1)

where Xobs and Xmis denote the observed and missing components of X, respectively; is a vector of parameters in the density function for the covariates. The above likelihood-based inference is valid when missingness is ignorable (Rubin 1976). Missingness is ignorable if the missing data mechanism is missing

at random (MAR) and if the model governing the missing data mechanism has parameters distinct from the parameters and (i.e., parameter distinctness). The MAR assumption is satisfied if missingness is conditionally independent of the unobserved items in the data matrix, given the observed items in the data matrix. It is important to note that MAR is much less restrictive than missing completely at random (MCAR), which implies that missingness is independent of both unobserved and observed data values. The MAR is known to hold in the above scanner panel example, where the missingness of marketing mix variables depends only on the observed choice outcomes.1
In the above likelihood, a multidimensional covariate matrix must be carefully modeled, which can be a challenging task. One approach is to posit parametric distributions for X. One limitation of the parametric covariate modeling approach is that misspecification of the covariate distributions can result in a significant estimation bias and misleading inference. Therefore, care must be taken in modeling covariates. On the other hand, as shown in our empirical marketing applications, the multidimensional interrelated covariates usually contain a mixture of continuous, semicontinuous, and discrete variables that often exhibit features such as skewness, multimodality, discreteness, and zero-inflation. It is difficult to specify a joint parametric covariate model to account simultaneously for all the features in these variables. The problem is further exacerbated because, unlike the case in which all the data are observed, it is much harder, if not impossible, to verify whether distributional assumptions in a parametric covariate model are satisfied simultaneously for all the missing covariates. Furthermore, the computation burden can be heavy because one needs to evaluate multiple integration with respect to those missing covariates in the above likelihood. What is needed, then, is a method that minimizes the impact of covariate distributional assumptions and also reduces the extra modeling and computational burden involved in covariate modeling.
To address these challenges, we propose a new distribution-free Bayesian approach to estimating marketing models with multiple missing covariates. Our approach builds on a novel odds ratio modeling framework, first proposed by Chen (2004). The proposed method is robust in that no distributional
1 The MAR assumption could be questionable in some marketing applications. For example, if the missingness of a consumer profiling variable (e.g., income) relates to the unobserved value of this variable, even after controlling for all the observed information including the observed consumer behaviors (e.g., purchase incidence outcome) and those observed profiling variables of the same consumer, the missingness then becomes missing not at random.

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

719

assumptions are required for modeling covariates. It can automatically generate suitable distributions for missing covariates and account for important distributional features including the ones mentioned above. Despite its full freedom from distributional assumptions, the method is flexible enough to allow for dependence among the covariates. Our analyses in both the real data and the simulation studies demonstrate that the proposed method improves the estimation of the marketing model parameters (e.g., consumer preference and marketing mix sensitivities) in the presence of missing covariates. Consequently, the proposed method offers the opportunity for better managerial decisions, such as optimal pricing and more accurate targeting. Furthermore, the proposed approach possesses modeling and computational simplicity, thereby rendering missing covariate problems easier to handle than they are under parametric covariate modeling approaches. As a Bayesian approach, the proposed method is ideal for individualized marketing when individual-level covariates are subject to missingness, and it ensures that no consumer is left behind in managerial considerations.2 We hope this paper will contribute to expanding the set of tools researchers need to deal with missing covariate problems.
Our approach for missing covariate problems is general and can be applied to a wide range of marketing applications, including the following examples. · Market data. As discussed above, in consumer
databases, important variables often are missing (e.g., marketing mix variables, consumer profiles). The proposed method allows researchers to more efficiently and robustly estimate consumer preferences and sensitivity to marketing mix variables. · Survey data. Survey studies are widely used and act as essential tools with which marketing researchers can answer important questions, particularly when market data are not available. Item and unit nonresponse are common in marketing survey data and can threaten effective analyses of survey data. The proposed method can be applied to this data type to improve estimation and inference. · Combining data from different sources. It is becoming increasingly popular in marketing to combine data from different sources to overcome the limitations of a data set from a single source (e.g., Kamakura and Wedel 1997, 2000; Gilula et al. 2006; Feit et al. 2010). The missing covariate problem often occurs when data from different sources are combined (Feit et al. 2010). Our proposed method can be applied to address the problem.
2 An example is for online purchases, where ongoing predictions need to be made based on sparse individual-level data. We thank the associate editor for suggesting this.

· Beyond customer-level data. Marketing research is multifaceted. Regression models are often applied to study the behaviors of marketing players other than consumers, such as firms (manufacturers, retailers), organizations, and countries. Although our applications in this paper focus on the consumer-level data, the method can be applied to address missing covariate problems in empirical applications in which these other marketing agents are the units of analysis. The rest of this paper is organized as follows. In §2
we review prior literature for missing covariate problems and describe our contributions to the field. In §3 we describe the model and estimation. In §4 we summarize the features and benefits of the proposed method. In §5 we apply the proposed method to two marketing applications with missing covariate problems. We conclude with a discussion in §6.
2. Literature Review and Contributions
Missing data are ubiquitous and problematic not only in marketing contexts but throughout empirical analysis in social sciences. Consequently, the subject has received an enormous amount of attention in the literature (e.g., Little and Rubin 2002, Schafer and Graham 2002, Daniels and Hogan 2008, Tsiatis 2006). A key message from the literature is that methods based on the probability models are preferred for dealing with missing data issues because these methods are based on the established statistical principles with known properties. Furthermore, as the assumptions in the analyses are made explicit, the methods can be evaluated clearly. Our review therefore focuses on modelbased methods.
Little (1992) and Ibrahim et al. (2005) review various methods for dealing with missing covariates. Two main approaches for solving missing covariate problems are popular. The first one is the multiple imputation (MI) method (Little and Rubin 2002, Schafer 1997). MI imputes the missing values multiple times using draws from the predictive distributions of missing values. Each imputed data set is analyzed using standard complete-data methods. The resulting multiple estimates and inferences are combined to form one pooled inference using Rubin's combination rule. The second approach is the direct estimation method, in which a joint model for the regression outcome and the covariates is directly estimated using the likelihood or the posterior distribution under the model. Compared with MI, the direct estimation method does not require separate steps to create multiple data sets nor to pool estimates over these data sets.
In marketing literature, the missing covariate issue has also received much attention. Bradlow et al. (2004)

720

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

develop an imputation learning model for the missing attributes in a conjoint model that improves model estimation. EKS (1999) and Feit et al. (2010) study missing covariate problems in discrete-choice models. EKS (1999) focus more on the robustness of covariate modeling and use a polynomial probability function to model the nonnormal feature of price and coupon values. One limitation of the approach is its inflexibility to model the potentially strong dependence among the covariates. Feit et al. (2010) use a multivariate normal (MVN) covariate model, which allows for correlated covariates. The MVN model is frequently used in missing data analysis because of its unique mathematical and computational properties.3 However, there are also significant limitations in using a MVN model to handle missing covariate problems. First, the regression parameter estimators can be substantially biased if the parametric distributional assumption is incorrect. Second, the MVN covariate model does not allow for nonlinear relationships (e.g., a quadratic relationship or a relationship with interaction) among covariates. As shown in §4.5, this inflexibility in modeling covariates can cause bias in outcome regression estimates. Third, except for some limited types of regression models, the computational cost generally is high. For example, when the outcome is nonnormal or when the regression model contains nonlinear or interaction terms of missing covariates, the likelihood of the resulting joint model can involve intractable integrals with respect to missing data.
There are other important works in marketing literature related to missing data problems. Kamakura and Wedel (1997, 2000) develop MI methods to solve data fusion problems. Their novel idea is to use a finite mixture model to identify underlying homogeneous groups; the missing data are then stochastically imputed using observations from the same group. Gilula et al. (2006) propose a direct approach to data fusion, which directly estimates the joint distribution of the variables of interest. Although these methods have been highly successful in addressing the problems for which they were designed, they address issues that differ from missing covariate problems, which are the focus of this paper.4 Another stream of
3 For example, the multiple imputation procedure in SAS, PROC MI, uses the MVN model as the working model.
4 For example, Kamakura and Wedel's data fusion approaches address problems for which all variables are treated equally, and no regression model in the form of f y x is considered. In contrast, in missing covariate problems, the regression model f y x is of primary interest, and it is important to use f y x to impute missing covariate values. Gilula et al. (2006) do employ a regression model f y x . Their direct data fusion approach assumes that all covariates in x are fully observed and thus also does not address the missing covariate problems.

research studies the missing outcome issues in regression models (Bradlow and Zaslavsky 1999, Ying et al. 2006, Qian and Xie 2010, Yang et al. 2010). In these studies, however, the missingness occurs in the outcome instead of in the covariates, thus obviating the need to model covariates.
There is emerging literature in statistics on weighting methods for missing data (Tsiatis 2006). This class of methods can be considered as a direct estimation approach in which the estimation is based on a set of inversely weighted estimating equations. A major motivation of the weighting methods is the robustness to model misspecifications. In addition to specifying a covariate model, a weighting method requires modeling how covariates are missing even if they are missing at random. Modeling how multiple covariates are missing may not be easy, and thus this approach may require much more modeling work. This is in stark contrast to the likelihood-based approaches in which there is no need to model missing data mechanisms when data are MAR. The benefit of the additional modeling in the weighting method is its property of double robustness. In missing covariate problems, this implies that as long as either the missing data model or the covariate model is correctly specified, the resulting inference is consistent. The method therefore protects against misspecifications of one of the two working models, although not against simultaneous misspecifications of both. Debates are ongoing regarding the relative merits of likelihoodbased methods and weighting methods (e.g., see the discussions in Kang and Schafer 2007). We note three relevant points here. First, except for the special case of monotone missingness, finding the most efficient estimator in weighting methods is difficult, whereas a likelihood-based approach, if correctly specified, is most efficient. Second, for a general pattern of missingness, correctly specifying missing data models for all missing covariates is difficult, if not impossible. When the missing data models are misspecified, the validity of a weighting approach, similar to that of a likelihood-based approach, also depends on the robustness of the covariate model. Thus in the weighting approach, the robustness of covariate modeling is also important in achieving a good property. Third, because likelihood-based approaches are familiar to and used frequently by researchers for various reasons, it is highly relevant to develop robust methods for missing covariate problems within the likelihoodbased framework.
As is reviewed above, to handle missing covariate problems in marketing models, there is a clear need for further research to find a method that is more robust and flexible yet also general enough and relatively simple to use. To that end, we contribute to the literature by proposing a new distribution-free

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

721

Bayesian approach that overcomes several important limitations of existing methods for missing covariates. Our approach builds on the novel semiparametric odds ratio model, first proposed by Chen (2004), and extends it to a Bayesian framework. In the extension, we study the Bayesian inference and carefully deal with the issue of efficient sampling algorithms under the unique semiparametric model. As such, our method shares many benefits of Chen's approach while overcoming its limitation in handling highdimensional missing covariate problems and/or complex models. Because such problems are common in marketing applications, the proposed method is applicable to a much wider range of such applications. We offer a more detailed discussion on the features and benefits of the proposed method in §4.

3. Model and Notation
Following the notation in §1, let f Y X denote the density function of a parametric model, with its parameters being the main interest of the study. Below are some examples of the commonly used parametric regression models in marketing applications.
· Generalized Linear Model (GLM). The GLM assumes that the outcome Yi is independently drawn from a distribution in the exponential family whose density function is

f yi xi

= exp yi i

xi - b i a

xi + c yi

(2)

where i is the canonical parameter as a function of regression parameter ; functions b · and c · · determine a particular distribution in the exponential family; and a = /w, where is the dispersion parameter and w is a known weight. The GLM includes normal, binomial, Poisson, Gamma, and inverse Gaussian models as special cases. It is frequently used in data analysis and forms the foundation for many more advanced marketing models.
· Discrete-Choice Model and Conjoint Model. Built from underlying marketing and economic theories (e.g., utility maximization), these models are well suited for estimating consumer preferences and sensitivity to marketing mix variables, market segmentation, and policy forecast.
· Duration Model. This model is useful for studying consumer purchase incidence behavior. Seetharaman and Chintagunta (2003) demonstrate examples of parametric duration models.
· Models with heterogeneity. All of the above models can be extended to incorporate consumer heterogeneity, a critical feature in marketing applications (Allenby and Rossi 1999).

As explained in §1, the covariate X can be sub-

ject to missingness in many marketing applications.

To handle the problem, one needs to posit a covari-

ate model, f X . We review a novel semiparametric

odds ratio model below, first proposed by Chen (2004)

and adopted here for covariate modeling. To illustrate

the idea, we start with a simple case in which X con-

tains only two variables, X1 and X2, which could be either continuous or discrete. Let f x1 x2 be the joint density function when X1 X2 = x1 x2 . Let x10 x20 be a fixed and prespecified point in the sample space

of X. The odds ratio is

x2

x20

x1

x10

f x2 = f x2

x1 f x20 x10 x10 f x20 x1

(3)

The odds ratio, as defined above, captures the depen-

dence between X1 and X2. When X2 is independent of X1, the odds ratio x2 x20 x1 x10 is one for all possible values of x1 and x2. Chen (2004) shows that the conditional distribution can be reexpressed as

f x2 x1 =

x2 x20 x1 x10 f x2 x10 x2 x20 x1 x10 f x2 x10 dx2

As shown above, the main idea of the modeling
approach is to decompose the conditional density
f x2 x1 into two parts: a conditional density function f x2 x10 and an odds ratio function x2 x20 x1 x10 . These two parts can then be modeled separately.
f x2 x10 is the density function of X2 = x2 at a fixed value, X1 = x10. Although it is not the same as the marginal density function f x2 , it behaves like a marginal density function instead of a conditional dis-
tribution, as will be shown later in this section. We
call such a density a marginal-like density function.
Using the odds ratio representation, the joint density
for x1 x2 is

f x1 x2 = f x1 f x2 x1

=

x2 x20 x1 x10 f x2 x10

f

x2 x20 x1 x10 f x2 x10 dx2

x1

This idea can be extended to the case in which X
contains more than two variables by using condition-
ing. Let X = X1 XK denote the K covariates. Its joint density function is

f x1 xK

K

= f 1 x1 f k xk xk-1

x1

k=2

K

= f 1 x1

k xk xk0 xk-1

x1 x k-1 0

x10

k=2

·f k

xk

x k-1 0

x10

·

k xk xk0 xk-1

x1 x k-1 0

x10

·f k

xk

x k-1 0

-1

x10 dxk

(4)

722

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

where each conditional distribution f k xk xk-1 x1 is reexpressed as a function of an odds ratio function and a marginal-like density function; 1 and k denote the parameters in the marginal density func-

tion of X1 and in the conditional density function of Xk, respectively; and k and k denote the parameters in the odds ratio function and the marginal-like

density function for Xk, respectively. Let xk1

xkNk

be the unique observed values in the data set for Xk.

A nonparametric model assigns probability mass pk =

pk1

pkNk to f xk x k-1 0

x10 , where a con-

straint is that

Nk l=1

pkl

=

1

for

every

k.

To

relax

the

con-

straint, we reparameterize pk as k = k1

kNk ,

such that pkl = exp

kl = kl /

ln
Nk u=1

pkl /pkNk exp ku

for l = 1 Nk. Thus, . With this nonparamet-

ric model for f xk x k-1 0

x10 , the joint density

function for X can be expressed as in Equation (4),

where

f k xk xk-1

x1

k xk xk0 xk-1

x1 x k-1 0

x10

f k

xk

x k-1 0

x10

=

k xk xk0 xk-1

x1 x k-1 0

x10

f k

xk

x k-1 0

x10 dxk

=

1 Nk
l=1 xk =xkl

k xkl xk0 xk-1

x1 x k-1 0

x10 exp kl

Nk l=1

k xkl xk0 xk-1

x1 x k-1 0

x10 exp kl

(5)

f 1 x1 can also be written in the above format

by letting = 1. Equation (5) assigns probability

1

mass pk = pk1

pkNk to xk1

xkNk , where pkl =

f k xk = xkl xk-1

x1 l = 1

Nk. As shown

in Equation (5), the integral in the denominator of

f k xk xk-1

x1 is replaced with a summation

over a finite number of observed data values. This

simplifies computation by avoiding the evaluation of

integrals. In this modeling framework, the marginal-

like distribution has been modeled nonparametrically,

thus enhancing the robustness of the method. We fol-

low Chen (2004) by using the following simple bilin-

ear form for odds ratio functions:

ln k xk xk0 xk-1

x1 x k-1 0

x10

k-1

=

kv xk - xk0 xv - xv0

(6)

v=1

As noted in Chen (2004), using the above simple bilinear form for odds ratio makes it easy to see that the model nests the popular generalized linear model as a special case. To see this, let xk follow a GLM, as in Equation (2); its mean, k, is

g k = 0 + 1x1 + · · · + k-1xk-1

where g · is the canonical link. The corresponding odds ratio function can be shown to be

ln k xk xk0 xk-1

x1 x k-1 0

x10

k-1

v
= v=1 a

xk - xk0

xv - xv0

The GLM model therefore has a bilinear form of

odds ratio function, and the log-odds parameter k is a reparametrization of the parameters in the famil-

iar generalized linear model. On the other hand, the

marginal-like density function, f k xk x k-1 0

x10 ,

is modeled parametrically in a GLM, whereas it is

modeled nonparametrically in the distribution-free

method. Thus, with the bilinear form of the odds ratio

function, it is readily seen that the above distribution-

free model nests the commonly used parametric GLM

as a special case by eschewing the distributional

assumptions. It is important to note that despite

its full freedom from distributional assumptions, the

distribution-free model is as flexible as a classical

regression model in modeling relationships among

variables. For example, similar to GLM, higher-order

terms can be included in the odds ratio functions to

model more complex relationships; nominal variables

can be included in the odds ratio functions by using

the dummy-variable technique.

We have developed an efficient Markov chain

Monte Carlo (MCMC) algorithm to make inference

of the joint model. One key step in the algorithm is

to update the parameters in the semiparametric odds

ratio model for covariates. The semiparametric odds

ratio model is distinct from the conventional para-

metric models. A difficulty to overcome in Bayesian

inference is finding an efficient method for posterior

sampling. There is no conjugate prior to updat-

ing these parameters. The random-walk Metropolis-

Hastings algorithm encounters the slow mixing prob-

lem because of the potentially high correlations

between parameters. We employ a hybrid Monte

Carlo (HMC) sampler (Duane et al. 1987) to update

these parameters. The sampler exploits the local

dynamics of the target distribution to propose a can-

didate draw, thus leading to a higher acceptance

rate with fast mixing of the posterior draws. The

details of the estimation algorithm are described in

Appendix A of the electronic companion, available

as part of the online version that can be found at

http://mktsci.pubs.informs.org/.

4. Features and Benefits of the Proposed Method
To motivate our research, we conducted extensive simulation studies covering various covariate distributions and a wide range of types of regression models, including GLMs, mixed multinomial logit, and multivariate probit discrete-choice models, and hierarchical probit purchase incidence models with and without autocorrelation. Simulation results illustrate the limitations of the existing approaches to missing covariate problems and demonstrate the unique features and benefits of the proposed method. Because

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

723

of the space limitation, we summarize the main conclusions below and move the details of simulation studies to Appendix B of the electronic companion.
4.1. Robustness The simulation studies demonstrate the importance of robust covariate modeling. As shown in Appendix B.1 of the electronic companion, when the parametric distributional assumptions are correct, parametric covariate modeling approaches to handling missing covariates work well and can remove the large bias and substantial loss in estimation efficiency that occurred in complete-case analysis. When the covariate distribution is misspecified, however, a sizable bias and poor coverage rate can arise in the estimates of outcome regression parameters. In contrast, the proposed distribution-free method works well over different shapes of covariate distributions. The simulation studies detailed in Appendices B.5 and B.6 of the electronic companion confirm the robustness of the proposed method for other types of marketing models, and these studies show that the proposed method can correct for the bias in the estimates of consumer preferences and marketing mix sensitivities as a result of the misspecification of distributional assumptions in parametric covariate modeling approaches. These studies demonstrate the value of a nonparametric procedure as a robust approach to minimize the impact of distributional assumptions in handling missing covariate problems.
4.2. Simplicity We investigate two aspects of simplicity: computational and modeling. We first discuss computational simplicity. Recall that the likelihood function of the joint model as specified in Equation (1) involves integration with respect to missing covariates. For a nonnormal regression model such as Poisson, the integral has no closed-form solution with those parametric covariate models. This leads to computational difficulty, as detailed in Appendix B.2 of the electronic companion. In contrast, updating Xmis in our proposed Bayesian approach is simple in that its conditional distribution is a closed-form multinomial distribution on a set of known values, and the probabilities in the multinomial distribution can be readily evaluated. As shown in simulation studies and in real data analysis, this computational simplicity helps to improve the convergence properties of the MCMC algorithm and to reduce the computational time compared with the parametric covariate modeling approach.
Next, we discuss modeling simplicity, which in our opinion is no less important than computational simplicity. As noted above, because selecting suitable distributions for missing covariates is important, careful modeling must be done. This presents

a number of difficulties, however. A common and convenient parametric model might not be general enough to fit the unknown distributional shapes of missing covariates. The attempt to verify the parametric distributional assumptions for all covariates is also cumbersome--if not infeasible--when covariates are subject to missingness. The finite mixture modeling approach is more flexible in that it tries different parametric distributions for covariates and chooses the one that fits the data best. As shown in the simulation studies, its success depends critically on correctly specifying the number of mixture components. In general, selecting the correct number of mixture components is not an easy task and remains an active research area. This issue may be more challenging for missing covariate problems. Furthermore, avoiding local optima often requires that researchers repeatedly fit the joint model with a wide range of values for the number of mixture components. The workload can become computationally burdensome with a more complicated outcome regression model and in a high-dimensional missing covariate problem.
One important value of the proposed distributionfree approach for missing covariate problems, as a nonparametric procedure, is its automatic modeling feature; it does not require researchers to specify parametric covariate distributions and can automatically generate suitable distributions for missing covariates. The automatic feature of the proposed method frees up researchers' time to look for proper covariate distributions, and it allows them to invest their valuable time in other aspects of modeling, such as developing a more intelligent outcome regression model, thereby increasing the efficiency of their research activities.
Last but not least, our approach conditions on any fully observed covariates. This important feature has the advantage of further reducing the computational burden and increasing the modeling robustness compared with an approach based on a joint normal model or a mixture of joint normal models.
4.3. Efficiency Our proposed method is also efficient in that the variability of regression parameter estimates using the proposed method is almost the same as that using the correct parametric covariate model.5 This might at first seem counterintuitive to the concept that a highly parameterized model should have less variability in estimation than a nonparametric method. This should not be unexpected, however, because the regression parameters are high-level functionals of the probability density function. Such high-level functionals
5 Note that the sample size used in the simulation study is only moderately large for marketing applications. For greater sample sizes, the efficiency loss would vanish.

724

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

undergo smoothing operations of integration of the probability density functions. As a result, the regression parameters theoretically can be estimated more efficiently with a nonparametric procedure than lowlevel functionals, such as the density function itself.6
In summary, by using the proposed distributionfree procedure, researchers would expect little or no loss of efficiency in typical marketing applications, and the method would perform as well as a correctly specified parametric covariate model. On the other hand, when the parametric covariate model is misspecified, a substantial bias can result. Because the nonparametric distribution-free method is still consistent in this case, the proposed distribution-free method will outperform the parametric method.
4.4. Convergence The general convergence properties of the MCMC algorithm are established in Tierney (1994). Our approach uses proper priors, and the Markov chain in our algorithm is defined by a strictly positive transition kernel that is irreducible and aperiodic. Specifically, the samplers used in our algorithm to update model parameters are known to have these properties. The imputation step involves drawing from the set of observed values, each of which has a strictly positive probability to be visited. Therefore, theoretically, the MCMC chain will converge to its stationary distribution. Empirically, we use both time-series plot and numerical Geweke's diagnostic statistics (Geweke 1992) to check convergence. These statistics show that the Markov chains converge to the stationary distribution. In particular, the distributions of the Geweke's diagnostic statistics over the simulated data sets follow the null distribution of the test statistics. Chen (2004) establishes that under general regularity conditions, the maximum likelihood estimator (MLE) based on the semiparametric odds ratio covariate model is consistent and asymptotically normally distributed. Because of the asymptotic equivalence of the frequentist procedure and a Bayesian approach, we expect our Bayesian procedure to share this general property.
4.5. Flexibility An important strength of the proposed method is its modeling flexibility, which refers to its ability to model the potentially complex dependence structure among covariates. The simulation studies in Appendix B.5 of the electronic companion show the importance of modeling the dependence among
6 Meier et al. (2004) had a similar finding in a different context. They found that when estimating mean survival time, a special type of regression parameter, the loss of efficiency of the nonparametric Kaplan­Meier procedure relative to parametric approaches is negligible.

covariates; assuming independence in covariate modeling when covariates in fact depend on each other can lead to biased estimates in a brand-choice model. As reviewed in §2, despite its convenience in some special cases, the commonly used MVN model has limitations in accounting for a nonlinear relationship (e.g., a quadratic relationship or a relationship with interaction) among covariates. The simulation study described in Appendix B.3 of the electronic companion demonstrates that when the MVN covariate model is used in the presence of underlying nonlinear relationships among covariates, a significant amount of bias in outcome regression model estimates can occur. It is reasonable to believe that such bias would also exist when a latent MVN model is used to model discrete covariates, if nonlinear relationships exist among these covariates. In contrast, the odds ratio model is flexible enough to allow for such nonlinear relationships while not making any parametric distributional assumptions.
4.6. Generality The proposed method is general in that it can handle a wide variety of types of continuous and discrete variables. It can also handle a general pattern of missingness.
4.7. Comparison with the Method of Chen (2004) Our Bayesian method also compares favorably in terms of scalability to higher-dimensional missing data problems and to more complex models with the MLE method developed by Chen (2004). The MLE method requires evaluating the model likelihood. Although the integration in the likelihood is replaced by the summation over finite points, the number of terms to evaluate can become large with multiple missing covariates, which makes the MLE method computationally expensive. In contrast, the MCMC algorithm used in our Bayesian approach avoids evaluating likelihood, and thus it can handle much higher-dimensional missing data problems, commonly seen in marketing applications. The simulation study in Appendix B.4 of the electronic companion shows that the computational time increases exponentially for MLE as the number of missing covariates increases but only linearly with the Bayesian approach. The computational advantage would be even more dramatic for more complex models, such as when the covariate model involves interaction effects or when the outcome regression model becomes more complex. Because of computational difficulty, certain important data features that cannot be incorporated using the MLE approach can be handled with relative ease using the proposed Bayesian approach.

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

725

Table 1 Summary Statistics of Marketing Variables

Price

Brand

Choice share (%) Mean

SD and correlation matrix

Heinz

27 2

Hunt's

32 1

Store brand

20 8

1 17 0 16 -0 43 -0 30

1 01

0 15 0 21

0 71

0 10

Coupon

Proportion of

Mean of

no coupon (%) no-zero coupon

78 9 88 5 100

0 473 0 479
NA

Other benefits of the proposed Bayesian approach compared with the MLE approach include exact inference in small samples, easy incorporation of useful information from other sources through prior specifications, and proper and convenient estimation of unit-level quantities. Using the proposed Bayesian approach for missing covariates, all these benefits become readily available to researchers.

5. Applications

5.1. Ketchup Data Set Our first example is the ketchup data in the ERIM scanner panel data set provided by ACNielsen. We include three brands in the analysis: Heinz, Hunt's, and the store brand. These three major brands account for more than 80% share in the market. The sample period is from 1985 to 1987, covering two and a half years of transactions. Our analysis considers those purchases in the dominant package size of 32 ounces. The analysis sample contains 171 households that made a total of 1,093 purchases from one store in the Springfield market. Table 1 contains the summary statistics of the data set.
We employ a discrete-choice model to estimate the effect of pricing and coupon availability on the demand of ketchup. Let uitj be the utility function of the jth brand for the ith consumer at purchase occasion t, and

uitj = 0ij + XiTtj i + itj i = 1

N

(7)

where the brand index j = 1 2 3 represents the Heinz,

Hunt's, and store brands, respectively. In the utility

function, 0ij is the individual-specific preference for brand j, where 0i3 is normalized to be zero for identification purposes. The term Xitj is a vector of brand characteristics, and in our application, Xitj = Pitj Citj , where Pitj and Citj denote the price and coupon values, respectively, for the jth brand faced by the ith con-

sumer at purchase occasion t. The parameter i = 1i 2i , where 1i and 2i are the individual-specific
sensitivity coefficients for price and coupon, respec-

tively. The term itj is the idiosyncratic error term, unobservable to researchers. The researchers observe

the consumers' choices among the brands. Let Yit =

Yit1

YitJ be a vector of binary variables, where

Yitj = 1 if the consumer i chooses brand j at the purchase occasion t, and Yitj = 0 otherwise. The random utility model assumes that Yit is determined by the latent utility in the following way:

Yitj = 1 iff uitj > uitj j = j

We assume that itj follows an independent and identically distributed (iid) Type I extreme value distribution across purchase occasions, brands, and consumers. The probability for the choice of consumer i observed at time t is

f i Yit Xit =

J j =1

Yitj

exp

Vitj

J j =1

exp

Vitj

and

Vitj = 0ij + 1iPitj + 2iCitj

We model consumer heterogeneity i = 0i1 0i J -1 1i 2i J = 3 as follows:

i  N Zi -1

(8)

where is an nr × nz matrix, Zi is a vector of length nz containing consumer-level characteristics, and is an nr × nr precision matrix. and contain hyperparameters that describe the population distribution of the subject-specific parameters i.
The mixed multinomial logit (MNL) model specified above and its variant have been well studied and widely applied in economics and marketing (e.g., Guadagni and Little 1983, Kamakura and Russell 1989, Chintagunta et al. 1991, Gönül and Srinivasan 1993).7 The Bayesian approach and the MCMC algorithm for the mixed MNL estimation are well established (Rossi and Allenby 1993, Allenby and Lenk 1994).
In practice, some of the important marketing mix variables are subject to missingness. The pioneering

7 We use the standard form of the mixed MNL model for the following reasons: (1) This allows us to investigate and demonstrate the effects of missing covariates, the main theme of this paper, and to contrast our approach with the prior approach of EKS (1999) to the same missing covariate problem in a relatively straightforward setting. (2) It is reasonable to believe that more complicated brand choice models would not affect the relative performance of the methods in dealing with the missing covariates here.

726

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

and insightful work of EKS (1999) points out the problem of missing covariates in a discrete-choice model, where the prices and coupon availability are missing for the brands not purchased by any customer in the scanner panel data. They presented an econometric approach to correct for the self-selection bias that results from missing covariates. Specifically, they posited a model for the price and coupon process and based the inference on the likelihood

L
N
=
i=1

Y Xobs Z
f i Yit Xiotbs Ximt is
tTi

· f Xiotbs Ximt is dXimt is f i Zi d i (9)

where Ti is the set of purchase occasions for con-

sumer i, and Xit = Pitj Citj j = 1

J . Their

approach assumes that the covariates are indepen-

dent: f Xit = j f pj Pitj j f cj Citj , where each density is separately modeled as a polynomial function.

When applying the proposed method to the brand

choice model, our approach can be viewed as an

extension of EKS in the following ways. First, we

attempt to make the above approach more robust.

To increase the modeling robustness, a nonparametric

distribution function is applied to model each covari-

ate. Because the parameters in the discrete-choice

model are of primary interest, and the parameters in

the covariate model are rarely of interest, a robust

model with fewer assumptions about the covariate

distribution is desirable. Second, we relax the assump-

tion of independence among covariates. As will be

shown later in this section, allowing for the correla-

tions between covariates can further improve the esti-

mates of brand preferences and sensitivity to market-

ing mix variables. Moreover, our generalization in this

aspect makes the method applicable to other cases

wherever correlations exist among covariates, as is

shown in the second application of the paper. Third,

our development uses a Bayesian framework, which

has well-known advantages in the individual-level

parameter estimation (Allenby and Rossi 1999).8

8 Other related work includes Chiang (1995) and Musalem et al. (2008). Chiang (1995) also recognized the problem of missing marketing mix variables, but explicit modeling of the problem is not the emphasis of that work. A general issue with such ad hoc approaches to handling missing covariates is that they do not account for dependence between the regression outcome and missing covariates, which can lead to selection bias in outcome regression estimates. Furthermore, assumptions involved in such ad hoc approaches often are hidden, which makes it difficult to assess the validity of these methods. Musalem et al. (2008) developed a new Bayesian method to estimate demand models when only aggregate data are available. Their approach is to simulate latent (i.e., entirely missing)

Strictly speaking, the discrete-choice model could not be directly estimated using available data because the price and coupon variables face serious missingness problems. In fact, no purchase transaction has all the values of Pitj and Citj observed. Some sort of imputation method is required for filling in the missing values to estimate the discrete-choice model. We believe that a valid imputation method needs to take into account the dependence between the choice outcome and the missing covariate values, as well as the dependence among the covariates.
Here, we consider four imputation methods. The first method is a conventional simple imputation (SI) method as documented in EKS (1999). For any nonbought brand in a purchase, the conventional method searches in the database for any other consumer who bought this brand in the same store on the same day. If such a customer exists, the price at which that consumer bought the brand is used to fill in the missing price. If no such customer exists, we will fill in the missing price with the average weekly price. If there is no other weekly sale for this product, the average price on the nonpromotion days in the study period is used to fill in the missing price values. For a coupon, the SI method assumes that the coupon value is zero for any nonbought brand. It is important to note that this procedure only uses the observed price and coupon values to fill in missing values. Although this type of simple imputation procedure is commonly used in practice, e.g., by scanner panel data provider to fill in missing prices, it does not consider the potentially strong dependence between the choice outcome and these marketing mix variables, and thus it can lead to a strong self-selection bias.
The second and third imputation methods apply the proposed distribution-free method to model the price and coupon distributions. Let the covariate Xit = Pit1 Pit2 Pit3 Cit1 Cit2 Cit3), where the third subscript takes a value of 1, 2, or 3 representing the Heinz, Hunt's, and the store brands, respectively. A semiparametric odds ratio model as specified in Equations (4) and (5) is applied to model Xit, with the following bilinear forms of the odds ratio functions:

j -1

ln Pitj Pitj Pitj0 =

P jj

Pitj - Pj0

Pitj - Pj 0

j =1

+

P j0

Pitj - Pj0

Pitj0 - Pj00

ln

Citj Pitj =

C j

Citj - Cj0

Pitj - Pj0

consumer-level data that are consistent with the aggregate data. The missing covariates are of binary types. Our approach considers more detailed data (e.g., coupon face values instead of coupon usage indicators) where covariates can contain a mixture of continuous and discrete variables; this requires more careful modeling.

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

727

Practical applications pose situations in which other

observations can provide useful information about

the missing values of a covariate. An important

strength of the proposed method is its flexibility in

allowing such information to be used through the

odds ratio functions, despite its full freedom from dis-

tributional assumptions. For example, the prices of

different brands might be correlated because of price

competition or price conformity. This price correlation

might be related to the market structure. The correla-

tions among prices of the three brands are significant.

Table 1 shows that the correlation coefficients among

prices of the three brands, using the observed data,

are as follows: -0.43 (between Heinz and Hunt's),

-0.30 (between Heinz and the store brand), and 0.21

(between Hunt's and the store brand). In the above

odds ratio model, the log odds parameter

p jj

captures

the correlations among the prices of different brands

and therefore allows the price of a brand not pur-

chased by a customer to be informed by that of the

customer's purchased brand. The price and coupon

values may also be correlated, and the parameter

C j

captures

such

potential

correlations.

Because

we

never simultaneously observe the coupon availability

and face values of all brands for any consumer, we

opt for a simpler analysis that assumes independence

among coupon values of different brands and that

fixes the corresponding parameters in the odds ratio

functions at zero. Observations from other consumers

may provide useful information about the missing

price values. For example, even though a price for a

nonpurchased brand might not be observed for a con-

sumer, another consumer might purchase that brand

during the same time period. To incorporate such

information, we create a new variable, Pitj0, which denotes the price paid for the brand j at the time t

by a customer other than consumer i. If no such cus-

tomer exists at time t, we search for the customer

who purchased the brand in the nearest time and

use that price as Pitj0. Our model then allows the covariate distribution to depend on such informa-

tion through the odds ratio functions. In the above

model, the fixed and prespecified points for each vari-

able are chosen to be the smallest observed values for

the price and coupon variables, respectively.9 More

details about the distribution-free procedure and its

9 Theoretically, the choice of the fixed points can be arbitrary. For example, when we use the largest values instead of the smallest values, the estimation results have negligible changes in that the changes of all parameter estimates are well within 3% of those estimates using the smallest values. Practically speaking, an absurd choice of these points, such as points extraordinarily remote from observed data points, could lead to computational instability. We recommend using a fixed-point value within the smallest and largest observed values.

estimation algorithm can be found in Appendix A.2 of the electronic companion.
The above model is named "DF Model II." For a comparison, we fit a model named "DF Model I," which assumes all the covariates in Xit are independent of each other. This is equivalent to setting all the log odds parameters at zero in the above odds ratio functions. In this aspect, DF Model I is akin to the analysis of EKS (1999) in that it ignores the potential dependence among marketing mix variables. On the other hand, DF Model I assumes a nonparametric distribution for each covariate instead of the parametric polynomial distribution used in EKS (1999). We estimate the model using the priors and the MCMC algorithm described in Appendix A.2 of the electronic companion. For the purpose of comparison, we also fit a parametric MVN covariate model for Xit0 Xit , where Xit0 = Pit10 Pit20 Pit30 . It is important to note that the MVN method models Xit0, whereas DF Models I and II condition on it. The DF models therefore further reduce the computational workload while increasing the modeling robustness. All the models run the MCMC sampler, which discards the first 30,000 iterations as the burn-in period and keeps every 10th draw for the next 500,000 iterations. We use Geweke's diagnostic to check the convergence. The chains were found to converge well, except for the parameters related to the coupon variable in the SI model.10 The computational times to obtain 1,000 effectively independent draws for the population regression parameters are 1 hour and 40 minutes, 35 minutes, and 38 minutes for the MVN model, DF Model I, and DF Model II, respectively. The ratios of the average f statistics of the population regression parameters in the Markov chains, relative to those from the MVN model, are 0.91 and 0.93 for DF Models I and II, respectively.11 Because of its computational simplicity, as explained in §4.2, we can see that the proposed distribution-free method takes significantly less time than the parametric MVN model with a somewhat smaller autocorrelation.12
10 As explained later in this section, the coupon variable does not converge in the SI model because the ad hoc method to fill in the coupon variable in the SI method creates a strong self-selection bias. EKS (1999) also note this problem.
11 Because we use the same sampler to update parameters in the outcome regression models for all methods, the difference (or ratio) of computational times (or f statistics) among methods can be attributed to differences in methods for dealing with missing covariates. For high-dimensional missing covariate problems, the importance-sampling-type algorithm is infeasible, so we use the data augmentation algorithm described in Appendix B.2 of the electronic companion for the MVN model. The f statistic, as defined in Rossi et al. (2005, Chapter 3.10.3), measures the strength of autocorrelation in a Markov chain, with a higher f value indicating stronger autocorrelation.
12 Given that a finite mixture of the MVN model is more complicated than the MVN model, it is expected that the approach would

728

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

Table 2 Estimation Results in the Ketchup Purchase Data

Parameter

SI model

MVN model

DF Model I

DF Model II

Intercept (Heinz) Intercept (Hunt's) Price Coupon
11
22
33
44
12
13
14
23
24
34
(1) Price model Heinz p11 p12 p13 p14 p15 p16
Hunt's p21 p22 p23 p24 p25 p26 p27
Store brand p31 p32 p33 p34 p35
(2) Coupon model Heinz c11 c12 c13 c14 c15 c16 c17
Hunt's c21 c22 c23 c24 c25 c26
Store brand c31
(3) Dependence
P 10 P 20 P 21 P 30 P 31 P 32 C 1 C 2
Marginal LL

1 8 (0.28) 1 6 (0.20) -3 4 (0.50) 53 6 (3.32) 2 2 (1.1) 1 4 (0.6) 2 8 (2.1) 3 3 (8.8) 0 98 (0.77) -1 56 (1.48) 0 24 (1.87) -0 91 (1.04) 0 28 (1.28) -0 18 (2.96)
-1,164.40

Choice outcome model 3 5 (0.44) 3 1 (0.36)
-6 1 (0.76) 2 4 (0.56) 4 2 (1.5) 3 7 (1.1) 15 4 (5.8) 1 44 (1.21) 3 1 (1.2) 2 8 (2.3) 0 3 (0.4) 3 6 (2.1) 0 6 (0.8)
-0 4 (0.2)
Covariate modela

37 33 -6 6 44 61 49 18 5 69 46 14 16 21 15 -2 2

(0.45) (0.36) (0.86) (1.28) (2.6) (1.7) (8.2) (6.4) (2.0) (4.2) (3.8) (3.5) (3.0) (7.8)

0 21 (0.02) 0 48 (0.03) 0 19 (0.02) 0 008 (0.005) 0 054 (0.014) 0 053 (0.014)
0 31 (0.02) 0 24 (0.02) 0 36 (0.03) 0 03 (0.01) 0 0095 (0.007) 0 025 (0.01) 0 022 (0.01)
0 11 (0.02) 0 66 (0.03) 0 134 (0.02) 0 024 (0.01) 0 08 (0.02)
0 87 (0.02) 0 005 (0.003) 0 040 (0.009) 0 035 (0.009) 0 002 (0.002) 0 050 (0.011) 0 0027 (0.002)
0 93 (0.012) 0 002 (0.002) 0 002 (0.002) 0 005 (0.003) 0 06 (0.01) 0 002 (0.002)
1 00 (0.00)

-1,122.63

-3,428.16

30 28 -5 4 35 48 40 15 2 32 35 29 04 32 03 -0 8

(0.36) (0.31) (0.66) (1.24) (1.8) (1.2) (5.9) (2.1) (1.4) (2.7) (2.1) (2.4) (1.8) (3.9)

0 20 (0.02) 0 49 (0.03) 0 22 (0.02) 0 004 (0.005) 0 051 (0.02) 0 035 (0.02)
0 31 (0.02) 0 27 (0.02) 0 37 (0.04) 0 02 (0.01) 0 005 (0.01) 0 016 (0.01) 0 018 (0.01)
0 10 (0.02) 0 66 (0.03) 0 164 (0.02) 0 020 (0.02) 0 06 (0.02)
0 84 (0.02) 0 003 (0.002) 0 047 (0.01) 0 039 (0.01) 0 0011 (0.002) 0 066 (0.02) 0 0029 (0.002)
0 90 (0.01) 0 002 (0.002) 0 001 (0.002) 0 006 (0.004) 0 088 (0.02) 0 004 (0.003)
1 00 (0.00)
39 1 (3.7) 41 0 (8.0) -22 3 (5.1) 28 4 (7.9)
0 82 (4.0) 12 97 (6.5)
2 4 (1.8) 9 2 (1.8) -2,631.89

Notes. Presented are the posterior means (posterior SD) for each parameter. The parameter pbl in the price model is the estimated marginal probability mass at the lth price value of brand b, where these price values, in the order presented in the table, are as follows:
for Heinz, 0.99, 1.19, 1.39, 1.45, 1.49, 1.59; for Hunt's, 0.89, 0.99, 1.19, 1.39, 1.45, 1.49, 1.59; and for the store brand, 0.59, 0.69,
0.89, 0.95, 0.99. The parameter cbl in the coupon model is the estimated marginal probability mass at the lth coupon value of brand b, where these coupon values, in the order presented in the table, are as follows: for Heinz, 0.00, 0.25, 0.30, 0.36, 0.40, 0.50, 0.90; for
Hunt's, 0.00,0.30, 0.36, 0.40, 0.50, 1.00; and for the store brand, 0.00. LL, log likelihood. aBecause of space limitations, we report the estimates of the MVN covariate model in Appendix Table 6 of the electronic companion.

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

729

Table 2 summarizes the model estimation results. The result shows that the population price sensitivity parameter 1 is estimated to be -3.4, -6.1, -6.6, and -5.4 by the SI method, MVN model, DF Model I, and DF Model II, respectively. The price sensitivity estimate from the SI method is substantially smaller. This is so because the SI method uses the accepted (i.e., observed) prices to fill in those missing price values. As the accepted price tends to be on the lower end of the underlying price distribution, this tends to underestimate the missing prices, therefore leading to an underestimation of the price sensitivity. The estimates of the price sensitivity parameter for the MVN model, DF Model I, and DF Model II are closer to each other, although the estimate from DF Model II is noticeably smaller in size.
A more serious selection bias for the coupon effect estimate can occur if it is not accounted for properly. The estimate for the population coupon effect 2 is 53.6, 2.4, 4.4, and 3.5 for the SI method, MVN model, DF Model I and DF Model II, respectively. As noted in EKS (1999), the MLE estimate under the SI method theoretically will be infinity because the ad hoc method for filling in coupon values used in the SI method creates a strong self-selection bias. Because the Bayesian approach for the SI method puts a prior with mean at zero and a finite variance that helps stabilize the model estimation, however, the posterior mass of the parameter lies on a large number instead of on infinity.13 The other three methods yield much more comparable coupon sensitivity estimates.
It is also important to note that the standard errors of the estimates in DF Model II are smaller than those in DF Model I, in some cases by about 50%. This is because DF Model II has allowed correlations in marketing mix variables, therefore reducing the variability when imputing the missing marketing mix values. As a result, the estimation efficiency increases.
Table 2 also reports the logarithm of the marginal density (LMD) of the data for four models, using the method of Raftery et al. (2007).14 The LMD from the SI method cannot be compared to those from the two
take considerably more time, particularly if the correct number of mixture components needs to be assessed.
13 Another ad hoc approach is to impute missing coupon values for a brand with the average of coupon face values used by customers who bought the brand, instead of zero. This creates selection bias in the opposite direction: because the coupon value used for a purchased brand tends to be on the high end of its distribution, one tends to overestimate the coupon values of nonpurchased brands, leading to a downward bias in coupon effect estimates. Indeed, because of the downward bias, the sign of the coupon effect estimate when using this ad hoc approach to impute missing coupon values in the data set becomes negative, which is highly implausible and inconsistent with the economic theory of the coupon effect.
14 We thank the associate editor for pointing out the availability of the new method.

DF models because it does not model the covariate--

neither can that of the MVN method because it views

covariates as data types different from the DF models.

The LMD from DF Models I and II can be compared

with each other. We find DF Model II has a substan-

tially larger marginal likelihood, with the difference

of the LMD being 796.27, indicating that DF Model II

fits data significantly better than DF Model I.

In Table 2 we also report the estimated nonpara-

metric marginal distributions of price and coupon

for each brand. In DF Model I, the distribu-

tions are calculated as the probability mass pkl =

exp kl /

Nk u=1

exp

ku

for the lth unique observed

value of the kth covariate, where kl are the param-

eters defined in Equation (5). In DF Model II, this cor-

responds to the marginal-like distribution. We use the

simulation method to calculate the marginal distribu-

tion in DF Model II. In the analysis, the observed price

and coupon values are rounded to the second decimal

place. The results change little when holding more

decimal places. We find in Table 2 that the marginal

distributions of price and coupon values are clearly

nonnormal, which shows that the MVN model is not

adequate for such data. Furthermore, we find sig-

nificant dependence structures among marketing mix

variables, as shown by the log odds parameters, most

of which have 95% credible intervals excluding zero.

Therefore, a model that does not account for such

strong correlations, such as DF Model I, is inadequate

in this aspect. In Appendix B.5 of the electronic com-

panion, we further conduct simulation studies that

demonstrate the advantages of the proposed method

in repeated samples.

5.2. Managerial Implications The above analyses demonstrate the potential bias of parameter estimates, caused by improper imputations of missing price and coupon values. Such bias can translate into substantial bias when the impact of a managerial policy of interest is assessed. As an example, Table 3 reports a simulation result that investigates the effects of a 20% cut in Hunt's price on market shares. Starting from almost identical market shares before the price cut, the percentage increases of the Hunt's market share for such a price cut are predicted to be 33%, 59%, 61%, and 53% for the SI method, MVN model, DF Model I, and DF Model II, respectively.

Table 3 The Impact of Price Cut on Market Shares

SI (%)

MVN (%) DF Model I (%) DF Model II (%)

After

After

After

After

Brand Baseline cut Baseline cut Baseline cut Baseline cut

Heinz 35.5 27.2 33.8 22.5 33.2 21.3 33.0 23.4 Hunt's 41.2 55.1 40.1 63.9 40.3 65.1 40.3 61.5 Store 23.2 17.7 26.1 13.6 26.5 13.6 26.7 15.1

730

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

Figure 1

Comparison of Optimal Prices Determined from Different Approaches

0.15

SI

MVN

DF I

DF II

0.10

Profit

0.05

0.00

­ 0.3 ­ 0.2 ­0.1

0.0

0.1

0.2

0.3

Price cut as a percentage

Notes. There are substantial differences in the optimal price suggested by the different methods. The suggested optimal price cuts are -22%, -8%, -3%, and -14% for the SI method, MVN model, DF Model I, and DF Model II, respectively.

In practice, the above results can inform the optimal price for a manufacturer. To achieve this goal, we consider the optimal price that maximizes the profit. Specifically, we consider the profit function pj = Mj Pricej - Costj , where Mj is the market share for alternative j at a specified price value Pricej , and Costj is the cost of the alternative j. We calculate the market shares and profits for Hunt's for a grid of values of potential price cuts. We assume the Hunt's cost is 70% of its original price. Figure 1 presents the profit functions for a range of price-cut values based on the estimation results of the different methods. As we can see, different methods suggest substantially different optimal prices: the suggested optimal price cuts are -22%, -8%, -3%, and -14% for the SI method, MVN model, DF Model I, and DF Model II, respectively. Compared with DF Model II, other methods lead to substantially different pricing suggestions. As shown in the figure, substantial differences also exist in the profits predicted by different methods.
5.3. Retail Store Purchase Incidence Data Set Our second application illustrates the method in a purchase incidence model using a data set in a frequent shopper database from a retail store in China. One managerial question is to study what affects purchase incidence of customers and to profile the customers based on some identifiable variables. Such analysis is often of interest for customer relationship management (CRM) and market segmentation. Our sample contains purchase records during four years for 455 frequent shoppers who made their initial purchases within the first year. The household characteristics considered important in profiling include Firstbuy (the purchase amount at the first visit), Age (age of the consumer), Marriage (marital status of the

consumer), Income (household income), Kidslt18 (the number of children at home younger than 18), and DTS (travel distance to the store). In the data set, because of item nonresponse, Kidslt18 is missing 8.7%, Age is missing 19.5%, Income is missing 7.6%, and DTS is missing 9.7% of their values. There is no missingness for Firstbuy and Marriage.
We employ a discrete-time purchase incidence model to study the interpurchase time of these consumers (Gupta 1991, Wedel et al. 1995). A distinct feature of the discrete-time survival model is its ability to model explicitly the effects of marketing mix variables on consumer behavior at the times when they did not visit the store (Seetharaman and Chintagunta 2003). Let uit denote consumer i's utility to purchase in the store at month t. We assume

uit = 0i + 1ieit + 2iPromt + mt mt + it

(10)

where eit is the elapsed time since the last purchase by the consumer; Promt is the variable capturing the monthly promotional activity of the store; mt is the dummy for calendar month, where mt  1 11 denotes months from January to November; mt is the corresponding fixed effect; and it is the iid unobserved idiosyncratic factor affecting the utility to purchase, which follows a standard normal distribution. The consumer's decision to shop or not to shop at the store, Yit, is a binary variable, and Yit = 1 if uit > 0 and Yit = 0 otherwise. We model consumer heterogeneity
i = 0i 1i 2i as in Equation (8), where Zi includes Age, Income, Marriage, Kidslt18, DTS, and Firstbuy.
As indicated above, some components in Z are missing. The complete-case analysis excludes about one-third of the customers who have a missing value in any of these variables. The method is thus inefficient, as the excluded consumers supply valuable information in other observed variables. More importantly, it may still be of interest for the manager to draw inferences about these consumers' preferences and sensitivities to manage relationships with them. In this case, excluding consumers from the analysis is managerially undesirable. In addition, the missing values of certain customers may result from systematic differences between these customers and the observed ones. Such selection effects must be accounted for in the analyses.
Here, we apply our Bayesian method to the data set, which includes all the consumers in the analysis. Note that Z contains a mixture of discrete and continuous variables, in which Marriage is dichotomous, Kidslt18 is a count variable, and the other variables are continuous. Figure 2 shows these variables have features of nonnormality: skewness, multimodality, or discreteness. Kidslt18 is a count variable naturally modeled as a Poisson outcome--or perhaps

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

Figure 2

Histograms of Variables in the Retail Store Data Set Using the Observed Data 0.04

0.004

0.03

0.02 0.002
0.01

0.0 0

200 400 600 800 1,000 1,200 1,400 Firstbuy

0.0
20 30 40 50 60 70 80 Age

731

0.08 0.06 0.04 0.02
0.0 0

5

10

15

20

25

Income

1.0

0.8

0.6

0.4

0.2

0.0

0

1

2

3

4

5

Kidslt18

0.08

0.04

0.0 0
8

5

10

15

20

25

DTS

6

4

2

0

0.0

0.2

0.4

0.6

0.8

1.0

Marriage

more appropriately, a zero-inflated Poisson outcome. It is difficult to specify a joint parametric model to account simultaneously for all the features in these variables. The effect of covariate model misspecifications could be complicated because of the intercorrelations among covariates. Our method augments the above purchase incidence model with a semiparametric odds ratio covariate model for Z, as specified in Equations (4) and (5). In the approach, each covariate's marginal-like distribution is modeled nonparametrically, thereby automatically allowing for all the aforementioned data features. Thus, our approach reduces data analysts' modeling efforts while helping guard against model misspecifications. The dependence among the variables in Z is modeled by the parametric odds ratio functions.
Model estimation is performed through an MCMC algorithm that uses the approach of Albert and Chib

(1993) to update parameters in the purchase incidence model and the HMC sampler to update parameters in the covariate model. The imputation of missing covariate values accounts for any potentially important dependence between the covariates and the purchase incidence outcomes. For the purpose of comparison, we conduct the complete-case analysis and the analysis based on an MVN covariate model. It is important to note that the MVN models all the covariates, including the two fully observed variables, Firstbuy and Marriage, whereas the DF model conditions on these two variables and models only the variables subject to missingness. All analyses run the MCMC sampler for 12,000 iterations, and the first 2,000 iterations are discarded as the burn-in period.15
15 Because of the amenability of the outcome regression model to Bayesian analysis and the high efficiency of the HMC sampler,

732

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

Table 4 Estimation Result of a Purchase Incidence Model in the Retail Store Data Set

Parameter

Complete-case

MVN

DF

Intercept Firstbuy Marriage Age Income Kids DTS
Prom Prom  FirstBuy Prom  Marriage Prom  Age Prom  Income Prom  Kids Prom  DTS
eit eit  FirstBuy eit  Marriage eit  Age eit  Income eit  Kids eit  DTS
11
22
33
12
13
23
Subjects/Obs.

-0 44 (0.11)+ 0 02 (0.04) 0 065 (0.11) 0 035 (0.05) 0 011 (0.043)
-0 073 (0.042) -0 071 (0.05)

4 11 0 37 -0 02 -0 15 -0 74 0 14 -0 83

(1.12)+ (0.30) (0.90) (0.39) (0.36)+ (0.36) (0.38)+

0 043 (0.027) -0 002 (0.01) -0 02 (0.03)
0 0069 (0.013) 0 004 (0.012) 0 01 (0.012) -0 004 (0.014)

0 25 (0.03)+ 6 38 (2.85)+ 0 029 (0.0025)+ -0 22 (0.21) -0 012 (0.006)+ -0 010 (0.029)

292/14,357

-0 52 (0.080)+ 0 016 (0.033) 0 11 (0.083) 0 053 (0.038) 0 023 (0.036)
-0 022 (0.035) -0 095 (0.034)+

3 57 0 31 0 30 -0 21 -0 47 0 05 -0 49

(0.77)+ (0.26) (0.65) (0.27) (0.27) (0.27) (0.27)

0 028 (0.017) 0 001 (0.008) -0 005 (0.02) 0 004 (0.008) 0 003 (0.008) 0 003 (0.008) 0 000 (0.008)

0 28 (0.03)+ 6 06 (2.26)+ 0 020 (0.0014)+ -0 20 (0.16) -0 013 (0.004)+ -0 0073 (0.020)

455/22,340

-0 50 (0.079)+ 0 012 (0.033) 0 09 (0.080) 0 086 (0.044) 0 055 (0.039)
-0 017 (0.038) -0 11 (0.035)+

3 36 0 35 0 49 -0 35 -0 69 0 01 -0 59

(0.78)+ (0.26) (0.63) (0.36) (0.29)+ (0.31) (0.27)+

0 027 (0.016) 0 001 (0.008) -0 005 (0.02) 0 002 (0.008) 0 002 (0.008) 0 003 (0.008) 0 001 (0.008)

0 27 (0.03)+ 5 49 (2.08)+ 0 019 (0.0014)+ -0 17 (0.15) -0 013 (0.004)+ -0 0067 (0.019)

455/22,340

Note. Presented are the posterior means (posterior SD) of each parameter. +95% credible interval excludes zero.

All the observed decimal places of the covariate values are kept in the analysis to form unique covariate values. Table 4 presents estimation results for the parameters in the purchase incidence model, which are of primary interest in the study. The covariates in Z are standardized before entering the model. The parameter estimates for Intercept, Prom, and eit therefore represent their effects for an average consumer in the population. The comparison shows that the proposed method improves the estimation efficiency compared with the complete-case analysis by using all the available information. The posterior standard deviations (SDs) for all parameters are substantially smaller than those from the complete-case analysis-- in some incidences, by a half. Also, some parameter estimates have substantial differences. For example, the estimated effect of DT S in our proposed model is larger than that in the complete-case analysis and is found to become statistically significant. The estimation results using the MVN and DF model are more similar to each other. Noticeable differences in some
a relatively small number of iterations is required for convergence. Geweke's diagnostic statistic confirms the quick convergence of the MCMC sampling.

model estimates still remain, however. For example, the 95% credible interval for Prom  DTS is found to exclude zero under the DF models but to include zero under the MVN model. We further conduct simulation studies in Appendix B.6 of the electronic companion that demonstrate the advantages of the DF method in repeated samples for purchase incidence models relative to the other two methods.
We now turn to the estimation of customer-level estimates when some variables are missing from a consumer's profile. In individually targeted marketing, it is often useful to make inferences on the consumer-specific parameters and then adopt differential marketing strategies based on the estimates of these parameters. A Bayesian approach is well suited for such individual-level analysis. Allenby and Rossi (1999) consider such estimation when covariates are fully observed. For our case in which covariates are subject to missingness, the posterior distribution of j in a fully Bayesian approach is given by
j Y Zobs X



i

Zmis Y Zobs X d -j d d d d dZmis

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

733

Figure 3 2.8

Comparison of Posterior SD for 2i on the Subset of Consumers with the Complete Data on Variables in Zi

Posterior SDs using all cases

2.6

2.4

2.2

2.0

2.0

2.2

2.4

2.6

2.8

Posterior SDs using complete cases

Notes. The X axis gives the posterior SDs when the complete-case analysis is used. The Y axis gives the posterior SDs from our proposed Bayesian DF model analysis, where all the consumers are used to fit the model.

where -j denotes all the consumer-specific parameters except for the jth consumer. One benefit of the Bayesian approach is that the entire posterior distribution for j can be obtained as a by-product of the MCMC algorithm. It is important to note that our fully Bayesian approach also automatically accounts for the uncertainty in the imputation of missing covariates.
Figure 3 plots the posterior SDs of 2i obtained from the complete-case analysis versus those obtained from our proposed method. It shows that the estimates using the proposed method have smaller SDs because the proposed method uses all the consumers in the data, whereas the complete-case analysis discards information contained in those incomplete cases. Such reduction in the estimation variability of consumer-specific parameters can be valuable, as these individual-level parameters tend to be less accurately estimated. What are not shown in the figure are those incomplete cases whose individual-level estimates are not available in the complete-case analysis

but are available as a by-product of the fitting of our proposed model.
5.4. Managerial Implications In this subsection, we investigate the managerial implications of the above estimation results. Specifically, we investigate the differences of targeting and profiling consumers based on observed characteristics of consumers using the above estimation results. Such profiling on actionable consumer characteristics can be managerially very useful to take findings from one store to another similar store (e.g., Singh et al. 2006). Similar to the approach of Singh et al. (2006), we calculate the marginal effects of observed household characteristics. More specifically, we calculate the effect of a 30% price promotion on the purchase incidence probability for a population with covariate vector Z = z¯, zj 5%, zj 95%. In the notation, z¯ is the sample average of the covariate vector Z; zj 5% zj 95% is the same as z¯, except that the jth covariate is set to be the 5th (95th) percentile of its distribution. Based on the model estimates from different methods, we simulate populations of consumers and calculate the average purchase incidence probabilities before and after the promotion when the variables of interest are DTS and Age.
Table 5 presents the simulation results. It shows that the estimates of the changes in purchase probabilities before and after the promotion vary under different methods. The complete-case (CC) analysis tends to overestimate considerably the promotional effects in this data set. For example, at Age95%, the overestimation, compared with DF, is about 35%. Thus, the complete-case analysis could lead a manager to misjudge the effect of promotion on purchase incidence probability and, in turn, the profitability of the potential promotion activity. For example, using the complete-case analysis, the manager might conclude that the increase in the purchase incidence probability outweighs the loss of money values because of promotion and thus may conclude that the promotion is profitable. An analysis using DF may show, however, that the increase in the purchase incidence is not large

Table 5 Moderating Effect of Covariates on the Promotional Effects

CC

MVN

DF

Z

Before After CC Before After MVN

DTS 5% 0.39 0.85 0.46 0.38 0.76 0.38

DTS Z

0.35 0.72 0.37 0.32 0.66 0.34

DTS 95% 0.31 0.57 0.26 0.29 0.54 0.25

Age 5% 0.32 0.73 0.40 0.29 0.66 0.37

Age Z

0.35 0.72 0.37 0.32 0.66 0.34

Age 95% 0.37 0.72 0.35 0.35 0.65 0.30

MVN - CC Before After

DF

CC

-17

0.39 0.77 0.38

-8

0.33 0.65 0.32

-4

0.28 0.50 0.22

-8

0.28 0.66 0.38

-10

0.33 0.65 0.32

-16

0.38 0.64 0.26

DF - CC
CC
-17 -14 -14 -5 -14 -26

734

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

enough to offset the loss because of promotion, leading the manager to conclude that the promotion is not profitable. The MVN and DF models for covariates lead to more comparable results. In Table 5, we report the percentage change of the promotional effect on purchase incidence probabilities from that predicted using the complete-case analysis for the MVN and DF models, respectively. These numbers indicate that the MVN model also overestimates the promotional effects at DT S95% and Age95%.
6. Conclusion
With the increasing popularity of database marketing, CRM, and individualized marketing, companies face a greater need to provide customized marketing solutions based on consistent and precise elasticity estimates on marketing mix variables. On the other hand, the real applications above indicate that the covariates in a marketing regression model often are subject to missingness. The convenient complete-case analysis can lead to strong self-selection bias and to substantial loss of estimation efficiency. More advanced methods for overcoming these drawbacks commonly assume parametric models for covariate distributions. One limitation of the parametric modeling approach is its nonrobustness; when the parametric covariate model is misspecified, a substantial bias can arise in the estimation of marketing outcome models. The issue is further exacerbated by the difficulty in assessing the validity of distributional assumptions in modeling covariates with missing values. Furthermore, the extra computational and modeling workload can be high, which have hindered the routine use of these methods for dealing with high-dimensional missing covariate problems. Therefore, how to extract useful information from the available data in a robust, efficient, and simple manner is an issue pertinent to current marketing research activities.
To this end, we have developed a distribution-free Bayesian method to handle missing covariate problems. Our development of an efficient MCMC algorithm overcomes an important limitation of Chen (2004) and enables one to handle high-dimensional missing covariate problems and/or complex models commonly seen in marketing applications. Some other key benefits of the method to marketing researchers are (1) its distribution-free feature, which enables robust modeling of covariate distributions and minimizes the impact of distributional assumptions in covariate modeling; (2) its flexibility, which allows for complex dependence among covariates and to incorporate any useful information for covariate distribution; and (3) its simplicity in modeling and computation, which substantially reduces the workload associated with careful modeling of covariates compared with alternative parametric approaches.

The applications of the proposed method yield some interesting empirical findings. In the ketchup example, we confirm that because they do not account for the dependence between choice outcomes and missing marketing mix variables, conventional ad hoc approaches to imputing missing marketing mix values can create strong selection bias in the estimation of brand-choice models. The joint modeling of the choice outcomes and missing covariates provides a principled approach to correcting the bias. Our analysis shows that to remove the bias, it is important to properly model distributional features of marketing mix variables and to account for the dependence among them. Ignoring either feature can lead to sizable bias in estimation and, consequently, to suboptimal managerial decisions. As demonstrated in the empirical application and simulation studies, the proposed method improves model estimates of consumer preferences and sensitivities to marketing mix variables when compared with prior approaches to the problem. The retail store example shows that the interrelated covariates often exhibit various features such as discreteness, skewness, multimodality, semicontinuity, and zero-inflation. The proposed method accounts automatically for these important data features and helps guard against model misspecifications in a parametric covariate modeling approach. Our Bayesian approach also enables straightforward estimation and inference of consumer-level parameters if some components of the consumer's profile are missing. This approach ensures that no customer is left behind in the analyses and in the subsequent managerial inferences.
Several issues and opportunities for future research remain. First, in our covariate model, although the univariate marginal-like distributions are modeled nonparametrically, the odds ratio functions are modeled parametrically. As noted in Chen (2004), the assumption can be wrong only for the higher-order terms of dependence structure. It is therefore reasonable to believe that the potential effect is relatively minor when the lower-order terms capture the majority of the associations among covariates. To control for such potential misspecification more thoroughly, however, it would be valuable in future research to develop a formal procedure for choosing proper terms in the odds ratio functions.
Second, our analysis assumes that the covariates are missing at random. Although this is a standard assumption in missing data analysis and is either known to hold or considered reasonable in many marketing applications, it could be tenuous in some marketing applications. When covariates are missing not at random, all methods based on the MAR assumption, including the proposed method in this paper, are potentially invalid. Extending the method to account

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

735

for such potentially nonignorable missing data would be very valuable.
In this paper we have investigated the use of the method for a wide range of types of commonly used marketing models. The proposed method is not limited to these marketing models, however. An essentially infinite number of parametric marketing models exists, and new ones are proposed constantly. In many of these models, a Bayesian approach is a preferred method for estimation and inference. It would be interesting to combine the proposed method with these other types of marketing regression models to make better use of available data sets.
7. Electronic Companion
An electronic companion to this paper is available as part of the online version that can be found at http:// mktsci.pubs.informs.org/.
Acknowledgments The authors thank the editors, area editor, and two anonymous referees whose constructive comments helped to substantially improve the earlier versions of this paper. They thank Ulf Böckenholt, Eric Bradlow, Yuxin Chen, Hua Yun Chen, Preyas Desai, Manuel Hermosilla, and Peter Rossi for their very helpful comments on the earlier versions of the paper. The second author received financial support from National Institutes of Health Grant UL1RR029879.
References
Albert, J. H., S. Chib. 1993. Bayesian analysis of binary and polychotomous response data. J. Amer. Statist. Assoc. 88(422) 669­679.
Allenby, G. M., P. J. Lenk. 1994. Modeling household purchase behavior with logistic normal regression. J. Amer. Statist. Assoc. 89(428) 1218­1231.
Allenby, G. M., P. E. Rossi. 1999. Marketing models of consumer heterogeneity. J. Econometrics 89(1­2) 57­78.
Blattberg, R. C., B.-D. Kim, S. A. Neslin. 2008. Database Marketing: Analyzing and Managing Customers. Springer, New York.
Bradlow, E. T., A. M. Zaslavsky. 1999. A hierarchical latent variable model for ordinal data from a customer satisfaction survey with "no answer" responses. J. Amer. Statist. Assoc. 94(445) 43­52.
Bradlow, E. T., Y. Hu, T.-H. Ho. 2004. A learning-based model for imputing missing levels in partial conjoint profiles. J. Marketing Res. 41(4) 369­381.
Chen, H. Y. 2004. Nonparametric and semiparametric models for missing covariates in parametric regression. J. Amer. Statist. Assoc. 99(468) 1176­1189.
Chiang, J. 1995. Competing coupon promotions and category sales. Marketing Sci. 14(1) 105­122.
Chintagunta, P. K., D. C. Jain, N. J. Vilcassim. 1991. Investigating heterogeneity in brand preferences in logit models for panel data. J. Marketing Res. 28(4) 417­428.
Daniels, M. J., J. W. Hogan. 2008. Missing Data in Longitudinal Studies: Strategies for Bayesian Modeling and Sensitivity Analysis. Chapman & Hall, London.
Duane, S., A. D. Kennedy, B. J. Pendleton, D. Roweth. 1987. Hybrid Monte Carlo. Phys. Lett. B 195(2) 216­222.

Erdem, T., M. P. Keane, B. Sun. 1999. Missing price and coupon availability data in scanner panels: Correcting for the selfselection bias in choice model parameters. J. Econometrics 89(1­2) 177­196.
Feit, E. M., M. A. Beltramo, F. M. Feinberg. 2010. Reality check: Combining choice experiments with market data to estimate the importance of product attributes. Management Sci. 56(5) 785­800.
Geweke, J. 1992. Evaluating the accuracy of sampling-based approaches to calculating posterior moments. J. M. Bernardo, J. O. Berger, A. P. Dawid, A. F. M. Smith, eds. Bayesian Statistics 4: Proceedings of the Fourth Valencia International Meeting. Clarendon Press, Oxford, UK, 169­194.
Gilula, Z., R. E. McCulloch, P. E. Rossi. 2006. A direct approach to data fusion. J. Marketing Res. 43(1) 73­83.
Gönül, F., K. Srinivasan. 1993. Modeling multiple sources of heterogeneity in multinomial logit models: Methodological and managerial issues. Marketing Sci. 12(3) 213­229.
Guadagni, P. M., J. D. C. Little. 1983. A logit model of brand choice calibrated on scanner data. Marketing Sci. 2(3) 203­238.
Gupta, S. 1991. Stochastic models of interpurchase time with timedependent covariates. J. Marketing Res. 28(1) 1­15.
Ibrahim, J. G., M.-H. Chen, S. R. Lipsitz, A. H. Herring. 2005. Missing-data methods for generalized linear models: A comparative review. J. Amer. Statist. Assoc. 100(469) 332­346.
Kamakura, W. A., G. J. Russell. 1989. A probabilistic choice model for market segmentation and elasticity structure. J. Marketing Res. 26(4) 379­390.
Kamakura, W. A., M. Wedel. 1997. Statistical data-fusion for crosstabulation. J. Marketing Res. 34(4) 485­498.
Kamakura, W. A., M. Wedel. 2000. Factor analysis and missing data. J. Marketing Res. 37(4) 490­498.
Kang, J. D. Y., J. L. Schafer. 2007. Demystifying double robustness: A comparison of alternative strategies for estimating population mean from incomplete data (with discussion). Statist. Sci. 22(4) 523­539.
Khan, R., M. Lewis, V. Singh. 2009. Dynamic customer management and the value of one-to-one marketing. Marketing Sci. 28(6) 1063­1079.
Little, R. J. A. 1992. Regression with missing X's: A review. J. Amer. Statist. Assoc. 87(420) 1127­1137.
Little, R. J. A., D. B. Rubin. 2002. Statistical Analysis with Missing Data. John Wiley & Sons, New York.
Meier, P., T. Karrison, R. Chappell, H. Xie. 2004. The price of Kaplan­Meier. J. Amer. Statist. Assoc. 99(467) 890­896.
Musalem, A., E. T. Bradlow, J. S. Raju. 2008. Who's got the coupon? Estimating consumer preferences and coupon usage from aggregate information. J. Marketing Res. 45(6) 715­730.
Qian, Y. 2007. Do national patent laws stimulate domestic innovation in a global patenting environment? A cross-country analysis of pharmaceutical patent protection, 1978­2002. Rev. Econom. Statist. 89(3) 436­453.
Qian, Y., H. Xie. 2010. Measuring the impact of nonignorability in panel data with non-monotone nonresponse. J. Appl. Econometrics, ePub ahead of print February 1, http://onlinelibrary .wiley.com/doi/10.1002/jae.1157/abstract.
Raftery, A. E., M. A. Newton, J. M. Satagopan, P. N. Krivitsky. 2007. Estimating the integrated likelihood via posterior simulation using the harmonic mean identity. Bayesian Statist. 8 1­45.
Rossi, P. E., G. M. Allenby. 1993. A Bayesian approach to estimating household parameters. J. Marketing Res. 30(2) 171­182.
Rossi, P. E., G. M. Allenby, R. McCulloch. 2005. Bayesian Statistics and Marketing. John Wiley & Sons, London.
Rubin, D. B. 1976. Inference and missing data (with discussion). Biometrika 63(3) 581­592.

736

Qian and Xie: No Customer Left Behind Marketing Science 30(4), pp. 717­736, © 2011 INFORMS

Schafer, J. L. 1997. Analysis of Incomplete Multivariate Data. Chapman & Hall, London.
Schafer, J. L., J. W. Graham. 2002. Missing data: Our view of the state of the art. Psych. Methods 7(2) 147­177.
Seetharaman, P. B., P. K. Chintagunta. 2003. The proportional hazards model for purchase timing: A comparison of alternative specifications. J. Bus. Econom. Statist. 21(3) 368­382.
Singh, V. P., K. T. Hansen, R. C. Blattberg. 2006. Market entry and consumer behavior: An investigation of a Wal-Mart supercenter. Marketing Sci. 25(5) 457­476.
Tierney, L. 1994. Markov chains for exploring posterior distributions. Ann. Statist. 22(4) 1701­1728.

Tsiatis, A. A. 2006. Semiparametric Theory and Missing Data. Springer, New York.
Wedel, M., W. A. Kamakura, W. S. Desarbo, F. T. Hofstede. 1995. Implications for asymmetry, nonproportionality, and heterogeneity in brand switching from piece-wise exponential mixture hazard models. J. Marketing Res. 32(4) 457­462.
Yang, S., Y. Zhao, R. Dhar. 2010. Modeling the underreporting bias in panel survey data. Marketing Sci. 29(3) 525­539.
Ying, Y., F. Feinberg, M. Wedel. 2006. Leveraging missing ratings to improve online recommendation systems. J. Marketing Res. 43(3) 355­365.

