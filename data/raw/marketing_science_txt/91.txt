http://pubsonline.informs.org/journal/mksc/

MARKETING SCIENCE
Vol. 38, No. 4, July­August 2019, pp. 690­710 ISSN 0732-2399 (print), ISSN 1526-548X (online)

Inference for Product Competition and Separable Demand

Adam N. Smith,a Peter E. Rossi,b Greg M. Allenbyc
a UCL School of Management, University College London, London E14 5AA, United Kingdom; b Anderson School of Management, University of California, Los Angeles, Los Angeles, California 90095; c Fisher College of Business, Ohio State University, Columbus, Ohio 43210 Contact: a.smith@ucl.ac.uk, http://orcid.org/0000-0003-1959-7962 (ANS); perossichi@gmail.com (PER); allenby.1@osu.edu, http://orcid.org/0000-0001-9759-0067 (GMA)

Received: October 12, 2017 Revised: November 29, 2018 Accepted: January 27, 2019 Published Online in Articles in Advance: July 8, 2019
https://doi.org/10.1287/mksc.2019.1159
Copyright: © 2019 INFORMS

Abstract. This paper presents a methodology for identifying groups of products that exhibit similar patterns in demand and responsiveness to changes in price using store-level sales data. We use the concept of economic separability as the basis for establishing similarity between products and build a weakly separable model of aggregate demand. A common issue with separable demand models is that the partition of products into separable groups must be known a priori, which severely shrinks the set of admissible substitution patterns. We develop a methodology that allows the partition to be an estimated model parameter. In particular, we specify a log-linear demand system in which weak separability induces equality restrictions on a subset of cross-price elasticity parameters. An advantage of our approach is that we are able to find groups of separable products rather than just test whether a given set of groups is separable. Our method is applied to two aggregate, store-level data sets. We find evidence that the separable structure of demand can be inconsistent with category labels, which has implications for optimal category marketing strategies.

History: Yuxin Chen served as the senior editor and Michel Wedel served as associate editor for this article.
Supplemental Material: Data files and the online appendix are available at https://doi.org/10.1287/ mksc.2019.1159.

Keywords: price elasticities · category demand · dimension reduction · random partition models · Bayesian inference

1. Introduction
This paper presents a methodology for measuring the dimension and boundaries of consumer demand using store-level scanner data. We formally define the boundaries of demand using the concept of economic separability: two product groups are said to be weakly separable if consumer preferences within each group are independent of consumption levels in the other group (Deaton and Muellbauer 1980). For example, the demand for cereal would be weakly separable from the demand for milk only if consumer preferences between any two cereals (e.g., Cheerios and Frosted Flakes) do not depend on the type or amount of milk consumed. Although separability assumptions remain widely used in empirical work, there is relatively little discussion of their practical viability (Chintagunta and Nair 2011). In multicategory demand settings, for example, it is commonly assumed that preferences are separable across categories, where the definition of categories is fixed according to product labels in the data. However, we believe that deciding on the separable structure of demand is an empirical question, especially when the goal is to measure substitution patterns within wide assortments or across multiple categories.

Our approach is to let the partition of products into separable groups be a parameter that can be estimated from the data. We specify an aggregate log-linear demand system in which the assumption of weakly separable preferences induces equality restrictions on a subset of cross-price elasticity parameters. Full inference in this model is nontrivial, as it requires quantifying the uncertainty in a partition, which is a discrete object defined over a high-dimensional and nonEuclidean space. To overcome this challenge, we take a Bayesian approach to inference and rely on recent advances in the literature on models for random partitions. Specifically, we use the location-scale partition model of Smith and Allenby (2019) to specify a coherent prior and efficiently navigate the posterior of both the partition and the lower-dimensional set of price elasticities. The novelty is that we are able to discover groups of separable products rather than just test whether a given set of groups is separable.
The proposed demand model is applied to weekly, store-level retail scanner data in two product categories: (i) jams, jellies, and spreads and (ii) juice drinks. The jams, jellies, and spreads category contains two complementary subcategories--jams/jellies and

690

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

691

spreads--which creates a strong prior on how to categorize products; that is, one may reasonably expect jams/jellies and spreads to constitute separable demand groups. This gives us the ability to examine the face validity of the partitions found by our method. In contrast, the juice category is comprised of wide assortments with many product lines spanning multiple flavor subcategories. The amount and type of variety make it harder to define the nature of competition, and thus an appropriate product categorization, a priori.
Throughout both analyses, we find that partitions with high posterior probability can be markedly different from predefined category labels in both their granularity and composition. In the juice category, for example, we find evidence that demand is not separable by flavor categories (e.g., apple, orange). We then show how assuming the wrong structure of demand can lead to a misunderstanding of competition and biases in category promotion effects. An additional benefit of our methodology is that we can integrate over the uncertainty in the partition parameter, which leads to improved estimates of cross-price effects and demand forecasts.
The idea of using economic separability to add structure to demand systems has a long history in marketing and economics. For example, much of the early empirical work in applied microeconomics imposes separability restrictions to facilitate estimation of demand models with highly aggregated goods, many parameters, and limited data (e.g., Barten 1964, Byron 1970, Jorgenson and Lau 1975). Although this additional structure provides gains in efficiency, it can also limit the set of admissible substitution patterns. Pudney (1981) suggests that empirical tests of separability are often rejected because there is no discussion of how to choose the grouping pattern imposed on the model. Our approach is thus similar in spirit, as we use the data to find more suitable demand groups.
The availability of modern scanner data has since allowed for more disaggregate demand analysis. Researchers now have access to UPC-level price and movement data across many product categories, but for tractability reasons usually work with data from a single product category or subcategory. Regardless of the scope of the data used, separability assumptions remain ubiquitous. For example, a common assumption in empirical work is that utility for the inside goods is separable from the utility of the outside good (Chintagunta and Nair 2011). In multicategory demand models, it is also often assumed that utility is separable across predefined categories (e.g., Mehta 2007, Thomassen et al. 2017). However, and as will be seen in the following section, the viability of these assumptions crucially depends on the researcher's definition of categories. By allowing the composition of separable groups to be estimated from the data, we can

offer insights into the boundaries of competition and if/where cross-category assumptions of separability appear unreasonable.1
Separability has also been shown to be useful for measuring price elasticities. For example, Montgomery and Rossi (1999) improved elasticity estimates in a log-linear demand system by shrinking the parameters toward values predicted by additive separability. The main difference between their approach and ours is the type of separability imposed on the model. In particular, they assumed additive separability, which requires all pairs of goods to be strong substitutes (Deaton and Muellbauer 1980). This is sensible given their empirical focus on the demand for orange juice alone. We instead rely on weak separability which imposes a more flexible restriction across product groups and does not rule out complementarity a priori. This is motivated by our interest in modeling demand across wide assortments (e.g., the juice category), where products will be related but not necessarily substitutable.
More recently, there have been efforts to visualize and predict demand patterns for high-dimensional choice sets. Examples include those by France and Ghose (2016) and Ringel and Skiera (2016), who provide methods for visualizing competition for more than 1,000 products using consumer purchase and online search data, respectively. The output from both analyses is some form of competitive map rather than estimates of marketing responsiveness parameters. Jacobs et al. (2016) also study choice among large assortments, but focus on predicting future purchases rather than identifying competitive effects. They leverage models in text analysis to improve large-scale customer purchase predictions. One fundamental difference in our work is the treatment of demand. Whereas these methods abstract away from formal demand models, we embed the goal of identifying separable product groups within a traditional demand analysis where we estimate both the partition of goods and associated demand parameters. However, this comes at the cost of estimating a potentially large set of price effects, so the scalability of our model will depend on the type and amount of dimension reduction afforded by separability.
Bajari et al. (2015) provide an alternative dimension reduction solution for large-scale linear and logit demand models. In particular, they employ machine learning methods such as stepwise regression, support vector machines, and the lasso to reduce the number of relevant model covariates. However, many of these off-the-shelf methods provide a form of dimension reduction that lacks grounding in economic theory. For example, regularized regression estimators like the lasso can only accommodate shrinkage toward fixed constants that are usually set to zero. The benefits may thus be limited if the shrinkage points are

692

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

misspecified. For instance, shrinkage to zero would be undesirable when applied to the price effect parameters of any Marshallian demand system, as zero substitution effects need not imply zero price effects. In this sense, separability offers a more flexible, theorydriven form of dimension reduction. Subsets of the full cross-price elasticity matrix are constrained to live in a lower-dimensional (and potentially nonzero) space of group-level parameters. This provides both adaptive and differential shrinkage, as elasticities are shrunk toward values consistent with theory, learned from the data, and that can change across product groups.
The remainder of this paper is organized as follows. Section 2 develops a separable aggregate demand model. Section 3 discusses probability models for random partitions. Section 4 outlines our approach for posterior inference. Section 5 presents the results of the two empirical studies. Section 6 explores the implications of separable demand on product competition, brand positioning, and price promotions effects. Section 7 concludes.
2. Separable Preferences and Aggregate Demand
The theory of economic separability dates back to Leontief (1947), Gorman (1959), Sono (1961), and Goldman and Uzawa (1964), who provided a framework for analyzing large or complicated demand systems under the assumption that consumer preferences conform to a lower-dimensional structure. In particular, separability requires that the set of products under study can be partitioned so that consumer preferences within each product group can be described independently of consumption levels in other groups. This type of economic dimension reduction is attractive for both behavioral and econometric reasons. For example, consumers may naturally limit the amount or type of information they use when choosing among a high-dimensional set of goods. Separability also limits the effects of price changes on the demand for products across groups, and therefore offers efficiency gains to the researcher wanting to estimate a demand system with many cross-price elasticities and limited data.
The problem is that the gains in efficiency or parsimony come at the cost of model flexibility. The assumptions of separable preferences impose strong restrictions on demand elasticities when the partition is fixed, which means that the partition of products fully determines the nature of competition (Deaton and Muellbauer 1980). Our approach is to let the partition be an estimated model parameter, which relaxes the assumption that the structure of demand is known. Rather, we assume only that some true structure exists and then use the data to learn about that structure.

2.1. Economic Separability
Let n (g1, . . . , gn) denote a partition of n items into K  n groups, where gi is an item-group indicator variable. Preferences are said to be weakly separable with respect to the partition n if the utility of the consumption vector q (q1, . . . , qn) can be written as

u(q) V(v1(Q1), . . . , vK(QK)).

(1)

Here, Qk is the consumption set for products assigned to group k, vk(·) is a subutility function, and V(·) is an aggregation function defined over K variables. To better understand the behavioral implications of separability, we discuss two additional (and ultimately equivalent) definitions.
The first requires the marginal rate of substitution between any two products i and j in group k to be independent of consumption levels for a third product r in group :

ui(q)/uj(q) qr

0 for all gi

gj

k, gr

,k

. (2)

Here, ui(q) denotes the marginal utility of good i. The consequence of (2) is that the consumption levels in group cannot affect the consumer's preference ordering for products in group k. Notice that this restriction does not say that the demand for products in group k is independent from the demand of products in group . Rather, separability can hold for product groups who are substitutes or complements in aggregate. For example, consider two complementary product groups: pasta and pasta sauce. The demand for pasta is weakly separable from the demand for sauce only if the consumer's preferences for two brands of pasta sauce (e.g., Prego and the store brand) are unaffected by the amount or type of pasta purchased. In the context of differentiated product markets, one feature that could "break" separability is the presence of quality tiers. For example, if consumers prefer pairing certain types of pasta only with high-quality brands of sauce, then preferences between sauce varieties will depend on the type of pasta purchased, violating (2).
The last definition is based on restrictions to the compensated (Slutsky) price effects:

Sij

k

(q)

qi m

qj m

for all

gi

k, gj

,k

. (3)

Here, Sij is a compensated price effect (i.e., the deriva-
tive of the Hicksian demand function for good i with respect to the price of good j), m is a monetary budget,2
and k (q) is a function summarizing the relationship between groups k and . In our empirical applica-
tions, we assume a constant function k (q) k . Equation (3) implies that the effect of changing the price of
product i in group k on the demand for product j in

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

693

group must conform to the group-level price effect, except as modified by budgetary effects. Again, if the demand for pasta is weakly separable from the demand for pasta sauce, then a decrease in the price of one sauce variety should have the same effect on the demand for all pasta varieties, barring budgetary effects. Goldman and Uzawa (1964) show that (1)­(3) are all necessary and sufficient for each other, so that weakly separable preferences can be represented by any of the three.
A more restrictive form of separability is strong (or block-additive) separability, which assumes that the aggregation function V(·) in (1) is additive. There are two important empirical consequences of strong separability. The first is that the groups themselves cannot have special meaning, as the additivity of V(·) always permits the creation of new groups by arbitrarily combining other groups (Deaton and Muellbauer 1980). Second, strong separability not only requires all crossgroup price effects conform to (3), but also requires that k (q) (q) for all groups k and . However, like weak separability, strong separability still leaves the set of within-group elasticities unrestricted. In this sense, the partition parameter n is still meaningful in that it dictates which price effects are restricted.
A special case of strong separability is when each product constitutes its own group. In this case, preferences are said to be additive3 and all pairs of goods must be strong substitutes. For both strong and additive separability, the additional restriction of constant group-level price effects is very limiting a priori and will be suitable only for narrowly defined product categories. Because our goal is to model demand for wide assortments with potentially ambiguous economic relationships, the flexibility of weak separability is preferred. Going forward, we will use the terms separability and weak separability interchangeably.
2.2. A Weakly Separable Log-Linear Demand Model
There are generally two strategies for constructing separable demand models. The first approach is to construct a separable utility function and then solve for the associated demand functions. However, the construction of weakly separable utility functions is challenging in practice. For instance, using the functional form restriction in (1) requires the researcher to specify sufficiently flexible subutility and aggregating functions vk(·) and V(·) that also yield tractable demand equations. This is infeasible when taking the primal approach, given that direct utility functions must be additively separable to yield a tractable demand system (Mehta 2015). An alternative is to work with indirect utilities and impose the restriction in (2) on the marginal rates of substitution of a flexible functional form. However, Blackorby et al. (1977) show that many flexible indirect utility functions such as the translog

are "separability inflexible" in that, once restricted, they are no longer flexible enough to be regarded as approximations to any arbitrary weakly separable utility function.
The second approach, which we follow in this paper, is to impose separability restrictions on the demand function directly. Specifically, we impose the restriction in (3) on the price elasticity parameters of a log-linear demand system:

n

log qit

ij log pjt + i log mt + ziti + it,

j1

(4)

t (1t, . . . , nt)  N(0, ).

Here, qit is the movement for product i at time t, and pjt is the price of product j at time t. The variable mt represents total expenditure at time t and can be viewed as an aggregated sample analogue to the individuallevel monetary budget term discussed in the previous section. It is important to include expenditure in the demand equation because (3) expresses price effects as a function of expenditure effects. We also include a d-dimensional vector of product-specific controls zit such as seasonal effects or promotional activity. The demand equations are tied together contemporaneously through the n × n error covariance matrix .
The log-linear functional form is attractive because it is linear in price and expenditure elasticities and admits flexible substitution patterns. This has led to its widespread use for elasticity-based pricing in both industry and academia (Montgomery 1997, Hitsch et al. 2017, DellaVigna and Gentzkow 2019). For our purposes, this functional form also makes it straightforward to project ij onto the lower-dimensional space of separability parameters defined in (3). In fact, we later show that this restricted model retains its linearity in the lower-dimensional set of parameters, which enables efficient posterior computation.
Because separability is fundamentally a restriction on consumer preferences, it is also worth discussing the extent to which the demand equation in (4) is consistent with utility theory. In general, a demand system is said to be integrable (i.e., it can be rationalized by a model of constrained utility maximization) if it satisfies four properties: adding up, homogeneity, Slutsky symmetry, and negativity (Deaton and Muellbauer 1980). In a log-linear demand system, adding up is the most straightforward to impose a priori, as it requires all expenditure elasticities to equal one. The other three conditions place restrictions on functions of model parameters.4 However, requiring these conditions to hold everywhere yields a model in which a subset of own-price elasticities must equal negative one and all cross-price elasticities equal either zero or 1 + ii (LaFrance 1986). Because this renders the log-linear model practically useless for measuring

694

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

substitution patterns, we instead treat (4) as a flexible first-order approximation to a valid Marshallian demand system. In our empirical applications, we impose the adding-up restriction and then use the posterior distribution of cross-price effects to examine whether the remaining integrability conditions hold in the data.
Our separable log-linear model is then defined as (4) subject to the restriction in (3), which we translate from Sij to ij and impose at the average expenditure share for each good w¯ j (see Appendix A for details on the derivation):

ij

w¯ j(k ij - i) if gi gj,

ij

if gi gj.

(5)

Here, ij is an unrestricted within-group elasticity, and k is a separability parameter that we further restrict to be symmetric to satisfy group-level Slutsky
symmetry. For two normal goods i and j belonging
to different groups k and , it is now that case that

ij > 0  k

>

1 j

.

(6)

Therefore, all products in group k will be substitutes to all products in group if k is big enough, and complements if k is small enough.
There is still a question of whether the log-linear model
subject to the restriction in (5) can approximate a de-
mand system generated by some weakly separable
utility function. As shown by Blackorby et al. (1977),
the concern is that the separability constraints are too
restrictive in that the model no longer has enough
parameters to approximate the underlying separable
model. To address this issue, Driscoll et al. (1992) show that a model needs 1 + n + k nk(nk + 1)/2 + K(K - 1)/2 parameters to constitute a flexible approximation
to a weakly separable process, where nk denotes the number of products assigned to group k. Because our model contains k n2k+ K(K - 1)/2 price effects, this condition will be satisfied as long as we include n product intercepts and nk > 1 for at least one group.5

2.3. Related Models
Our aim in this paper is to study the structure of aggregate demand both within and across highly differentiated product categories. It is then necessary that our empirical demand specification allow for flexible substitution patterns. A natural starting point is to consider the unrestricted log-linear demand system in (4). The main drawback is that it requires n2 price elasticity parameters to be estimated, which can be demanding on the data for even a moderate number of products. Moreover, the assessment of product competition is nontrivial, as it requires careful examination of a potentially large elasticity matrix.

Separability offers a dimension reduction solution through the introduction of product groups, but this comes at the cost of flexibility. By treating the partition as a model parameter, we accomplish three goals: (i) we endogenize the separable structure of demand, (ii) we reduce the dimension of the parameter matrix, and (iii) we retain much of the flexibility of the unrestricted model a priori. Estimating our separable model would be preferred over an unrestricted model whenever the researcher has insufficient data to precisely estimate price effects or directly cares about inferring the boundaries of competition.
An alternative approach commonly taken in the differentiated products literature is to use a mixed or random coefficient logit demand model, which is flexible in the sense that its choice probabilities can approximate the choice probabilities from any underlying utility function (Berry et al. 1995, McFadden and Train 2000). The added flexibility over the homogeneous logit model comes from the assumption that consumers are heterogeneous in their tastes for product characteristics. This allows the cross-price elasticity between two goods to be driven by their similarity in the characteristics space.
Although mixed logit models benefit from a formal treatment of utility theory and aggregation, there are a few reasons why they are not necessarily suitable for our purposes. First, the practical flexibility of the mixed logit is unclear, as the result of McFadden and Train (2000) only holds for some appropriately specified mixing distribution and when arbitrarily highorder polynomials of price are allowed to enter the logit expression. Second, mixed logit models assume that market shares result from the aggregation of discrete choices across consumers. When modeling demand for wide assortments or across categories, the assumption of discrete choice is unreasonable. Third, accurate measurement of cross-price effects depends on the availability of rich product characteristic data, which are not always available. The flexibility in our model is not driven by characteristics (although the model can be extended to include them if desired). Finally, it is not obvious how to identify separable product groups within a mixed logit demand model. Although it is possible to use dimension reduction or clustering techniques on the induced price elasticity matrix, there is no reason to believe that those groups would actually reflect the separable structure of demand.
3. Models for Random Partitions
The separable demand model proposed in Section 2 is defined conditional on a partition n. This section outlines probability models for n that enable joint posterior inference. Because random partition models have seen little application in the field of marketing,

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

695

we first present a general discussion of their foundation and connection with Bayesian nonparametrics. Then, we review the more recent work of Smith and Allenby (2019), who develop a location-scale partition model that we use as the proposal distribution in our posterior sampling routine.
The construction of models for random partitions is often based on sampling from a discrete random probability measure, which is a central topic of Bayesian nonparametric methods. For example, using the Po´ lya urn scheme of Blackwell and MacQueen (1973) to sample from a random distribution G with a Dirichlet process prior (Ferguson 1973) also induces a model for random partitions. This result is due to the almost sure discreteness of draws from a Dirichlet process; that is, if a set of random variables 1, . . . , n is sampled from G, then some of the draws will take on the same value with positive probability. The tied values can then be used to assign the items into mutually exclusive groups, which is equivalent to constructing a partition (Figure 1).

3.1. Random Partitions and the Dirichlet Process

Formally, consider sampling i|G  G for i 1, . . . , n, where G  DP(, G0). The precision parameter  > 0 and base distribution G0 are fixed hyperparameters. Blackwell and MacQueen's (1973) Po´ lya urn scheme

provides a way to generate the vector of 's: draw 1  G0 and then sample i| < i for i 2, . . . , n according to

K(i)

i| < i  w0G0(i) + wkk (i),

(7)

k1

where

w0

  + i - 1 and wk



nk +i-

1

.

(8)

Here, k is the kth unique value in the set  < i (1, . . . , i-1), k (·) is a point mass at k, K(i) is the number of unique values in  < i, and nk is the number of 's equal to k. The weights w0 and wk represent the

Figure 1. Drawing Random Partitions from Discrete Random Measures

Notes. Four random variables are drawn. The realized values are used to create the vector item-group assignment variables g1, . . . , g4 that constitute a partition. The solid lines indicate probabilistic sampling, whereas the dashed lines indicate deterministic labeling.

probability bution and

that i exactly

is a new equal to

draw from the base distrik, respectively. Because

our focus is on the induced partition rather than the

distribution G, the choice of G0 is immaterial, because the value of each i serves only as a group membership label.

The important feature of this sampling scheme is

that i can be exactly equal to one of the previous 's with strictly positive probability. Therefore, we can

translate the vector  (1, . . . , n) into a partition n (g1, . . . , gn) using the following mapping:

gi k if i k for i 1, . . . , n and k 1, . . . , K, (9)

where K denotes the number of groups. Because the 's are generated stochastically, the Po´ lya urn scheme in (7) induces a probability distribution p(n) defined over the space of possible partitions 3n. The sequential nature of (7) also leads to simple probability calculations:

n

p(n)  p(gi|g < i),

(10)

i2

where g < i (g1, . . . , gi-1), and

p(gi| g < i)

w0 if gi / {g1, . . . , gi-1}, wgi otherwise.

(11)

We next describe three desirable properties of random partition models based on Po´ lya urn sampling schemes.
Property 1 (Endogenous K ). If n is a random partition generated from a Po´lya urn scheme, then the number of groups K max{g1, . . . , gn} is also random. Consequently, the partitioning model p(n) induces a probability model over the number of groups p(K).
In many existing models of categorization (e.g., models based on the multinomial distribution), the number of groups must be fixed by the researcher a priori. Partitioning models based on Po´ lya urn schemes instead allows us to make inference about partitions and the number of groups jointly.
Property 2 (Order Restriction). If n is a random partition generated from a Po´lya urn scheme, then the elements of n conform to the following order restriction:
g1 1 and gi  {1, . . . , K(i) + 1} for i 2, . . . , n, (12)
where K(i) max{g1, . . . , gi-1}.
This property prevents any issues of label switching, which are also common in models of categorization. For example, consider two equivalent partitions n (1, 1, 2, 1) and n (2, 2, 1, 2). The order restriction only permits n to be generated from the model, not n. We will let 3n denote the set of all possible partitions of n items subject to this restriction.

696

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

Property 3 (Marginalization). Let n be a random partition of n items, and let n+1 be a random partition of n + 1 items. If n and n+1 are generated from Po´lya urn schemes, then the probability model for n arises from marginalizing the model for n+1:

K+1

p(n)

p(n+1).

(13)

gn+1 1

This property ensures that a partitioning model for n items does not depend on whether we consider an additional item, at least a priori. Further discussion of the marginalization property can be found in Müller et al. (2015).
The problem with the specific probability model for n induced by the Dirichlet process is that it depends only on  and nk. Consequently, it is hard for the researcher to control the partitioning process or form expectations about the composition of sampled partitions. This restrictive nature of the Dirichlet process partitioning model makes it unattractive as a prior because it is not obvious how to summarize our knowledge of n through the single precision parameter . It is also unattractive as a proposal distribution within a Markov chain Monte Carlo (MCMC) routine because we can only navigate the high-dimensional partition space using independent state transitions; that is, there is no way to "center" the partition distribution around the current state when generating a candidate partition.

3.2. The Location-Scale Partition Distribution Smith and Allenby (2019) address these limitations by developing the location-scale partitioning model, denoted LSP(n, ). The idea is to parameterize the group-assignment probabilities in (7) with a location partition n (s1, . . . , sn) and scale parameter  > 0:
K(i)
i| < i, n,   w0(n, )G0(i) + wk(n, )k (i).
k1
(14)

Here, w0(·) and wk(·) are positive functions that satisfy w0(·) + k wk(·) 1. The composition of groups is now controlled by the information in n and . Holding  fixed, two items that are grouped together in n are also more likely to be grouped together in n. The specific functional forms for w0(·) and wk(·) are given by

wk(n, )

c~i

·

 C(i)

+ +

nsSik +

nk

,

(15)

w0(n, )

c~i

·



+ I(si C(i)

+

C(i) +

+ 1

1)

,

(16)

where Sk {sj : gj k and j < i}, C(i) max{s1, . . . , si-1}, cn~icSkiscoaunnotsrmthaelinzuinmgbceornosftealnemt. ents in Sk equal to c, and

Because (14) is a modified Po´ lya urn scheme, the LSP probability model will automatically satisfy Properties 1 and 2 described above. The functional forms for w0(·) and wk(·) also guarantee that the LSP model satisfies Property 3 as well as the following consistency property (see Smith and Allenby (2019) for formal proofs).

Property 4 (Location-Scale Consistency). If n  LSP(n, ), then for any number of items n and location partition n  3n,

lim
0

Pr(n

n|n, )

1.

(17)

This property ensures that the LSP(n, ) distribution behaves like a continuous, univariate distribution belonging to a location-scale family; that is, n shifts the center of the distribution on 3n, and  determines the amount of dispersion around n. As  goes to zero, more probability mass is placed on n. As  gets large, the mass is spread more evenly over 3n. An illustration of the differences between the partition dis-
tribution induced by the Dirichlet process and the
LSP distribution is provided in the online appendix. For our purposes, the LSP distribution facilitates es-
timation and inference in two ways. First, it serves as a prior distribution for n, where prior knowledge can be directly imposed through the choice of location partition n and dispersion parameter . Second, it serves as a proposal distribution in an MCMC routine. Specifically, we implement a random-walk Metropolis­ Hastings algorithm, where a candidate partition n is proposed from an LSP(n, v) distribution. Here n is the partition in the current state, and v is a step size
parameter. Candidate partitions will then be generated
from a distribution centered around the partition in the current state, where the similarity between n and n is controlled by v. The resulting Markov chain will be able to navigate the partition space much more
effectively than alternative independence proposal
mechanisms.

4. Posterior Inference

4.1. Likelihood

The unrestricted log-linear demand system has a con-

venient statistical representation. Whereas log-linear

models usually take the form of multivariate regres-

sions, we rewrite (4) as a seemingly unrelated regres-

sion (SUR) model to account for the product-specific

control variables:

 

y1 y2 ...

 

 

X1 0 ...

0 X2 ...

··· ··· ...

0 0 ...

 

1 2 ...

 

+

 

1 2 ...

 ,

(18)

yn

0 0 · · · Xn n

n

y X + .

(19)

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

697

Here, yi log qi is a T-dimensional vector of log demand, and Xi (P, M, Zi), where P is a T × n matrix of log prices, M is a T-dimensional vector of log expenditure, and Zi is a T × d matrix of product-specific controls. Furthermore, let i (i , i, i ), where i is an n-dimensional vector of price elasticities, i is a scalar expenditure elasticity, and i is a d-dimensional vector of control coefficients. Finally, the T-dimensional
error vector follows a multivariate normal distribution with an expanded covariance matrix   N(0,   IT), which induces a multivariate normal likelihood for
the data.

4.2. Computation
In its unrestricted form, sampling from the posterior of the model in (19), subject to the specification of proper conjugate priors, can be achieved using the SUR Gibbs sampling routine outlined in chapter 3 of Rossi et al. (2005). Posterior inference for the model in (19) subject to separability restrictions in (5) is more challenging. This is because the separability restrictions both (i) parameterize the conditional mean function as a nonlinear function of , which breaks the conjugacy that enables the use of Gibbs sampling, and (ii) project a subset of the elasticity parameters onto a lower-dimensional space whose dimension can change with the partition.
We address these challenges by rewriting the mean function:

y X(n, ; P, w)n + c(n, ; P, w) + M + Z + , (20)

where n ( ,  ) denotes the joint vector of unrestricted elasticities  and restricted separability parameters . The first term presents the key result in that, once the suitable X(·) matrix is constructed, the model remains linear in n . The second term c(n, ; P, w) represents the remaining restrictions in (5) not contained in X(·). Specifically, let c(n, ; P, w) vec(PC), where C is an n × n matrix with elements Cij w¯ jiI(gi gj). The next two terms include log expenditure and product-specific controls, which are parameterized just as they are in (19) with M diag{M, . . . , M} and Z diag{Z1, . . . , Zn}.
Next, we turn to the construction of X(·), which
requires binding together the appropriate prices that are informative about  and , respectively. This gives
rise to the following structure:

X(n, ; P, w)

 

U1

(n) 0 ...

0
U2 (n ) ...

··· ··· ...

0 0 ...

R11(n, ) R21(n, )
...

··· ···

R1n R2n

(n (n

, ,

) )

 ,

0

0

· · · Un(n) Rn1(n, ) · · · Rnn (n, )

(21)

where the block diagonal matrix in the first n columns constitutes the unrestricted covariates for , and the
remaining columns constitute the restricted covariates for . Specifically, Ui(n) is the T × ni matrix of log prices corresponding to the set of product i's unrestricted elasticities i, where ni dim(i). It is a function of n because it is formed by combining all columns j of P such that gi gj. Each element of the remaining matrix is a T × 1 vector defined as

Rij(n, )

{r: gr6j  gr gi} w¯ rir log pr if gi  6j,

0

otherwise,

(22)

where n dim(), and 6j {k, } stores the pair of group indices (k, ) corresponding to the jth element of the  vector. For example, if n (1, 1, 2, 2, 3, 3), then n 3, 61 {1, 2}, 62 {1, 3}, and 63 {2, 3}.
The full set of model parameters includes the vector
of unrestricted elasticities and separability parameters n , the expenditure elasticities , the partition of goods n, the coefficients on the controls , and the error covariance matrix . Our posterior sampling
strategy directly follows from the structure of the
mean function in (20) and takes advantage of con-
ditional conjugacy. We outline the two-step posterior
sampling routine below.

Step 1 (, ). To sample  and  from their posterior conditional on (n , n, ), let

y - X(n, ; P, w)n - c(n, ; P, w) - M Z + , (23)

which is a standard SUR model. Thus, we can sample from this conditional posterior directly, subject to the specification of conjugate priors:   N(¯ , A-1) and   IW(0, V0).

Step 2 (n , , n). To sample (n , n, ) from their posterior conditional on (, ), let

y - Z X(n, ; P, w)n + c(n, ; P, w) + M + .
(24)
This model is linear in n but not in  or n, so direct sampling from the associated posterior is not possible. We instead rely on a Metropolis­Hastings step. The key is to construct efficient proposal distributions that ensure proper mixing and dimension matching between n and n.
We construct our joint proposal distribution as follows:
q(n , n, |n , n, ) q1(n |n, )q2(n|n)q3(|),
(25)

where (n , n, ) denote the candidate values and (n , n, ) denote the current values. Notice that conditional on values of n and , we can rewrite (24)

698

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

as another SUR-like model that is linear in n .6 The benefit is that, subject to the specification of a conditionally conjugate prior n |n  N(¯n , A- 1), we can directly sample from the associated conditional
posterior (see Appendix B for details). This results in a highly efficient independence proposal given that q1(·) is the exact conditional posterior of n . Two marginal random-walk proposals can then be used for n and . In particular, we choose q2(·) to be the LSP distribution of Smith and Allenby (2019) so that n  LSP(n, v), where v is a step size. The efficiency of this approach comes from being able to generate n from a distribution "centered" around the current partition,
as in any ordinary random-walk proposal. There are two benefits from the joint proposal
strategy outlined above. First, the resulting ratio of
likelihoods will always be tractable in the sense that the dimension of n is guaranteed to conform with n. In fact, recognizing that q1(·) is the conditional posterior of n, it becomes straightforward to show the acceptance probability reduces to

!

min

1,

m(y|n, , )p(n)p()q2(n|n) m(y|n, , )p(n)p()q2(n|n)

,

(26)

where

m(y|n, , )

p(y|n , n, , )p(n |n)dn . (27)

Therefore, the proposed sampler is equivalent to a sampler that marginalizes over n when navigating the posterior of n.
The second benefit is that generating n from its full conditional distribution independent of n allows us to handle changes in dimensionality with little computational burden. Traditional attempts to accommodate transdimensional sampling problems within MCMC rely on random-walk proposals such as the reversible-jump MCMC sampler of Green (1995). However, these methods require complicated transition probability calculations and become inefficient in high dimensions. In contrast, we only use random-walk proposals to marginally navigate a high-dimensional (but fixed) partition space, and then use efficient independence proposals for n . Therefore, the transition probabilities in the proposed routine only require evaluating a multivariate normal density and the LSP probability mass function.

4.3. Specification of Priors
Care must be taken when choosing hyperparameters in the prior distributions of n and n. This is because the acceptance probability in the proposed MCMC
routine is driven by the ratio of marginalized likelihoods that are integrated over n. Given that the dimension of n depends on n, the integrals in the

numerator and denominator of (26) may be of differing dimensions and will penalize models with many parameters in the presence of diffuse conditional priors on n (Lindley 1957). In the context of our separable demand model where n i ni grows faster than n, this means that the ratio of marginalized likelihoods will naturally favor models with fewer unrestricted elasticity parameters and many groups.
In situations with limited data (where the prior dominates the likelihood) or when the researcher wants to penalize models with many groups, this effect can be countered through a judicious choice of ¯n , A, n, and . For example, researchers often specify diffuse priors in regression models by choosing ¯n 0 and A 0.01I. However, choosing A 0.1I may be more appropriate, as it reflects the knowledge that elasticities rarely fall outside the range (-6, 6). One may also choose n to have few groups with a small value of . Doing so allows the marginal prior on n to penalize partitions with many groups. See the online appendix for a simulation study that further explores the effect of the prior on posterior inference.
4.4. Scalability
Although the SUR-like representation of the model likelihood enables efficient posterior inference, there are some limitations that arise when n is large. First, the joint proposal strategy outlined in Section 4.2 requires us to sample from the conditional posterior of n given all other parameters and data. The linearity of the model makes direct sampling possible, but potentially computationally expensive. This is because the dimension of this conditional posterior is nn n + n k n2k + K(K - 1)/2, which grows quadratically in both the number of unrestricted parameters and groups. For example, if there are K 10 groups with each having nk 10 products, then nn 1,000 + 10(9)/2 1045. In contrast, if there are only K 2 groups with each having nk 50 products, then nn 5,000 + 1 5,001. Thus, the dimension of the conditional posterior can change dramatically with n.
As with any Bayesian SUR model, drawing from this conditional posterior distribution of n requires computing its posterior mean and the inverse of the Cholesky root of its posterior covariance matrix in each iteration of the Markov chain (Rossi et al. 2005). Because the posterior moments depend on the design matrix X(n, ; P, w), which in turn depends on n, we must also construct X(n, ; P, w) in each iteration. Although this adds to the complexity, we avoid the cost of multiplying these large matrices by exploiting the partial sparsity of X(n, ; P, w) and instead construct its cross product directly.7
Figure 2 illustrates the computational cost of sampling from the conditional posterior of n . The computation time we measure includes the cost of constructing the

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

699

cross product of X(n, ; P, w), computing the posterior mean, and taking the inverse of the Cholesky root of the posterior covariance matrix.8 In this exercise, we always define n to be a partition with two groups (n 1), but vary the number of elements in each group nk  {5, 10, 15, . . . , 50}. This leads to models with n  {10, 20, 30, . . . , 100} products and n  {50, 200, 450, . . . , 5, 000} unrestricted elasticities. We plot the average computation time (across 100 replicates) against the number of unrestricted elasticities, where the number of observations is fixed at T 200 across all models. We find that the computation cost increases nonlinearly with n.
Our model also requires navigating the space of partitions, which grows superexponentially in n (Bell 1934). LSP proposals allow us to navigate this space efficiently for moderate n, but are subject to the same scaling limitations as any random-walk Metropolis­ Hastings algorithm; that is, there is a question of how to choose the step size of the LSP proposal distribution to ensure proper mixing as n gets large. Smith and Allenby (2019) find that using v 1/(n log n) appropriately scales the dimension of 3n, and they demonstrate practical convergence for up to n 100 items. Higher-dimensional product sets can still be accommodated in our model, but may require stronger prior restrictions on the partition (e.g., assuming that a set of products must always belong to the same group).
Finally, there is a question of how the number of products n is allowed to scale relative to the number of observations T. In online retail, for example, there is a practical interest in "high-dimensional" regressionbased demand models in which the number of products, and associated price effects, exceeds the number of observations. The challenge is in this setting is that the least squares estimator of the unrestricted price elasticity matrix is no longer well defined. Note that
Figure 2. Average Computation Time in Seconds (over 100 Replicates) for a Single Draw from the Conditional Posterior of n for Various Model Sizes

although a Bayesian estimator of the same price elasticity matrix is not subject to this limitation because of the regularity imposed by the prior, the associated posterior would still exhibit significant uncertainty. Because we take a Bayesian approach to inference and impose further parameter restrictions, our model will generate a well-defined posterior even when n > T. However, this high-dimensional setting is not our inherent focus for a few reasons.
First, our analysis is motivated by the fact that separability assumptions remain widely (and often implicitly) used in large- and small-scale demand problems alike. One of our goals is to assess the viability of these assumptions by providing empirical insights into the separable structure of demand. Although the choice of separable groups becomes more difficult when product space is really large, to our knowledge there is no other work that attempts to identify separable demand groups even within a single product category. Instead of focusing on scale alone, we aim to provide a more comprehensive description of competition within broad and highly differentiated product categories. Moreover, in our empirical applications, we focus on competition between brands and have found that the number of brands that constitute the majority of total category sales is small relative to the number of UPCs. Thus, for a brand-level analysis, the product set need not be extremely large to provide a complete description of category competition.
That being said, the core dimension reduction offered by separability remains attractive in very highdimensional settings. Joint inference for n and n is impractical when n > T because of the complexity of the partition space 3n and the limited number of observations. However, if the goal is to simply forecast demand or generate estimates of price effects (which are otherwise intractable), then our recommendation is to fix both the expenditure elasticities (e.g., i 1 for all i) and partition. Doing so greatly reduces complexity of our sampling algorithm by removing the need to implement a Metropolis­Hastings step, which in turn makes posterior inference more practical when n is large (e.g., in the hundreds). In the online appendix, we also use a simulated data to show how the separable demand model performs in n > T settings. Because the core focus of this paper is to uncover the separable structure of demand through posterior inference on n, we assume T > n going forward.

5. Empirical Analysis
5.1. Data
Our data come from the Nielsen Retail Measurement Services (RMS) database, which contains weekly movement, pricing, and store environment information for over 90 retail chains across the United States.9

700

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

Within the RMS database, UPCs are grouped into 10 departments (e.g., dry grocery), 125 product groups (e.g., snacks), and 1,100 product modules (e.g., potato chips). We construct two data sets from two distinct product groups: (i) jams, jellies, and spreads and (ii) juice drinks. The jams, jellies, and spreads product group consists of 9 product modules, whereas the juice product group consists of 18.10 For simplicity, we use data from a single store in Cincinnati, Ohio, for which instore promotional activity is available. Our sample period spans four years, from 2008 to 2011, and we use a random sample of 52 weeks as a holdout sample.
For each product group, we aggregate UPCs to the brand level because of high collinearity of prices within a brand (e.g., a 28 oz. jar of Jif creamy peanut butter vs. a 28 oz. jar of Jif chunky peanut butter). In the jams, jellies, and spreads category, we also combine the jams and jellies modules because they exhibit highly collinear prices. We believe that a brand-level analysis is the most natural for considering the formation of separable demand groups. For example, it seems unreasonable to think that rate of substitution between an 18 ounce jar of Jif peanut butter and an 18 ounce jar of Skippy peanut butter would ever be independent of the demand for the exact same Jif offering in a 28 ounce jar. Our sample of products includes the majority of brands that have a within-module share of volume exceeding 1% and are present for each year in the sample. For each brand, we then create volumeweighted prices that are standardized prices for the most common pack size in the product group.
Our analysis in the jams, jellies, and spreads product group uses data from the jams, jellies, preserves, and peanut butter modules. These four modules constitute 84% of total demand in the product group. Aggregating up to the brand level results in 18 unique products that are comprised of 224 UPCs and account for 85% of demand across the four product modules. Moreover, the distinct differences in and complementary relationship between peanut butter and jellies/preserves create a strong prior for how to categorize products. By comparing the separable demand groups we find in the data to the product module labels, we can examine the face validity of our methodology.
The second analysis from the juice drinks product group uses data from the top eight product modules, which constitute 90% of total demand for the entire juice product group. Aggregating up to the brand level results in 32 products that are comprised of 421 UPCs and account for 64% of total demand across the eight product modules. The relatively lower share of volume is due to the high fraction of small on-the-go package sizes, which we exclude in our analysis. Conditional on the set of package sizes in our sample (40­140 ounces), these 421 UPCs account for 83% of demand.

In both data sets, we include seasonal effects, display and feature advertising variables, and product intercepts as product-specific covariates. We also construct Mt using expenditure data at the product group level, which spans a broader set of product modules and UPCs than those used to form the items under study. Detailed descriptions of the products from both data sets are provided in Appendix C.
5.2. Prior and MCMC Settings Until now, we have treated expenditure elasticities  as model parameters. Although inference for  is possible, we choose to fix i 1 for all i 1, . . . , n, as suggested by the adding-up condition. We feel this restriction is justified for two reasons. First, it amounts to placing a very dogmatic prior on  that is centered around values suggested by economic theory. Doing so helps push estimates of remaining model parameters toward values consistent with integrable demand. Second, specifying demand as a function of total expenditure raises a concern of endogeneity when estimating . The inclusion of expenditure in (4) is important to maintain the coherence of the restriction in (3). However, our focus is on understanding the structure of cross-price effects, so a formal treatment of expenditure endogeneity (e.g., by way of instrumental variables) only adds unnecessary complication to our analysis.
We proceed by estimating three demand models. The first is an unrestricted log-linear model. The second is a separable log-linear model where the partitioning of goods is fixed a priori based on the definition of product modules. The third is a separable log-linear model where n is estimated from the data. All models are estimated using MCMC methods discussed in Section 4. Each Markov chain is run for R 500, 000 iterations and thinned by keeping every 100th raw. We use the first 25% of draws as burn-in. When n is estimated, we choose the scale parameter of the proposal distribution to be v 1/(n log n).
Conditionally conjugate but fairly diffuse priors are placed on all parameters in the unrestricted model:   N(0, 100I),   N(0, 10I), and   IW(n + 3,(n + 3)I). In both separable demand models, we place a N(0,10I) prior on the unrestricted elasticities , a N(0, 100I) prior on the separability parameters , and the same priors on  and  as in the unrestricted model. When n is estimated, we use the LSP distribution as a prior with n equal to the partition with one group and  1/(nlog n). Doing so imposes a slight penalty on models with many groups.
5.3. Model Comparison Table 1 provides posterior estimates of in-sample and predictive fit statistics. We report both the

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

701

log marginal density (LMD), calculated using the Newton­Raftery approximation, and the root mean squared error (RMSE). The in-sample fit across models is generally similar, with the unrestricted model fitting best in the jams, jellies, and spreads data and the more flexible separable model fitting best in the juice data. The advantages offered by separability are most noticeable in the predictive fit statistics. Specifically, reducing the dimension of the parameter space improves the accuracy and precision of demand forecasts.
The extent of the improvement between the two separable models depends on the product category and how closely the module labels match the demand structure in the data. For example, estimating n leads to larger improvements in predictive fit when the posterior places mass on product groups inconsistent with category labels. In the next section, we show that module labels do a reasonable job describing the separable structure of demand for jams, jellies, and spreads, but not juice drinks.
We can also test for differences between weak, strong, and additive separability using the nested structure of the elasticity restrictions as discussed in Section 2.1. For example, additive separability requires n to have n groups, so we can test for additivity by computing the posterior probability that K n in the more flexible separable model. In both data sets, the posterior distribution of K places no mass on K n, rejecting additivity.
Strong separability holds whenever the separability parameters are constant across groups. We can then test for strong separability by testing for equality among the k parameters. We carry out this test using the separable model that estimates n because it fits the data best.11 The only complication is that when n is estimated, the dimension of the  vector potentially changes across iterations. We therefore isolate the partitions visited more than once in the Markov chain and compute 95% credible intervals for each k in the associated  vector. We test for equality among the k 's by then checking to see whether any of the

credible intervals do not overlap, which is the case 99% of the time in both data sets. Thus, the magnitude of the separability parameters provides empirical evidence that supports weak rather than strong separability.
Finally, we use the posterior distribution of crossprice effects ij to examine the extent to which the integrability conditions are satisfied in the data. Adding up is satisfied by assumption. The posterior distributions for the homogeneity and negativity conditions are shown in the online appendix. We find that both hypotheses cannot be rejected for nearly all products in the data. We also compute the posterior distribution of the symmetry condition and find that it cannot be rejected 97% of the time in the jams, jellies, and spreads data and 98% of the time in the juice data.
5.4. Inference for Partitions The posterior distribution of n is summarized in Figure 3, which plots the posterior pairwise similarity matrix from each data set. The similarity matrix captures the proportion of times two items are grouped together throughout all post-burn-in iterations of the Markov chain, where darker colors imply higher clustering probabilities. We also show the grouping structure implied by product modules in the bottom right corner of each similarity matrix to be able to compare how the partitions supported by the data compare with product categories.
In the jams, jellies, and spreads data set, we find that partitions with high posterior probability are fairly consistent with the definition of product modules; that is, the estimated demand groups tend to separate peanut butter from jellies, jams, and preserves. Our results do indicate some co-clustering across the jellies/ jams and preserves modules. However, the majority of clustering occurs within the product module. We also find a slightly more refined structure of demand within the jellies/jams module, in which grape and strawberry offerings are usually separated from blackberry and raspberry offerings. However, the model fit

Table 1. Model Fit Statistics

In-sample

Predictive

Model

LMD

RMSE

LMD

RMSE

Jams, jellies, and spreads
Unrestricted Separable, fixed n Separable, estimated n Juice drinks
Unrestricted Separable, fixed n Separable, estimated n

-2,494.675 -2,477.253 -2,471.433
-3,126.433 -2,938.950 -2,867.157

0.786 0.790 0.789
0.420 0.418 0.398

(0.007) (0.005) (0.004)
(0.005) (0.003) (0.004)

-1,205.749 -1,092.224 -1,082.494
-1,237.058 -1,016.541 -1,009.781

1.047 0.974 0.960
0.492 0.422 0.409

(0.023) (0.015) (0.014)
(0.013) (0.007) (0.007)

Notes. Posterior standard deviations of the RMSE statistic are given in parentheses. LMD, log marginal density; RMSE, root mean squared error.

702

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

Figure 3. Posterior Pairwise Similarity Matrices for Each Data Set

Note. The bottom right corner of each plot shows the grouping structure implied by product modules.

statistics suggest that making the mistake of defining a category too broadly is still less egregious than defining categories that are too narrow.

In the juice data set, we find stark differences between the separable structure of demand and the predefined module categorization. In fact, partitions

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

703

with appreciable posterior mass always contain demand groups that span different flavor subcategories. For example, we find that three Simply juices (apple, orange, grapefruit) exhibit high co-clustering probabilities (83% for apple­orange, 64% for apple­grapefruit, and 58% for orange­grapefruit).
The nonseparability of demand for Simply juices may be attributed to marketing activities. For example, Simply products all have identical branding and are displayed together in the refrigerated section of the grocery store.12 The shelf placement of Simply Apple is especially intriguing given that most all apple juice products are usually shelf stable and physically located in a different aisle. Activities like these could help Simply, a much younger brand than its competitors, create a local monopoly in the broader juice category.
5.5. Inference for Separability and Elasticity Parameters
The estimates of the separability parameters provide information about the relationship between separable groups. In the jams, jellies, and spreads data set, for example, one may not only expect peanut butter and jelly to be in separable groups, but also that the separability parameters indicate groupwise complementarity. Given that the a priori relationship between different demand groups in the juice category is less obvious, we focus on inference for separability parameters for the jams, jellies, and spreads category.
Marginal inference for separability parameters is challenging when n is estimated because the dimension of  changes with n. Because we are interested in whether the estimates of  generally pick up complementarity between the peanut butter and jellies/ preserves product groups, we summarize the posterior of  as follows. We first condition on states in

the posterior such that all peanut butters belong to different groups from the jellies and preserves. Then, we compute the average value of  both across peanut butters and jellies/preserves and within jellies/ preserves. The full distribution of  in each case is shown in Figure 4.
A priori, one may expect  to induce complementarity between peanut butter and jellies/preserves, but substitutability between jellies and preserves. We can assess product relationships using (6), which shows that complementarity holds whenever  < 1. Figure 4 shows that the distribution of  generally falls below one across peanut butter and jellies/preserves, and above one across jellies and preserves. This provides evidence that when n is estimated, the model not only tends to assign peanut butter and jellies/ preserves into separable groups, but also produces values of  that reflect complementarity between peanut butter and jellies/preserves and substitutability between jellies and preserves.
We can also project estimates of the lower-dimensional separability parameters back up to the space of the n × n price elasticity matrix. Figure 5 plots the posterior means and standard deviations of the full price elasticity matrix for the unrestricted model against the induced elasticities from the separable model with estimated n. Although there is a high degree of correlation between elasticity estimates, many of the cross-price elasticities are estimated to be zero in the proposed model. One explanation is that some of the demand groups are not only separable, but also isolated. The fact that our model can accommodate both cases is an advantage over other regularization methods that only impose shrinkage to zero.
Moreover, the precision of the estimates tends to be worse for both unrestricted models. This is shown in the right column of Figure 5, where the majority

Figure 4. The Distribution of Separability Parameters for (a) Peanut Butter and Jellies/Preserves and (b) Jellies and Preserves

Density 0.0 0.2 0.4 0.6 0.8 1.0
Density 0.0 0.2 0.4 0.6 0.8 1.0

-4 -2

0

2

4

6

8

-4 -2

0

2

4

6

8

Note. The dashed vertical line indicates the value of  for which products are complements ( < 1) or substitutes ( > 1).

704

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

of points fall to the right of the 45 degree line. This provides evidence that separability restrictions are still able to provide gains in efficiency when the partition is also estimated.
6. Implications
This section explores the implications of separable demand on product competition, brand positioning, and the measurement category promotion effects. We investigate these topics using results from the juice data set, where the variety of flavors and brands generally complicates the analysis of market structure.
6.1. Competition An advantage of economic demand models is that they allow for a formal analysis of product competition as measured by the sign and magnitude of

cross-price effects. For instance, brands with higher cross-price effects compete more intensely and are therefore closer substitutes. Separability offers a third dimension for assessing competition: the dimension of the price elasticity matrix. By allowing n to be estimated from the data, we can learn about the boundaries of consumer preferences as defined by (2).
Empirically, we find brands like Simply in the juice category appear to break the notion of separability by flavor. This means that the rate at which consumers substitute between brands within a flavor category (e.g., apple juice) may very well depend on their consumption in other flavor categories (e.g., orange juice). In a sense, this finding corroborates the goals of many marketing activities like umbrella branding and advertising, which seek to create information spillovers in the consumer's choice process. This result also implies that the boundaries of competition may be

Figure 5. Posterior Means and Standard Deviations of Price Elasticity Parameters for the Separable and Unrestricted Models

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

705

broader than previously thought, at least within the juice category. Allowing for a formal connection between marketing variables (e.g., shelf collocation or advertising) to the separable structure of demand is something we leave for future work.
In addition to the boundaries of competition, we can also explore the induced effects of separability restrictions on the sign and magnitude of cross-price effects. In a separable demand model, cross-group price effects are a function of budget shares w¯ j, separability parameters , and expenditure elasticities . Because we fix expenditure elasticities a priori, the sign and magnitude of these cross-group price effects will be driven by . In many cases,  will need to be large in absolute value to overcome small budget shares and produce nonzero cross effects.
We start by plotting the distribution of withingroup and across-group price elasticities for both separable models (Figure 6). We find that imposing separability generally shrinks the cross-group price effects to a small neighborhood around zero, which suggests that products within a group are most influenced by price changes within the group than across groups. This is consistent with previous work on the effects of separability on competition (e.g., Rubinfield 2000), which have treated this property as a shortcoming of separability because the form of competition is in part fixed by the researcher's partitioning of goods. However, this is not a concern when n is estimated from the data. In fact, we need the cross-group restrictions to be dogmatic to separate true cross effects from random noise.
To see the impact of separability at a more granular level, we also decompose the within-group and acrossgroup elasticities by flavor category. Table 2 reports the average own elasticity, within-group elasticity, across-group elasticity, and absolute value of the ratio

of within to across for each product module. The ratio illustrates the extent to which the magnitude of withingroup elasticities exceeds that of the cross-group elasticities.
We find that when the partition is fixed, the average ratio of within- to across-group elasticities tends to be extremely large. However, the ratios shrink significantly when n is estimated. Even though each partition still places strong restrictions on the crossgroup effects, the reported elasticities are averaged over the posterior distribution of n. This induced differential shrinkage allows the separable model to admit more flexible substitution patterns, obviating the concern that separable assumptions fix the form of product competition.
6.2. Brand Positioning Given the relationship between the partitioning of goods into separable groups and the induced patterns of competition, we next investigate how this information can influence brand positioning strategies. To illustrate, again consider the case of Simply juices. Our empirical analysis showed that Simply juices often belong to one group rather than separable groups. The retailer may then wonder whether this local concentration of demand for Simply hurts its ability to compete with its store brand juice offerings.
If brand positioning is a determinant of the separable structure of demand, then the retailer could consider repositioning the line of store brand juices in a way that moves store brand juices into the cluster of Simply juices. We explore this type of counterfactual with a simple example with three products: Simply Apple, Simply Orange, and store brand orange juice. If Simply Apple and Simply Orange belong to one group and the store brand orange juice belongs to another, then Simply Orange and the store brand orange

Figure 6. Distributions of the Within-Group and Across-Group Elasticities for Separable Demand Models in the Juice Category

706

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

Table 2. Average Price Elasticities by Product Module in the Juice Category

Module
Apple Orange Cranberry Grape Grapefruit Fruit drinks Tomato Other vegetable

Own
-0.773 -2.010 -2.146 -1.458 -1.368 -1.853 -1.833 -2.087

Fixed n

Within Across

0.079 0.185 0.321 0.024 0.012 -0.080 0.281 0.189

-0.027 -0.022 -0.007 -0.045
0.010 0.012 -0.014 -0.006

|Ratio |
9.448 9.799 82.190 13.858 38.589 12.794 19.803 38.455

Own
-0.439 -2.085 -2.021 -1.498 -0.798 -2.064 -2.029 -2.097

Estimated n

Within Across

0.012 0.062 0.303 -0.416 -0.039 -0.004 0.174 0.025

-0.044 0.016 0.008
-0.039 -0.064
0.015 -0.012 -0.006

|Ratio |
1.147 3.816 22.014 12.238 5.518 8.592 20.758 7.533

juice will likely be less competitive (as measured by the magnitude of their cross-price effect).
By exploiting the uncertainty in the posterior distribution of n, we can offer insights relating to this counterfactual; that is, in the posterior of n, we observe Simply Orange and Simply Apple belonging to the same cluster 83% of the time, whereas we observe Simply Orange and the store brand orange juice belonging to the same cluster 23% of the time. We then look at cases when Simply Orange and the store brand orange juice are either grouped together or not and compute the average cross-price elasticities between (i) Simply Orange and the store brand orange juice and (ii) Simply Apple and the store brand orange juice. The distributions of the mean absolute value cross-price elasticities are shown for each case in Figure 7.
We find that the Simply­store brand cross-price effects are roughly zero when the two belong to different groups, but nonzero when they belong to the same group. This is even true for the effect of a price change on Simply Apple on the demand for store brand orange

juice. The intuition is that joining the same cluster as Simply has the potential to generate positive crosscategory spillover effects for the store brand.
6.3. Promotion Effects and Category Revenue Category managers are often tasked with setting pricing and promotional schedules across a wide assortment of goods. In these settings, it becomes especially important to estimate category demand systems that yield flexible yet precise demand elasticities to accurately measure the impact of price promotions on category sales. To illustrate the implications of separable (or nonseparable) demand on marketing actions, we consider the following promotional forecasting problem: What is the effect of a price promotion of one product on total category sales? In general, the answer is ambiguous as it depends on the relationship between a product's own and cross-price effects. It is then important to measure these price effects accurately and precisely, both within and across product modules.

Figure 7. Cross-Price Elasticities Between Simply Orange (Left) and Store Brand Orange and Simply Apple and Store Brand Orange (Right)

Note. "Same" indicates Simply Orange and store brand orange belong to the same group, whereas "different" indicates they belong to different groups.

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

707

Let 5)(m|X) j) pj · qj(m|X) denote the total revenue from product set ) predicted by model m with unobservables m and covariates X. The demand
equation for each model takes the general form

log qi hm(X, mi ) + i,

(28)

 (1, . . . , n)  N(0, ),

where hm(X, mi ) denotes the conditional mean function for model m, which depends on covariates X and parameters mi . We let m denote the full collection of model parameters. For example, m (, , , ) in the unrestricted model, whereas m (n , n, , , ) in the separable model when estimating n. When the
error vector is multivariate normal, the expected de-
mand for good j (integrating over ) has a simple closed-
form expression:

qj(m|X) E qj(m, |X) exp hm(X, mj ) + 0.5jj .
(29)
Expected revenue can then be written as an integral of 5)(m|X) over the posterior distribution of all model parameters m, corresponding to the posterior predictive distribution of m:

Em [5)(m|X)] Em pj · qj(m|X)
j)
pj · exp hm(X, mj ) + 0.5jj
j)
· dF(m|X).
(30)
We first provide an illustrative example in which we predict the effects of a $0.50-off price promotion for Simply Orange on category revenue. The depth of this promotion reflects a move from the 75th percentile of the Simply Orange price distribution to the 25th percentile of the distribution. Choosing Simply Orange also allows us to demonstrate the consequences of misspecifying the separable structure of demand because we find evidence that Simply Orange may not be separable from other Simply offerings. For each of the separable models, we compute expected demand under two price sets: (i) prices of all products are fixed at their average price, and (ii) prices of all products are fixed at their average price except for Simply Orange, which is $0.50 less than its average price.
When n is fixed, the model predicts a null effect on category revenue, with the 95% credible interval ranging from -3.6% to 3.3%. However, when n is estimated, the model predicts a 2.8% increase on category revenue, with the 95% credible interval ranging from -2.4% to 11.2%. The difference is likely

due to the misspecified shrinkage structure of crossprice effects. For instance, the nonseparability of demand coming from a brand like Simply may generate a form of brand complementarity. In this case, a price promotion of Simply in one flavor subcategory may lead to increased demand for Simply in other subcategories. However, this effect cannot be captured when n is fixed and misspecified.
To empirically validate the previous example and demonstrate that biases exist beyond Simply Orange alone, we use price variation in our holdout sample to predict category sales. Because price promotions are not labeled in the data, we must first construct a set of base and promotion prices for each product. We define the base price as any price in the top 25th percentile of the product's price distribution in a given year, and the promotion price as any price in the bottom 25th percentile of the same distribution.13 We then use the unrestricted and separable models to predict demand under each product's base and promotion price set, compute the associated percentage change in category revenue, and then compare with the observed percentage change in sales in our holdout sample.
For each product i 1, . . . , n, we use (30) to compute the percentage change in expected category revenue generated by a price promotion of product i. This generates estimates of the category promotion effect for each good, which we then compare with the actual percentage change in category revenue observed in the holdout sample. Table 3 reports the average bias in absolute value and standard deviation of these estimates for each model, where the averaging is done across products.
Estimates from the unrestricted model exhibit less bias but larger variance than those from the separable model with fixed n. The larger variance is an artifact of the number of parameters in the unrestricted model. When n is estimated; however, the bias relative to the unrestricted model disappears and we still retain the relative gains in efficiency.
7. Discussion
This paper develops a methodology that can be used to learn about the separable structure of demand from store-level scanner data. Traditional work on separable demand has treated the partitioning of products as fixed. Instead, we let the partition be a model

Table 3. Effect of Price Promotions on Category Revenue

Model
Unrestricted Separable, fixed n Separable, estimated n
Note. SD, Standard deviation.

Bias
0.051 0.058 0.051

SD
0.055 0.026 0.026

708

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

parameter that can be estimated and propose a Bayesian method of joint inference for the partition and other demand parameters. An immediate benefit is that we are able to use the data to find potentially less obvious grouping structures.
Using data from two distinct product categories, we find that the separable structure of demand can be markedly different from predefined category labels. For example, in the juice category, we find that multiple flavors are often present within demand groups, suggesting that the demand is not separable by flavor. This result also suggests that the boundary of competition between subcategories like apple and orange juice may extend beyond that which is defined by subcategory labels. We then show how misspecifying these boundaries impacts inference for product competition and promotion effects.
There are limitations of the current work that serve as a motivation for possible extensions. For example, our treatment of aggregate demand ignores many important aspects of consumer choice, such as store choice, category choice, purchase timing, and household inventories. Ideally, we would derive aggregate demand from a micro-model of utility maximization to account for these factors. However, this becomes challenging when the underlying utility deviates from an additively separable structure. We also used a store-level demand system that does not attempt to formally model the distribution of consumer preferences. If consumers are heterogeneous in the partitions that define their separable preferences, then some of the nonseparabilities we find at the store level could be due to this source of heterogeneity. However, it is well known that consumer heterogeneity is only weakly identified with aggregate data. It remains to be investigated whether heterogeneity in separability-based groupings of products can be identified using even relatively disaggregate storelevel data.
Our work may also have implications for formal retailer pricing policies. Traditionally, retailers are assumed to set prices by maximizing category profits, where categories are defined at a more disaggregate level, such as orange juice (e.g., Montgomery 1997, Dubé et al. 2008). However, our results suggest demand may not be separable across categories like apple and orange juice, especially in the presence of strong multiproduct national brands. Formalizing the consequences on coordinated pricing with nonseparable category demand remains an open area for future work.
Finally, we have shown that both the structure of the log-linear model and the sheer dimension of the partition space both limit the scalability of our model. At the same time, very high-dimensional product sets are becoming more common in empirical work, so it

would be useful to see how the core dimension reduction offered by separability can be used when the product space is extremely large. To the extent that separability can formally connect flexible and scalable statistical models with economic theory, this extension will be especially relevant when firms want to estimate demand parameters for the purpose of optimizing marketing actions. We leave these topics for future research.

Acknowledgments The authors thank the senior editor, associate editor, and two anonymous reviewers for their insightful comments. The authors' analyses were calculated (or derived) based in part on data from the Nielsen Company (US), LLC and marketing databases obtained through the Nielsen Datasets at the Kilts Center for Marketing at the University of Chicago Booth School of Business. The conclusions drawn from the Nielsen data are those of the researchers and do not reflect the views of Nielsen. Nielsen is not responsible for, had no role in, and was not involved in analyzing and preparing the results reported herein.

Appendix A. Separability Restrictions for

Price Elasticities

Let Sij

qi pj

+

qj

qi m

denote

the

effect

of

a

unit

increase

in

the

price of good j on the compensated (Hicksian) demand of

good i. Weak separability imposes a restriction on cross-

group compensated price effects; that is, if i and j are in

different groups, then

Sij

k

(q)

qi m

qj m

.

(A.1)

Because log-linear demand models are parameterized in terms of uncompensated price elasticities (i.e., elasticities with respect to Marshallian demand functions), we need to translate the restriction on Sij intro a restriction on ij. We first rewrite the original separability restriction in terms of expenditure elasticities:

Sij

k

(q)

qi m

qj m

k (q) m

·

qi/qi m/m

·

qj/qj m/m

·

qiqj m

k (q) m

i

j

qiqj m

k

(q)ij

qiqj m

.

(A.2) (A.3) (A.4) (A.5)

We make the further assumption that the function k (q) only contains an intercept term and is thus independent of demand: k (q) k . Then, by the elasticity form of the Slutsky equation, it follows that

Sij

·

pj qi

ij + iwj

 k

ij

qiqj m

·

pj qi

ij + iwj

 k

ij

qjpj m

ij + iwj

 ij wj(k ij - i).

(A.6)
(A.7) (A.8)

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

709

Appendix B. Details for the Conditional Posterior of n
To derive the posterior distribution of n conditional on all other parameters and data, we first isolate n and rewrite
the model in (20) as

y X(n, ; P, w)n + ,

(B.1)

where y y - c(n, ;P,w) - M - Z and   N(0,   IT). Although X(·) is not block diagonal as in a standard SUR

model, the likelihood function still exhibits a SUR-like re-

presentation because of the vectorized response, expanded

mean function, and correlated errors. Next, we translate this system into a system of un-

correlated errors:

y~ X~ n n + ~,

(B.2)

where

 U U,
y~ ((U-1)  IT)y, X~ n ((U-1)  IT)X(n, ; P, w),
~ ((U-1)  IT),

(B.3) (B.4) (B.5) (B.6)

so that Var(~) ((U-1)  IT)(  IT)(U-1  IT) (U-1) U-1
IT In  IT. With a conditionally conjugate prior n |n  N(¯n , A- 1), the associated posterior takes the form

n |n, else  N(~ n , (X~ n X~ n + A)-1), where ~ n (X~ n X~ n + A)-1(X~ n y~ + A¯ n ).

(B.7)

Appendix C. Product Descriptions

Brand
Jams, jellies, and spreads 1. Jif 2. Skippy 3. Smucker's 4. Private Label (CTL BR) 5. Welch's 6. Smucker's 7. Smucker's Squeeze 8. Private Label (CTL BR) 9. Smucker's 10. Private Label (CTL BR) 11. Smucker's 12. Smucker's 13. Smucker's 14. Private Label (CTL BR) 15. Smucker's 16. Private Label (CTL BR) 17. Smucker's 18. Private Label (CTL BR) Juice drinks 1. Mott's 2. Simply Apple 3. Nestle Juicy Juice 4. Private Label (CTL BR)

Module
Peanut butter Peanut butter Peanut butter Peanut butter Jelly Jelly Jelly Jelly Jelly Jelly Jelly Jelly Preserves Preserves Preserves Preserves Preserves Preserves
Apple Apple Apple Apple

Submodule
Grape Grape Grape Grape Strawberry Strawberry Blackberry Raspberry Strawberry Strawberry Raspberry Raspberry Apricot Apricot

Appendix C. (Continued)

Brand

Module

Submodule

5. Tropicana

Orange

6. Simply Orange

Orange

7. Minute Maid

Orange

8. Private Label (CTL BR) Orange

9. Ocean Spray

Cranberry

10. Northland

Cranberry

11. Private Label (CTL BR) Cranberry

12. Welch's

Grape

13. Nestle Juicy Juice

Grape

14. Private Label (CTL BR) Grape

15. Ocean Spray

Grapefruit

16. Simply Grapefruit

Grapefruit

17. Private Label (CTL BR) Grapefruit

18. Minute Maid

Fruit drinks

19. Simply Lemonade

Fruit drinks

20. Country Time

Fruit drinks

21. Private Label (CTL BR) Fruit drinks

22. Minute Maid

Fruit drinks

23. Hawaiian Punch

Fruit drinks

24. Tampico

Fruit drinks

25. Private Label (CTL BR) Fruit drinks

26. Campbell's

Tomato

27. Red Gold

Tomato

28. Private Label (CTL BR) Tomato

29. V8

Other vegetable

30. V8 Splash

Other vegetable

31. V8 V-Fusion

Other vegetable

32. Private Label (CTL BR) Other vegetable

Endnotes
1 Smith and Allenby (2019) also apply their partitioning methodology to a multicategory demand setting. In their demand model, the partition identifies isolated product groups exhibiting zero cross-price effects. Although we utilize their random partition model, our work differs in that we focus on estimating separable demand models in which product groups have lower-dimensional, but not necessarily zero, cross-price effects.
2 In the separability literature, m is also commonly referred to as income (Goldman and Uzawa 1964). This is likely because early empirical work concurrent to the development of separability focused on estimating complete demand systems with product sets spanning the entire space of commodities (e.g., food, housing, clothing) and a binding budget constraint on income. However, modern UPClevel scanner data have allowed researchers to measure substitution patterns at a finer level of granularity for a subset of the commodity space (e.g., breakfast cereals). In these settings, partial demand systems are usually estimated in which the budget constraint binds on a preallocated monetary budget that need not be equal to income.
3 The distinction between blockwise additivity and additivity is also made in Pollak (1971) and Deaton and Muellbauer (1980, chapter 5.3).
4 Homogeneity is satisfied if j ij + i 0 i; Slutsky symmetry is satisfied if ijqi/pj + i jiqj/pi + j i, j; and negativity is satisfied if ii  iwi i. 5 For example, if n (1, 1, 1, 2, 2, 2), then n + k n2k + K(K - 1)/ 2 6 + 18 + 1 25, which exceeds the required 1 + n + k nk(nk + 1)/2 + K(K - 1)/2 1 + 6 + 12 + 1 20.
6 The model is not exactly a SUR model because the design matrix X(n, ; P, w) is not block diagonal. 7 A similar strategy is used to sample from the posterior of the standard Bayesian SUR model in the bayesm package (Rossi 2017) in R.

710

Smith, Rossi, and Allenby: Inference for Product Competition and Separable Demand Marketing Science, 2019, vol. 38, no. 4, pp. 690­710, © 2019 INFORMS

8 All posterior sampling functions are written using the Rcpp package (Eddelbuettel and François 2011) in R. 9 The data were provided by the Kilts Center for Marketing at the University of Chicago Booth School of Business. 10 Jams, jellies, and spreads include butter-fruit and honey, fruit spreads, garlic spreads, honey, jams, jelly, marmalade, peanut butter, preserves. Juice drinks include apple, cider, clam, cranberry, fruit drinks, fruit drinks (can), grape, grapefruit, grapefruit (can), lemon/lime, nectars, orange, orange (can), pineapple, prune, tomato, vegetable (other), and remaining. 11 We also computed 1 -  credible intervals for each k in the separable model with a fixed partition n. We found evidence of nonoverlapping credible intervals at the 10% level in the juice category and the 20% level in jams, jellies, and spreads. 12 See https://www.simplyorangejuice.com/faq. 13 Other definitions of promotions, such as a percentage reduction from the base price, did not induce any material changes to the results.
References
Bajari P, Nekipelov D, Ryan SP, Yang M (2015) Demand estimation with machine learning and model combination. Amer. Econ. Rev. 105(5):481­485.
Barten A (1964) Consumer demand functions under conditions of almost additive preferences. Econometrica 32(1­2):1­38.
Bell ET (1934) Exponential numbers. Amer. Math. Monthly 41(7): 411­419.
Berry ST, Levinsohn J, Pakes A (1995) Automobile prices in market equilibrium. Econometrica 63(4):841­890.
Blackorby C, Primont D, Russell RR (1977) On testing separability restrictions with flexible functional forms. J. Econometrics 5(2): 195­209.
Blackwell D, MacQueen JB (1973) Ferguson distributions via Po´ lya urn schemes. Ann. Statist. 1(2):353­355.
Byron R (1970) A simple method for estimating demand systems under separable utility assumptions. Rev. Econom. Stud. 37(2):261­274.
Chintagunta PK, Nair HS (2011) Structural workshop paper-- Discrete-choice models of consumer demand in marketing. Marketing Sci. 30(6):977­996.
Deaton A, Muellbauer J (1980) Economics and Consumer Behavior (Cambridge University Press, Cambridge, UK).
DellaVigna S, Gentzkow M (2019) Uniform pricing in US retail chains. NBER Working Paper 23996, National Bureau of Economic Research, Cambridge, MA.
Driscoll P, McGuirk A, Alwang J (1992) Testing hypotheses of functional structure: Some rules for determining flexibility of restricted production models. Amer. J. Agricultural Econom. 74(1):100­108.
Dubé JP, Hitsch GJ, Rossi PE, Vitorino MA (2008) Category pricing with state-dependent utility. Marketing Sci. 27(3):417­429.
Eddelbuettel D, François R (2011) Rcpp: Seamless R and C++ integration. J. Statist. Software 40(8):1­18.
Ferguson TS (1973) A Bayesian analysis of some nonparametric problems. Ann. Statist. 1(2):209­230.
France SL, Ghose S (2016) An analysis and visualization methodology for identifying and testing market structure. Marketing Sci. 35(1): 182­197.
Goldman S, Uzawa H (1964) A note on separability in demand analysis. Econometrica 32(3):387­398.

Gorman W (1959) Separable utility and aggregation. Econometrica 27(3):469­481.
Green PJ (1995) Reversible jump Markov chain Monte Carlo computation and Bayesian model determination. Biometrika 82(4):711­732.
Hitsch GJ, Hortaçsu A, Lin X (2017) Prices and Promotions in US Retail Markets: Evidence from Big Data. Working Paper 17-18, Booth School of Business, University of Chicago, Chicago.
Jacobs BJD, Donkers B, Fok D (2016) Model-based purchase predictions for large assortments. Marketing Sci. 35(3):389­404.
Jorgenson DW, Lau LJ (1975) The structure of consumer preferences. Ann. Econom. Soc. Measurement 4(1):49­101.
LaFrance JT (1986) The structure of constant elasticity demand models. Amer. J. Agricultural Econom. 68(3):543­552.
Leontief W (1947) Introduction to a theory of the internal structure of functional relationships. Econometrica 15(4):361­373.
Lindley D (1957) A statistical paradox. Biometrika 44(1­2):187­192.
McFadden D, Train K (2000) Mixed MNL models for discrete response. J. Appl. Econometrics 15(5):447­470.
Mehta N (2007) Investigating consumers' purchase incidence and brand choice decisions across multiple product categories: A theoretical and empirical analysis. Marketing Sci. 26(2):196­217.
Mehta N (2015) A flexible yet globally regular multigood demand system. Marketing Sci. 34(6):843­863.
Montgomery AL (1997) Creating micro-marketing pricing strategies using supermarket scanner data. Marketing Sci. 16(4):315­337.
Montgomery AL, Rossi PE (1999) Estimating price elasticities with theory-based priors. J. Marketing Res. 36(4):413­423.
Müller P, Quintana F, Jara A, Hanson T (2015) Bayesian Nonparametric Data Analysis, Springer Series in Statistics (Springer, Cham, Switzerland).
Pollak RA (1971) Conditional demand functions and the implications of separable utility. Southern Econom. J. 37(4):423­433.
Pudney SE (1981) An empirical method of approximating the separable structure of consumer preferences. Rev. Econom. Stud. 48(4):561­577.
Ringel DM, Skiera B (2016) Visualizing asymmetric competition among more than 1,000 products using big search data. Marketing Sci. 35(3):511­534.
Rossi PE (2017) bayesm: Bayesian inference for marketing/microeconometrics. R package version 3.1-0.1. https://cran.r-project.org/ web/packages/bayesm/index.html.
Rossi PE, Allenby GM, McCulloch R (2005) Bayesian Statistics and Marketing (John Wiley and Sons Ltd., West Sussex, UK).
Rubinfield DL (2000) Market definition with differentiated products: The Post/Nabisco cereal merger. Antitrust Law J. 68: 163­185.
Smith AN, Allenby GM (2019) Demand models with random partitions. J. American Statist. Assoc., ePub ahead of print June 4, https://doi.org/10.1080/01621459.2019.1604360.
Sono M (1961) The effect of price changes on the demand and supply of separable goods. Internat. Econom. Rev. 2(3):239­271.
Thomassen Ø, Smith H, Seiler S, Schiraldi P (2017) Multi-category competition and market power: A model of supermarket pricing. Amer. Econom. Rev. 107(8):2308­2351.

