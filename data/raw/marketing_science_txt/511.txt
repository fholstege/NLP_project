CELEBRATING 30 YEARS
Vol. 30, No. 4, July­August 2011, pp. 686­701 issn 0732-2399 eissn 1526-548X 11 3004 0686

doi 10.1287/mksc.1110.0644 © 2011 INFORMS

Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

Thomas Otter
Goethe University, 60054 Frankfurt am Main, Germany, otter@marketing.uni-frankfurt.de
Timothy J. Gilbride
Mendoza College of Business, University of Notre Dame, Notre Dame, Indiana 46556, tgilbrid@nd.edu
Greg M. Allenby
Fisher College of Business, Ohio State University, Columbus, Ohio 43210, allenby_1@osu.edu
Marketing expenditures in the form of pricing, product development, promotion, and channel development are made to maximize profits. A challenge in evaluating the effectiveness of these expenditures is that decisions such as whether to lower prices or run promotions are made based on managers' knowledge of how sensitive consumers are to these marketing activities. Although marketing control variables are explanatory of sales, they are often set in anticipation of a market response, which reflects strategic behavior on the part of a firm. A challenge in developing a model of strategic behavior is that the process by which marketing expenditures are made is often not directly observable. We propose tests for comparing supply-side model formulations in which input variables are strategically determined. In these models, the joint likelihood of demand (y) and supply (x) can be factored into a conditional factor of demand given supply and into a marginal factor of supply. We illustrate our approach using data from a services company that operates in multiple geographic regions.
Key words: structural models; Bayesian analysis; Bayes factors; model selection History: Received: November 30, 2009; accepted: January 24, 2011; Eric Bradlow and then Preyas Desai served
as the editor-in-chief and Michel Wedel served as associate editor for this article. Published online in Articles in Advance June 6, 2011.

1. Introduction
A growing literature on the supply-side behavior of firms recognizes the endogeneity of marketing variables. Expenditures in support of product, promotion, price, and channel initiatives are often made by firms to maximize profits by responding to individual wants, attracting new customers, and increasing sales and profits. Marketing mix variables become endogenous whenever they are determined, in part, by parameters that are present in the demand model. As pointed out by many authors, the endogeneity of explanatory variables such as prices can lead to inconsistent parameter estimates in standard models that simply condition on marketing mix variables (Chamberlain 1984, Villas-Boas and Winer 1999, Bronnenberg and Mahajan 2001, Manchanda et al. 2004, Dong et al. 2009).
An elegant way to address this endogeneity problem motivates the observed realizations of explanatory marketing variables through a model reflective of firms' goal-directed behavior. We generically refer to the behavior of firms as the "supply-side" model or simply as the supply model. In these models, a firm's goal-directed behavior is assumed

to proceed conditional on knowledge about unobserved demand-generating parameters formally linking the demand and supply models. The econometric endogeneity problem can be resolved by jointly fitting the demand and supply models (e.g., Reiss and Wolak 2007).
Models that include a supply-side story have made significant inroads in marketing. It is hard to embrace the premise that marketing mix variables are set randomly as in an experiment or by a process that is independent of expected outcomes. However, these models rely on very specific assumptions about the knowledge set and optimizing behavior of firms when they set prices, levels of advertising, etc. The resulting models are frequently elegant and parsimonious while providing measures of economic interest. In principle, a direct empirical investigation of managers' decision protocols and knowledge sets is desirable to support or critically question the assumptions made. Without this information, the supply-side model needs to be carefully tested. Testing of the supply-side model is crucial for the research to have empirical content beyond the calibration of parameters for a model assumed to be true a priori.

686

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

687

However, the evaluation of supply-side models is difficult for two reasons: (i) data are limited, and (ii) tests have concentrated on joint fit of the demand and supply data, not on the congruence of these data for explaining common parameters. In this paper, we develop a Bayesian test of the supply-side model, building on the intuition that if the supply-side model is correct, then its inclusion should not only lead to more plausible parameter estimates but also more accurate predictions than using the demand model only. Our test facilitates the statistical comparison of models with and without a supply-side specification and automatically accounts for the fact that the presence of a supply-side model necessarily reduces the maximized fit of the demand-side data. The ultimate test for any model, of course, is whether the effects from causal interventions (such as changes in demand after an exogenous price change) are correctly predicted.1 However, the more we can say about different supply-side formulations before moving to the ultimate test of implementing a derived policy recommendation, the more we can hope to contribute through research before costly experiments.
The remainder of this paper is organized as follows. Section 2 discusses the scope of our test and gives modeling examples. Section 3 discusses Bayesian tools for model testing. Performance of the methods developed is illustrated in §4 through a simulation study. Section 5 applies the methods to data from a services firm that operates in multiple geographic areas. Concluding remarks are offered in §6.

2. Models of Strategic Behavior with
Conditional Likelihoods
Our tests are developed for models where the likelihood of inputs x (i.e., supply) and outputs y (i.e., demand) can be factored into a conditional likelihood of outputs given inputs and into a marginal likelihood of the inputs:

y x x y xy

= y x y xy × x x xy

(1)

where y are parameters uniquely found in the demand equation, x are parameters found only in the supply equation, and x y are shared parameters. An example of y is the scale parameter of the error term in the demand equation, whereas x y might be a coefficient reflecting price sensitivity. Equation (1)
implies that the model for the inputs, or supply-
side variables (x), depends on the expectation of
demand as predicted by model parameters ( x, x y and not on their realized value (y). This factorization
is typically not present in models where inputs (x)

1 See Misra and Nair (2009) for an impressive validation of a structural model through the actual implementation of a derived policy.

and outputs (y) are simultaneously determined, as Equation (1) implies a sequencing of variable determination--first x is determined, and then y is realized given x.
Strategic behavior means that the likelihood of supply, x x x y , reflects some goal-directed behavior on the part of management (Chintagunta et al. 2006) such as that encountered in the maximization of profits. In general, the supply variables are marketing variables (4Ps) invested to maximize immediate profits or some form of infrastructure that makes this goal easier in the future.
The factorization in Equation (1) is present in empirical industrial organization models (see Yang et al. 2003), where x x x y is implied, e.g., by an equilibrium resulting from rational competitive behavior conditional on public and private information that includes knowledge about demandgenerating parameters. However, in the following we will confine our discussion to monopolistic situations where marketing control variables are set in anticipation of sales and other outputs without taking competitive reactions into account (e.g., Manchanda et al. 2004). We will revisit these models in the concluding section.

2.1. Monopolist Pricing To illustrate, consider a monopolist pricing problem using a constant elasticity model, where it is assumed that the variation in prices over time is due to stochastic departures from optimal price-setting behavior. The joint likelihood for the data is a combination of a traditional demand model:

ln yt = 0 + 1 ln pt + t

tN 0 2

(2)

and a factor for the endogenous price variable. Profit-maximizing pricing for a monopolist can be shown to be

pt = mc

1
1+ 1

et

tN 0 2

(3)

where mc denotes the marginal cost of the brand, and

a supply-side error term has been added to account

for a temporal variation of observed prices from the
optimal price. In this example, y = 0 2 , x = 2, and x y = 1.
The supply-side error term in Equation (3) has a

structural interpretation as a (perceived) cost shifter.

Observed prices are set as if marginal costs varied

over time, suggesting that the supply-side error real-

izations are known to the decision maker. However,

the supply-side errors are not part of the data and

thus are unobservable to the analyst. Taking logs of

Equation (3) yields

ln pt = ln mc + ln

1
1+ 1

+t

tN 0 2

(4)

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

688

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

The supply-side equation (4) can be used to help locate the value of 1 if the marginal cost is known. It also implies, through the second-order conditions of the optimization problem, ordinal constraints on the model parameters--i.e., 1 < -1 for a positive, finite price at a profit maximum. Optimal pricing behavior for the monopolist only exists when own-price effects are elastic. The supply-side equation (4), derived from first-order conditions, influences estimation in line with assuming a profit maximum at positive, finite prices, even when marginal costs are not known. This is because the error term is structurally confined in that it cannot be used to explain managers' lack of knowledge about the response coefficients, such as mistaking inelastic demand for elastic demand. From Equation (3), we can see that the error term t can only expand or contract the ratio B1/ 1 + B1 . The supply-side equation can therefore impart a great deal of information for decision making, even when costs are not observed. It is therefore important to have methods for developing and assessing the validity of supply-side models.
Equations (3) and (4) are not the only explanation of how prices could be set in this stylized example. An alternative and more common formulation involves the presence of an omitted variable, t, that creates correlation between demand and prices:

ln yt = 0 + 1 ln pt +

t+

 t

t=

t+

 t

pt = mc

1
1+ 1

e

t+

 t

t=

t+

 t

(5)

t N 0
t

The omitted variable t increases demand and marginal costs exponentially and is assumed known in advance to the agent setting prices. In this model, price variation is due to the omitted variable as opposed to just variation in marginal costs as in (3). For example, demand for hotel rooms increases exponentially over the weekend of a popular football game and so do marginal costs because of overtime for staff. In this situation, the hotel can pass on these higher costs through higher room rates in anticipation of a peak in demand.
As shown by Yang et al. (2003), by conditioning on t, we can write the likelihood as in Equation (1), and the Bayesian method of data augmentation can then be used to integrate over the distribution of t. Thus, certain models traditionally viewed as simultaneous can often be recast with a conditional likelihood function considered in this paper. The key difference is whether prices are set in anticipation of a market outcome versus being driven by realized demand. The former implies a recursive system between the

supply-side variables and demand--e.g., t reflects information used to set prices--and once prices are set, demand is then realized.
A third explanation for variation in prices over time could be due to anticipated variation in price elasticity through time:

ln yt = 0 + 1 t ln pt + t

pt = mc

1t
1+ 1 t

e

t

(6)

t N 0 I
t
where I represents the 2 × 2 identity matrix, and we note the time (t) subscript for the price coefficient. From Equations (3)­(6), it is evident that multiple goal-directed explanations for the data exist, each with possibly different implications about optimal price-setting behavior. Price variation as a result of random variation in costs leads to different prices but the same percentage markup, whereas price variation as a result of variation in the price elasticity itself implies variation in the optimal markup. Our goal is to develop ways to understand which explanation of the data is correct, including the possibility that none of the goal-directed formulations under investigation applies.

2.2. Cobb-Douglas Production and Optimal Allocation
For a supply-side model to be goal directed, it must involve aspects of the demand model as reflected though the shared parameters x y and the first-order conditions associated with some criterion function (e.g., profits) that the firm wishes to maximize. As a second example, we develop a constrained allocation problem in the context of a Cobb-Douglas production function, allowing us to consider multiple interacting input variables.
Many authors have used the Cobb-Douglas function in marketing--Misra et al. (2005) posits a hierarchical model structure to account for district and regional effects in decomposing salesforce technical effects, Horsky and Nelson (1996) propose a method for benchmarking sales response, Carroll et al. (1979) investigate preferences for leisure time, Morey and McCann (1983) study optimal lead generation from advertising, and Mantrala et al. (1992) compare allocation rules for various concave functions to top-down budgeting practices at firms. None of this literature, however, acknowledges the possibility that if a firm allocates inputs with even an implicit understanding of market response, then both input and output variables are dependent on the same model parameters, x y. Thus, these previous methods that condition on the inputs are prone to misspecification. The

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

689

models illustrated next resolve the simultaneity by incorporating the first-order conditions for optimally allocating marketing expenditures. Outside of marketing, researchers have used variants of the CobbDouglas production function together with first-order conditions to assess technical and allocative efficiency (Zellner et al. 1966).
We begin by considering general first-order conditions. Optimal allocation occurs when the marginal effect of an additional input unit per unit cost (e.g., dollar of expenditure) is equal across the decision units. Optimal levels (x) can be determined by forming the auxiliary production function (L) that includes the budget constraint and Lagrangian multiplier ( , by taking derivatives, and by solving the system of equations that arises from the identities L/ xi = L/ xk = L/ = 0 for x. These equations lead to the allocation rule that marginal output divided by input prices (p) should be the same across inputs:

y/ xj y/ xk pj = pk

for all j and k

(7)

where the subscripts j and k refer to different input variables, and pj denotes the price of input j. Equation (7) can be used to specify a system of equations that reflect goal-directed behavior, and it pertains to situations where the objective function is proportional to the output measure. Consider a standard CobbDouglas production function and associated firstorder conditions:

y = 0x1 1 x2 2

=

y/ x1

1

p1 = p1

0x1 1-1x2 2

(8)

=

y/ x2

2

p2 = p2

0x1 1 x2 2-1

Taking logs and rearranging terms, we have

ln y = ln 0 + 1 ln x1 + 2 ln x2

ln x = ln x1 = 1 - 1

-1 2

ln x2

1

2-1

(9)

ln - ln 0 - ln 1 + ln p1 ·
ln - ln 0 - ln 2 + ln p2

We note that Equation (9) is not the only model of strategic behavior that could be considered. Our goal is to test alternative models, including the possibility of the simple conditional demand model.

2.3. Structural Error Terms Observed deviations from optimal allocations are accommodated by associating error with the optimal allocation rule in (7). For example, errors ( could be structurally associated with input prices, i.e., pj = pj e j , assuming that Equation (7) holds exactly for pj

replaced by pj. In this case, the unobservable ( is an argument in the optimization problem, suggesting
that ( is observed by the decision maker and is open
to a structural interpretation.
Updating Equation (9) by adding additive observation2 error ( i to the demand equation, and assuming that inputs are allocated based on pi = pe i rather than p, leads to estimation equations:

yi =

0

x1

1
i

x2

2
i

+

i

ln xi =

ln x1i ln x2i

=

1-1
1

-1 2
2-1

(10)

ln -ln 0 -ln 1 +lnp1 + 1i ·
ln -ln 0 -ln 2 +lnp2 + 2i

This system is just identified for known and prices, and repeated observations allow estimation of all model parameters. When input prices are missing, the assumption of constant input prices identifies the allocation errors. Alternatively, prior restrictions on the allocation errors can identify unobserved input prices. Variation in the input variables is entirely due to factors known to the decision maker but not observed by the analyst (i.e., allocation errors). By rearranging the equation that generates the inputs and applying the change of variable theorem, we see that the solution space for the parameters of the production function is bounded away from the region of constant marginal returns for any distribution of ( :

1i

1-1

2

ln x1i

i=

=

2i

1

2 - 1 ln x2i

ln - ln 0 - ln 1 + ln p1 -

(11)

ln - ln 0 - ln 2 + ln p2

J ln x i = 1 - 1 2 - 1 - 1 2

ln xi

=

i g J ln xi

The Jacobian term evaluates to zero for constant marginal returns. This rules out continuous moves from the solution space with diminishing marginal returns to the solution space with increasing marginal returns. Also, different from the simple ordinal constraint 0 < 1 + 2 < 1 0, the density of positive allocations decreases continuously in the direction of either boundary.
It is important to note that a flat prior for the allocation error does not automatically translate into a flat

2 We use additive instead of the more common multiplicative error structure. The multiplicative error structure is often chosen to facilitate estimation. However, in most marketing applications, zero inputs (e.g., no advertising in the current period) do not necessarily translate into the zero output implied by multiplicative errors. Additive errors capture this fact.

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

690

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

posterior from the supply-side model. For example, the likelihood for the inputs implied by the structural errors in Equation (11) becomes informative as the response coefficients approach constant returns to scale; i.e., 1 + 2 = 1. For a flat distribution i , the likelihood of the log inputs is proportional to the Jacobian term with a minimum ridge corresponding to the set of parameters that imply constant returns to scale:

ln xi  1 - 1 2 - 1 - 1 2

(12)

The structural interpretation of an unobservable is tightly linked to what cannot be explained by any possible realization of that unobservable. This was illustrated with the monopolist pricing example, where no realization of t in Equation (3) could lead to managers mistaking inelastic demand for elastic demand. Replacing the input prices p by p in Equation (7) retains the assumption that an interior allocation optimum exists and thus puts zero prior probability on managers mistaking constant or increasing marginal returns for decreasing marginal returns.
This is an example of how some measure of "rationality" is assumed in the model. A structural supplyside model helps locate parameters within the region that is consistent with interior optimal solutions. We develop a test to determine to what extent the assumed measure of rationality is empirically supported by the data that complement essentially a priori arguments based on face validity. However, the question of whether the unobservables reflect allocation errors or material private information held by the managers has to be judged on grounds other than observed inputs (x), outputs (y), and empirical fit.

2.4. Descriptive Supply Models An alternative approach is to formulate a descriptive supply-side specification that can impart minimal influence on common parameters x y = 0 1 2 if the data indicate. Such an approach is proposed by Manchanda et al. (2004), who introduce additional parameters in the supply-side model that, when zero, nullify the effect of the supply side on x y. It turns out, however, that this result (i.e., a descriptive supply model being directionally consistent with output increases) is rather unique and is driven by the chosen response function, which has only one input and nondecreasing marginal returns. When multiple inputs are present and interact with each other, the optimal allocation of a single input does not necessarily increase with an increase in output.
Consider three units producing according to different Cobb-Douglas specifications:

y1 = x1016x2011

y2 = x1021x2026

(13)

y3 = x10345x20345

Table 1

Optimal Allocation to Three Heterogeneous Cobb-Douglas Production Units

=04

= 0 44

=05

Unit Input 1 Input 2 Input 1 Input 2 Input 1 Input 2

1

2 13

0 35

1 55

0 26

1 01

0 17

2

0 35

2 13

0 26

1 55

0 17

1 01

3

3 25

3 25

1 25

1 25

0 35

0 35

Setting input prices to 1, we obtain the optimal allocations in Table 1 for less and more attractive outside investment options, represented by smaller and larger Lagrangian multipliers ( .
With the least attractive outside option ( = 0 4) investigated here, unit 3 in Table 1 receives the highest allocations along both inputs even though it does not have the (individually) highest coefficients. When the attractiveness of the outside option is increased ( = 0 44), the optimal allocation suggests a different ordering. Now, unit 1 receives the highest input 1 and unit 2 the highest input 2. The sum of the two inputs is still maximal for unit 3. When the attractiveness of the outside option increases further ( = 0 5), the sum of the two inputs is now the smallest for unit 3. This simple example illustrates the difficulty in extending the notion of a descriptive supply-side model of strategic behavior where the inputs interact.
We develop an empirical test of the supply-side formulation for this and similar situations where a directionally consistent descriptive supply-side formulation is not available and where a (necessarily) directionally consistent supply-side model derived from first-order conditions cannot revert to a neutral state of zero influence on the demand side.

3. Bayesian Tests of Strategic Behavior

In this section, we discuss Bayesian tests of strate-

gic behavior for likelihoods of inputs (x) and outputs

(y) that can be factored as in Equation (1). A sim-

ple approach to drawing inference about the supply-

side model is to compare predictive densities from

posteriors informed by different subsets of the data.

One comparison would be the predictive fit of hold-

out demand data (yh) using the supply-side variables

(xh, x ) to help inform the posterior distribution, i.e.,

yh xh

y d versus

yh xh

y x d and

yh xh

y x xh d

(e.g., Manchanda et al. 2004). The model for the inputs is supported if

yh xh

yd

<

yh xh

yxd

(14)

<

yh xh

y x xh d

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

691

That is, predictions based on a demand model are worse than predictions that successively use more information about gleaned from the supply-side model. Although this approach can be used to compare different prior specifications for the supply side including the special case without a supply side, it requires sufficient data so that a reasonably sized holdout data set can be created. For example, Dong et al. (2009) estimate their model with 11 consecutive quarters of individual-level data, leaving only the 12th for the holdout sample. We view the possibility of a direct comparison to an agnostic conditional model as essential because the joint fit of the demand and the allocations may be masking the event that the allocation model is negatively affecting the fit of the response data. We now propose a way to achieve this comparison in small data sets that do not allow for extensive holdout samples.
We introduce a new method of testing by first specifying the prior distribution of model parameters in (1) as having independent factors that facilitate the comparison of the joint model to the conditional demand model:

y x xy =

y

x

xy

(15)

The joint marginal likelihood of inputs and outputs in (1) is then

y x y xy · xy d y x

xx
xy = =

xy

y

y x Mf y x Mf

x
(16)
x Mf

and the conditional marginal likelihood is given by

y x y xy

y

xy d y xy

= y x Mc

(17)

Our goal is to assess the reasonableness of the
supply-side specification by comparing an estimate
of y x Mf from (16) to y x Mc from (17). Estimates of y x Mf can also be used to assess the relative merits of different supply-side formula-
tions, which gives rise to different joint models Mf . If the supply model is misspecified, then the conditional
marginal density of y x Mf will be smaller than the corresponding estimate of y x Mc . Also, if a particular supply-side formulation is better supported
by the demand data, the corresponding y x Mf will be larger than that of another full model derived
with a different supply-side story.
We derive two estimators for y x Mf . The first provides a direct estimate of y x Mf similar to the Newton and Raftery (1994) estimator. The second
is an indirect estimator based on the identity y
x Mf = y x Mf / x Mf , the building blocks

of which are estimated following Gelfand and Dey (1994). The advantage of the direct Newton­Raftery (NR) estimator is that it can be very easily computed and understood. A disadvantage is that it can suffer from the same simulation bias as discussed by Lenk (2009) in the context of estimating y x Mc . The indirect Gelfand and Dey (GD) estimator is computed as the ratio of two normalizing constants. The advantages of the indirect estimator are that it is more accurate and it is always pointed to the correct model in our simulations (see §4). A disadvantage of the indirect estimator is that it is harder to compute.
The direct NR-style estimator derived in Appendix A is defined as

y x Mf =

1 y x y xy

y x y xy x x xy

x

y

·

yx x

-1
xy d x y xy

(18)

This results in the following approximation based on an Markov chain Monte Carlo (MCMC) sample from the (marginal) posterior from the full model:

1M y x Mf  M m=1

yx

m y

-1
m -1 xy

(19)

that is, the estimator simply averages the inverse of the conditional likelihood of the demand data evaluated at parameter draws from the full model, which includes the supply side.
A practical caveat to this particular estimator of y x Mf , not to the underlying theory, is Lenk's (2009) demonstration of simulation bias in the NR approximation because of the practically limited support of MCMC samples from (concentrated) posterior distributions relative to their theoretical support and that of the prior. The proposed estimator will suffer from similar practical problems as documented by Lenk (2009) if the prior on parameters only informed by the demand model, i.e., y in our generic notation, is much more diffuse than its posterior counterpart y y x) or if the information contributed to the posterior by the demand-side model outweighs the information contributed by the supply-side model disproportionally. We therefore construct an alternative, indirect estimator of the marginal conditional density y x Mf using the identity y x Mf = y x Mf / x Mf . Reliable estimates of y x Mf and x Mf are obtained following Gelfand and Dey (1994). The GD method also relies on the posterior represented in the form of MCMC draws as an integrating density. In addition, it uses the posterior to calibrate suitably thin-tailed normalized importance densities

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

692

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

q to be used in the generic expression (see also Rossi et al. 2005, Chapter 6):

data Mi

q

-1

=

data Mi

Mi

data Mi d

(20)

The calibration of the normalized importance densities q from the posterior, incorporating possible constraints from the supply side, avoids the practical and theoretical problems of the NR-style estimator. Details for estimating (20) are in Appendix A.

4. Simulation Study

We demonstrate the potential of our proposed test

statistic using two simulation studies. The first study

involves simulated data from the monopolist pric-

ing example discussed. The second study examines

the performance of the test statistic using the Cobb-

Douglas function in Equation (10) and anticipates

analysis performed in our empirical application.

The first simulation study examines the sensitivity

of the test statistics to alternative supply-side specifi-

cations. Priors are specified as being relatively diffuse

but proper across the models, with the prior on coef-

ficients in Equation (2) set to N 0 100 and the prior

on variance terms set to Inverted Gamma 3 0 1 ×

3 - 1 ). We investigate four different data-generating

mechanisms:

i. Demand only. A standard regression model

as in Equation (2) with prices generated from

Gamma 30 15 and

2 

=

2 = 0 1.

ii. Demand + Supply, random costs. A joint model

with price variation as a result of observed cost varia-

tion distributed Gamma 30 15 , unobserved cost vari-

ation in Equation (4) with

2 

=

2 = 0 1, and the same

demand error variance as in (i) above.

iii. Demand + Supply, common shocks. A joint model

with price variation as a result of observed cost vari-

ation as above, plus common shocks as in (5) with

a variance of 2 = 0 50, implied demand and supply

error variances

2=

2 

+

2 = 0 6,

2=

2 

+

2 = 0 6,

and an implied correlation of 0.83 between demand-

and supply-side errors.

iv. Demand + Supply, time-varying elasticity. A joint

model with price variation as a result of observed cost

variation as in (ii) above, temporal random effects as

in (6) with 1 t  N -2 0 15 , and demand and sup-

ply error variances

2 

=

2 = 0 1,

2 

=

2 = 0 1.

We simulate a year's worth of weekly data from

each data-generating mechanism and fit four mod-

els to each data set: (i) a demand-only model, (ii) a

demand and supply model with random cost shocks,

(iii) a demand and supply model with common

shocks on top of random cost components, and (iv) a

demand and supply model with time-varying elasticities indentified through the supply side. We collect parameter estimates from all models fitted to all of the four data-generating mechanisms in Table 2. The corresponding test statistics are presented in Table 3.
When the data-generating mechanism matches the model, on the diagonal of Table 2, parameters are correctly recovered. When the data are generated from a conditional model where the prices do not contain any information about unobservables in the demand model, adding any of the three candidate supply-side models results in severe biases. Note that the datagenerating price elasticity is -0.7 and in the inelastic range, but adding any of the three supply-side models forces the elasticity into the elastic range. Without access to the formal test we propose, we believe that many researchers would be tempted to accept one of the joint models based on presumed plausibility of elastic demand.
When the data are generated from a joint model, fitting the conditional model that only considers the demand side will result in elasticities that are (absolutely) too small. The exception is the joint model, where only random cost shocks cause temporal price variation. With this data-generating mechanism, consistent inferences from a demand-only model are possible because parameters driving price variation are orthogonal to parameters in the demand model.
Table 3 shows that the proposed test statistic ln y x M , estimated from MCMC output using the indirect GD estimator, identifies the correct model in every case (along the diagonal of Table 3). It correctly rejects all supply-side models when the data are generated from a simple conditional model, debunking the increased face validity from adding any of the supply-side stories. It correctly rejects the demandonly model when the data were generated with a supply side and identifies the data-generating formulation. When consistent inferences are possible from the demand-only model such as in the case of random cost shocks, the test statistic correctly picks up the increased efficiency from adding the correctly specified supply-side.
Comparing estimates from the direct (NR) and the indirect estimator (GD), it seems that the direct estimator may be too optimistic, which is in line with the results in Lenk (2009). More importantly, the direct (NR) estimator of ln y x M incorrectly points to the model with time-varying elasticity, which is much larger in dimensionality when the data are generated with random costs.
Our second simulation study investigates whether the proposed test statistic can detect the (lack of) contribution of a formal allocation model in the context of Cobb-Douglas production functions. We investigate three different data-generating mechanisms. In

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

693

Table 2 Parameter Estimates: Monopolist Pricing Example, Posterior Mean

Parameters True values

Demand only

Demand + Supply, random costs

Demand + Supply, common shocks

Demand + Supply, time-varying elasticity

n
1
Var[ 1] Var[ ] Var[v ] Var Corr[ v ]

1 00 -0 70
0 00 0 10 NA NA NA

Data generation: Demand only

0 95 (0.119)a 2 26 (0.192)

2 72 (0.105)

-0 58 (0.145) -2 30 (0.231)

NA

NA

-2 29 (0.168) NA

0 10 (0.019) 0 37 (0.106)

0 15 (0.052)

NA

0 41 (0.116)

0 06 (0.028)

NA

NA

0 41 (0.099)

NA

NA

0 79 (0.058)

n
1
Var[ 1] Var[ ] Var[v ] Var Corr[ v ]

1 00 -2 00
NA 0 10 0 10 NA NA

Data generation: Demand + Supply, random costs

0 91 (0.193) 0 91 (0.127)

1 22 (0.142)

-2 01 (0.137) -2 01 (0.084)

NA

NA

-2 30 (0.120) NA

0 14 (0.027) 0 17 (0.026)

0 10 (0.030)

NA

0 12 (0.023)

0 08 (0.026)

NA

NA

0 11 (0.030)

NA

NA

0 57 (0.078)

n
1
Var[ 1] Var[ ] Var[v ] Var Corr[ v ]

1 00 -2 00
NA 0 10 0 10 0 50 0 83

Data generation: Demand + Supply, common shocks

-0 14 (0.117) -1 11 (0.084)
NA

0 38 (0.124) -1 55 (0.076)
NA

1 05 (0.095) -2 00 (0.085)
NA

0 22 (0.043) 0 33 (0.074)

0 14 (0.046)

NA

0 78 (0.174)

0 08 (0.042)

NA

NA

0 53 (0.113)

NA

NA

0 83 (0.041)

n
1
Var[ 1] Var[ ] Var[v ] Var Corr[ v ]

1 00 -2 00
0 15 0 10 0 10 NA NA

Data generation: Demand + Supply, time-varying elasticity

0 19 (0.197) 0 80 (0.128)

1 16 (0.130)

-1 33 (0.136) -1 78 (0.079)

NA

NA

-2 06 (0.117) NA

0 21 (0.041) 0 25 (0.051)

0 12 (0.035)

NA

0 26 (0.051)

0 07 (0.028)

NA

NA

0 22 (0.054)

NA

NA

0 70 (0.066)

aPosterior standard deviation.

2 37 (0.193) -2 50 (0.243)
0 11 (0.064) 0 36 (0.110) 0 35 (0.096)
NA NA
1 00 (0.111) -2 09 (0.087)
0 06 (0.016) 0 06 (0.023) 0 12 (0.024)
NA NA
0 49 (0.111) -1 71 (0.091)
0 08 (0.029) 0 25 (0.064) 0 56 (0.129)
NA NA
1 02 (0.08) -2 01 (0.077)
0 11 (0.027) 0 05 (0.017) 0 13 (0.028)
NA NA

Table 3 Test Statistics: Monopolist Pricing Example

Demand only

Demand + Supply, random costs

Demand + Supply, common shocks

Demand + Supply,
time-varying elasticity

ln y x M GD NR

Data generation: Demand only

-23 37 -15 61

-93 77 -67 44

-71 63 -43 06

-94 32 -60 67

Data generation: Demand + Supply, random costs

ln y x M GD -34 06 NR -25 38

-28 84 -24 30

-32 19 -25 44

-29 39 -18 81

Data generation: Demand + Supply, common shocks

ln y x M GD -48 14 NR -37 48

-66 11 -53 27

-41 33 -34 01

-63 59 -49 36

Data generation: Demand + Supply, time-varying elasticity

ln y x M GD -74 06 NR -62 90

-77 13 -68 63

-70 65 -61 98

-56 99 -38 42

the first data-generating mechanism, the observed allocation does not contain any additional information about unobservables in the demand model (the allocation is exogenous). The second data-generating mechanism allocates endogenously following Equation (10). However, the variance in the allocated inputs is exogenously driven by independent supply-side errors only, i.e., there are no missing input factors, so that the true model has a fixed, non-heterogeneous intercept. Finally, the third data-generating mechanism has inputs optimally allocated according to Equation (10), with near-zero allocation error--i.e., V i = 1 0 × 10-6I and differences between production units through heterogeneity in the multiplicative constant unobserved by the analyst. We simulate 21 observations from each of the three data-generating mechanisms, the same number of observations as in our empirical application reported in this paper.

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

694

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

Table 4 Parameter Estimates: Cobb-Douglas Allocation Example

Parameters

True values

Demand only

Demand + Supply fixed effects

ln 1 ln 2 E0 Var 0 ln 1 ln 2 Var 1 Cov 1 2 Var 2
2
ln 1 ln 2 E0 Var 0 ln 1 ln 2 Var 1 Cov 1 2 Var 2
2
ln 1 ln 2 E0 Var 0 ln 1 ln 2 Var 1 Cov 1 2 Var 2
2

-1 50 -1 50
5 00 0 00 NA NA NA NA NA 1 00

Simulated data set 1--Random allocation

-1 55 (0.031) -1 57 (0.044)
5 38 (0.208) NA NA NA NA NA NA
0 62 (0.196)

-1 54 (0.032) -1 57 (0.044)
5 38 (0.209) NA
-1 28 (0.347) -0 98 (0.308)
2 54 (0.839) -0 78 (0.536)
1 96 (0.636) 0 62 (0.197)

-1 50 -1 50
5 00 NA -0 35 0 05 1 00 0 00 1 00 1 00

Simulated data set 2--Strategic allocation

-1 48 (0.119) -1 39 (0.097)
4 61 (0.225) NA NA NA NA NA NA
0 77 (0.243)

-1 46 (0.120) -1 38 (0.089)
4 58 (0.224) NA
-0 32 (0.219) 0 24 (0.227) 0 76 (0.254)
-0 31 (0.209) 0 96 (0.317) 0 76 (0.240)

Simulated data set 3--Efficient allocation

-1 50 -1 50
4 80 2 00 -0 35 0 05 1 0 × 10-6 0 1 0 × 10-6 1 00

0 09 (0.082) -8 97 (1.37)
2 92 (0.027) NA NA NA NA NA NA
1 04 (0.323)

-0 54 (0.460) -1 58 (0.460)
3 89 (0.395) NA
0 65 (0.460) 0 02 (0.88) 0 003 (0.003) 0 003 (0.003) 0 003 (0.003) 1 20 (0.371)

Demand + Supply random effects
-1 58 (0.063) -1 64 (0.100)
5 65 (0.352) 0 33 (0.133) -1 32 (0.353) -1 05 (0.323) 2 53 (0.823) -0 78 (0.546) 2 00 (0.648) 0 59 (0.283)
-1 46 (0.119) -1 39 (0.091)
4 60 (0.225) 0 66 (0.405) -0 32 (0.218) 0 23 (0.228) 0 76 (0.260) -0 31 (0.215) 0 96 (0.327) 0 76 (0.238)
-1 50 (0.001) -1 50 (0.002)
4 75 (0.011) 1 86 (0.553) -0 34 (0.009) 0 06 (0.010) 1 03 × 10-6 -0 002 × 10-8 1 03 × 10-6 1 02 (0.297)

We fit three models to each data set: (i) a demandmodel only, (ii) a demand and supply model assuming homogeneous production functions, and (iii) a demand and supply model with random multiplicative intercepts indentified through the supply side, i.e., the allocation model. All subjective priors are standard proper conjugate priors chosen to be minimally informative unless noted otherwise. The model comparison is challenging because of the small number of observations. Table 4 collects parameter estimates, and Table 5 presents test statistics.
Parameters are correctly recovered when the data-generating mechanism matches the estimated model. Parameter estimates are severely biased when "Efficient allocation" based on the knowledge of random multiplicative intercepts is ignored.3
3 This level of parameter recovery reported for the efficient allocation with random effects is only achieved with an informative prior, V = IW 51 0 495 × 10-4I , in line with very small allocation errors.

When variance in the allocation is driven by exogenous allocation errors ("Strategic allocation"), the demand-only model is consistent, which is confirmed by our results.

Table 5 Test Statistics: Cobb-Douglas Allocation Example

Demand + Supply Demand + Supply

Demand only fixed effects

random effects

ln y x M GD NR

Simulated data set 1--Random allocation

-147 6 -26 41

-148 18 -26 47

-187 91 -35 06

ln y x M GD NR

Simulated data set 2--Strategic allocation

-151 95 -29 25

-140 47 -29 11

-150 15 -29 2

ln y x M GD NR

Simulated data set 3--Efficient allocation

-149 39 -32 4

-147 8 -34 03

-116 18 -31 07

Note. With a standard diffuse prior V = IW 2 0 5 × 10-3I , we obtain the following fits when the allocation is "efficient" and a joint model with random effects is estimated: ln y x M : (GD), -134.5; and NR, -32.28.

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

695

Again, the proposed test statistic ln y x M reported in Table 5 identifies the correct model in every case (along the diagonal of Table 5). When the allocation is not driven by unobserved differences in responsiveness across production units ("Random allocation" and "Strategic allocation"), the proposed test clearly rejects the models that identify a random intercept through the supply-side formulation. When the allocation is endogenous ("Strategic allocation" and "Efficient allocation"), we find that the addition of the supply side actually increases the conditional marginal likelihood of the demand data. When the allocation is endogenous but its variance is exogenous ("Strategic allocation"), the proposed test statistic picks up the increased efficiency from adding the supply model.4
Finally, when the allocation is random and thus exogenous, the test statistic barely differentiates between the joint model with fixed effects and the demand-only model. This is not a problem with the test statistic but a feature of the data-generating mechanism. With the data-generating parameters in line with decreasing marginal returns and unobserved input prices, an allocation model driven by exogenous allocation errors cannot fit the demand data any worse than the demand-only model, except for the influence of subjective priors in the allocation model. This is different from our pricing example, where the data-generating price elasticity could not be reconciled with profit maximization, and marginal costs were partially observed.
Overall, the proposed test statistic correctly identifies the conditions where the supply side is a sensible addition to the model through improvements in the marginal conditional fit of the demand data relative to the demand-only model. Both simulation studies demonstrate that our test theory and its implementation work. The indirect Gelfand and Dey (1994) estimator of the proposed test statistic y x Mf identifies the true data-generating model from among a variety of competitive models. We find some evidence for bias in the direct NR estimator and recommend the direct estimator only as a quick first check.
5. Empirical Application
5.1. Data and Models We illustrate our method with data from a services organization operating in 21 regions along the eastern seaboard of the United States. The firm maintains multiple branch offices in each of the regions
4 With decreasing allocation errors, the demand-only model approaches an indeterminate design matrix, i.e., no variation in the inputs across the decision units. In this situation, adding the functional form of the allocation model to the demand model results in a noticeable gain in efficiency.

and makes yearly promotional allocations. One of the outputs generated by these inputs is the net number of new customers per year, the dependent variable in our analysis. Figure 1 displays the data used in the analysis in logarithmic form. New customers for each of the regions (y) are plotted against promotional expenditures (x1 and the number of branch offices (x2 along with the population in each region. The points in each of the plots fall along the 45 line, corresponding to a unit slope, or a proportional allocation rule. It appears that promotional expenditures and the number of branch offices vary in direct proportion to the population in each region.
The goal is to determine whether the data are consistent with the optimal allocation rule implied by Equation (10). It is useful to think of the effect of marketing expenditures in per-capita terms. Promotional expenditures and the number of branch outlets have diminishing marginal effects that should depend on the population size of the region, with allocations made in smaller market areas satiating more quickly. We therefore standardize the variables in the analysis per a population of 1,000 and view each (standardized) geographic region as providing exchangeable information for estimating model parameters.
We specify and test alternative versions of a multiplicative production function with an additive error:

yi =

i x1

1
i

x2

2
i

+

i

(21)

where i is a region-specific intercept that is identified through the supply-side portion of the model. Table 6 reports coefficient estimates for four analyses based on this demand model. When a supply side is present, we use the same priors for our supply-side error variance as in the simulation examples with a diffuse prior; i.e., V = IW 2 0 5 × 10-3I . Standard methods were used for drawing parameters from their posteriors using MCMC methods, and full details are available from the authors upon request.
The first model contains the demand Equation (21) only. As a result, it cannot identify region-specific intercepts, although a common intercept is still identified. We find that 2, the coefficient for the number of branch offices, is estimated to be significantly negative, which indicates that this input hinders the "production" of new customers.
The second model attempts to address the negative estimate by imposing constraints on the parameters so that 1 > 0 and 2 > 0, consistent with increasing returns to inputs. This constraint results in an estimate of 2 close to zero and a slight improvement in the marginal density estimate.5 It is important to

5 We only report estimates based on GD here because we found the NR estimates to be biased in our simulation study.

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

696

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

Figure 1

Scatterplots of Unnormalized Data for Each Region 10 11 12 13

ln(New customers)

6789
10 9 8 7 6

ln(Promo)
8 7 ln(Branch) 6 5

ln(Population)

remember that in Bayesian analyses, the likelihood is not being maximized, and incorporating an ordinal constraint need not lead to a degradation of model fit. In fact, the additional information made present through the prior is seen to reduce uncertainty in the posterior distribution of model parameters, with the

marginal density indicating a more plausible model structure.
The third model incorporates the supply-side portion of the model as a formal means for justifying the ordinal constraint, and we retain the presence of a fixed intercept for the 21 regions. We find

Table 6 Parameter Estimates: Posterior Mean

Parameters

Demand only

Demand only with constraints

1
2
Ei Var i ln 1 ln 2 Var 1 Cov 1 2 Var 2
2
Marginal density ln y x M GD

0 06 (0.259) -0 770 (0.370) 11 75 (12.07)
NA NA NA NA NA NA 3 95 (1.228)
-160.61

0 14 (0.097) 0 03 (0.028) 1 91 (0.678)
NA NA NA NA NA NA 3 86 (1.154)
-158.40

Note. Posterior standard deviation.

Demand + Supply fixed effects
0 22 (0.115) 0 09 (0.109) 1 35 (0.647)
NA -4 52 (0.540) -3 13 (1.031)
0 08 (0.034) -0 04 (0.020)
0 07 (0.026) 3 84 (1.156)
-144.70

Demand + Supply random effects
0 20 (0.028) 0 13 (0.056) 1 10 (0.211) 0 21 (0.066) -4 56 (0.211) -2 38 (0.375) 0 05 (0.031) -0 05 (0.012) 0 08 (0.046) 3 99 (1.202)
-141.23

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

697

an improvement of the marginal density of the conditional demand, our proposed test statistic. This indicates that the supply side implying marginally decreasing returns is supported by the demand data.
The fourth model allows for random intercepts, in other words, the presence of unobserved factors as in Equation (5) that lead to local departures from a homogeneous production function. We find that the presence of random effects identified through the supply side again improves the marginal fit of the conditional model y x M . These results indicate that the firm currently follows an optimal allocation rule, and the improvements from optimal reallocations are likely to be small.
It is not obvious how this conclusion could claim empirical support without the proposed test statistic and, of course, without access to additional data. We view the ability to test whether random coefficients structurally identified through the supply side are supported by the marginal conditional fit of the demand side as one of our key contributions. We showed previously that the marginal conditional fit of the demand rejects random coefficients identified through the supply side in situations where the data were generated differently.

5.2. Optimal Allocation
Our analysis of the data indicates that our observed firm is currently allocating inputs in a manner consistent with the first-order conditions associated with optimal allocation, with departures from optimality reflected in the supply size error realizations 1 i and 2 i. We investigate the change in expected demand through a reallocation of promotional expenditure, subject to the constraint that the total expenditure across regions and the distribution of branch offices remain the same. If the true values of the parameters
1 and 2 were known, then the optimal allocation of promotional expenditure must satisfy the first-order conditions:

yi x1 i =

i

1

x1

1 -1 i

x2

2
i

=

k

1

x1

1 -1 k

x2

2
k

=

yk x1 k

(22)

or

x1 i x1 k =

ix2 i kx2 k

2/ 1- 1

(23)

Because we do not directly observe the true values of the parameters, we employ the posterior distribution of the model parameters to obtain the expected output for a given allocation of promotional expenditures and employ a search algorithm to identify the optimal allocation. Details of our algorithm are provided in Appendix B. Results of our search, applied to each of the models investigated, are displayed in Table 7.

Table 7 Optimal Allocation of Promotional Expenditures

Parameters

Demand only

Demand only with
constraints

Demand + Supply fixed effects

Demand + Supply random effects

Expected y Observed x 67 4 Expected y Optimal x 496 38

69 88 70 34

70 36 71 06

68 66 68 98

Figure 2

Optimal and Observed Promotional Spending for the Demand + Supply Model with Random Effects

80

Optimal promotional spending

70

60

50

40

40

60

80

100

Observed promotional spending

We find similar results among models except for the first model, where the estimate for 2 is negative. For this response function, the optimal allocation is to concentrate expenditure in areas with a relatively small number of branches per 1,000 so that the negative effect is minimized. The dramatic increase in the expected new customers is due to the large estimated intercept in this model. For the remaining models, the expected increase in output (new customers per a population of 1,000) is slightly greater than expected with the current allocation.
Figure 2 displays changes in the regional allocation of promotional expenditures for the "Demand + Supply" model with random effects. The horizontal axis of the graph corresponds to the current allocation, and the vertical axis corresponds to the optimal allocation. Also plotted is a 45 line. The plot indicates that current allocation is too diverse--i.e., the optimal allocation is less extreme. However, as anticipated previously, the achieved output is already close to optimal.

6. Conclusion and Future Research
This paper introduces methods for developing and testing models of strategic behavior where the joint likelihood of demand (y) and supply (x) can be

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

698

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

factored into a conditional factor of demand given supply, as well as a marginal factor of supply. These models of strategic behavior assume that inputs are set before outputs are realized, and they differ from models of simultaneity where inputs and outputs are inextricably jointly realized in the marketplace. Strategic models allow for a factorization of the joint likelihood of inputs and outputs (conditioning on the information decision makers might have used), for which we develop a test statistic based on the marginal density of the conditional demand data. The idea behind the test is that if the supply-side model is correct, it will help predict demand when parameter estimates are based on the joint versus the conditional likelihood. We examine the performance of the proposed test statistic in simulated and actual data, and we investigate improvements in expected output for a firm that is found to already be allocating resources in an approximately optimal manner. Without our proposed test statistic, this final conclusion would have to be based on prior knowledge or additional data.
Models of strategic behavior provide a rationale for constraining parameters so that models have reasonable implications. Inputs such as prices, promotional expenditures, and branch offices are rarely concentrated at extreme values in the marketplace, which reflects management's belief in diminishing marginal returns. The development of a supply-side specification based on the same parameters in the demand model requires the parameters to explain both input and output variables. Our proposed test statistic can be used to develop models that fit both supply and demand data without sacrificing the fit to the conditional demand data. This is especially useful in small samples, where coefficients with unreasonable values are often found.
The framework and analysis presented in this paper can be extended in a number of ways. First, although our discussion touched on industrial organization-like models, we did not explicitly apply our test statistic to such a model. An interesting avenue for future research is to determine whether the game-theoretic supply-side specifications of these models are consistent with the demand-side likelihoods. The empirical organization literature started with sparse data problems, where only the combination of demand and supply theory provided enough prior structure to identify parameters of interest at all (Reiss and Wolak 2007). With sparse data, the scope for statistically testing the assumptions needed for identification is obviously limited. However, the empirical organization literature-inspired applications in marketing, a field relatively richer in data, may benefit from the proposed test statistic. For example, using Berry's (1994) general notation, market shares are a function of observed product characteristics x, prices p,

unobserved product characteristics , and unobserved demand parameters :

st = f x pt t

(24)

Prices, in turn, are an implicit function of the same arguments and marginal costs, where the implicit function reflects optimization behavior in a competitive environment and defines equilibrium prices:

pt = g x pt t mct

(25)

Given unobserved parameters and unobserved product characteristics, we can factor the joint density of shares and prices as follows:

pt st x pt t mct
= h st f x pt t × k pt g x pt t mct (26)
The function h st f x pt t is the conditional likelihood of observed market shares st given those predicted, i.e., f x pt t , where pt are observed prices. The function k pt pt = g x pt t mct is the marginal likelihood of observed prices given the predicted prices pt that result from competitive optimization given knowledge about demand primitives and marginal cost. Because prices and observed market shares are seen to be informative about demand primitives in this model, it is valid to question whether adding the pricing story is supported by the marginal conditional fit of the demand data.
A concrete example is a Nash pricing scenario with expected market share of brand j at time t:

MSjt =

exp x j + pjt p + j t

K k=1

exp

x

k + pkt p + k t

(27)

and implied equilibrium prices

1

pjt = mcjt - p 1 - MSjt

(28)

With at least partially known variable costs, the pricing equation is highly informative about the price parameter, other demand parameters, and unobserved product characteristics, similar to the monopolistic pricing example explored in our simulation study. Observed prices and variable costs, coupled with the above-mentioned pricing rule, define an informative prior for the parameters in the share equations. Thus, the marginal contribution of the pricing story to fitting the market shares can be assessed after defining a demand-side likelihood that measures departures from expected shares and a supply-side likelihood that measures departures from implied prices by adding error terms. The marginal density of the market shares could be used to compare the

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

699

Nash equilibrium to a demand-only model or to other models of market behavior. We leave this for future research.
Second, our investigation involved aspects of promotion and distribution but did not involve productrelated expenditures. Data were also not available on promotional quality, media content, or differing regional costs of branch outlets. The assessment of input prices is often difficult because it is dependent on cost drivers and cost allocation rules used by firms, and the development of input price estimators is an interesting extension of our work.
Third, we have considered only continuous strategic decisions and not discrete strategic choices by firms. Examples might include whether or not to adopt an everyday low pricing strategy (Ellickson and Misra 2008) or the decision to continue operating in a specific market. Discrete strategic choices represent corner solutions similar to the discreteness found in choice models, and they lead to inequality constraints in the supply-side specification. Additional research is needed to develop the proposed testing ideas in this context.

Appendix A. Derivation and Calculation of

Conditional Marginal Likelihoods

The direct NR-style estimator of the conditional marginal

likelihood is derived as follows:

x x xy

x

xy

y

y x y xy x x xy

x

y

xy

y x y xy x x xy

x

×

yx x

y

xy d x y xy

=

x x xy

x

yx x

xy d x xy

(A1)

1 = yx x

x x xy

x

xy d x xy

1 = yx x x

1 = yx

We note that the only departure from the NR estimator of the joint marginal likelihood is the inclusion of the supply-side likelihood x x x y as part of the subsequently non-normalized importance density.
Next we show analytically why estimating joint marginal likelihoods using the Newton and Raftery (1994) (NR), approximation in the presence of a supply-side model is usually flawed. Then we detail how to estimate conditional marginal likelihoods based on Gelfand and Dey (1994) (GD) in our applications.
In Bayesian analysis of joint models of demand and supply, e.g., Yang et al. (2003), it is current practice to couple the joint likelihood from Equation (1) with standard priors such as in

x y xy y x  y x y xy × x x xy ×

x x y y (A2)

By standard priors, we mean priors that do not reflect the effective constraints on parameters through the supply-side likelihood x x x y . Examples of such implied constraints are that own-price elasticities have to be smaller than -1 or that the sum of exponents in Cobb-Douglas production functions is constrained to values below 1. If the prior x x y y does not reflect these constraints, then the identity on which the NR estimator is based is violated a priori. That is,

x xy y
x xy y x y
× x x y y x y d x y x y <1

(A3)

because the posterior does not have the same support as the prior distribution. Lenk (2009) pointed out that the NR estimator is not simulation-consistent for all practical purposes because of the large discrepancy between the effective support of the posterior MCMC sample and the theoretical support of the prior even if the theoretical support of the posterior is identical to that of the prior. Here, the situation is potentially worse because usually joint models of demand and supply result in a posterior that is not even theoretically supported over the range of standard priors. Thus, a model comparison based on NR between a structural model with constraints through the supply side and a descriptive model of y and x without implied constraints, each coupled with standard priors, is likely to favor the structural model by construction of the NR estimator.

Calculating the Indirect GD Estimator for the

Monopolist Pricing Example

In our general notation, the application of Gelfand and

Dey's (1994) identity requires the specification of nor-

malized importance densities q x x y y q x x y , and q x y y , with thin tails relative to x x y y x y ,
x x y x , and x y y y , i.e., the posterior from the joint model, from the supply-side-only model, and from the

demand-side-only (the conditional) model, respectively. We

can then apply Equation (20) to obtain the marginal like-

lihoods y x Mf , x Mf , and y Mc , as well as the target quantity y x Mf as y x Mf / x Mf , which can be directly compared with y Mc and across specifications.

We will start with how to specify q x x y y based on an MCMC sample from x x y y x y . In our monopolist pricing example, we have three joint models

of demand and pricing: (i) a model that rationalizes price

variation through random cost shocks only, with posterior

0 1 2 2 pt yt}); (ii) a model that connects demand and price variation through common shocks, with posterior

222 01

t

pt yt}); and (iii) a model where

time-varying price elasticity links demand and price varia-

tion, with posterior 0 1 t V 1 2 2 pt yt ). We specify importance densities as multivariate normal

distributions. The exponential tails of the multivariate nor-

mal are useful because we need thin tails. However, the

variance parameters 2, 2, 2, and V 1 can only take positive values, and 1 and { 1 t} are restricted to values smaller than -1. Therefore we log-transform 2, 2, 2, and V 1. To obtain unrestricted counterparts of 1 and { 1 t}, we use

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

700

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

the transformation log(- 1 + 1 . We fit a multivariate normal distribution to the posterior after transformation. The

importance density is then the multivariate normal density

of the transformed posterior times a Jacobian. The resulting

Jacobian matrix is diagonal, with entries of the form 1/V

for variance terms and -1/ 1 + 1) for price elasticities.

The specification of q 1 2 , q 1 2 2 t}), and

q 1 1 t V 1 2 based on MCMC samples from

2 1

pt }),

22

1

t

pt}), and

1 1t

V 1 2 pt}) to estimate x Mf under the three specifica-

tions proceeds analogously.

In the case of the demand-only model, the three pos-

teriors

0 1 2 yt }),

22 01

t

yt}), and

0 1 t V 1 2 yt}) are well defined because of

proper priors and functional form assumptions. However,

for all practical purposes, only y Mc corresponding to the model 0 1 2 yt}) is relevant. The specification of the importance density proceeds in analogue to the joint

model above.

Calculating the Indirect GD Estimator for the

Cobb-Douglas Example

In our Cobb-Douglas example, we have two joint mod-

els of output y and inputs x: (i) a model that rationalizes

input variation through random cost shocks, input pricing

errors, or both, with posterior 0 log 1 log 2 2 i x1 i x2 i yi}); and (ii) a model that connects vari-
ation in the inputs and output across units to unob-

served differences in the production function, with posterior

0 i V 0 log 1 log 2 2

i x1 i x2 i yi}).

We follow a similar strategy to specify importance densi-

ties based on MCMC samples from the posterior as in our

monopolist pricing example. However, in the Cobb-Douglas

case, we have a constraint on the exponents in the pro-

duction function, i.e., 1 + 2 < 1, which is impossible to represent by fixed transformations. The importance density

needs to reflect this constraint coming through the supply

side. If it does not, it will have a fatter tail than the pos-

terior in the direction of 1 + 2 >= 1 by definition, and the GD identity from Equation (20) will no longer hold. We

view this and similar complications resulting from implicit

constraints as a characteristic features of models that are

derived from the optimization behavior of agents.

Our solution to this problem first factorizes the joint

importance density q 0 log 1 log 2 2

i}) into

a marginal part corresponding to the constraint with

no explicit representation q log 1 log 2 and then a conditional part where all constraints, if any, can be

represented by simple transformations q 0 2

i

log 1 log 2 . We define q log 1 log 2 as a bivari-

ate normal distribution fitted to log 1 log 2

x1 i x2 i yi}) truncated to the range where 1 + 2 < 1. We

estimate the mean and variance­covariance of the corre-

sponding unconstrained bivariate normal as well as the nor-

malizing constant by simulation.

We then define q 0 2

i log 1 log 2 as

q 0 2 i log 1 log 2 × q . We define q

independently for convenience as an Inverse Wishart den-

sity with parameters estimated from

x1 i x2 i yi}).

The density q 0 2 i log 1 log 2 is specified

as MVN( 0 log 2 i log 1 log 2 × 1/ 2. We esti-

mate the means and the variance­covariance matrix of these

distributions, regressing 0 log 2 i on log 1 log 2

in the MCMC sample from

0 log 1 log 2

2 i

x1 i x2 iyi}).

Estimation of x Mf under the two specifications

does not present any additional difficulties given sam-

ples from

0 log 1 log 2

i x1 i x2 i}), and

0 i V 0 log 1 log 2

i x1 i x2 i}). This is

similar to estimating y Mc . Again, even though

0 i V 0 log 1 log 2 2 yi}) is well defined with

proper priors and our functional form assumptions, the

comparison in practice will be to a demand model without

random effects, i.e., 0 log 1 log 2 2 yi}), when only a cross section is observed.

Appendix B. Optimal Actions In general, the problem of finding the optimal Bayes action is to find a = maxa U a p data d , where U a is the utility to be maximized. It depends on the action a and characteristics of nature . The optimal action is defined as the value of the action that maximizes (posterior) expected utility.
In our case, utility is equal to the (expected) output y as a function of the actions or inputs {x1i x2i} and characteristics of the areas producing the outputs summarized by 1, 2, and (or { i}, depending on the model), y x1i x2i 1 2 i}). If the response parameters were known, we could obtain closed-form solutions for the optimal inputs by numerically solving (23) for the inputs, subject to constraints. Because our knowledge of response parameters is limited by posterior uncertainty, the optimal allocation is defined as the maximum of an integral. In general, we have

N

x1 i

x2 i

= max x1 i x2 i

yi x1 i x2 i 1 2 i
i=1
·p 1 2 i data M d 1

2

i

(B1)

s.t. c x1 i x2 i  constraint

In our application, we lack the price information needed to optimally balance the two inputs x1 i and x2 i within areas. Thus, we investigate the conditionally optimal allocation of the first input across areas. Note that we implicitly assume that the price of the first input is constant across areas. Thus we solve the following maximization problem

N

x1 i

= max x1 i

yi x1 i x2obiserved 1 2 i
i=1

·p 1 2 i data M d 1 2 i

N

N

s.t.

x1 i = x1obiserved

i=1

i=1

(B2)

Because our production function is nonlinear and the posterior distribution is not of a known form, a closedform solution to this maximization problem is not available. We use a simulated annealing algorithm to approximate the conditionally optimal inputs. The algorithm picks two areas i and j at random, increases (decreases) x1 i by a randomly determined delta, and decreases (increases) x1 j by

Otter, Gilbride, and Allenby: Testing Models of Strategic Behavior Characterized by Conditional Likelihoods

Marketing Science 30(4), pp. 686­701, © 2011 INFORMS

701

the same amount. The candidate reallocation is accepted with probability

min exp

N
yi x1cani d p
i=1

1 2 i data M

N
- yi x1 ip
i=1

1 2 i data M

1 (B3)

The positive scale parameter controls the "heat" of the algorithm. Small values of correspond to more heat, allowing the algorithm to traverse areas of decreasing expected output. We increase as a function of the iterations of the simulated annealing algorithm such that, eventually, the local maximum is determined almost surely.

References
Berry, S. T. 1994. Estimating discrete-choice models of product differentiation. RAND J. Econom. 25(2) 242­262.
Bronnenberg, B. J., V. Mahajan. 2001. Unobserved retailer behavior in multimarket data: Joint spatial dependence in market shares and promotion variables. Marketing Sci. 20(3) 284­299.
Carroll, J. D., P. E. Green, W. S. DeSarbo. 1979. Optimizing the allocation of a fixed resource: A simple model and its experimental test. J. Marketing 43(1) 51­57.
Chamberlain, G. 1984. Panel data. Z. Griliches, M. D. Intrilligator, eds. Handbook of Econometrics, Vol. 2. North Holland, Amsterdam, 1247­1318.
Chintagunta, P. K., T. Erdem, P. E. Rossi, M. Wedel. 2006. Structural modeling in marketing: Review and assessment. Marketing Sci. 25(6) 604­616.
Dong, X., P. Manchanda, P. K. Chintagunta. 2009. Quantifying the benefits of individual-level targeting in the presence of firm strategic behavior. J. Marketing Res. 46(2) 207­221.
Ellickson, P. B., S. Misra. 2008. Supermarket pricing strategies. Marketing Sci. 27(5) 811­828.
Gelfand, A. E., D. K. Dey. 1994. Bayesian model choice: Asymptotics and exact calculations. J. Roy. Statist. Soc. Ser. B 56(3) 501­514.

Horsky, D., P. Nelson. 1996. Evaluation of salesforce size and productivity through efficient frontier benchmarking. Marketing Sci. 15(4) 301­320.
Lenk, P. 2009. Simulation pseudo-bias correction to the harmonic mean estimator of integrated likelihoods. J. Comput. Graphical Statist. 18(4) 941­960.
Manchanda, P., P. E. Rossi, P. K. Chintagunta. 2004. Response modeling with nonrandom marketing-mix variables. J. Marketing Res. 41(4) 467­478.
Mantrala, M. K., P. Shinha, A. A. Zoltners. 1992. Impact of resource allocation rules on marketing investment-level decisions and profitablility. J. Marketing Res. 29(2) 162­175.
Misra, S., H. Nair. 2009. A structural model of sales-force compensation dynamics: Estimation and field implementation. Research Paper 2037, Stanford University, Stanford, CA. http://ssrn.com/abstract=1474462.
Misra, S., A. T. Coughlan, C. Narasimham. 2005. Salesforce compensation: An analytical and empirical examination of the agency theoretic approach. Quant. Marketing Econom. 3(1) 5­39.
Morey, R. C., J. M. McCann. 1983. Estimating the confidence interval for the optimal marketing mix: An application to lead generation. Marketing Sci. 2(2) 193­202.
Newton, M. A., A. E. Raftery. 1994. Approximate Bayesian inference with the weighted likelihood bootstrap. J. Roy. Statist. Soc. Ser. B 56(1) 3­48.
Reiss, P. C., F. A. Wolak. 2007. Structural econometric modeling: Rationales and examples from industrial organization. J. J. Heckman, E. E. Leamer, eds. Handbook of Econometrics, Vol. 6A. Elsevier, Amsterdam, 4277­4415.
Rossi, P. E., G. M. Allenby, R. McCulloch. 2005. Bayesian Statistics and Marketing. John Wiley & Sons, New York.
Villas-Boas, J. M., R. S. Winer. 1999. Endogeneity in brand choice models. Management Sci. 45(10) 1324­1238.
Yang, S., Y. Chen, G. M. Allenby. 2003. Bayesian analysis of simultaneous demand and supply. Quant. Marketing Econom. 1(3) 251­276.
Zellner, A., J. Kmenta, J. Drèze. 1966. Specification and estimation of Cobb-Douglas production function models. Econometrica 34(4) 784­795.

