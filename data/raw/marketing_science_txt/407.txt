Vol. 32, No. 3, May­June 2013, pp. 454­470 ISSN 0732-2399 (print) ISSN 1526-548X (online)

http://dx.doi.org/10.1287/mksc.2013.0782 © 2013 INFORMS

A Direct Utility Model for
Asymmetric Complements
Sanghak Lee
Tippie College of Business, University of Iowa, Iowa City, Iowa 52242, sanghak-lee@uiowa.edu
Jaehwan Kim
Korea University Business School, Korea University, Seoul 136-701, Korea, jbayes@korea.ac.kr
Greg M. Allenby
Fisher College of Business, Ohio State University, Columbus, Ohio 43210, allenby.1@osu.edu
Asymmetric complements refer to goods where one good is more dependent on the other, yet consumers receive enhanced utility from consuming both. Examples include garden hoses and sprinklers, chips and dip, and routine versus personalized services where the former has a broader base for utility generation and the latter is more dependent on the other's presence. Measuring asymmetric effects is difficult when all that is observed are the purchase quantities present in a consumer's market basket. We propose a direct utility model with a latent decision sequence for measuring asymmetric effects that allows us to capture differential responses to cross-category purchases and inventories. Scanner panel data of milk and cereal purchases are used to investigate the presence of asymmetric complementarity, and implications are explored through counterfactual analyses involving cross-price elasticities and spillover effects of merchandising variables.
Key words: utility theory; choice modeling; Bayesian estimation; indivisible demand History: Received: November 21, 2011; accepted: January 19, 2013; Preyas Desai served as the editor-in-chief
for this article. Published online in Articles in Advance April 8, 2013.

1. Introduction
The simultaneous demand for goods in multiple categories can be attributed to many factors. Demand can be simultaneously high because goods are complements, from cross-category timing of promotions and price discounts, from relaxed budgets corresponding to large shopping trips, and from the presence of joint demand shocks reflecting unobserved spikes in demand. Until recently, multicategory demand models have relied extensively on modified versions of the same models used to study substitute goods. Modifications include the introduction of correlated error terms (Li et al. 2005, Manchanda et al. 1999), correlated coefficients (Duvvuri et al. 2007, Hansen et al. 2006, Erdem 1998, Ainslie and Rossi 1998), the presence of common covariates (Nair et al. 2004, Basu et al. 2003, Manchanda et al. 1999), and the distinction between consumption and purchase (Dubé 2004) that helps account for the likelihood of simultaneous purchases. Although these modifications have the capability of representing patterns of correlated demand, they are limited in their ability to explain its origin. Correlated errors and correlated coefficients do not distinguish between inherently complementary products, defined in terms of superadditive utility, versus

the presence of other reasons for simultaneous purchase and negative cross-price effects.
An interesting aspect of modeling cross-category demand lies in detecting the presence of demand asymmetries. One category might be more dependent on the other while the other less dependent on the first, which is not reflected by introducing simple interaction terms into a consumer's utility function. In models of quadratic utility where U x1 x2 = x + 1/2 x Bx, for example, off-diagonal elements of the coefficient matrix, B, are constrained to be symmetric (e.g., ij = ji), because utility is scalar and depends on the sum of coefficients in the term ij + ji xixj , not each coefficient separately. The symmetry constraint is present in all models employing quadratic forms--e.g., translog utility functions (Christensen et al. 1975).
The marketing literature has recently begun to move to more formal models of cross-category demand. Song and Chintagunta (2007) propose a model structure for cross-category analysis based on economic theory that relies on a Taylor series approximation to an underlying indirect utility function. Their model captures households' multicategory purchase incidence, brand choice, and purchase quantity

454

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

455

decisions by considering a joint utility function of multicategory purchases. Mehta's (2007) model is similar to that of Song and Chintagunta (2007) in that the basic translog indirect utility function is employed and the logit choice probability forms the basis of the model. However, the model is restricted to account for the purchase incidence only, ignoring the possibly confounding effect of satiation on market basket demand. We note that both models rely on an indirect translog utility function (Pollak and Wales 1992, Christensen et al. 1975), which in turn relies on a Taylor series approximation of an arbitrary utility or indirect utility function. One of the advantages of this approach is that it does not rely on any specific form of a utility function. However, although offering some flexibility, it is limited in describing crosscategory relationships that result from the symmetry restriction.
We propose a direct utility model in which a consumer makes a sequence of purchase decisions across multiple categories. Asymmetric cross-category dependences are identified from the differential responsiveness of the demand of one category to the changes in cross-category purchases and inventory. Temporal variations in purchase quantities, together with interpurchase times, allow us to infer the latent inventories that might have a differential impact on its cross-category demand. A latent sequence of a consumer's purchases allows for a direct interaction among the multicategory decisions within the same shopping trip such that purchases in one category are affected by earlier purchases in other categories. We posit a latent model for the purchase sequence, allowing the probability of a particular sequence to be influenced by product inventory and observed merchandising variables. Our data likelihood is obtained by integrating over the latent sequences.
We contribute to the literature on complementary demand by developing a direct utility model that identifies asymmetric interdependencies among goods. Our model has the following properties: (i) an order of sequential purchase decisions is estimated; (ii) the model allows for asymmetric interdependencies among categories including complementarity as well as substitutability; (iii) the model provides a unified framework to handle brand-level purchase quantities, accommodating both corner and interior solutions; and (iv) the model explicitly deals with the indivisibility of data, not assuming a continuous decision space for a consumer. The model is applied to scanner panel data of milk and cereal purchases. The parameter estimates provide evidence of asymmetric complementarity between milk and cereal such that the impact of milk on the utility of cereal is greater than the impact of cereal on the utility of milk. The presence of asymmetric spillover effects

has implications for marketing practice, particularly for the sequencing of category investment decisions and the cross-category coordination of promotional campaigns. We show that asymmetric interdependency in utility leads to asymmetric spillover effects of promotions and that assuming symmetric effects will bias the parameter estimates and distorts policy implications.
In the next section, we develop our direct utility model that is assumed to be maximized subject to budgetary and packaging restrictions. In §3, our model is applied to scanner panel data, and the estimation results are summarized. Section 4 discusses the implications of our model, and concluding remarks are offered in §5.
2. Model Development
Complementary products are defined in our model in terms of a superadditive utility structure that favors joint as opposed to separate purchase. Our definition is different from the standard economic definition of complementarity (e.g., Pashigian 1998), where negative cross-price effects are used to identify complementary products. That is, if a price decrease in one good leads to increased demand for another, then the goods are traditionally considered as complements. Such an effect, however, can be due to many factors such as a person's attention to prices being more acute during a weekly, large budgeted shopping trip versus a filler trip for specific basket items. Our goal here is to derive insight into how utility is formed, which we believe to be more informative than studying how consumers react to prices.
We begin our model development with the utility specification, and then we introduce a latent decision sequence into a model. We then present the specification of the model likelihood and discuss the identification of the asymmetric complementarity. The model is developed in terms of two product categories for exposition and then generalized to an arbitrary number of categories.
2.1. Direct Utility Model for Sequential Decisions Our model assumes that a consumer makes a series of decisions over multiple categories within a shopping trip. Only one category is considered at a time, and the decisions made earlier have an impact on the later decisions based on their cross-category relationships. The purchase quantities of all the brands within a category, however, are determined simultaneously. A model of sequential decisions might reflect a physical path of a consumer's trip at a store, or it might represent the order of decisions made in a consumer's mind that may be different from the temporal sequence of actual purchases.

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

456

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

The assumption of sequential decisions has an intu-

itive appeal in that necessary information for decision

making is provided in a sequential manner in a mar-

ketplace. For example, a consumer is exposed to the

prices and promotions of the items under one cate-

gory as the consumer walks in the aisle of that cat-

egory. In addition, the model of sequential decisions

better represents how consumers deal with the inher-

ently high dimensionality of multicategory decisions.

In cases where there are n categories and m brands

under each category, a consumer makes purchase

decisions about total n × m items in a given shop-

ping trip. We believe that consumers make a series

of smaller and feasible decisions, each of which con-

siders only m brands under the same category rather

than solving a constrained utility maximization of the

n × m items simultaneously.

Suppose there are two product categories (i.e.,

X and Y ), and two brands are available for each cate-

gory (i.e., x1, x2 and y1, y2), with their unit prices being (p1x, p2x p1y p2y) and unit volumes being (s1x s2x s1y s2y). In a shopping trip at time t, a consumer has a fixed

budget E that implies the maximum willingness to pay

for the two categories, and the consumer is aware of

the levels of the inventories of the two categories (i.e.,

x t

,

y t

).

We

assume

that

consumer

purchases

reflect

a

sequential process of constrained utility maximization

across product categories. If category X is considered

first and the decision on category Y is made condi-

tional on the decision on X, then the purchase decision

can be described as two-step procedure.

First, a consumer makes a purchase decision on X

to maximize the joint utility of X and an outside good

Zx under a set of constraints: (i) a budget constraint defined by E and the unit prices pixt, (ii) the discrete-
ness imposed by package sizes, and (iii) nonnegativ-

ity of purchase quantities. Here, the outside good is

defined as the remaining dollars that are saved rather

than spent on the inside goods (X), and the linear

subutility for the outside good is assumed:

max
x1t x2t zxt

U x1t x2t zxt

x t

y t

2

=

x it

log

six xit

+

x
t+

zzxt

i=1

2

s.t.

pixtxit + zxt  E

i=1

xit  0 1 2

i 1 2

zxt  0

(1)

where

x it

=

exp

x i

+

y
yx t +

x i

mxit

+

x it

,

with

mxit

denoting a marketing activity on xit. The parameter

x i

represents the time-invariant baseline utility of xit,

and

x i

measures

the

impact

of

a

marketing

activ-

ity mit;1 yx captures the impact of category Y on the

utility of category X, with positive yx implying com-

plementarity and negative yx implying substitutabil-

ity;

x it

implies

a

demand

shock

that

is

known

to

a

decision maker but not revealed to a researcher, and it

is assumed to follow an independent and identically

distributed (i.i.d.) probability distribution. Because of

the concavity of logarithm, the marginal utility of xit is a decreasing function of its own purchase quan-

tity and the inventory of X. The utility specification

in (1) allows for horizontal variety-seeking behavior

of a consumer, which is manifested by the shopping

basket where multiple brands of a category are pur-

chased simultaneously.

Once the purchase decision is made for the first cat-

egory, the second category is considered in the same

manner. However, its purchase utility is influenced

by the previous purchase decision on the first cat-

egory, and the unspent money from the first deci-

sion becomes the total budget for the second decision.

Conditional on the purchase decision on X (i.e.,

x1t, x2t), the consumer makes a purchase decision on Y such that the joint utility of Y and the outside good

Zy is maximized under the remaining budget (i.e.,

E =E-

2 i=1

pixt

xit

):

max
y1t y2t zyt

U y1t y2t zyt x1t x2t

x t

y t

2

=

y jt

log

sjyyjt +

y
t+

zzyt

j =1

2

s.t.

pjytyjt + zyt  E

j =1

yjt  0 1 2

j  1 2

zyt  0

(2)

where

y jt

=

exp

y
j + xy

x t

+

2 i=1

six

xit

+

y j

myjt

+

y jt

;

xy captures the impact of category X on the utility

of category Y and is associated with the sum of the

inventory and the newly purchased amount of X (i.e.,

x t

+

2 i=1

six

xit

).

Linear subutility of an outside good implies that the

value of unspent money does not satiate and leads to

the constant marginal utility of the outside good (i.e.,

Uzt = U / zt = z), which is independent of the budgetary allotment, E. Therefore, our model is agnostic

not only to the level of the budgetary allotment but

1 We acknowledge that marketing activities such as feature advertisement do not directly affect consumer's utility, but rather they influence the level of attention or the consideration set formation (Terui et al. 2011), which will lead to the increased probability of purchase. Because neither a level of attention nor a consideration set formation is formally modeled, the impact of marketing actions on the purchase likelihood is captured by introducing them in utility formulation.

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

457

also to whether consumers have separate budgets for

different categories. The unspent money from the first

decision can either be allocated for the second cate-

gory or be saved again in the second decision.

When the sequence of purchase decisions is re-

versed, everything remains the same except for two

things: (i) the budgetary allotment is now E for the

purchase of Y , and E = E -

2 j =1

pjyt

yjt

for

X;

and

(ii)

x it

is

dependent

on

y
t+

2 i=1

sjy

yjt

,

whereas

y jt

is only influenced by the current inventory of Y and

not by the purchase amount of X at time t. Note that

the optimality conditions under the two sequences are

indifferent if the observed purchases are all zero. Pos-

itive purchase quantities differentiate the optimality

conditions under the two different sequences, inform-

ing which sequence is more likely than the other.

We introduce a latent level of category interest, t, by which the order of the purchase sequence is

determined:

2

x

x

x

t = 0+ 1 t+ 2

mxit +

x t

i=1

(3)

2

y

y

y

t = 0+ 1 t+ 2

myjt +

y t

j =1

The parameter 0 implies the category-specific baseline of interest, and 1 and 2 capture the influence of inventory and marketing activities, respectively. We

expect the interest of a category increases when the

inventory is low or when marketing activities draw

more attention from a consumer.2 t is a stochastic component of latent interest and is assumed to fol-

low an i.i.d. Type I extreme-value distribution,3 which

produces a closed-form expression for the sequence

probability. Category X is considered first if its inter-

est level is greater than that of Y (i.e.,

x t



y t

);

the

reverse is true otherwise.

Because household inventory is not observed by

an analyst, a model for consumption is required to

approximate the inventory of goods. We employ an

exponential decay model for inventory depletion, in

which a fixed proportion of goods is consumed

in each period (Ailawadi et al. 2007).4 The inventory

2 The impact of inventory (or marketing activities) might differ

across categories (e.g.,

x 1

=

y 1

).

However,

the

difference

was

found

to be insignificant in our empirical analysis, which might not be

the case when dealing with other categories. The choice of the base

unit for each category as the most frequently chosen package size

alleviates the concern of incomparability of the inventories of dif-

ferent categories.

3 F x = exp - exp -x .

4 We also tried a linear decay model, in which a constant amount of goods is consumed in a unit period. However, the exponential decay pattern is chosen based on the model fit.

of category X at time t is given by

2

x
t=

t-1 t x

x
t-1 +

sixxi t-1

(4)

i=1

where t - 1 t denotes the time interval between the two shopping trips, and x indicates the rate of inventory for category X, which lies between 0 and 1. Because of the recursive structure of the inventory decay model in (4), an initial inventory level is required. We set it to be equal to the average inventory level that can be calculated from the data in a model-free manner.
There are two sources of inventory updates in our model. First, the consumption of a good is the major source of inventory updates. The time-series observation of past purchase quantities and interpurchase time provide the information for estimating the rate of consumption. Second, a latent decision sequence allows for the immediate update of the inventory of the previously purchased good when the decision of the second good is made. This allows for a direct interaction between the purchase decisions that are made during the same shopping trip.

2.2. Model Likelihood

The model likelihood comprises two stochastic com-

ponents: (i) the probability of each sequence and

(ii) the conditional probability of purchase quanti-

ties given a sequence. Because we only observe the

purchase quantities without knowing the sequence of

decisions, we first derive the conditional likelihood

for the purchase quantities and then integrate over the

probabilities of the sequences to obtain the marginal

likelihood of the purchase quantities. There are two

possible sequences with two categories: (i) first X,

then

x t

<

Y (i.e.,

y t

).

The

x t



y t

);

or

(ii)

first

Y,

then

probability of each sequence

X (i.e., can be

derived in closed form as follows:

Pr

xy
t t

= 1 + exp

1

y
0-

x 0

+

1

y
t-

x t

+

2

2 j =1

myjt

-

Pr

x t

<

y t

= 1-Pr

xy
t t

2 i=1

mxit

(5)

The conditional likelihood of purchase quantities given a specific sequence is derived by associating the observed data with the optimality conditions for the sequential decision problems formulated in (1) and (2). The indivisibility of purchase data is incorporated into the model as a constraint on a consumer's decision space with the observed purchase quantities not necessarily indicating the exact point of utility maximization, but rather the grid point at which feasible and constrained utility is maximized (see Lee and Allenby 2013). If a consumer makes

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

458

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

a decision on X first and then considers the pur-

chase of Y , the likelihood of the data (x1t x2t y1t y2t)

can be factored into the likelihood of (x1t x2t) and

the likelihood of (y1t y2t x1t x2t). Because the bud-

get constraint is binding at the optimal solution

(i.e.,

2 i=1

pixt xit

+

zxt

=

E),

we

can

simplify

the

decision

problem in (1) by substituting the budget constraint

for zxt in the utility specification:

max
x1t x2t

U  x1t x2t

x t

y t

2

2

=

x it

log

sixxit +

x
t+

z

E-

pixt xit

i=1

i=1

s.t. xit  0 1 2
2
E - pixtxit  0
i=1

i 1 2

(6)

U  is the constrained utility function of the inside

goods only, where the budget constraint is always sat-

isfied. The nonnegativity constraint for the outside

good in (1) places an upper boundary for the decision

space of the inside goods such that the total spend-

ing for the inside goods does not exceed the bud-

getary allotment (i.e., E -

2 i=1

pixt

xit

 0).

When

the

unconstrained utility function U is additively separa-

ble with the linear subutility for the outside good, the

sufficient conditions for an observed quantity (x1t x2t) to be optimal can be simplified as follows:

U  x1t x2t  max U  x1t + 1 x2t + 2 i -1 0 1 (7)

Substituting the constrained utility in (6) into the opti-

mality conditions in (7) yields the bounds on error

realizations

(

x 1t

x 2t

)

that

rationalize

the

observed

demand (x1t x2t):

lbxit <

x it

<

ubxit

i 1 2

where

lbxit = log

0pixt - log log

sixxit +

x t

six xit - 1 +

x t

-

x i

-

yx

y
t-

x i

mxit

ubxit = log

0pixt - log log

six xit + 1 +

x t

sixxit +

x t

(8)

-

x i

-

yx

y
t-

x i

mxit

In the case xit = 0, no comparison is required with

the point where i = -1 because of the nonnegativity

constraint for xit. Therefore, there is no lower bound-

ary for

x it

(i.e.,

lbxit

=

-

). Theoretically, a similar logic

can be applied to the case where additional purchase

of brand i is not feasible because of the restriction of

the budgetary allotment.5 However, we preclude this

case by setting E that can afford additional purchase

of any inside good.6 It is assumed that purchasing

an additional unit of any inside good is always fea-

sible, but it does not occur for optimality (i.e., it is

better off to save that money). Because the budget

constraint is always binding at the optimal solution

(i.e.,

2 i=1

pixt xit

+ zxt

=

E),

this

assumption

implies

that

there is always some saved money that is no less than

the maximum price of the inside goods (i.e., zxt 

max p1xt p2xt ). Assuming

x it

follows

an

i.i.d.

probabil-

ity distribution f , we can compute the likelihood of

(x1t x2t) by integrating over the joint density of the errors over the region specified in (8):

L x1t x2t

x t



y t

ubx1t
=f lbx1t

x 1t

d

x 1t

ubx2t
f
lbx2t

x 2t

d

x 2t

(9)

The likelihood of (y1t y2t x1t x2t) can be computed in

a similar way. and the utility

The budget

of yjt

y jt

is

is now E (=E -

2 i=1

pixt

influenced not only by

xit ), the

inventory (

x t

)

but

also

by

the

purchase

quantities

of

X

2 i=1

six

xit

:

max
y1t y2t

U  y1t y2t x1t x2t

x t

y t

2

2

=

y jt

log

sjyyjt +

y
t+

z

E-

pjyt yjt

j =1

j =1

s.t. yjt  0 1 2

j  1 2

2
E - pjytyjt  0

j =1

(10)

where

y jt

=

exp

y
j + xy

x t

+

2 i=1

six

xit

+

y j

myjt

+

y jt

.

The comparison to the adjacent grid points produces

the

bounds for

error realizations

(

y 1t

y 2t

):

lbyjt <

y jt

<

ubyjt

j  1 2

where

lbyjt = log

0pjyt -log log

sjyyjt +

y t

sjy yjt - 1 +

y t

y
- j - xy

2

x
t+

six xit

i=1

-

y j

myjt

ubyjt = log

0pjyt -log log

sjy yjt + 1 +

y t

sjyyjt +

y t

y
- j - xy

2

x
t+

six xit

i=1

-

y j

myjt

(11)

5 If adding one more unit of brand i makes the total spending

exceed the budget (i.e., pixt xit + 1 +

2 j =1

j =i

pjxt xjt

> E),

x it

is

bounded

only from below (i.e., ubxit = ).

6 Because our model is agnostic to the level of the budgetary allotment as a result of the linear subutility for the outside good, the estimation results are not influenced by the choice of E.

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

459

Integrating

the

joint

density

of

(

y 1t

y 2t

)

over

the

region in (11) produces the likelihood of (y1t

y2t x1t x2t ):

L y1t y2t x1t x2t

x t



y t

uby1t
=f lby1t

y 1t

d

y 1t

uby2t
f
lby2t

y 2t

d

y 2t

(12)

The conditional likelihood of (x1t x2t y1t y2t) given the specific sequence is equal to the product of the
likelihood of x1t x2t and the likelihood of y1t y2t x1t x2t :

L x1t x2t y1t y2t

xy
t t

= L x1t x2t

x
t

y t

L y1t

y2t

x1t

x2t

xy
t t

(13)

Consequently, the joint likelihood of the sequence and the purchase quantities is given by multiplying the probability of the sequence in (5) by the conditional likelihood of the purchase quantities given the sequence in (13):

L x1t x2t y1t y2t

x t



y t

= Pr

x t



y t

L

x1t

x2t

y1t

y2t

x t



y t

(14)

Because the joint likelihood of the opposite sequence and the purchase quantities is given in a similar manner, we can compute the marginal likelihood of the purchase quantities by integrating out the purchase orders:

L x1t x2t y1t y2t

= L x1t x2t y1t y2t

xy
t t

+ L x1t x2t y1t y2t

x t

<

y t

(15)

2.3. Identification Asymmetric complementarity is identified by the differential responsiveness of demand to the latent cross-category inventories. Whereas the demand of a strongly dependent category is sensitive to the temporal changes in the latent inventory of another product category, the demand of an independent category is not affected by the cross-category inventory. The expression for the marginal utility7 illustrates this property:

Uxit =

U six exp xit =

x i

+

yx

y
t+

x i

mxit

+

x it

sixxit +

x t

(16)

Dealing with purchase quantities is crucial for the model identification because they provide information for the temporal variations in latent inventories. The longitudinal variations in purchase quantities

7 Although indivisibility prevents us from using the marginal utility for computing the likelihood, this expression is still valid because the discreteness comes from the constraint, not from the utility.

( xt

yt

T t=1

variation

), together with interpurchase

in inventories over time (

x t

time, lead to

y t

T t=1

)

that

enables us to identify asymmetric complementarity

( yx xy). The extent to which the demand of X is responsive to the inventory of Y determines the sign

and the magnitude of yx, which might be different from xy.
For the purpose of illustration, we contrast two sets

of hypothetical data where good X is more dependent

on good Y in one (i.e., xy < yx), and the opposite is true in the other (i.e., xy > yx). All the other model elements are set to be identical to ensure that any

difference between the two data sets is attributed to

the asymmetry in complementarity. Each data set is

simulated such that a hypothetical consumer makes a

purchase quantity decision for two goods, X and Y ,

over a certain period (T = 200). Idiosyncratic errors

are drawn from a normal distribution, and prices and

feature advertisements are generated from a standard

normal and a binomial distribution, respectively.

Figure 1 illustrates the different patterns in the

hypothetical data sets that are driven by the asym-

metric complementarity. Each box plot summarizes

a distribution of 1,000 sample correlations, each of

which is computed from a randomly drawn hypothet-

ical data set.

When X is more dependent on Y (i.e., xy < yx), the correlation between the demand of X and the

inventory of Y is greater than the correlation between

the demand of Y and the inventory of X. We also

observe that the magnitude of the positive corre-

lation between the demand of X and the demand

shifter of Y , such as price or feature advertisement,

is greater than that of the opposite case. Likewise,

when Y is more dependent on X, the demand of Y is

more responsive to the temporal changes in the inven-

tory of X, which are possibly driven by the demand

shifters of Y .

Note that it is seldom the case that the demon-

strated patterns in Figure 1 are observed in actual

data in a model-free manner. Because the observed

demand is influenced by many factors other than

complementarity, any asymmetry between the two

goods can create differences in correlations. In addi-

tion, the proliferation of zeros in actual data masks

or at least weakens the relationship among variables

unless it is systematically controlled for.

2.4. Extensions to N Categories Although the model likelihood in (15) is derived for the simplest case with two categories, it can be extended to a more general case where N categories are related to one another. A consumer has a latent level of interest for category i, which is affected by the

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

460

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

Figure 1 Identification of Asymmetric Complementarity

Correlation with cross inventory

(a) When X is more dependent on Y (i.e., xy < yx)

Correlation with cross price

Correlation with cross advertisement

0.3

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0.1

0.0

0.0

0.0

­ 0.1

Corr(X, Inv_Y ) Corr(Y, Inv_X)

­ 0.1

Corr(X, ­Pr_Y ) Corr(Y, ­Pr_X )

­ 0.1

Corr(X, Adv_Y ) Corr(Y, Adv_X )

Correlation with cross inventory

(b) When Y is more dependent on X (i.e., xy > yx)

Correlation with cross price

Correlation with cross advertisement

0.3

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0.1

0.0

0.0

0.0

­ 0.1

­ 0.1

­ 0.1

Corr(X, Inv_Y ) Corr(Y, Inv_X )

Corr(X, ­Pr_Y ) Corr(Y, ­Pr_X )

Note. The panels summarize the sampling distributions of correlations based on 1,000 hypothetical data sets.

Corr(X, Adv_Y ) Corr(Y, Adv_X )

level of inventory and the sum of marketing activities conducted on the ni brands under the category:

ni

i t

=

i 0

+

1

i t

+

2

mikt +

i t

k=1

i 1

N (17)

If

i t

is

assumed

to

follow

an

i.i.d.

Type

I

extreme-

value distribution, the probability of a complete

sequence is given by an exploded logit form as fol-

lows (Chapman and Staelin 1982):

Pr

1 t

>

2 t

>

·

·

·

>

N t

N -1
=
i=1

exp

i 0

+

1

i t

+

2

mikt

N j =i

exp

j

j

0+ 1 t+ 2

mjkt

(18)

Conditional on a specific sequence Si (e.g.,

1 t

>

2 t

>

··· >

N t

),

it

is

straightforward

to

compute

the

con-

ditional likelihood of purchase quantities. Let xi

denote the observed purchase quantities for brands

in category i. The conditional likelihood of the pur-

chase quantities across N categories (x1

xN ) is

given by

L x1

xN  Si = L x1 Si L x2 x1 Si ×···

×L xN  x1

xN -1 Si

(19)

Consequently, the likelihood of purchase quantities is computed by summing over all the joint probabilities of the purchase quantities and sequence as follows:

L x1

N!
xN  = Pr Si L x1
i=1

xN  Si (20)

We acknowledge that the proposed model of sequential decisions is limited to accommodate a relatively small number of categories because the number of latent sequences increases exponentially as the number of categories increases; N categories give rise

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

461

to N ! different latent sequences in total. However, if we can predefine independent categories, the number of latent sequences to be explored is dramatically reduced, which enables us to expand the number of categories in analysis. The development of a more general framework for asymmetric complements is left as a further study.

2.5. Heterogeneity Consumer heterogeneity is incorporated by introducing a random-effect specification for household parameters:

h=

h

 N ¯+



h

h

zh V



h

h

(21)

where h = 1 H indexes the households, and = exp  = 1/ 1 + exp -  .8 We examine house-
hold size and household income as covariates zh, and we center these variables so that ¯ reflects the popu-
lation mean.

2.6. Simulation Study A simulation study is conducted to illustrate the performance of our model. Data are generated according to the model likelihood with randomly generated prices and feature advertising variables for 150 respondents and 150 observations per respondent. These choices were made so that the simulated prices and data are of similar length to our empirical study reported below. We illustrate the model using three product categories and two brands under each category, and various cross-category relationships are imposed among the three categories: X and Y are asymmetric complements, Y and Z are substitutes, and X and Z are assumed to be independent. A random-effect distribution was employed without covariates with covariance equal to 0 5I. Table 1 reports the estimated mean of the random-effect distribution, along with the true values.
All the parameters are well recovered, having the true values within 95% credible intervals. The simulation study confirms that we can estimate models of various cross-category relationships including independence, substitutes, and asymmetric complementarity.

3. Empirical Analysis
3.1. Data We applied our model to the IRI panel data set described in Bronnenberg et al. (2008). Milk and cereal categories are chosen to illustrate the asymmetric cross-category inferences afforded by our

8 The reparameterization guarantees 0 < , 0 < < 1.

Table 1 Parameter Estimates of the Simulation Study

Parameter

True value

Posterior mean

Baseline
x
¯1
x
¯2 y
¯1 y
¯2
z
¯1
z
¯2
Cross-category relationship
¯xy ¯yx ¯xz ¯zx ¯yz ¯zy
Impact of marketing activity on utility
¯x 1
¯x 2
¯y  1
¯y  2
¯z 1
¯z 2
Inventory rate
¯ x
¯ y
¯ z
Decision sequence
y
¯0 ¯0z
¯1
¯2

1 000 0 800 0 700 0 900 0 900 0 900
0 200 0 400 0 000 0 000 -0 100 -0 200
-1 204 -1 204 -1 204 -1 204 -1 204 -1 204
0 0000 0 000 0 000
0 000 0 000 -1 000 1 000

1 000 0 815 0 699 0 898 0 887 0 848

0 040 0 043 0 043 0 042 0 046 0 042

0 194 0 371 -0 088 0 014 -0 118 -0 209

0 042 0 044 0 040 0 037 0 043 0 041

-1 292 -1 292 -1 319 -1 285 -1 239 -1 230

0 085 0 098 0 106 0 098 0 121 0 109

-0 021 0 074 -0 047 0 084 -0 101 0 082

-0 027 -0 295 -0 849
0 823

0 148 0 245 0 291 0 136

Notes. Posterior standard deviations are given in parentheses. = exp  and = 1/ 1 + exp - 

model specification. The data contain each household's grocery shopping history, in which purchase quantities, prices, and marketing activities (e.g., feature and display) are available. We include all purchase occasions in our analysis, including those when no purchases are made in either category. Although our model is general enough to be applied to a brandlevel analysis, the cereal category contains many brands with relatively small volume, with the top 40 brands accounting for 70% of total demand and the share of the leading brand being just 8.8%. We therefore engage in an aggregation of stock-keeping units to keep the number of model parameters to a reasonable level.
We retain the two leading manufacturers in each product category for analysis and aggregate the products to form three package-size groups within each manufacturer. This allows us to move from an analysis of 157 universal product codes (UPCs) to 12 aggregates--6 in milk and 6 in cereal. Therefore, the subscript i in (1) corresponds to each aggregate

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

462

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

Table 2 Data Description

(a) Purchase frequency

Milk and cereal

Milk only

Cereal only

None

Number of trips (%)

3,312 (15.7%)

5,625 (26.6%)

2,323 (11.0%)

9,882 (46.7%)

(b) Descriptive statistics

Milk

Cereal

Guida's

Private label

General Mills

Kellogg's

Package size

Large Medium Small Large Medium Small Large Medium Small Large Medium Small

Number of UPCs

3

3

6

6

9

7

20

21

14

23

22

23

Unit volume (16 oz.)

8.00

4.00

2.00 8.00

4.00

2.00 1.27

0.93

0.70 1.25

0.91

0.68

Unit price (USD)

3.38

1.92

1.07 3.27

1.80

1.05 4.30

3.58

3.51 3.82

3.46

3.27

Price per volume

0.42

0.48

0.54 0.41

0.45

0.53 3.38

3.84

4.99 3.07

3.81

4.79

Feature

0.15

0.04

0.00 0.11

0.08

0.03 0.13

0.17

0.12 0.10

0.12

0.10

Display

0.00

0.00

0.00 0.00

0.00

0.00 0.05

0.08

0.05 0.05

0.06

0.05

Purchase incidence (%) 7.15

2.57

0.09 20.23 13.16

1.50 4.38

8.53

4.58 5.54

5.69

5.86

Purchase quantity

1.35

1.28

1.11 1.26

1.35

1.06 1.49

1.60

1.29 1.32

1.34

1.35

offering, and

x i

is

determined

by

the

following

four

indicators:

x i

=

x 1

D1xi

+

x 2

D2xi

+

x l

DLxi

+

x s

DSix

(22)

where D1xi , D2xi , DLxi , and DSix are the indicators of manufacturer 1, manufacturer 2, large package size, and small package size, respectively. The top two manufacturers are Guida's and private label for milk and General Mills and Kellogg's for cereal, and they account for approximately 60%­80% of the total sales with each category.9 A share-weighted average of the UPC-level store variables (e.g., unit price, unit volume, feature, and display) is computed to represent those of each package-size group. We select households who have at least 20 purchases of milk and cereal during the two-year data period, resulting in 140 households. The unit volume of the most frequently purchased item is used as the base unit of volume for each category (128 oz. for milk, 15 oz. for cereal). A basic description of the data is provided in Table 2.
Households make an average of 151 shopping trips during the two-year data period, with 42% of the trips involving the purchase of milk and 27% of the trips involving cereal; 47% of the trips contain purchases in neither category, and 16% of the trips contain both. We find that large-sized and mediumsized packages of milk are more frequently promoted (e.g., feature advertisement) than other package sizes and that the data show variety-seeking behavior of consumers in both milk and cereal categories. Of the cereal purchases, 13% come from multiple manufacturers, which is rarely observed in milk. Joint

9 The market share for each manufacturer is as follows: Guida's, 21.02%; private label, 54.12%; General Mills, 33.48%; and Kellogg's, 32.68%.

purchases of multiple pack sizes (within the same manufacturer) are observed 5% of the time for milk and 16% for cereal. We use 90% of the data for the model calibration, leaving 10% for prediction.
3.2. Estimation Results We assume that consumers maximize utility subject to budget and packaging constraints, and we employ Lee and Allenby's (2013) estimation strategy for indivisible demand. Demand discreteness is caused by transactions constrained to lie on a grid of support defined by the available package sizes, resulting in a model likelihood with interior points defined in terms of point masses instead of the usual density contribution to the likelihood. As discussed earlier, there are many error realizations associated with any observed purchase when demand is indivisible.
A standard normal distribution with mean zero and unit variance is employed for the distribution of errors. We found that the variance of the errors is weakly identified in our empirical study, which might be due to the lack of variations in purchase quantities. Because zeros and ones are the most frequently observed quantities in our data, fixing the variance at one helps identifying the model parameters. The correlation among the errors within a category is not allowed for alleviating the computational burden in the likelihood computation. However, our model allows for positive correlation among the utilities of the brands within the same category because the category-level inventories affect all the brands within the same category to the same direction. For example, a high inventory of category A decreases the utilities of all the brands within category A because of satiation while it increases the utilities of all the brands within category B because of complementarity.

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

463

Table 3 Parameter Estimates of the Proposed Model

Parameter

Posterior mean

Baseline preference for manufacturer ¯m1 ¯m2 ¯c1 ¯c2
Baseline preference for package size ¯ml ¯ms ¯cl ¯cs
Impact of feature advertisement ¯1m1  ¯1m2  ¯1c1 ¯1c2
Impact of merchandising display ¯2m1  ¯2m2  ¯2c1 ¯2c2
Inventory rate
¯ 1m ¯ 1c
Decision sequence ¯0c
¯i
¯t
¯d

-2 426 0 146 -1 721 0 121 -1 188 0 103 -1 212 0 090
0 781 0 142 -2 600 0 121 -0 240 0 070 -0 009 0 070
-0 512 0 132 -1 410 0 179 -1 068 0 154 -0 665 0 146
na na -0 106 0 095 -0 668 0 163
-2 006 0 246 0 090 0 114
2 129 0 251 -7 338 0 742
0 118 0 178 0 363 0 291

Notes. Posterior standard deviations are given in parentheses. = exp  , and = 1/ 1 + exp -  . For milk, subscripts 1 and 2 indicate Guida's and private label, respectively. For cereal, subscripts 1 and 2 indicate General Mills and Kellogg's, respectively. na, not available.

We estimate the model using Bayesian Markov chain Monte Carlo (MCMC) methods with proper but relatively diffuse priors.10 Seventy thousand iterations of the chain were used to generate parameter estimates, with the first 20,000 draws discarded as burn-in. Because sequential draws from the joint posterior are autocorrelated, we thinned the chain by keeping every 10th draw of the remaining 50,000 draws (Raftery and Lewis 1992, Geyer 1992). The detailed sampling procedure is provided in Appendix A. Table 3 reports posterior means and standard deviations of the hyperparameters, ¯.
There is ordinal agreement between the estimates of baseline preferences for manufacturers reported in Table 3 and the market shares reported in Table 2. Consumers prefer the one-gallon package size in milk and disfavor milk packaged in quart containers. In cereal, the larger package size (20 oz.) is less preferred to medium (15 oz.) or small (11 oz.) package sizes. More

10 h  h

h

 h

h

 h

N

¯

V

, where ¯  N 0 100I

and

V  IW 25 25I .

interesting are the estimates of complementary parameters that reflect cross-category effects. The two categories show a complementary relationship in which the marginal utility of one good is enhanced by the presence of the other. The impact of milk on the utility of cereal is greater than the impact of cereal on the utility of milk (i.e., ¯mc > ¯cm), indicating the presence of asymmetric complementarity. Figure 2 illustrates the asymmetric effect, where the subutility of cereal is heightened with the presence of milk whereas the subutility of milk is weakly enhanced by cereal. These results have face validity because milk is often consumed independently whereas cereal is more likely to be consumed with milk.
Marketing activities of the retailer (e.g., feature advertisement, merchandising display) enhance the marginal utility of the promoted item, which in turn increases the likelihood of purchase. Table 3 shows differences in the effectiveness of various marketing activities. Feature advertisement is effective for Guida's milk and Kellogg's cereal, whereas its influence is small for private label milk and General Mills cereal. The merchandising display of cereal has a greater impact in increasing the marginal utility than the feature advertisement.
The inventory rate is greater for cereal than for milk, implying that consumers tend to stockpile cereal, whereas milk is more frequently depleted. The baseline interest of cereal is higher than that of milk, which is set to be zero for identification. However, when a consumer stockpiles cereal, the purchase decision for milk is made first as the latent interest of cereal is lowered because of the inventory. The marketing activities such as feature and display do not make a significant impact on the latent interests of the categories.
Finally, we find that household size is significantly related to the individual-level parameters as summarized in Table 4. Larger households prefer larger packages of milk, but not cereal. We do not find any significant relationship between household income and individual-level parameters.
Although not reported, for the sake of brevity, the estimate of the variance­covariance matrix of the random effects show that consumers are more heterogeneous in the impact of milk on the utility of cereal than in the impact of cereal on the utility of milk (i.e., var mc = 0 59 > var cm = 0 27). The positive correlation among the two complementarity parameters (i.e., cov mc cm = 0 09) suggests that the two goods tend to be jointly complementary.
3.3. Model Comparison The proposed model is compared with six benchmark models. The first model is identical to the proposed model except for the symmetric restriction in complementarity (i.e., ij = ji). The second model

464

Figure 2

Asymmetric Interdependency in Utility
(a) Guida's 1.2
Without cereal With cereal 0.8

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements Marketing Science 32(3), pp. 454­470, © 2013 INFORMS
(b) Private label 1.2
0.8

Utility

Utility

0.4

0.4

0.0

0

1

2

3

4

5

Quantity

(c) General Mills 1.2

0.0

0

1

2

3

4

5

Quantity

(d) Kellogg's 1.2

0.8

0.8

Utility

Utility

0.4

0.4

0.0

0

1

2

3

4

5

Quantity

Note. Drawn based on 128 oz. milk and 15 oz. cereal package sizes.

assumes that there is no interdependency between the two categories (i.e., ij = ji = 0). When categories are independent, the conditional likelihood of purchase quantities given a sequence stays the same across different sequences. Therefore, the parameters for capturing the latent level of category interest (i.e., ) are not identified in benchmark model 2. In the third and fourth benchmark models, consumers' purchase sequence is assumed to be fixed and thus preimposed by the analyst. Benchmark model 3 assumes that milk is determined independently, and then the decision on cereal is made conditionally. The opposite sequence is true in benchmark model 4.
We also develop a model of simultaneous decisions, benchmark model 5, in which consumers are assumed to maximize the joint utility of milk and cereal together with an outside good. This model does not allow for the direct interaction between the purchase quantities of milk and cereal in the same shopping basket. The last benchmark model employs a linear consumption pattern for latent inventory, assuming that a fixed amount of a good is consumed during a unit period. This model allows us to check the robustness of our results with regard to the choice of a consumption pattern of latent inventory. Detailed

0.0

0

1

2

3

4

5

Quantity

descriptions of the six benchmark models are provided in Appendix B. Table 5 compares the proposed model with the benchmark models in terms of model fit, and the parameter estimates of the six benchmark models are presented in Table 6.
Table 5 shows that the proposed model outperforms all the benchmark models in both in-sample and predictive fits. In Table 6, imposing symmetric restrictions on the nature of complementarity as in the first benchmark model leads to a systematic bias such that the impact of milk on the utility of cereal is underestimated whereas the impact of cereal on the utility of milk is overestimated. Accordingly, the baseline parameters of the more dependent category (i.e., cereal) are inflated, whereas those of the independent category (i.e., milk) are reduced. Benchmark model 2, in which no complementarity is assumed, shows the worst performance in fitting the data. This indicates that allowing for some complementarity is important, and we also find that ignoring complementarity results in the overestimation of the baseline parameters, especially for the more dependent category (i.e., cereal). Comparison to the third and fourth benchmark models indicates that the sequence of purchase decisions varies over time and across households.

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

465

Table 4 Impact of Household Size on Parameters

Parameter

Posterior mean

Baseline preference for manufacturer
m
¯1 ¯¯¯c2m2c1 Baseline preference for package size ¯¯mscml ¯l ¯cs
Cross-category relationship
¯mc ¯cm
Impact of feature advertisement ¯1m1  ¯1m2  ¯1c1  ¯1c2 
Impact of merchandising display ¯2m1  ¯2m2  ¯2c1  ¯2c2 
Inventory rate
¯ m
¯ c
Decision sequence ¯0c ¯i ¯f ¯d

-0 138 0 103 -0 088 0 090
0 058 0 078 -0 006 0 066
0 560 0 106 -0 136 0 099
0 056 0 052 -0 038 0 054
-0 028 0 053 0 009 0 033
0 084 0 088 0 204 0 110 0 192 0 089 0 106 0 079
na na -0 005 0 065 0 150 0 090
0 204 0 166 -0 139 0 081
-0 319 0 195 -0 305 0 393 -0 226 0 130
0 148 0 221

Notes. Posterior standard deviations are given in parentheses. = exp  , and = 1/ 1 + exp -  . na, not available.

The simultaneous decision model (i.e., benchmark model 5) does not fit the data as well, supporting the view that consumer decisions across categories are sequential, not simultaneous. Finally, when we employ a linear form of inventory decay, the asymmetric complementarity between milk and cereal

Table 5 Model-Fit Comparison

Model

In-sample fit (LMD)

Prediction likelihood

Proposed (asymmetric complementarity)
Benchmark 1 (symmetric complementarity)
Benchmark 2 (no complementarity)
Benchmark 3 (fixed sequence: milk first)
Benchmark 4 (fixed sequence: cereal first)
Benchmark 5 (simultaneous decision)
Benchmark 6 (linear inventory decay)

-49 458 78 -50 010 32 -51 035 61 -50 203 07 -50 435 24 -50 496 64 -50 468 43

-5 208 81 -5 261 48 -5 364 50 -5 314 83 -5 361 54 -5 388 88 -5 321 91

Note. LMD, log marginal density (Newton and Raftery 1994).

is preserved, showing the robustness of our results regardless of the choice of consumption pattern. There are some parameters whose estimates are sensitive to the choice of a consumption pattern such as the baseline parameters. Because the linear decay model is susceptible to a spike in demand, while it is more smoothly accommodated in the proposed model due to the exponential decay pattern, it is not surprising to see the decrease of the model fit as well as the differences in the parameter estimates.
4. Discussion
Asymmetric complements are products that drive utility in other categories at differential rates, and their presence is potentially important for product design, pricing, distribution, and advertising decisions. In the extreme case of tied goods such as a computer printer and ink, it is often profitable to enhance, advertise, and price discount the dominant good (e.g., the printer) with the goal of inducing sales in the dependent good. Our model informs such decisions through the estimated model parameters. In our analysis of scanner panel data, we observe varying prices and merchandising variables, and in this section we explore the implications of asymmetric complements on these variables.
We use our sequential model of asymmetric complements to investigate two issues. First, we compute model-based cross-price elasticity estimates by aggregating individual-level demand estimates under various price discounts, and we show that the estimates are influenced by the presence of asymmetric effects. We then investigate the cross-category effect of merchandising variables.
4.1. Cross-Price Elasticity Complementarity produces a positive interaction in the demand for products, resulting in negative crossprice effects where the decrease in the price of one category leads to an increase in the demand of another. To estimate the cross-price elasticity between milk and cereal, we calculate the expected demand of each category for various prices. The expected demand is computed by integrating over the posterior distributions of parameters as well as the distribution of error terms for each of the actual (observed) prices versus prices that are increased or decreased by the indicated amount. The budgetary allotment for each household is set to be equal to the maximum spending for the inside goods plus the maximum unit price among the inside goods, which guarantees the feasibility of the additional purchase. Feature and display variables are set to be their average values in the data to reflect an average level of promotion in the product category. The level of inventory is similarly set to be the average value of the inventory trajectory that is computed from the household-specific estimate of the

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

466

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

Table 6 Parameter Estimates of the Benchmark Models

Model Benchmark 1 Benchmark 2 Benchmark 3 Benchmark 4 Benchmark 5 Benchmark 6

¯m1
-2 438 0 145
-2 270 0 133
-2 302 0 152
-2 353 0 137
-2 261 0 141
-2 814 0 101

¯

m 2

-1 773 0 118
-1 554 0 109
-1 610 0 129
-1 682 0 117
-1 571 0 119
-2 137 0 081

¯c1
-1 077 0 106
-0 801 0 096
-1 097 0 113
-0 865 0 098
-0 904 0 106
-2 229 0 080

¯c2
-1 097 0 098
-0 821 0 082
-1 116 0 094
-0 879 0 083
-0 916 0 092
-2 290 0 072

¯ml
0 715 0 143 0 769 0 139 0 754 0 141 0 759 0 138 0 746 0 132 0 836 0 126

¯ms
-2 479 0 120
-2 690 0 160
-2 676 0 164
-2 550 0 118
-2 646 0 142
-2 577 0 174

¯

c l

-0 237 0 069
-0 235 0 069
-0 238 0 066
-0 241 0 066
-0 242 0 068
-0 158 0 069

¯cs
0 001 0 068 -0 002 0 063 0 000 0 066 -0 005 0 065 0 003 0 066 -0 097 0 070

¯mc
0 274 0 047 0 000
na 0 285 0 050 -0 091 0 085 0 122 0 080 0 444 0 072

¯cm
0 274 0 047 0 000
na 0 080 0 049 0 091 0 037 0 076 0 046 0 032 0 041

Model

¯1m1 

¯1m2 

¯1c1 

¯1c2 

¯2c1 

¯2c2 

¯ m

¯ c

¯0c

¯i

¯f

¯d

Benchmark 1 Benchmark 2 Benchmark 3 Benchmark 4 Benchmark 5 Benchmark 6

-0 495 0 130
-0 464 0 147
-0 547 0 158
-0 478 0 124
-0 557 0 175
-0 293 0 120

-1 376 0 162
-1 468 0 168
-1 479 0 183
-1 522 0 171
-1 415 0 174
-1 274 0 177

-1 085 0 176
-1 064 0 154
-1 091 0 184
-1 171 0 189
-1 127 0 173
-1 111 0 151

-0 628 0 141
-0 642 0 166
-0 591 0 133
-0 623 0 127
-0 601 0 128
-0 485 0 152

-0 104 0 090
-0 084 0 100
-0 079 0 091
-0 077 0 100
-0 073 0 088
0 262 0 084

-0 650 0 134
-0 601 0 121
-0 654 0 134
-0 634 0 160
-0 667 0 156
-0 249 0 126

-1 870 0 209
-1 918 0 201
-1 949 0 237
-1 827 0 221
-1 810 0 211
1 479 0 121

0 076 0 113
0 183 0 115
0 141 0 114
0 194 0 115
0 187 0 118
2 199 0 167

1 418 0 253
na

-8 303 0 950
na

-0 121 0 215
na

-0 363 0 267
na

na

na

na

na

na

na

na

na

na

na

na

na

0 312 -4 719 0 226 0 412

0 131 0 156

1 547 0 370

Notes. Posterior standard deviations are given in parentheses. = exp  . = 1/ 1 + exp -  for benchmarks 1­5 and = exp  for benchmark 6. na, not available.

inventory rate parameter and the time-series data of purchase history.
Table 7 reports changes in expected demand when prices are changed by 10%. Also reported, in parentheses, is the expected change in demand for the first two benchmark models. The first benchmark model assumes that complementary effects are symmetric (i.e., ij = ji), and the second benchmark model assumes no complementary relationships (i.e.,
ij = ji = 0).

Table 7 Estimates of Price Elasticity

% Change in demanda

Milk

Cereal

Outside good

10% decrease in milk price
10% decrease in cereal price

13.26 (13 85 11 41)
3.39 (5 24 0 00)

6.78 (5 08 0 00)
16.89 (15 78 13 13)

-0.34 (-0 30 -0 01)
-0.34 (-0 37 -0 06)

Note. Price elasticities based on benchmark models 1 and 2 are provided in parentheses for comparison.
a% Change implies the ratio of increased demand compared with the demand under a reference condition, where neither price is changed.

As the price of a product decreases, its own demand increases (i.e., negative own-price elasticity), and the demand of the complementary product increases while the demand of the outside good decreases. The own-price elasticity of cereal (i.e., -1.689) is greater in its magnitude than that of milk (i.e., -1.326). The demand for cereal is sensitive to the price change of milk (i.e., -0.678), and the impact of cereal prices on the demand of milk is smaller (i.e., -0.339), showing that the asymmetric effects in utility leads to asymmetric effects in price. The comparison to the benchmark models indicates that the restriction of symmetric or no interdependency distorts the ownprice as well as cross-price elasticities. The model of symmetric complementarity underestimates the spillover effect of price change in milk and overestimates the spillover effect of price change in cereal.
One might argue that the complementarity between the two goods is not the only source of the negative cross-price elasticity of aggregate demand. When there is a price discount in one category, it not only changes the rate of exchange among goods (i.e., the substitution effect) but also enhances the purchasing power (i.e., the income effect) of a consumer's budget. The

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

467

Table 8 Slutsky Decomposition of the Price Effects

% Change in demanda

Milk

Cereal

Outside good

Substitution effect Income effect
Total effect

(a) 10% decrease in milk prices

12 71

5 93

0 55

0 85

13 26

6 78

-0 48 0 14
-0 34

(b) 10% decrease in cereal prices

Substitution effect Income effect

2 75

14 74

0 64

2 14

Total effect

3 39

16 89

-0 52 0 18
-0 34

a% Change implies the ratio of increased demand compared with the demand under a reference condition, where neither price is changed.

Slutsky equation addresses this issue by decomposing the impact of a price change into two effects, a substitution effect and an income effect:

xi p E pj

=

hi p u pj

-

xi

pE E

xj

p

E

(23)

where h p u is the Hicksian demand and x p E is the Marshallian demand, at price p, budget E, and utility level u. Whereas the substitution effect results from the change of relative prices, the income effect captures an increase or decrease in the consumers purchasing powers as a result of the price change. The results of Slutsky decomposition11 are reported in Table 8.
Whereas the income effects are small for the inside goods, it is relatively greater for the outside good, implying that the increased purchase power by a price discount tends to be saved rather than increasing the purchase quantities of the inside goods. The positive substitution effect of a price discount on the crosscategory demand reflects that the positive impact of complementarity overrides the negative impact of changes in the relative prices. Consequently, the observed positive cross effects are mainly driven by complementarity, not by an income effect.

4.2. Spillover Effect of Marketing Activity Table 9 reports estimates of the effect of changes in the feature advertisement. Reported is the percentage

11 Because of the uncertainties in the estimated utility and the demand indivisibility, the Slutsky decomposition was conducted by using simulated demand. The total change in demand (i.e., x p E - x p E ) is decomposed by introducing the hypothetical demand that would be realized under the new price with the maintained purchase power (i.e., x p E , where E = x p E × p ). That is, the substitution effect implies the change in demand due only to the change in price ratio when the income is adjusted so that the consumer can exactly afford the original bundle (i.e., x p E - x p E ), whereas the income effect is measured by the remaining change in demand (i.e., x p E - x p E ).

Table 9 Spillover Effect of Merchandising Activity

% Change in demanda

Merchandising activity

Milk

Cereal

Outside good

Feature advertisement of milk
Feature advertisement of cereal

2.23 (2 00 1 51)
0.24 (0 81 0 00)

0.56 (1 00 0 00)
1.83 (2 28 1 72)

-0.11 (-0 12 -0 05)
-0.08 (-0 12 -0 06)

Note. Spillover effects based on benchmark models 1 and 2 are provided in parenthesis for comparison.
a% Change of demand is the percentage increase in demand when merchandising is enhanced by 20% a compared with existing merchandising activity.

change in demand when the feature advertisement is enhanced by 20% in each category. We find, as with the price elasticity estimates, that the spillover effect is greater when the independent category is promoted. Enhanced feature advertisement in milk increases the demand of cereal by 0.57%, and the demand of milk increases by 0.24% with the feature advertisement in cereal.
In summary, we find that allowing for asymmetric parameters in a direct utility model is important for measuring cross-category spillover effects. Demand of the more dependent category is influenced to a greater extent by the marketing activities on its complement, and the spillover effect is small for the opposite case. Not accounting for asymmetric parameters in the utility structure, as is in benchmark models 1 and 2, leads to systematic biases in the effects of prices and merchandising variables: (i) the underestimation (overestimation) of the cross-category effects of marketing activities of a less (more) dependent category and (ii) the distortion of the effects of marketing activities on its own demand.

5. Concluding Remarks
A model of asymmetric complements is developed within a formal model of direct utility maximization. Complementary effects occur when the marginal utility of one good is enhanced by the presence of a second good. A challenge in developing models of such asymmetry is due to it being equal to the second derivative of the utility function 2U / x1 x2 , which is symmetric because the order of differentiation does not matter. Additional information is therefore needed to identify asymmetric utility effects, and this paper uses the longitudinal variation of marginal utility in response to the variation in the cross-category inventory as revealed in observed purchases across product categories.
A latent decision sequence is hypothesized and used to identify a sequential purchase decision where the purchase of goods early in the sequence is not affected by goods later in the sequence. We allow the order

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

468

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

of the purchase sequence to be partially dependent on current product inventory and merchandising variables that change over time. The model likelihood is obtained by integrating over all possible decision sequences, and it is shown to fit our data better than models that restrict effects to be either symmetric or nonexistent. We find evidence of asymmetric spillover effects between milk and cereal, where milk influences the consumption of cereal but cereal has little effect on milk consumption.
Identifying the presence of asymmetric complements is important whenever decisions have multiple components and the decision sequence is not fixed. Cross-selling activities is one example where the order of product purchase may impact the likelihood of purchasing other items. This occurs in financial services where it is believed that some initial exposure to a firm through a simple product (e.g., a checking account) aids in the successful sale of more complicated products (e.g., insurance products). The same rationale is used to offer introductory items at a discount to encourage additional purchases in the future. The identification of which introductory items have larger spillover effects is an important consideration in this strategy. We therefore believe the model has potentially wide application.
We acknowledge the following limitations of our model and empirical findings. First, we selected the households that purchase both milk and cereal on a regular basis because enough variations in data help us to better identify the model parameters. The variations in purchase quantities lead to the variations in latent inventories, which enable us to identify asymmetric complementarity.12 Second, our model is restricted to accommodate a relatively small number of categories because the number of possible sequences increases exponentially as more categories are included. Third, the proposed model is limited in its ability to allow for bidirectional influence between the purchase quantities of two complementary goods because the later decision of a latent sequence does not have an impact on earlier decisions. The development of a simultaneous decision model where bidirectional influence is captured is left for future research. Finally, additional research is needed to identify the attributes and attribute levels that give rise to asymmetric effects. Our analysis based on observed demand data did not include information on product attributes, and
12 We confirmed that the asymmetric complementarity found in our empirical study is preserved with a larger data set where less frequent shoppers (i.e., at least five purchases of milk and cereal during the two-year data period) are also included. The randomeffects distribution in the Bayesian hierarchical model plays an important role in identifying the individual-level parameters for households with sparse purchase occasions. The estimation results with an extended data set are provided in Appendix C.

we view the ability to identify the origin of asymmetric effects as a potentially profitable area of marketing research. The development of asymmetric models of stated preference data is therefore also needed.

Appendix A. Estimation Procedure The proposed model of asymmetric complementarity is estimated by Bayesian MCMC methods. The joint posterior is derived by multiplying the model likelihood, derived in §2.2, to the prior distributions specified as follows:

h

h

h

 h

h

 h

N

¯

V

¯  N 0 100I V  IW I

= 25

The estimation algorithm starts by setting the initial values

for the coefficients of the random-effect distribution (i.e., ¯

and V ). Conditional on these initial values, the individual-

level parameters (i.e., h) can be drawn by a MetropolisHastings algorithm with a random walk chain. The spirit

of a blocked Gibbs sampler can be employed for efficiency

such that two or more parameters are grouped and sam-

pled together using a Metropolis-Hastings algorithm con-

ditional on the rest of the parameters. In our empirical

study, the individual-level parameters were grouped into

three: (i)

h

h , (ii)

 h

,

and

(iii)

h

 h

,

and

the

param-

eters in the same group were jointly drawn the Metropolis-

Hastings algorithm with a random walk chain. Once all

the individual-level parameters are drawn, the coefficients

for the random-effects distribution can be easily drawn by

using a Gibbs sampling method that is widely used for a

Bayesian multivariate regression.

Step 1. Set initial values for ¯ and V ( ¯ 0 = 0 V 0 = 25I22).

Step 2. Set initial values for

h h=1

H

(

0 h

=0

 h).

Step 3. Draw h h=1 H .

At the kth iteration,

k h

is drawn from a Metropolis-

Hastings algorithm with a random walk chain

k h

¯ k-1

V k-1  N ¯ k-1 V k-1 × xht yht t=1 T .

(i) Draw

k h

k h

 k-1 h

k-1 h

 k-1 h

¯ k-1 V k-1 .

(ii) Draw

k h

k h

k h

k-1 h

 k-1 h

¯ k-1 V k-1

(iii) Draw

k h

k h

k h

k h

k h

¯ k-1 V k-1

(iv) Repeat (i)­(iii) for each household (h = 1 H ).

Step 4. Draw ¯.

¯ k  N B H V k-1 -1 + 100I -1 -1

where

B=

HV

k-1

-1
+100I

-1

-1

H V k-1 -1 H

k h

+100I -1

0

h=1

Step 5. Draw V .

V k  IW

0+H

H

I+

k h

-

¯k

h=1

k h

-

¯k

Step 6. Repeat Steps 3­5 at each iteration of the MCMC. (The draws at the previous iteration become the new initial values.)

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

469

Appendix B. Benchmark Models

A Sequential Decision Model with Symmetric Complementarity. The model is identical to the proposed model except for the symmetry restriction in complementarity (i.e.,
ij = ji).

A Sequential Decision Model with No Complementarity. The model is identical to the proposed model except for the restriction of no complementarity (i.e., ij = ji = 0).

A Fixed Decision Sequence Model (Milk First). The

model assumes that the purchase decision of milk (xt) is always made first. The utility of milk is enhanced only by

the inventory of cereal, but not by the new purchase (yt):

x it

=

exp

x i

+

yx

y
t+

x i

mxit

+

x it

Because the purchase of cereal (yt) is considered after the decision on milk (xt), the utility of cereal is influenced by the sum of the inventory and the newly purchased amount
of milk:

y jt

=

exp

y
j + xy

x t

+

six xit

+

y j

myj t

+

y jt

i

Because the sequence is fixed such that milk is always con-

sidered first (i.e., Pr

x t



y t

= 1 , the likelihood of the

observed purchase quantities is given by

L xt yt

= L xt yt

x

y

t t

= L xt

x
t

y t

L

yt

xt

x

y

t t

A Fixed Decision Sequence Model (Cereal First). The model assumes that the purchase decision of cereal is always made prior to the purchase decision of milk.

A Simultaneous Decision Model with Asymmetric Complementarity. The model assumes that a consumer maximizes the joint utility of milk and cereal together with an outside good:

max
xt yt zt

U xt yt zt

xy
t t=

x it

log

six xit

+

x t

i

+

y jt

log

sjy yjt

+

y
t+

z zt

j

s.t.

pixt xit + pjyt yjt + zt  E

i

j

xit  0 1 2

i

yjt  0 1 2

j

zt  0

where

x it

=

exp

x i

+

yx

y
t+

x i

mxit

+

x it

and

y jt

=

exp

y
j+

xy

x t

+

y j

myj t

+

y jt

.

The model does not allow for direct interaction between

the purchase quantities of milk and cereal in the same shop-

ping basket, implying that the utility enhancement is driven

by the cross inventory only. Because it brings a new set of

challenges13 to develop a simultaneous decision model in

which the direct interaction between the purchase quanti-

ties of the complementary goods is incorporated, we leave

it for future research.

13 For example, a joint decision model for complementary goods requires a utility specification that is not additively separable

A Model with a Linear Inventory Decay. The model assumes that a constant amount of goods is consumed in a unit period. Because a linear decay pattern does not preclude negative values, inventories are truncated at zero, which implies depletion:

x t

=

max

0

2

x
t-1 +

sixxi t-1 - x t - 1 t

i=1

Appendix C. Estimation Results with an Extended Data Set The extended data set contains 303 households who have at least five purchases of milk and cereal during the two-year data period. The estimation results reported in Table C.1 show a consistent pattern with the main results in Table 3.

Table C.1

Parameter Extimates of the Proposed Model with an Extended Data Set

Parameter

Posterior mean

Baseline preference for manufacturer ¯m1 ¯m2 ¯c1 ¯c2
Baseline preference for package size ¯ml ¯ms ¯cl ¯cs
Cross-category relationship
¯mc
¯cm
Impact of feature advertisement
¯1m1 
m
¯12
c
¯11 ¯1c2

-2 302 0 095 -1 682 0 074 -1 309 0 072 -1 264 0 063
0 472 0 092 -2 304 0 134 -0 261 0 043
0 022 0 041
0 566 0 056 0 120 0 025
-0 579 0 122 -1 406 0 121 -1 160 0 135 -0 514 0 094

because of the synergetic effect of a joint purchase. In this case, accommodating the discreteness of demand is challenging because a complicated integration is required for the likelihood computation (Lee and Allenby 2013). Second, a joint utility maximization model for complementary goods is limited in its flexibility for accommodating the multifaceted nature of multicategory demand. In particular, the chance of a variety-seeking behavior, where multiple brands of one category are chosen together, has been largely ignored in previous literature to reduce the dimensionality of the problem. Song and Chintagunta (2007) employ a linear subutility for brands within a category, implying that only one brand can be purchased under each category. Finally, a joint utility maximization model for complementary goods assumes that a decision maker is aware of all the market information (e.g., prices, promotions) for all the brands in multiple categories. Given that a consumer is exposed to marketing information in a sequential manner, the inconsistency between the model assumption and the reality should be carefully handled.

Lee, Kim, and Allenby: Direct Utility Model for Asymmetric Complements

470

Marketing Science 32(3), pp. 454­470, © 2013 INFORMS

Table C.1 (Cont'd.)

Parameter

Posterior mean

Impact of merchandising display
m
¯21 ¯22m
c
¯21
c
¯22
Inventory rate
¯ m
¯ c
Decision sequence ¯0c
¯i
¯f
¯d

na na 0 097 0 062 -0 449 0 089
-1 162 0 151 0 985 0 081
2 218 0 228 -8 249 0 624
0 194 0 330 0 550 0 317

Notes. Posterior standard deviations are given in parentheses. = exp  , and = 1/ 1 + exp -  . na, not available.

References
Ailawadi KL, Gedenk K, Lutzky C, Neslin SA (2007) Decomposition of the sales impact of promotion-induced stockpiling. J. Marketing Res. 44(3):450­467.
Ainslie A, Rossi PE (1998) Similarities in choice behavior across product categories. Marketing Sci. 17(2):91­106.
Basu A, Mazumdar T, Raj SP (2003) Indirect network externality effects on product attributes. Marketing Sci. 22(2):209­221.
Bronnenberg BJ, Kruger MW, Mela CF (2008) Database paper: The IRI marketing data set. Marketing Sci. 27(4):745­748.
Chapman RG, Staelin R (1982) Exploiting rank ordered choice set data within the stochastic utility model. J. Marketing Res. 19(3):288­301.
Christensen LR, Jorgenson DW, Lau LJ (1975) Transcendental logarithmic utility functions. Amer. Econom. Rev. 65(3): 367­383.

Dubé J-P (2004) Multiple discreteness and product differentiation: Demand for carbonated soft drinks. Marketing Sci. 23(1):66­81.
Duvvuri SD, Ansari A, Gupta S (2007) Consumers' price sensitivities across complementary categories. Management Sci. 53(12):1933­1945.
Erdem T (1998) An empirical analysis of umbrella branding. J. Marketing Res. 35(3):339­351.
Geyer CJ (1992) Practical Markov chain Monte Carlo. Statist. Sci. 7(4):473­483.
Hansen K, Singh V, Chintagunta P (2006) Understanding storebrand purchase behavior across categories. Marketing Sci. 25(1):75­90.
Lee S, Allenby GM (2013) Modeling indivisible demand. Working paper, University of Iowa, Iowa City.
Li S, Sun B, Wilcox RT (2005) Cross-selling sequentially ordered products: An application to consumer banking services. J. Marketing Res. 42(2):233­239.
Manchanda P, Ansari A, Gupta S (1999) The "shopping basket:" A model for multicategory purchase incidence decisions. Marketing Sci. 18(2):95­114.
Mehta N (2007) Investigating consumers' purchase incidence and brand choice decisions across multiple product categories: A theoretical and empirical analysis. Marketing Sci. 26(2):196­217.
Nair H, Chintagunta PK, Dubé J-P (2004) Empirical analysis of indirect network effects in the market for personal digital assistants. Quant. Marketing Econom. 2(1):23­58.
Newton MA, Raftery AE (1994) Approximate Bayesian inference by the weighted likelihood bootstrap. J. Roy. Statist. Soc. Ser. B 56(1):3­48.
Pashigian BP (1998) Price Theory and Applications (Irwin/McGrawHill, Boston).
Pollak RA, Wales TJ (1992) Demand System Specification and Estimation (Oxford University Press, Oxford, UK).
Raftery AE, Lewis SM (1992) [Practical Markov chain Monte Carlo]: Comment: One long run with diagnostics: Implementation strategies for Markov Chain Monte Carlo. Statist. Sci. 7(4): 493­497.
Song I, Chintagunta PK (2007) A discrete-continuous model for multicategory purchase behavior of households. J. Marketing Res. 44(4):595­612.
Terui N, Ban M, Allenby GM (2011) The effect of media advertising on brand consideration and choice. Marketing Sci. 30(1):74­91.

