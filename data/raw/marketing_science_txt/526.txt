CELEBRATING 30 YEARS
Vol. 30, No. 2, March­April 2011, pp. 274­289 issn 0732-2399 eissn 1526-548X 11 3002 0274

doi 10.1287/mksc.1100.0620 © 2011 INFORMS

The Evolution of Internal Market Structure
Oliver J. Rutz
Yale School of Management, Yale University, New Haven, Connecticut 06520, oliver.rutz@yale.edu
Garrett P. Sonnier
Red McCombs School of Business, University of Texas at Austin, Austin, Texas 78712, garrett.sonnier@mccombs.utexas.edu
We present a dynamic factor-analytic choice model to capture evolution of brand positions in latent attribute space. Our dynamic model allows researchers to investigate brand positioning in new categories or mature categories affected by structural change such as entry. We argue that even for mature categories not affected by structural change, the assumption of stable attributes may be untenable. We allow for evolution in attributes by modeling individual-level time-specific attributes as arising from dynamic means. The dynamic attribute means are modeled as a Bayesian dynamic linear model (DLM). The DLM is nested within a factor-analytic choice model. Our approach makes efficient use of the data by leveraging estimates from previous and future periods to estimate current period attributes. We demonstrate the robustness of our model with data that simulate a variety of dynamic scenarios, including stationary behavior. We show that misspecified attribute dynamics induce temporal heteroskedasticty and correlation between the preference weights and the error term. Applying the model to a panel data set on household purchases in the malt beverage category, we find considerable evidence for dynamics in the latent brand attributes. From a managerial perspective, we find advertising expenditures help explain variation in the dynamic attribute means.
Key words: choice modeling; Bayesian estimation; dynamic models; factor-analytic models History: Received: August 4, 2009; accepted: October 20, 2010; Eric Bradlow served as the editor-in-chief
and Greg Allenby served as associate editor for this article. Published online in Articles in Advance February 9, 2011.

1. Introduction
Factor-analytic choice models are often used to represent the internal structure of a market. Using data on consumer choice among competing brands, these models infer the positions of brands in a latent attribute space and consumer preferences for those attributes.1 In most applications, internal market structure is investigated by taking a short-run (e.g., six months in Elrod and Keane 1995) snapshot of a mature category, assuming that brand positions are constant over time (Elrod 1988, Elrod and Keane 1995). Erdem and Winer (1999) extend the internal market structure approach to model the correlation in latent attributes across different product categories. Erdem (1996) accounts for consumer choice dynamics by modeling consumers as potentially statedependent in their choices. Consumers may exhibit either habit persistence or variety-seeking behavior. More specifically, habit persistence or variety seeking is captured as a function of the difference between
1 The term market structure has been used to describe the representation of brand positions in an attribute space (e.g., Elrod 1988, Elrod and Keane 1995, Erdem 1996). We build on this stream of research and have thus adopted this terminology. Market structure has also been used to describe substitution patterns in a market as evidenced by cross-price elasticities (Cooper 1988, Kamakura and Russell 1989).

the latent brand positions of the current and previous choice. In a recent paper, Inman et al. (2008) combine Erdem's (1996) model with Fader and Hardie's (1996) stock-keeping unit (SKU) attribute approach to estimate the latent position of SKU attributes along with attribute-level choice dynamics.
A critical assumption of extant models of internal market structure is that the brand positions in the latent attribute space do not evolve over time. In this paper, we argue that latent brand attributes, and hence the competitive positions defined by these attributes, may evolve over time.2 Although this seems likely for a new category, it may also hold for a mature and stable category. If so, static models of internal market structure may yield misleading insights. A potential source of dynamics, for example, is advertising. Consider the two roles of advertising espoused in the economics and marketing literatures, information and persuasion (Ackerberg 2001, Narayanan and Manchanda 2009). These are inherently dynamic constructs and hold the potential to change consumer perceptions about a brand over time. For example, marketing communications on the health benefits of a particular brand of orange juice
2 For ease of exposition, we will use the term "brand attributes" to refer to the latent brand attributes.

274

Rutz and Sonnier: The Evolution of Internal Market Structure

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

275

may influence a consumer's utility by informing her about health properties of the brand (Stigler and Becker 1977). Even once educated, the consumer may still be open to persuasion. Indeed, models of decaying stocks of "goodwill" capture the notion that perceptions about a brand are inherently dynamic (for example, see Nerlove and Arrow 1962).
The competitive positioning of brands in an attribute space is one of the key strategic decisions faced by marketing managers. The goal of positioning is to utilize the marketing mix to locate the brand in a distinctive place in the mind of the consumer (Kotler and Keller 2006). A brand's competitive position is largely influenced by its points of differentiation, which can be established on more tangible physical features or more intangible attributes. For example, Coca-Cola and Pepsi are differentiated on the physical dimension of sweetness. In blind taste tests, consumers express a preference for Pepsi. However, preference for Coca-Cola is enhanced by the Coke brand, due in part to branding efforts (Ariely 2008). These branding efforts often focus on intangible attributes. For example, Coca-Cola's current marketing communications use the slogan "Open happiness." It is unclear which tangible attribute or attributes provide "happiness."
Differentiation by tangible attributes is difficult to achieve for many consumer packaged goods. Frequently, consumers cannot differentiate between products in blind tastings (Keller 2003). From the consumers' perspective, these products are often differentiated primarily by intangible assets such as brand identity (Bronnenberg et al. 2009). Thus, firms continually invest in market communications to strengthen current positions or move to more favorable ones. Existing models of internal market structure are not well suited to capture evolution in product positioning. Although evolution in positioning can involve changes to the physical attributes of a product (e.g., successive generations of a durable good), changes in marketing communications alone may also trigger a change in a brand's position. Consider, for example, Anheuser-Busch's $50 milliondollar "drinkability" campaign for Bud Light (Beirne 2008). The light beer category is well established in the United States and is dominated by three players with relative stable market shares: Anheuser-Busch, Coors, and Miller. Thus, it seems reasonable to posit that the light beer category is a good example of a stable and mature category. Bud Light's focus on the subjective attribute drinkability is not the result of a reformulation of the physical product. It appears that the firm is attempting to affect consumer perceptions about the product.
Although product position may evolve in mature categories, it is more likely that evolution occurs in

new product categories or categories impacted by structural shocks. Van Heerde et al. (2004) show that entry shifts existing brands' price and advertising elasticities (with respect to sales) immediately after introduction of a new brand, and over time, the elasticities stabilize. Building on their findings, we posit that in new categories or categories affected by structural change, latent brand positions are potentially evolving. If so, existing models of internal market structure are limited in their ability to study new and evolving categories because of the assumption of stable latent brand attributes over the observation window. Especially in these categories, the need for managers to understand positioning relative to competitors is important for growth and development of a strong brand. A dynamic factor-analytic choice model, as proposed in this paper, can help us to understand the positioning dynamics in a new category.
To summarize, in both mature and new categories the potential for evolving brand attributes exists. The main contribution of this paper is to develop a dynamic model of internal market structure that allows for evolution of latent brand attributes.3 Although applicable to new product categories, the method also enables researchers to revisit brand position dynamics in mature categories (perhaps because of firm repositioning efforts). The model can also accommodate the introduction of new brands over the analysis horizon.4 The model is specified as a factor-analytic multinomial probit and is estimated via Markov chain Monte Carlo (MCMC) methods. We use data augmentation to draw a set of latent utilities consistent with the observed choice data. Conditional on the draws of the latent utilities, we estimate individual-level dynamic brand attributes, individuallevel preference weights for these attributes, and individual-level parameters for both marketing mix variables and consumer state dependence. We estimate the dynamic attributes via a forward-filtering, backward-smoothing algorithm. By capturing dynamics in brand attributes and the competitive positions defined by these attributes, our model allows us to understand the evolution of market structure over time. Our model also allows us to investigate the immediate and long-run effects of advertising spending on the brand attributes.
To demonstrate the efficacy and robustness of the modeling approach, we apply the model to two simulation scenarios. In the first scenario, the brand attributes are relatively static over time. This is
3 For the remainder of this paper, we will use the phrase "dynamic parameters" to describe time-varying parameters.
4 Although the model is able to address entry, we do not consider it in this paper.

Rutz and Sonnier: The Evolution of Internal Market Structure

276

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

the classic case of a stable and mature market in which implementation of a static model would be warranted. The second scenario contains a mix of dynamic conditions, with stationary brands, evolving brands, and converging brands. We show that our proposed model does not impute dynamics where none exists and ably recovers different dynamic parameter paths, as well as the weights and marketing mix coefficients. The second simulation scenario allows us to investigate the effect of misspecificied dynamic attributes. We show analytically as well as empirically that estimating a static model on dynamic data induces both temporal heteroskedasticity in the error term as well as correlation between the error term and the preference weights. As a result, estimates of the attributes and marketing mix coefficients suffer from bias and attenuation.
In our empirical application, we estimate the proposed model with four years of panel purchase history data on consumer purchases in a new adult beverage category. The category is characterized by changing market shares of the major competitive brands over time; thus it is well suited to test the implications of our modeling approach. We capture the initial positioning of the brands in the latent attribute space and how the brand attributes are evolving as the category matures. Model estimates show a mix of dynamic behavior, with most of the brands evolving over the four years while one is relatively static. We find that advertising spending explains some of the evolution of the latent brand attributes. Comparing our proposed model to a set of competitive models, both static and dynamic, we find that our proposed model that captures the evolution of internal market structure best fits the data both insample and out-of-sample.
The remainder of this paper is structured as follows. We briefly review static models of internal market structure. Next, we introduce our dynamic model to study the evolution of internal market structure. Using a simulation study, we demonstrate the model's ability to handle a variety of market dynamics as well as investigate the effect of misspecified dynamics. An empirical application of the model to a new product category follows. We demonstrate that our proposed model yields superior in-sample and out-of-sample fit compared with alternative static and dynamic models. We also consider the implied patterns of price responsiveness across the models as well as the effect of changing advertising spending. Finally, we summarize and conclude.
2. Review of the Static Factor-Analytic Choice Model
Assume we observe i = 1 I individuals choosing among j = 0 J alternatives on each of t = 1 T

weeks. Let the utility of alternative j to individual i on occasion t be given by Uijt = ij + xijt i + ijt, where
ijt  N 0 1 . The J vector yit indexes the choice that corresponds to the alternative with maximum utility
for individual i at week t. The parameter ij is an individual-specific brand intercept. The vector xijt is a vector of independent variables, such as price, dis-
play, and feature, and can also include measures of
state dependence. Pioneered by Elrod (1988), factor-
analytic choice models decompose the intercept ij into latent attributes and preference weights for the
attributes. Thus, each product in the choice set has a
position defined by the latent attributes. Elrod (1988)
decomposes ij as follows:

ij = a1j wi1 + a2j wi2

(1)

where akj is the level of the kth attribute for brand j and wik is individual i's preference weight for the kth
attribute.

Given that the brand attributes as well as weights

are latent, identification restrictions are necessary.5

First, adding a constant to the kth attribute of all

the brands does not affect the probability of brand

choice for any individual. To remove this indetermi-

nacy, we fix the location of one of the brands by set-

ting the as to zero. Second, the attribute preference

weights can be scaled by a constant without affect-

ing the brand choice probabilities. Thus, the ws are

restricted to have a unit variance. Finally, the attribute

and preference vectors can be simultaneously rotated

without affecting the choice probabilities. A number

of options are available to remove this indeterminacy

(Elrod 1988, Elrod and Keane 1995, Erdem 1996). Fol-

lowing Erdem (1996), we set

k w

=

w  0  k. It fol-

lows that wik  N w 1  k.

Thus far, the model specifies that individuals

are homogenous with respect to brand attributes.

Chintagunta (1994) introduces a latent-class hetero-

geneity structure on the attributes. Erdem (1996)

allows for individual-level heterogeneity in the

attributes, which can be understood as allowing for

differences in individual perceptions with respect to

the brand attributes. Erdem (1996) also introduces

individual choice dynamics by allowing utility to

depend on the difference between attributes of the

current brand choice and the attributes of the brand

purchased on the last choice occasion. Although this

addresses state dependence from the individual's

perspective, it does not account for dynamic brand

attributes. We now turn our attention to modeling

heterogeneous dynamic brand attributes.

5 These restrictions are standard procedure in the factor-analytic choice model literature, and we discuss them without proof. For a comprehensive discussion, see Erdem (1996).

Rutz and Sonnier: The Evolution of Internal Market Structure

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

277

3. A Dynamic Factor-Analytic Choice Model
3.1. The Nature of Latent Brand Attributes Extant factor-analytic choice models assume that a brand's attributes and hence its position in attribute space are constant over time. This limits the application of the model to categories where the researcher is confident that the brand attributes are indeed static and poses a problem with using the model to study new categories or categories affected by structural shocks. Additionally, as discussed in §1, the assumption of static brand attributes may be untenable for even mature categories.
A static factor-analytic choice model may be viewed through the lens of individual learning models. In learning models, products are treated as having a true level of an imperfectly observed attribute that is stable over time, essentially, the ij in Equation (1).6 Individuals have expectations about ij and learn about the true level over time through, for example, advertising signals centered on the true level. Temporal variation in the expected value of the attribute is due to individual uncertainty, which diminishes as the consumer learns. Once individuals have extinguished uncertainty about the true attribute levels, the expectation converges to the true static level (Narayanan and Manchanda 2009). At this point, the brand choice probabilities are driven by the learned attribute levels, which create differentiation. Assuming that the category is stable and mature, static factor-analytic choice models ostensibly estimate the true static attribute levels and implicitly assume learning has occurred and individuals are no longer uncertain about the attribute levels.
It is useful to more closely consider the nature of these estimated attributes. If the attributes are "hard" and objective (e.g., detergent cleansing power), only a change in physical attributes should change a brand's position in attribute space (given that learning has occurred). If, however, the estimated attributes capture "soft" perceptions that inherently change over time, then the notion of learning the true level of an objective attribute is no longer meaningful. Many studies point toward "soft" perceptions in the domain of consumer packaged goods (CPG). For many CPG products, individuals cannot differentiate between products in blind tastings (e.g., Keller 2003). In other words, the products are not differentiated on any objective attribute at all. Other consumer products such as vodka or bottled water are inherently tasteless and odorless. Hence, if the objective attributes of a set of products are indeed indistinguishable
6 Erdem (1996) cites the richness of peanut butter or the cleansing power of detergents as examples of brand attributes.

and these attributes are what is measured by models of internal market structure, then the analysis should show little to no differentiation. However, published applications of internal market structure models consistently demonstrate differentiation on the latent attributes. Furthermore, competing firms in CPG industries often command different prices and achieve different market shares despite any discernable quality differences (Bronnenberg et al. 2009). This suggests that soft individual perceptions are playing a major role in defining the differentiated positions in the attribute space measured by internal market structure analysis.
Many CPG products are indeed differentiated not by objective quality but primarily by their brands (Bronnenberg et al. 2009). Brand image associations, consumer perceptions about a brand, and other brand-related constructs are likely to vary over time. Firms invest in their brands to establish and maintain unique and favorable associations, influence consumer perceptions, and ultimately position and reposition their brands in the competitive landscape. This is inherently a dynamic process. A recent example is Cheerios, which two years ago attempted to strengthen their health positioning by claiming that by eating Cheerios "you can lower your cholesterol 4% in 6 weeks."7 One may be able to measure the objective amount of whole grains in a serving of Cheerios, but the perceived amount of "health" in a serving of Cheerios is likely more subjective and may wax and wane.
In summary, we believe that the latent brand attributes estimated by factor-analytic choice models are most likely soft attributes. As such, internal models of market structure may benefit from relaxing the assumption of static brand attributes. As discussed, there are many reasons to suggest that brand attributes, especially soft attributes, are likely to be dynamic. Ultimately, we view this as an empirical question whose answer may very well differ from category to category, product to product, and also likely depends on the observation window. We now turn our attention to developing a model to allow researchers to investigate market structure dynamics.
3.2. Model Specification We introduce an extension to the static factor-analytic choice model that accommodates a variety of dynamic behavior in the brand attributes, including a lack of dynamics. In terms of specifying dynamic parameters in a weekly brand choice model, the ideal case
7 The U.S. Food and Drug Administration (FDA) recently warned General Mills, maker of Cheerios, that Cheerios was being sold as an unapproved new drug. The FDA warned General Mills that it must either change the way it markets Cheerios or apply for federal approval to sell Cheerios as a drug (FDA 2009).

Rutz and Sonnier: The Evolution of Internal Market Structure

278

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

for the researcher would be to observe a sufficient number of observations per week to enable estimation of any dynamic parameters at the weekly level. Unfortunately, this will rarely, if ever, be the case. Thus, the researcher must choose the period of calendar time (e.g., monthly, quarterly, or annually) on which the dynamic parameters will be specified. This creates two different time scales, one for the purchase occasions and one for the system dynamics (Lachaab et al. 2006). We allow for the attributes to evolve across periods we label q. The specification of q (e.g., months, quarters, or years) will depend on the empirical application. We discuss this in more detail in our application. Generally, each week, t, can be uniquely assigned to a period in which it occurs, q, where q = 1 Q. As before, we begin with a latent utility equation, Uijt = ijt + xijt i + ijt. We model ijt as

ijt = a1ijqwi1 + a2ijqwi2

(2)

The same restrictions on the ws as in the static factor-
analytic choice model apply here as well and as in the static model, wik  N w 1  k. We assume that individuals are heterogeneous in their perceptions of the
dynamic brand attributes and model the individuallevel brand attributes akijq as

akijq = akjq + cikj

(3)

where cikj  N 0

2 k

and k = 1

2. Equation (3) models

the heterogeneous dynamic attribute as arising from

a time-varying mean and a time-invariant individual

shock (Liechty et al. 2005). Note that although restrict-

ing the individual shock to be time invariant imposes

a stronger shrinkage structure, this allows us to inves-

tigate finer intervals of q than otherwise possible.8

We specify the evolution of the mean brand

attribute level as a naturally state-dependent process

akjq =

kj akjq-1 +

k jq

(4)

where is a parameter to be estimated and is an error term (to be defined below). Equation (4) allows us to empirically assess the stickiness of a brand's mean attribute akjq. If current mean attributes are not

8 An alternative specification for Equation (3) is akijq = akjq +

k ijq

.

Allowing the individual shocks to be time varying implies that the

researcher can only use observations for the individual that occur

within a given q. Clearly, there is a trade-off between the amount

of information and the level of q; the finer the latter, the less of the

former. Fixing the individual shocks to be time invariant allows us

to consider finer levels of temporal aggregation within our dynamic

model. We also model the transitions across time as a smooth pro-

cess. Alternatively, we could also allow for discrete movements that

could be triggered by an advertising shock or competitive entry.

This could be implemented by adding covariates, e.g., indicator

variables, to Equation (7).

influenced by previous period mean attributes, then
j will be close to zero. However, if changes in a brand's attribute do not occur instantaneously but
rather evolve slowly over time, then j will be closer to one (Kort et al. 2006, Bass et al. 2007). To estimate
the model, we stack the attribute means over brands and latent attributes into a J - 1 K × 1 vector, aq.9 The evolution of aq is modeled as a first-order autoregressive process as follows

aq = aq-1 + q

(5)

with q  MVN 0 . The J - 1 K × J - 1 K parameter matrix (to be estimated) contains the state dependence parameters. The covariance matrix allows for possible correlation in the dynamic parameter paths.
To summarize, the model hierarchy is as follows:

Uijt wik akjq cikj i xijt yijt

wik w

aq

aq-1

(6)

cij 2

i

The model is estimated with MCMC methods, which sample from the full conditional distributions for model parameters. We use a data augmentation step to draw the latent utilities Uijt. Next, Gibbs and Metropolis-Hastings steps are used to draw the remaining model parameters, with the exception of the time-varying attribute means akjq. A complication arises since for 0 < q < Q the conditional distribution of aq depends on aq-1 as well as on aq+1. This creates a circular reference problem that precludes us from specifying and sampling from the conditional distribution of aq in the usual manner. One way to address this problem is to conceptualize the model as a Bayesian dynamic linear model (DLM) that can be estimated using forwardfiltering, backward-sampling algorithm to account for the above-mentioned problem. The general specification of a DLM is

yt = Ft t + t

(7)

t = Gt t-1 + t

where yt is the observed data, t are the unobserved

dynamic states of interest, and t  N 0 and t 

N0

(West and Harrison 1997). Gt describes the

evolution of the unobserved states ,10 and Ft matches

9 As discussed, the attributes of one brand are set to zero for identification.
10 Note that in our application, Gt = G  t as follows from Equation (7).

Rutz and Sonnier: The Evolution of Internal Market Structure

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

279

Table 1 Simulation Study, Selected Parameters

Data-generating valuea

Mean

95% Coverage interval Lower bound Upper bound

Price coefficient Importance weight

(a) Simulation-stationary attributes, dynamic model

Mean Variance

-1 00 0 25

-0 95 0 30

-1 04 0 24

Mean

1 00

0 97

0 89

-0 86 0 37
1 05

Price coefficient Importance weight

(b) Simulation-mixed attributes, dynamic model

Mean Variance

-1 00 0 25

-0 97 0 25

Mean

1 00

0 97

-1 05 0 19
0 89

-0 89 0 32
1 05

Price coefficient Importance weight

(c) Simulation-mixed attributes, static model

Mean Variance
Mean

-1 00 0 25 1 00

-0 70 0 15 0 97

aCell entries are posterior mean estimates.

-0 77 0 12 0 86

-0 64 0 19 1 08

the unobserved states with the observed data. In our case, we model the dynamic latent attribute means aq as the unobserved states of interest and use the current draw of the latent utilities Uijt as data. In other words, at step s in the sampler we use the forwardfiltering, backward-sampling algorithm to draw a new set of mean brand attributes aq s and construct a new akijq s based on Equation (3).
To implement the sampler, we require a proper but diffuse prior distribution for the initial period, a0  N m0 C0 , as well as priors for other model hyperparameters. Details are included in the appendix. Before presenting our empirical application, we turn our attention to the performance of the dynamic factoranalytic choice model in a variety of evolutionary settings in a simulation study.
4. Simulation
Our simulation investigates parameter recovery in a variety of dynamic settings, including a lack of dynamics. This simulation was guided by three questions. First, can the proposed model ably recover dynamic parameters? Second, does the proposed model correctly recover static data and not impose dynamics where none exist? Finally, can the proposed model recover different types of dynamics? We also consider the effects of erroneously applying a static factor-analytic choice model to dynamic data. We generate data according to two scenarios. Both scenarios are composed of four brands, each of which is described by a two-dimensional brand attribute vector and a price. The two scenarios are differentiated by the evolutionary path of the latent brand attributes. Note that for identification, we set the brand attributes for brand 1 to zero. To focus more precisely on the dynamic aspects of the model, our

simulated data assume homogeneous brand image attributes. We simulate data with weekly observations over four years. For the simulation, we estimate the dynamic attributes at the quarterly level.
In the first scenario, the brand attributes are approximately stationary over time. This is intended to describe the case where the category is stable, with little to no shifts in brand attributes. In this setting, the static factor-analytic choice model is appropriate. An important consideration is how the proposed model handles a situation where the brand attributes are stationary or approximately stationary. The main concern is whether the dynamic model imputes dynamic behavior where none exists. In the second scenario, we mix different dynamic behaviors. We simulate one static brand and two dynamic brands along with the base brand. For one dynamic brand, the attributes are evolving over the entire observation period. This is consistent with a new product category where the "dust settling" has yet to occur. For the second dynamic brand, the attributes are evolving in initial time periods, but settling into a stationary position in later periods.11
4.1. Results To assess the ability of the proposed model to recover the brand attributes, we apply the model to two synthetic data sets consistent with each of the aforementioned scenarios. Table 1, panels a and b, present the data-generating values and the 95% coverage intervals of the estimates for the mean and variance of the
11 We also conducted simulations in which all three brands exhibit the same dynamic behavior as well as a scenario in which a structural shock occurs, introducing dynamics in a formerly static category. In all our simulation, the proposed model ably recovers the parameters. The simulations are available from the authors upon request.

Rutz and Sonnier: The Evolution of Internal Market Structure

280

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

Figure 1

Simulation Study: Brand Attributes

(a) Stationary attributes, dynamic model 1.5
1.0
0.5

Brand 1-Est Brand 1-Tru Brand 2-Est Brand 2-Tru Brand 3-Est Brand 3-Tru

0 ­ 0.6 ­ 0.4 ­0.2 0 0.2 0.4 0.6 0.8 1.0 1.2 1.4 1.6
­ 0.5

­1.0

(b) Mixed attributes, dynamic model 3.0 2.5 2.0
1.5 1.0

0.5

0

­1.0 ­0.5

0

­ 0.5

­1.0

­1.5

0.5

1.0

1.5

2.0

2.5

3.0

(c) Mixed attributes, static model 2.5

2.0

1.5

1.0

0.5

0

­ 0.5

0

­0.5

0.5

1.0

1.5

2.0

2.5

3.0

­1.0

­1.5

price coefficient and the mean importance weight. We see that for both scenarios, the 95% coverage intervals for each parameter contain the data-generating values. Figures 1(a) and 1(b) present plots of the data-generating values and estimates of the brand attributes for each of the five scenarios. In all cases, the model estimates are reasonably close to the datagenerating values. In Figure 1(a), we see that the model does not appear to impose dynamic behavior where none exists. The estimates cluster around the approximately stationary brand attributes. In Figure 1(b), we see that the model ably handles the

different types of dynamics. Overall, the proposed model appears to be quite robust to a variety of evolutionary scenarios.

4.2. Investigating Misspecified Dynamics It is of interest to investigate the behavior of the static factor-analytic model under the second scenario where the true brand attributes are dynamic. Consider a simplified true model with a single dynamic homogeneous brand attribute and evolution described by a random walk. Let the true latent utility model be

Uijt = ajq wi + xijt i + ijt (8)
ajq = ajq-1 + jq

with error terms distributed ijt  N 0 1 and jq 

N 0 2 , and initial condition aj0. At any time t, we

can express the utility as Uijt = ajq-1 + jq wi + xijt i

+ ijt. Through repeated substitution, we can express

the utility as Uijt = aj0 +

qt q=1

jq wi + xijt

i+

ijt ,

where qt is the quarter corresponding to week t. Rear-

ranging terms yields

Uijt = aj0wi + xijt i + ijt

qt

(9)

ijt =

jq wi + ijt

q=1

From an econometric perspective, there are three
things to note about ijt. First, the variance of ijt is greater than the variance of ijt. Because the utility function is scaled by the error variance, this
will deflate the choice model parameter estimates
(Griliches and Yatchew 1985, Swait and Louviere
1993). Second, the presence of the summation in the
equation for ijt implies that the variance of ijt is not constant over time but increasing with each time
period. Finally, note that ijt is correlated with wi; thus the standard assumption that E ijt wi = 0 is violated, which will bias the estimate of aj0. Estimating the model given in (12) by a static factor-analytic choice model of the form Uijt = aj wi + xijt i + jt with
jt  N 0 1 will, at best, approximately recover the initial state of the brand attributes. At worst, atten-
uation, inefficiency, and estimation bias in the latent
attributes will result from the misspecification of the
true dynamic model as static. Note that this is similar
to the effects of misspecified individual-level prefer-
ence heterogeneity (Chintagunta et al. 1991).
To assess the bias resulting from estimating a static
factor-analytic choice model on dynamic data, we esti-
mate a static model on our second synthetic data sets
described above. Table 1, panel c, presents the data-
generating values and the 95% coverage intervals of
the estimates for the mean importance weight and
the price coefficient. Estimates of the mean and the

Rutz and Sonnier: The Evolution of Internal Market Structure

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

281

variance of the price coefficient are attenuated. Figure 1(c) presents plots of the data-generating values and estimates of the latent brand attributes for each of the two scenarios. In Figure 1(c), consistent with our intuition, we see that the misspecified static model approximates a point in the neighborhood of the early periods.

5. Empirical Application
To illustrate the dynamic factor-analytic choice model, we apply it to a panel data set of household purchases in the flavored malt beverage category over the period 2002­2005. The data are from the IRI academic data set (Bronnenberg et al. 2008). We believe that this category is well suited to investigating dynamics in latent brand attributes. First, the category is relatively new, emerging in the U.S. market in the late 1980s as an alternative to wine coolers. The category grew significantly in the mid- to late 1990s, with the introduction and success of brands such as Zima and Smirnoff. A third major brand, Bacardi, entered the market the year before our observation period. Second, over the observation period, we see large shifts in market share. Table 2 presents the four brands included in our analysis and their market shares within the panel of N = 250 households. We model the most popular package size in the category, a six-pack of 12-ounce bottles. To be included in the sample, households must have at least one purchase in each of the four years of the observation period. Table 3 presents the average market prices and percentage changes in price over the observation period for the four brands. The relatively small price changes over the observation period lead us to conclude that price competition is, most likely, not a key driver of the significant market share changes.
As discussed in §3, to estimate the model described in Equation (6), the researcher must specify the time periods over which the mean brand positions are evolving. Whereas the researcher should desire the finest level of temporal aggregation possible (weekly, in our case), attention must be paid to the trade-off between the level of temporal aggregation and information. For our empirical application, brand choice is modeled on the weekly level, whereas the brand attributes are allowed to vary monthly. We note that with enough data per time period, we could simply estimate an individual static model for each time

Table 2 Brands and Market Shares

2002 (%) 2003 (%)

Smirnoff

45

65

Bacardi

21

15

Zima

25

9

Twisted Tea

9

12

2004 (%)
58 28 4 11

2005 (%)
62 12 16 11

Table 3 Market Prices

2002

2003

2004

Pricea ($) %

Pricea ($) %

Pricea ($) %

Smirnoff 7 11 N/A 7 19 1 7 23 1

Bacardi

7 33 N/A 7 33 0 7 36 0

Zima

5 88 N/A 6 01 2 5 96 -1

Twisted Tea 6 55 N/A 6 63 1 6 53 -2

aAverage price paid including promotional discounts.

2005
Pricea ($) %
7 15 -1 6 96 -5 6 08 2 6 87 5

period.12 In our case, we could attempt to estimate a static model for each month. However, this would leave us with a rather limited amount of data. Our dynamic model is efficient in the sense that it uses data from previous periods as well as from future periods to estimate current period brand attributes. Static snapshots are not able to use data in this way and present a less efficient and stable means to estimate the brand attributes.
We include in the vector of explanatory variables xijt price (prices paid including promotions) and an indicator variable for last brand purchased. Including the last brand purchased helps control for state dependence and follows the standard approach of most of the marketing literature. Finally, it is well known that correlation between price and error terms may lead to endogeneity bias in the price coefficient. Using data on barley prices, we implement an instrumental variable procedure (e.g., Kuksov and Villas-Boas 2008) to alleviate any concerns about price endogeneity.13
5.1. Model Comparison To estimate the model described in Equation (6), we run the sampler for a burn-in period of 15,000 iterations. To conduct posterior inference, we run the sampler for an additional 75,000 iterations and thin the chain by a factor of 5. Convergence diagnostics (e.g., Raftery and Lewis 1995) indicate that the chain has converged and that autocorrelation is not a significant problem. For comparison, we estimate a set of alternative models. The total set of estimated models can be grouped into standard probit choice models with no factor structure and factoranalytic probit choice models. Under each type of model (the standard and factor analytic), we estimate static models, models where the intercepts or brand attributes vary as a polynomial function of time and models with a first-order state-dependent process on

12 This is also true for choice models with heterogeneous household response coefficients. With enough observations per household, one can simply estimate models household by household. Of course, this condition is rarely, if ever, met in practice.
13 Barley prices are obtained from http://www.econstats.com.

Rutz and Sonnier: The Evolution of Internal Market Structure

282

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

Table 4 Model Fit Statistics

LMDa

Hit rateb

Standard probit

Dynamics on intercepts

Static

-1 168

0 63

Polynomial

-1 118

0 60

Dynamic linear

-1 109

0 77

Factor-analytic probit Dynamics on attributes

Static

-1 145

0 69

Polynomial

-989

0 76

Dynamic linear

- 956

0 81

aEstimated via harmonic mean of model likelihoods computed with the GHK simulator.
bEstimated with last choice for each household which is held out of estimation.

the intercepts or attributes (i.e., the DLM approach).14 This results in a total of six models for comparison, three standard models and three factor-analytic models. Table 4 reports the harmonic mean estimator of the log-marginal density (LMD).15 The likelihoods are computed via the Geweke, Hajivassiliou, and Keane (GHK) algorithm. We also hold out the last choice of each household and use these holdout choices to compute the out-of-sample hit rate. Estimates of the LMD and out-of-sample hit rate strongly favor our proposed model over the alternative models. Two additional points emerge from the model comparison. First, comparing each factor-analytic probit to its standard probit counterpart (based on dynamic specification of the intercepts or attributes), we see that the factor-analytic probits outperform the standard probits. This underscores the value of modeling internal market structure. Second, within each model type (standard probit versus factor-analytic probit), model comparison results demonstrate the value of modeling dynamics.
Table 5 reports the posterior mean estimates of the mean and variance of the price and last brand purchased coefficients, as well as the posterior mean estimate of the mean importance weight. The coefficients are all of the expected sign and estimated with reasonable precision. The estimates of the dynamic attribute means are plotted in Figure 2.16 Table 6

14 We illustrate the polynomial function of time approach for the standard dynamic probit. In this case, the intercepts are modeled
ijq = jq + cij , where cij  N 0 2 . The mean of the brand intercept is modeled as jq = 0j + 1j q + 2j q2. The polynomial function of the time approach is implemented in the same manner for the factoranalytic probit.
15 We find that a model with a full covariance structure on the mean brand attributes does not outperform a model in which is restricted to be a diagonal matrix. Consequently, we present the results from the latter model.
16 Because of the large number of parameters (48 parameters for each of the three brands and each of the two attributes), we do not report these values in tabular form. The results are available in tabular form upon request.

Table 5 Selected Model Parameters

Meana

Variance

Price

-0 50

0 80

0 12

0 29

Last brand purchased

0 22

0 41

0 08

0 15

Importance weight

1 25

1 00

0 21

--

aCell entries are posterior mean and posterior standard error (in parentheses).
The 95% coverage interval does not span zero.

Table 6

Latent Brand Attributes: Variance of Individual-Level Shocks

2

2

1

2

0 32

0 28

0 17

0 15

Note. Cell entries are posterior mean and posterior standard error (in parentheses).

reports the variances of the individual-level shocks to the dynamic attributes. Recall that the identifying brand is the market share leader, Smirnoff.
From Figure 2, we see that Bacardi is moving in a westerly direction on the horizontal dimension (attribute 1) and is essentially unchanged on the vertical dimension (attribute 2). Zima is moving in a southeasterly direction. From its initial condition in the southwest quadrant of the map, Zima moves past the origin on the horizontal dimension (attribute 1) and away from the origin on the vertical dimension (attribute 2). Twisted Tea exhibits significant movement over the observation window. From its initial position in the southwest quadrant, Twisted Tea first moves northeast toward the origin on both dimensions, then turns northwest, away from the origin on the horizontal dimension (attribute 1). Figure 2 also presents the attribute means implied by the static model; the dynamic model outperforms the static model in terms of penalized model fit. More importantly, the static factor-analytic choice model cannot reflect the evolution of the brand attributes over time. As in our simulation, the static model implies attribute means that are in the neighborhood of the initial periods of the dynamic model. Furthermore, the mix and state dependence coefficients are almost certain to be adversely affected by bias and attenuation.17
17 For comparison purposes, the mean price and state dependence coefficients for the static model are -0 39 and 0.34, respectively. Both parameters are significant; i.e., the 95% coverage intervals do not contain zero. Recall from Table 5 these values are -0 50 and 0.22 for the dynamic model.

Rutz and Sonnier: The Evolution of Internal Market Structure

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

283

Figure 2 Plot of Dynamic Attribute Means 2.0

1.0

0.0

­2.0

­1.5

­1.0

­ 0.5

0.0

0.5

1.0

1.5

2.0

­1.0

Bacardi

­2.0

Zima

Twisted Tea

Bacardi (static)

Zima (static)

­3.0

Twisted Tea (static)

­ 4.0

­ 5.0

­ 6.0 Note. The origin of the map is the market share leader, Smirnoff.

Table 7 presents the carryover parameters for the dynamic means as well as the error variances . The 95% coverage intervals for coefficients for all brands on the first attribute do not span zero. For the second attribute, the 95% coverage intervals for the coefficient for Twisted Tea does not span zero, whereas the coverage intervals for Bacardi and Zima do span zero. Overall, we find significant evidence for dynamic behavior in the latent brand attributes.

Table 7 State Equation Parameters

Attribute 1 Bacardi
Zima
Twisted Tea
Attribute 2 Bacardi
Zima
Twisted Tea

0 85 0 31 0 97 0 04 0 94 0 10
0 04 0 21 0 03 0 20 0 45 0 21

0 032 0 016 0 032 0 016 0 032 0 016
0 034 0 017 0 031 0 015 0 031 0 015

Note. Cell entries are posterior mean and posterior standard error (in parentheses).
Indicates the 95% coverage interval does not span zero.

We compare the aggregate own- and cross-price elasticities implied by our proposed model with those implied by the static factor-analytic probit. For both models, we estimate the elasticities by computing the overall market shares at the observed prices and the then recomputing the shares after increasing price by an increment of 10% (sequentially for each brand holding all else constant). Table 8 reports the elasticities. First, as can be seen from Table 8, compared with our proposed model, the elasticities implied by the static factor-analytic probit understate the own price elasticity for the market share leader, Smirnoff, and overstate the own-price elasticities for the three smaller market share brands. Second, to compare the cross-price elasticities, we compute the aggregate clout and vulnerability implied by the static

Table 8 Aggregate Own- and Cross-Price Elasticites

Smirnoff

Bacardi

Zima

Smirnoff Bacardi Zima Twisted Tea
Smirnoff Bacardi Zima Twisted Tea

(a) Static factor-analytic probit

-0 30 2 16 2 27 0 79

0 41 -3 12
0 21 0 33

0 22 0 50 -2 54 0 56

(b) Dynamic factor-analytic probit

-0 52 0 87 1 78 1 89

0 33 -1 93
0 60 0 18

0 23 0 19 -1 72 0 00

Twisted Tea
0 24 0 50 0 36 -3 94
0 30 0 23 0 27 -3 71

Rutz and Sonnier: The Evolution of Internal Market Structure

284

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

Figure 3 Clout and Vulnerability (a) Static model
6

Clout

4

2

0

0

1

2

3

4

Vulnerability

(b) Dynamic model

6

Smirnoff

Bacardi

4

Zima

Twisted Tea

2

Clout

0

0

1

2

3

4

Vulnerability

and dynamic factor-analytic models (Kamakura and Russell 1989). These maps represent the structure of price competition implied by each model. From Figure 3, we see that the order of the smaller market share brands is quite different across the two models. In particular, note that the static model implies Bacardi is the most vulnerable brand, whereas the dynamic model implies Bacardi is much less vulnerable. Also, note that Zima's clout is overstated in the static model. In the dynamic model, Zima is the weakest brand, with the smallest clout and largest vulnerability. Given that our proposed model has the best fit, these results imply that the static factor-analytic probit yields misleading results with respect to both own- and cross-price response. Especially for the smaller market share brands, the differences across the static and dynamic models are quite large.
5.2. Extensions We consider two extensions to our dynamic factoranalytic probit model. First, we consider dynamic importance weights. Second, we investigate whether or not advertising spending explains the evolution of the dynamic attribute means.
5.2.1. Extension 1. Economic theory, for the most part, assumes stable consumer preferences (e.g., Stigler and Becker 1977). Recent research in behavioral economics, however, challenges this notion (e.g., Ariely et al. 2006). We extend our proposed model to allow for dynamic evolution of the importance weights. A complication arises because of the identification restriction on the mean of the importance weights w, which is constrained to be strictly nonnegative. This restriction prohibits application of the

forward-filtering, backward-sampling algorithms uti-

lized for the evolution of the attribute values as a

result of the mixture of nonconjugate distributions

(i.e., we use a log-normal for w . To navigate around this problem, we propose a Metropolis step to draw

the dynamic weights that allows for dynamics in w.

To extend the model to dynamic weights, we express

ijt as

ijt = a1ijqwi1q + a2ijqwi2q

(10)

We model the akijq as before. Similarly, we model the dynamic weights as

wikq = wqk + vik

(11)

where vik  N 0 1 for k = 1 2. As before, we assume

that wqk = wq  k. We specify the prior as wq 

N wq-1

2 w

where ln wq

= wq. Note that the pos-

terior distribution will include information from the

likelihood of the q + 1 period. For more details, please

see the appendix. We estimated our proposed model

allowing for dynamic weights. The estimate of the

LMD for the model allowing dynamic weights is

-969, worse than the estimated LMD for the model

that assumes static importance weights, -956. Thus,

we conclude that the assumption of static importance

weights is appropriate for our data.

5.2.2. Extension 2. Our empirical results indicate

that the latent brand attributes are evolving over

time. We have demonstrated that the dynamic factor-

analytic probit best fits the data and that failure

to model dynamics may yield misleading inferences

with respect to price competition. However, as cur-

rently specified, the model does not indicate how

managers might influence the evolution of the latent

attributes. Assuming that the dynamic attributes are

indeed capturing soft attributes, advertising spending

seems to have the potential to explain the evolution

of the attributes. Our proposed model allows us to

investigate this issue in a natural fashion. We extend

our proposed model to allow advertising spending

to influence the evolution of the dynamic attribute

means,

akjq =

k j

akjq-1

+

zjq

k j

+

k jq

(12)

where zjq is advertising spending. We obtain monthly advertising expenditures for our brands from Taylor Nelson Sofres' Competitive Media Report.
Previous research in marketing has demonstrated the need to account for dynamic effects of advertising. Such effects can be modeled with advertising lags. In Equation (12), past advertising spending is parsimoniously captured in the lagged value of the attributes, alleviating the need to include lags in the specification. We estimate the proposed model with advertising and find that advertising indeed affects the evolution of the attributes. The estimated LMD also

Rutz and Sonnier: The Evolution of Internal Market Structure

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

285

Table 9 Advertising Parameters

Attribute 1 Bacardi
Zima
Twisted Tea
Attribute 2 Bacardi
Zima
Twisted Tea

-0 020 0 061 0 035 0 010 0 015 0 038
0 142 0 057 0 0001 0 002 0 195 0 051

Note. Cell entries are posterior mean. Indicates the 95% coverage interval does
not span zero.

improves to -950. The estimates of are reported in Table 9. We find that advertising affects the first dimension for Zima while affecting the second dimension for Bacardi and Twisted Tea. We see this as further evidence that our model captures soft attributes as variation in advertising explains some of the variation in the attributes. Although our data do not capture advertising themes, this is in an interesting topic for future research. Different types of advertising themes, for example, "hip" or "sophisticated," can easily be incorporated into our model by using indicator variables in combination with gross rating points.
Although understanding the effect of advertising on the attributes is interesting, managers are also interested in the ultimate effect on shares. To investigate this issue, we shock advertising for one brand and trace the changes in market share over time. To implement the shock, we average each brand's advertising and then, in turn, shock each brand by adding the average of its advertising to the current advertising in a particular period.18 We find that the effect of the advertising shock has mostly dissipated after about two periods. Interestingly, we find that the shares for the Smirnoff and Bacardi are more responsive than the shares for Zima and Twisted Tea. The implied advertising elasticity for Smirnoff and Bacardi is 0.19 and 0.18, respectively. For Zima and Twisted Tea, we find that the implied advertising elasticity is much smaller, 0.06 for both. Note that Smirnoff and Bacardi command higher prices and that Smirnoff is the clear market share leader. Using

18 We also used the maximum of advertising and find similar results. We implemented the shock in the 20th month of the observation window. Similar results were obtained with different months as the shock period.

the Ailawadi et al. (2003) concept of price premiums as a measure of brand equity, our results suggest the higher-equity brands reap greater benefit from marketing efforts. These results are consistent with the Slotegraaf and Pauwels (2008) finding that marketing response is stronger for high-equity brands.
6. Summary and Conclusions
We present a dynamic factor-analytic choice model to capture evolution of brand positions in latent attribute space. This represents an important extension to static factor-analytic choice models, which require the assumption that the brand attributes are stable over time. This assumption has limited empirical applications of the static factor-analytic choice model to mature product categories for which the researcher can be reasonably certain that the brand attributes are static over the observation period. Our dynamic model allows researchers to investigate brand positioning in new product categories or mature categories affected by structural change. We argue that even for stable and mature product categories, the assumption of stable brand attributes may be a strong assumption. The marketing and economics literatures have shown that even once learning has occurred in new product markets, advertising and other marketing efforts continue to play a dynamic persuasive role in individual choice. Furthermore, many CPG products are differentiated not by objective quality, but primarily by their brands (Bronnenberg et al. 2009). Thus, differentiation is defined primarily on softer (intangible) attributes rather than physical (tangible) characteristics. Given this, it seems reasonable to argue that factor-analytic choice models estimated on CPG data that find differentiation on brand attributes are likely measuring soft attributes. If factor-analytic choice models measure hard, objective product attributes that do not vary over time, the static assumption is perhaps more defensible. However, if these models are capturing differentiation based on softer attributes, the static assumption seems untenable as firms continually invest in advertising and marketing communications in an attempt to position and reposition their brands in the competitive landscape.
With enough data per unit of time, the researcher may estimate a sequence of static snapshots to capture dynamic in brand attributes over time. However, sparse data are more likely to be the norm. In this case, an efficient modeling solution is required. Our proposed model uses a forward-filtering, backwardsampling algorithm to model latent brand attributes as an evolving state-dependent process. More specifically, we model individual- and time-specific brand

Rutz and Sonnier: The Evolution of Internal Market Structure

286

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

attributes as arising from dynamic mean brand attributes. These means are specified as first-order autoregressive processes, capturing the idea that changes in a brand's attribute do not occur instantaneously, but rather evolve over time. The dynamic brand attributes and means are estimated in a Bayesian DLM framework nested within a factor-analytic choice model.
We investigate the properties of our dynamic factoranalytic choice model with a simulation study. We simulate data according to a variety of evolutionary scenarios, including a lack of evolution (the stationary scenario). It is of interest to ensure that the dynamic model does not impute dynamic behavior where none exists. We also investigate a variety of dynamic scenarios. In all cases, the dynamic factor-analytic choice model ably captures the behavior of the latent brand attributes. We also investigate the effects of misspecified dynamics in the brand attributes. Analytically, we show that misspecified brand attribute dynamics induce temporal heteroskedasticity and correlation between the preference weights and the error term. A nonconstant error variance affects parameter interpretation as probit model parameters are identified relative to the error variance.19 Furthermore, the correlation between the weights and the error term may bias estimates of the brand attributes. In a second simulation study, we estimate static factor-analytic choice models with dynamic data. Our results demonstrate that estimates of the brand attributes and the marketing mix coefficients are adversely impacted by misspecified dynamics.
We apply the dynamic factor-analytic choice model to a panel data set on household purchases in the malt beverage category. The category is well suited to exploring dynamics as it is a relatively new and turbulent category. We compare our proposed model with competing standard and factor analytic probit choice models. Within each type (e.g., standard and factor analytic), we estimate static and dynamic models. We find that our proposed model, which captures the evolutionary behavior of the latent brand attributes, performs best in terms of in-sample and out-of-sample fit. Although factor-analytic choice models are often used to describe market structure, market structure has also been captured by patterns of cross-price response. We compare our proposed model with a static factor-analytic choice model in terms of both own- and cross-price response. The elasticities implied by the static factor-analytic model understate the own-price elasticity for the market share leader and overstate the own-price elasticities for the smaller market share brands. In terms of clout and vulnerability, we also find pronounced differences across the static and dynamic factor-analytic
19 This is, of course, also true for a logit choice model.

models for the smaller market share brands. Given that our proposed model has the best fit, these results imply that the static factor-analytic model yields misleading results with respect to both own- and crossprice response.
We also consider two extensions to our proposed model, allowing for dynamic importance weights and investigating the role of advertising. Although economic theory, for the most part, assumes stable consumer preferences, the consumer behavior literature has questioned this assumption. We extend our proposed model to account for dynamics in the importance weights as well as the attributes. We find that the model with static importance weights better fits the data. In terms of advertising, we extend our proposed model to allow advertising to affect the dynamic attributes. We find that advertising spending explains the evolution of brand attributes for some of our brands across both dimensions. We also estimate the ultimate impact of changes in advertising spending on market shares under our proposed model and find that increases in advertising spending benefit higher-equity brands disproportionately.
In closing, we discuss some limitations of our model and some possibilities in terms of future research. First, our empirical application considers a relatively new category. It would be straightforward and of interest to apply the model to a number of stable and mature categories to assess the robustness of the assumption of stable attributes. Second, our model treats the attribute space as fixed over time. Entry or exit may cause the attribute space to expand or shrink. Also, repositioning may dynamically affect the dimension of the attribute space. To accommodate changing dimensionality of the attribute space, the number of dimensions could be included as a dynamic parameter in the model. However, this would significantly complicate the application of the DLM to the problem, as the dimension of the latent attribute space could shrink or expand from period to period with relatively little information per period to inform the estimate. Third, we do not model the firm production process with respect to the latent attributes. Arguably, the firm combines product characteristics and marketing efforts to produce profitmaximizing attributes (Hauser and Simmie 1981). Ultimately though, consumers observe firm choices with respect to product characteristics and marketing effort and engage in their own attribute production process (Stigler and Becker 1977). Thus, the econometrician would need to specify firm and consumer roles in the joint production of the brand attributes. Notably, this may require jointly modeling of interdependent supply-side decisions and demand-side responses dynamically in a nonstationary environment. As noted in Van Heerde et al. (2004), this would be a considerable modeling challenge.

Rutz and Sonnier: The Evolution of Internal Market Structure

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

287

Appendix We detail the sampler used to estimate the dynamic factoranalytic choice model described in Equation (9).

Uijt wi ajq cij i xijt yijt

wi w

aq

aq-1

cij 2

i

Recall that we observe i = 1 I individuals choosing

from among j = 0 J alternatives on each of t = 1 T

choice occasions. Each choice occasion, t, can be uniquely

assigned to a month, q, where q = 1 Q (see §5 for

details). The dimension of the vector xijt is given by L, while the dimension of the latent brand attribute space is given

by K. Note that akijq = akjq + cikj .
(1) Generate Uijt wi aijq i xijt yijt and 1 I and t = 1 T .

2 = 1 for i =

Start with j = 1:

if yijt = 1, then

Uijt  TN a1ijqwi1 + a2ijqwi2 + xijt i 1 Uijt > Uimt  m = j

if yijt = 0, then

Uijt  TN a1ijqwi1 + a2ijqwi2 + xijt i 1 Uijt < max Uimt  m = j

increment j and return to the top. (2) Generate i Xi Ui.
i Xi Ui  MVN b Xi Xi + -1 -1

b = Xi Xi + -1 -1 Xi Ui + -1

Uijt = Uijt - a1ijqwi1 + a2ijqwi2

where Ui is a J T × 1 vector consisting of the elements of Uijt. (3) Generate i .

i

 MVN b

0 -1 + N

-1 -1

b = 0 -1 + N

-1 -1

0 -1 0 + N

0 = 106 × IL

0 = 0L

(4) Generate

i.

N

i  IW v + N S +

i-

i=1

v=2+L

-1 1 N N i=1 i
i-

S = vIL

(5) Generate wik akijq Uijt, for k = 1 2.

wik w  N

-1
akijq 2 + 1
tj

Uikjtakijq + w
tj

-1
akijq 2 + 1
tj

Uikjt = Uijt - a-ijqkwi-k - xijt i

(6) Generate w wi1 wi2.

Given the constraint

k w

=

w  0  k, we use a trun-

cated normal prior for w. The full conditional distribution

is expressed as

w

wi1

wi2

 exp

-

1 2

KN z=1

w~ z -

w2×

1/

0

w- 1-

0 w

/

0

0 w

=

0



0 = 106

with

=

0-

0 w

/

0 , and w~ z is the zth element of vec w .

We use a random-walk Metropolis-Hastings algorithm to

generate draws from this nonstandard distribution.

(7) Generate cikj k2.

cikj

2 k



N

cj

Wik Wik +

2 -1 k

cj = Wik Wik +

2 k

-1

Wik

Uikj

Uikjt = Uijt - a1jq wi1 - a2jq wi2 - ci-j kwi-k - xijt i

where Uikj is a T × 1 vector consisting of the elements of Uikjt,

and Wik is a T × 1 vector with wik in each row.

(8) Generate

2 k

cikj for k = 1

2.

2 k

cikj  IG

c

+1 2

i

cik

cik

d + NJ 2

where c = 2 + LJ and d = 1 and cik consists of the elements of cikj stacked into a J × 1 vector.
(9) Generate ajq Uijt ajq-1. We estimate the latent dynamic mean brand positions

using a DLM (for further details on the Bayesian DLM,

please see West and Harrison 1997). The observation equa-

tion of our DLM matches the observed outcomes--in

our case, the heterogeneous brand attributes--with the

latent dynamic variables of interest--in our case, the latent

dynamic mean brand positions. The observation equation is

given by

Uikjt = akjq wik + ijt

(13)

where Uikjt = Uijt - a-ijqkwi-k - cikj wik - xijt i and k = 1 2. The transformation equation described the evolution
of the mean brand attribute level as a naturally state-
dependent process and is given by

akjq =

k j

akjq-1

+

k jq

(14)

To facilitate estimation, we stack the latent dynamic

means into a vector, A¯ q, and collect each

k j

into

the

diago-

nal matrix , such that

 a11q 

A¯ q

=



a1Jq aK1q



and

aKJq

= diag

1 1

···

1 J

···

K 1

···

K J

Rutz and Sonnier: The Evolution of Internal Market Structure

288

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

Similarly, we collect the elements of Uikjt for the purchase occasions that occur in month q into the vector Uiq:

Uiq

=

 

Ui11tq Ui1J t q UiK1T q

 

and

 U1q
Uq =   UNq

UiKJ T q

To match the A¯ q onto Uq, we require a mapping matrix. A complication arises because of the collection of weekly
purchase occasions into the appropriate quarter; Uq will be of differing lengths for different quarters depending on the
number of weekly purchase occasions occurring within the
quarter. Thus, the mapping matrix Fq will also be of differing size for each quarter. The matrix Fq contains the appropriate wik according to Equation (13). The covariance matrix
is given by ISq  v  IK , where v = IJ and Sq is number of weekly purchase occasions occurring within the quarter.
We now rewrite the observation and state equations for our
DLM in matrix form:
Uq = Fq A¯ q + q (15)
A¯ q = A¯ q-1 + q

where q  MVN 0

and q  MVN 0 . We use a

forward-filtering, backward-smoothing algorithm (West and

Harrison 1997) to sample the dynamic latent means, A¯ q.

Conditional on Aq F

A¯ 1

A¯ Q , p A¯ A F

, the distribution of A¯ = follows the standard nor-

mal DLM with a known covariance matrix, where A =

A1 AQ . The sampler has the following two steps. Step 1. We sample A¯ q from the posterior distribution
p A¯ q Dq based on the forward-filtering algorithm (see

West and Harrison 1997) for all q = 1 Q, where Dq is

the set of all information available at quarter q.

Step 2. We sample A¯ q-1 from the posterior distribution p A¯ q-1 Dq based on the backward-smoothing algorithm

(see West and Harrison 1997) for all q = 1 Q The result-

ing draws from Steps 1 and 2, A¯ = A¯ 1

A¯ Q , are draws

from the full posterior distribution of the latent dynamic

means. (10) Generate A¯ A¯ 0 . We draw each diagonal element of

one by one.

k j

A¯ k A¯ k0

k j



N

¯k j

1
0

+

1
2

A~ kj0A~ kj0

-1

kj

¯k j

=

1
0

+

1
2

A~ kj0A~ kj0

-1

kj

¯0 0+

1
2

A~ kj0A~ kj

kj

¯0 = 0

0 = 106

The vector A¯ kjq from q =

A~ kj 1

the first position

is the stacked vector of the Q, and A~ kj0 is the vector
and the stacked elements

elements of owf itAh¯ kjqA¯fkjr0omin

q=1

Q - 1 in the remaining positions. The scalar

2 kj

is the appropriate diagonal element of .

(11) Generate aq aq-1 . We draw each diagonal element of one by one

2 kj

akjq akijq  IG

c

+1 2

A~ kj -

k j

A~ kj0

A~ kj -

k j

A~ kj0

d

+Q 2

where c = 3 and d = 1. The vectors A~ kj and A~ kj0 are defined as in Step 10.

We now consider the dynamic importance weights

described in Equations (10) and (11). We detail the

Metropolis step used to estimate the dynamic mean of the

importance weights. Recall that wikq = wqk + vik, where vik 

N 0 1 for k = 1 2, wqk = wq  k, and wq  N wq-1

2 w

,

where ln wq = wq. We require the posterior distribution for

q = 1, 1 < q < Q, and q = Q. The dynamic mean at q = 1

is given the prior distribution w1  N w¯ 1

2 w1

.

Denote

the

probability that yijt = 1 as Pijt and the choice probabilities

belonging to month q as Pijtq. (12) Generate w1 aij1 w2 vi

2 w

i.

The choice likelihood for q = 1 is i j t1 Pijt1. For our

probit model, this likelihood can be computed via the GHK

algorithm. The likelihood for w2 is w2  N w1

2 w

. Finally,

the prior for w1 is w1  N w¯ 1

2 w1

.

The

mixture

of

pro-

bit and log-normal data densities and the log-normal prior

density results in a nonconjugate posterior for w1. We use a random-walk Metropolis algorithm to sample from the

posterior.

(13) Generate wq aijq wq-1 wq+1 vi q < Q.

2 w

i for 1 <

The choice likelihood for q is i j tq Pijtq. For our pro-

bit model, this likelihood can be computed via the GHK

algorithm. The likelihood for wq+1 is wq+1  N wq

2 w

.

Finally, the prior for wq is wq  N wq-1

2 w

.

The

mixture

of probit and log-normal data densities and the log-normal

prior density results in a nonconjugate posterior for wq. We use a random-walk Metropolis algorithm to sample from

the posterior.

(14) Generate wQ aijq wq-1 vi

2 w

i.

The choice likelihood for Q is i j tQ PijtQ. For our

probit model, this likelihood can be computed via the GHK

algorithm. The prior for wQ is wQ  N wQ -1

2 w

.

The

mix-

ture of the probit data density and the log-normal prior

density results in a nonconjugate posterior for wQ. We use a random-walk Metropolis algorithm to sample from the

posterior.

References
Ackerberg, D. A. 2001. Empirically distinguishing informative and prestige effects of advertising. RAND J. Econom. 32(2) 100­118.
Ailawadi, K. L., D. R. Lehmann, S. A. Neslin. 2003. Revenue premium as an outcome measure of brand equity. J. Marketing 67(4) 1­17.
Ariely, D. 2008. Predictably Irrational: The Hidden Forces That Shape Our Decisions. Harper Collins, New York.
Ariely, D., G. Lowenstein, D. Prelec. 2006. Tom Sawyer and the construction of value. J. Econom. Behav. Organ. 60(1) 1­10.

Rutz and Sonnier: The Evolution of Internal Market Structure

Marketing Science 30(2), pp. 274­289, © 2011 INFORMS

289

Bass, F., N. Bruce, S. Majundar, B. P. S. Murthi. 2007. Wearout effects of different advertising themes: A dynamic Bayesian model of the advertising-sales relationship. Marketing Sci. 26(2) 179­195.
Beirne, M. 2008. Bud Light touts "drinkability." Adweek (October 3), http://www.adweek.com/aw/content_display/news/ agency/e3i149edf3e04ae0168b00cab13b4836a92.
Bronnenberg, B. J., M. W. Kruger, C. F. Mela. 2008. The IRI marketing data set. Marketing Sci. 27(4) 745­748.
Bronnenberg, B. J., S. K. Dhar, J.-P. Dubé. 2009. Brand history, geography, and the persistence of CPG brand shares. J. Political Econom. 117(1) 87­115.
Chintagunta, P., D. C. Jain, N. J. Vilcassim. 1991. Investigating heterogeneity in brand preferences in logit models for panel data. J. Marketing Res. 28(4) 417­428.
Chintagunta, P. K. 1994. Heterogeneous logit model implications for brand positioning. J. Marketing Res. 31(2) 304­311.
Cooper, L. G. 1988. Competitive maps: The structure underlying asymmetric cross elasticities. Management Sci. 34(6) 707­723.
Elrod, T. 1988. Choice map: Inferring a product-market map from panel data. Marketing Sci. 7(1) 21­40.
Elrod, T., M. P. Keane. 1995. A factor-analytic probit model for representing the market structure in panel data. J. Marketing Res. 32(1) 1­16.
Erdem, T. 1996. A dynamic analysis of market structure based on panel data. Marketing Sci. 15(4) 359­378.
Erdem, T., R. S. Winer. 1999. Econometric modeling of competition: A multi-category choice-based mapping approach. J. Econometrics 89(1­2) 159­175.
Fader, P. S., B. G. S. Hardie. 1996. Modeling consumer choice among SKUs. J. Marketing Res. 33(4) 442­52.
Griliches, Z., A. Yatchew. 1985. Specification error in probit models. Rev. Econom. Statist. 67(1) 134­139.
Hauser, J. R., P. Simmie. 1981. Profit maximizing perceptual positions: An integrated theory for the selection of product features and price. Management Sci. 27(1) 33­56.
Inman, J. J., J. Park, A. Sinha. 2008. A dynamic choice map approach to modeling attribute-level varied behavior among stockkeeping units. J. Marketing Res. 45(1) 94­103.
Kamakura, W. A., G. J. Russell. 1989. A probabilistic choice model for market segmentation and elasticity structure. J. Marketing Res. 26(4) 379­390.

Keller, K. L. 2003. Strategic Brand Management: Building, Measuring, and Managing Brand Equity. Prentice Hall, Upper Saddle River, NJ.
Kotler, P., K. L. Keller. 2006. Marketing Management. Prentice Hall, Upper Saddle River, NJ.
Kort, P. M., J. P. Caulkins, R. F. Hartl, G. Feichtinger. 2006. Brand image and brand dilution in the fashion industry. Automatica 42(8) 1363­1370.
Kuksov, D., J. M. Villas-Boas. 2008. Endogeneity and individual consumer choice. J. Marketing Res. 45(6) 702­714.
Lachaab, M., A. Ansari, K. Jedidi, A. Trabelsi. 2006. Modeling preference evolution in discrete choice models: A Bayesian statespace approach. Quant. Marketing Econom. 4(1) 57­81.
Liechty, C., D. K. H. Fong, W. S. DeSarbo. 2005. Dynamic models with individual level heterogeneity applied to evolution during conjoint studies. Marketing Sci. 24(2) 285­293.
Narayanan, S., P. Manchanda. 2009. Heterogeneous learning and the targeting of marketing communication for new products. Marketing Sci. 28(3) 424­441.
Nerlove, M., K. J. Arrow. 1962. Optimal advertising policy under dynamic conditions. Economica 29(114) 129­142.
Raftery, A. E., S. M. Lewis. 1995. Implementing MCMC. W. R. Gilks, S. Richardson, D. J. Spiegelhalter, eds. Markov Chain Monte Carlo in Practice. Chapman & Hall, London, 115­130.
Slotegraaf, R. J., K Pauwels. 2008. The impact of brand equity and innovation on the long-term effectiveness of promotions. J. Marketing Res. 45(3) 293­306.
Stigler, G. J., G. S. Becker. 1977. De gustibus non est disputandum. Amer. Econom. Rev. 67(2) 76­90.
Swait, J., J. Louviere. 1993. The role of the scale parameter in the estimation and comparison of multinomial logit models. J. Marketing Res. 30(3) 305­314.
U.S. Food and Drug Administration (FDA). 2009. Letter to General Mills, Inc. (May 5), FDA, Washington, DC. http://www.fda .gov/ICECI/EnforcementActions/WarningLetters/ucm162943 .htm.
Van Heerde, H. J., C. F. Mela, P. Manchanda. 2004. The dynamic effect of innovation on market structure. J. Marketing Res. 41(2) 166­183.
West, M., J. Harrison. 1997. Bayesian Forecasting and Dynamic Models. Springer, New York.

